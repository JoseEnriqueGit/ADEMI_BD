create or replace PACKAGE BODY    pkg_solicitud_credito
IS
    --malmanzar Req. 99362 Begin Codigo Trigger Tempfud 15-02-2022
    PROCEDURE pcrearfud (pid_tempfud                  IN OUT NUMBER,
                         pnomarchivo                  IN OUT VARCHAR2,
                         pprocesado                   IN OUT VARCHAR2,
                         pidaperturacliente           IN OUT VARCHAR2,
                         ptipodocumentoidentidad      IN OUT VARCHAR2,
                         pnumdocumentoidentidad       IN OUT VARCHAR2,
                         pidoficial                   IN OUT VARCHAR2,
                         pidagencia                   IN OUT VARCHAR2,
                         --                        pPIN OUTrimer_Apellido                 VARCHAR2 , ---Buscar en Padr¿n
                         --                        pSIN OUTegundo_Apellido                VARCHAR2 ,
                         --                        pPIN OUTrimer_Nombre                   VARCHAR2 ,
                         --                        pSIN OUTegundo_Nombre                  VARCHAR2 ,
                         pprimernombre                IN OUT VARCHAR2,
                         pprimerapellido              IN OUT VARCHAR2,
                         psexo                        IN OUT VARCHAR2,
                         pfechanacimiento             IN OUT VARCHAR2,
                         papodo                       IN OUT VARCHAR2,
                         pidempleado                  IN OUT VARCHAR2,
                         pidpais                      IN OUT VARCHAR2,
                         pidprovincia                 IN OUT VARCHAR2,
                         pidmunicipio                 IN OUT VARCHAR2,
                         piddistrito                  IN OUT VARCHAR2,
                         pidestadocivil               IN OUT VARCHAR2,
                         pnohijos                     IN OUT VARCHAR2,
                         pdependientes                IN OUT VARCHAR2,
                         pgradoint                    IN OUT VARCHAR2,
                         pidocupacion                 IN OUT VARCHAR2,
                         pidvinculado                 IN OUT VARCHAR2,
                         pnombrevinculado             IN OUT VARCHAR2,
                         pidtipovinculado             IN OUT VARCHAR2,
                         pidcomosuponosotros          IN OUT VARCHAR2,
                         pdireccion                   IN OUT VARCHAR2,
                         pdireccion_idsector          IN OUT VARCHAR2,
                         pdireccion_idprovincia       IN OUT VARCHAR2,
                         pdireccion_idmunicipio       IN OUT VARCHAR2,
                         pdireccion_distrito          IN OUT VARCHAR2,
                         pdireccion_idtipovivienda    IN OUT VARCHAR2,
                         pref_domicilio               IN OUT VARCHAR2,
                         ptelefono_casa               IN OUT VARCHAR2,
                         ptelefono_celular            IN OUT VARCHAR2,
                         pnombrenegocio               IN OUT VARCHAR2,
                         pnoempleados                 IN OUT VARCHAR2,
                         prnc                         IN OUT VARCHAR2,
                         pfax                         IN OUT VARCHAR2,
                         pemail                       IN OUT VARCHAR2,
                         psectoreconomico             IN OUT VARCHAR2,
                         pactividad_ciiu              IN OUT VARCHAR2,
                         pidrama_ciiu                 IN OUT VARCHAR2,
                         pinicio_mes                  IN OUT VARCHAR2,
                         pinicio_ano                  IN OUT VARCHAR2,
                         pubicacion_neg               IN OUT VARCHAR2,
                         plugartrabajo                IN OUT VARCHAR2,
                         pfechaingreso                IN OUT VARCHAR2,
                         pcargo                       IN OUT VARCHAR2,
                         ptrabajo_direccion           IN OUT VARCHAR2,
                         ptrabajo_idsector            IN OUT VARCHAR2,
                         ptrabajo_idprovincia         IN OUT VARCHAR2,
                         ptrabajo_idmunicipio         IN OUT VARCHAR2,
                         ptrabajo_iddistrito          IN OUT VARCHAR2,
                         ppuntoreferencia             IN OUT VARCHAR2,
                         ptelefono                    IN OUT VARCHAR2,
                         pextension                   IN OUT VARCHAR2,
                         prefpersonales_apellidos     IN OUT VARCHAR2,
                         prefpersonales_nombres       IN OUT VARCHAR2,
                         prefpersonales_telefono      IN OUT VARCHAR2,
                         prefpersonales_relfamiliar   IN OUT VARCHAR2,
                         prefpersonales_nombres2      IN OUT VARCHAR2,
                         prefpersonales_apellidos2    IN OUT VARCHAR2,
                         prefpersonales_telefono2     IN OUT VARCHAR2,
                         prefpersonales_relfam2       IN OUT VARCHAR2,
                         pactualmenteenmora           IN OUT VARCHAR2,
                         pcumpliorequisitos           IN OUT VARCHAR2,
                         ppresento_doc_fraudulenta    IN OUT VARCHAR2,
                         pdijolaverdad                IN OUT VARCHAR2,
                         pclienteesfiador             IN OUT VARCHAR2,
                         pclientemoroso               IN OUT VARCHAR2,
                         psobreendeudamiento_sf       IN OUT VARCHAR2,
                         pactividadcliente            IN OUT VARCHAR2,
                         ptipopersona                 IN OUT VARCHAR2,
                         ptipodocumentoidentidadco    IN OUT VARCHAR2,
                         pnumdocumentoidentidadco     IN OUT VARCHAR2,
                         pprimernombreco              IN OUT VARCHAR2,
                         pprimerapellidoco            IN OUT VARCHAR2,
                         psexoco                      IN OUT VARCHAR2,
                         pfechanacimientoco           IN OUT VARCHAR2,
                         papodoco                     IN OUT VARCHAR2,
                         pidempleadoco                IN OUT VARCHAR2,
                         pidpaisco                    IN OUT VARCHAR2,
                         pidprovinciaco               IN OUT VARCHAR2,
                         pidmunicipioco               IN OUT VARCHAR2,
                         piddistritoco                IN OUT VARCHAR2,
                         pidestadocivilco             IN OUT VARCHAR2,
                         pnohijosco                   IN OUT VARCHAR2,
                         pdependientesco              IN OUT VARCHAR2,
                         pgradointco                  IN OUT VARCHAR2,
                         pidocupacionco               IN OUT VARCHAR2,
                         pidvinculadoco               IN OUT VARCHAR2,
                         pnombrevinculadoco           IN OUT VARCHAR2,
                         pidtipovinculadoco           IN OUT VARCHAR2,
                         pidcomosuponosotrosco        IN OUT VARCHAR2,
                         pnombrenegocioco             IN OUT VARCHAR2,
                         pnoempleadosco               IN OUT VARCHAR2,
                         prncco                       IN OUT VARCHAR2,
                         pfaxco                       IN OUT VARCHAR2,
                         pemailco                     IN OUT VARCHAR2,
                         psectoreconomicoco           IN OUT VARCHAR2,
                         pactividad_ciiuco            IN OUT VARCHAR2,
                         pidrama_ciiuco               IN OUT VARCHAR2,
                         pinicio_mesco                IN OUT VARCHAR2,
                         pinicio_anoco                IN OUT VARCHAR2,
                         pubicacion_negco             IN OUT VARCHAR2,
                         plugartrabajoco              IN OUT VARCHAR2,
                         pfechaingresoco              IN OUT VARCHAR2,
                         ptrabajo_direccionco         IN OUT VARCHAR2,
                         ptrabajo_idsectorco          IN OUT VARCHAR2,
                         ptrabajo_idprovinciaco       IN OUT VARCHAR2,
                         ptrabajo_idmunicipioco       IN OUT VARCHAR2,
                         ptrabajo_iddistritoco        IN OUT VARCHAR2,
                         ppuntoreferenciaco           IN OUT VARCHAR2,
                         ptelefonoco                  IN OUT VARCHAR2,
                         pextensionco                 IN OUT VARCHAR2,
                         pcargoco                     IN OUT VARCHAR2,
                         preside_mes                  IN OUT VARCHAR2,
                         preside_ano                  IN OUT VARCHAR2,
                         pactividadco                 IN OUT VARCHAR2,
                         ptipopersonaco               IN OUT VARCHAR2,
                         ptiposolicitud               IN OUT VARCHAR2,
                         pcodigoproyecto              IN OUT VARCHAR2,
                         pdestinocredito              IN OUT VARCHAR2,
                         pespecifiquedestino          IN OUT VARCHAR2,
                         ptipopersonacal              IN OUT VARCHAR2,
                         pedadcal                     IN OUT VARCHAR2,
                         pmontocal                    IN OUT VARCHAR2,
                         pplazocal                    IN OUT VARCHAR2,
                         pmonedacal                   IN OUT VARCHAR2,
                         pdiapagocal                  IN OUT VARCHAR2,
                         pfrecuenciacal               IN OUT VARCHAR2,
                         pgraciacal                   IN OUT VARCHAR2,
                         pgarantiacal                 IN OUT VARCHAR2,
                         pseguro_vehiculocal          IN OUT VARCHAR2,
                         pseguro_vidacal              IN OUT VARCHAR2,
                         pseguro_incendiocal          IN OUT VARCHAR2,
                         pgastoscal                   IN OUT VARCHAR2,
                         ptipoprestamocal             IN OUT VARCHAR2,
                         pgarantiasolidariacal        IN OUT VARCHAR2,
                         phipotecariacal              IN OUT VARCHAR2,
                         pprendariacal                IN OUT VARCHAR2,
                         pliquidacal                  IN OUT VARCHAR2,
                         pcuotasegurocal              IN OUT VARCHAR2,
                         pcuotaprestamocal            IN OUT VARCHAR2,
                         ptotalfinanciarcal           IN OUT VARCHAR2,
                         ptasacal                     IN OUT VARCHAR2,
                         pgastoslegalescal            IN OUT VARCHAR2,
                         psegurovidacal               IN OUT VARCHAR2,
                         pseguroaliadacal             IN OUT VARCHAR2,
                         psegurovehcal                IN OUT VARCHAR2,
                         pclasificacion               IN OUT VARCHAR2,
                         pfirmacliente                IN OUT VARCHAR2,
                         pfirmaco                     IN OUT VARCHAR2,
                         pclientepertenece            IN OUT VARCHAR2,
                         pfecha_registro              IN OUT VARCHAR2, ---malmanzar 10-03-2022
                         ptipocal                     IN OUT NUMBER,
                         ptipoparentesco              IN OUT VARCHAR2,
                         ptipoparentescoco            IN OUT VARCHAR2,
                         ptipopersona2                IN OUT VARCHAR2,
                         ptipocliente                 IN OUT VARCHAR2,
                         ptipoproductos               IN OUT VARCHAR2,
                         pactividadciiu_sol           IN OUT VARCHAR2,
                         pidramaciiu_sol              IN OUT VARCHAR2,
                         errorcode                    IN OUT VARCHAR2,
                         errordescription             IN OUT VARCHAR2,
                         pnocredito                   IN OUT NUMBER,
                         psegundonombre               IN OUT VARCHAR2,
                         psegundoapellido             IN OUT VARCHAR2,
                         psegundonombreco             IN OUT VARCHAR2,
                         psegundoapellidoco           IN OUT VARCHAR2,
                         pcodpaisiso                  IN OUT VARCHAR2,
                         papellidocasadacliente       IN OUT VARCHAR2,
                         pcedulaextranjera            IN OUT VARCHAR2)
    IS
        vcount                      NUMBER;
        verror                      VARCHAR2 (2000);
        vresult                     BOOLEAN;
        vidfud                      NUMBER;
        ---
        v_pa_pais_list              ia.pa_pkg_utl.t_pais_list
                                        := ia.pa_pkg_utl.t_pais_list ();
        tmpvar                      NUMBER;
        vmensaje_jmm                VARCHAR2 (100);
        p_codempresa                NUMBER (5);
        p_codagencia                NUMBER (5);
        p_nrocredito                pr_creditos.no_credito%TYPE;
        p_mensajeerror              VARCHAR2 (200);
        reg1                        pr_credito.t_rec_pr_creditos;
        v_error                     VARCHAR2 (200);
        v_error_sysde               VARCHAR2 (800);
        v_desc_ejecutivo            VARCHAR2 (500);
        v_desc_actividad            VARCHAR2 (500);
        v_agencia_labora            VARCHAR2 (100);
        v_desc_plan_inversion       VARCHAR2 (500);
        v_persona                   id_personas.cod_persona%TYPE;
        v_persona2                  id_personas.cod_persona%TYPE;
        v_nompais                   pais.nacionalidad%TYPE;
        --v_codpais                   pais.cod_pais%TYPE; --malmanzar 10-03-2022
        --
        v_nompaisco                 pais.nacionalidad%TYPE;
        --v_codpaisco                 pais.cod_pais%TYPE;   --malmanzar 10-03-2022
        --
        v_plazo                     pr_creditos.plazo%TYPE;
        vidprovincia                provincias.cod_provincia%TYPE;
        tidprovincia                provincias.cod_provincia%TYPE;
        --
        vplazo_minimo               pr_tipo_credito.plazo_minimo%TYPE;
        vplazo_maximo               pr_tipo_credito.plazo_maximo%TYPE;
        vmonto_minimo               pr_tipo_credito.monto_minimo%TYPE;
        vmonto_maximo               pr_tipo_credito.monto_maximo%TYPE;
        vvariacion_base             pr_tipo_credito.variacion_base%TYPE;
        --
        vporcentaje                 valores_de_tasas_de_interes.porcentaje%TYPE;
        vvariacion_min              tipos_de_tasas_de_interes.variacion_min%TYPE;
        vvariacion_max              tipos_de_tasas_de_interes.variacion_max%TYPE;
        --
        vidprovinciaco              provincias.cod_provincia%TYPE;
        tidprovinciaco              provincias.cod_provincia%TYPE;
        --
        v_cod_cat_clte              cat_clientes.cod_cat_clte%TYPE
            := param.parametro_x_empresa (p_codempresa   => '1',
                                          p_abrev        => 'P_COD_CAT_CLTE',
                                          p_codsistema   => 'PA');
        vcodoficial                 cliente.cod_oficial%TYPE;
        --     vcontempleados              NUMBER;
        --    vfechapertura               VARCHAR2 (11);
        --
        vactividadc                 personas_fisicas.actividad%TYPE;
        vactividadp                 personas_fisicas.actividad%TYPE;
        vcodsubactividadc           sub_actividades_economicas.codigo_subactividad%TYPE;
        vcodsubactividadp           sub_actividades_economicas.codigo_subactividad%TYPE;
        v_credito_anula             NUMBER (5);
        vpasext                     VARCHAR2 (1) := 'N';
        vpasextco                   VARCHAR2 (1) := 'N';
        --
        --    v_nombres                   VARCHAR2 (25) := NULL;
        --   v_apellido1                 VARCHAR2 (25) := NULL;
        --  v_apellido2                 VARCHAR2 (25) := NULL;
        --
        vesvida                     pr_creditos.esvida%TYPE;
        v_nombresco                 VARCHAR2 (25) := NULL;
        v_apellido1co               VARCHAR2 (25) := NULL;
        --    v_apellido2co               VARCHAR2 (25) := NULL;
        ---
        --- Excello:JPH:2019-02-12:Req._93767: Begin >>
        v_procesado                 VARCHAR2 (1) := NULL;
        v_msgerr                    VARCHAR2 (2000) := NULL;
        v_tipotco                   VARCHAR2 (1) := NULL;
        --- Excello:JPH:2019-02-12:Req._93767: End <<
        v_pa_id_personas_list       pa_pkg_utl.t_pa_id_personas_list
                                        := pa_pkg_utl.t_pa_id_personas_list ();
        vnumidformat                VARCHAR2 (30);
        vnumidformatco              VARCHAR2 (30);
        vfundinsert                 VARCHAR2 (60);
        --vTipoId Varchar2(1);
        v_pa_distritos_list         pa_pkg_utl.t_pa_distritos_list
                                        := pa_pkg_utl.t_pa_distritos_list ();
        v_pr_pr_analistas_list      pr_pkg_utl.t_pr_analistas_list
                                        := pr_pkg_utl.t_pr_analistas_list ();
        v_pa_empleados_list         pa_pkg_utl.t_pa_empleados_list
                                        := pa_pkg_utl.t_pa_empleados_list ();
        v_pr_pr_tipo_credito_list   pr_pkg_utl.t_pr_tipo_credito_list
            := pr_pkg_utl.t_pr_tipo_credito_list ();
        --
        vtipodocumentoidentidad     VARCHAR2 (5); --pendiente homologar Lenin de la Rosa   04-08-2022
        vtipodocumentoidentidadco   VARCHAR2 (5);
        v_codpais                   VARCHAR2 (5);
        v_codpaisco                 VARCHAR2 (5);
        --malmanzar 09-06-2022 Begin
        nacionalidadpe              VARCHAR2 (25) := NULL;
        vestadocre                  VARCHAR2 (1);
    --        nacionalidadPECO            VARCHAR2 (25) := NULL;
    --
    --        v_paisx                     INT := 1;
    --        v_distrito                  INT := 0;
    --        v_distrito2                 INT := 0;
    --        v_municipio                 VARCHAR2 (25) := NULL;
    --        v_municipio2                VARCHAR2 (25) := NULL;
    --malmanzar 09-06-2022 End
    --
    BEGIN
        pnomarchivo := REPLACE (pnomarchivo, 'FUD_');

        --p_depura ('Inicia crear fud Linea ' || $$plsql_line);

        p_codempresa := 1;
        reg1.codigo_empresa := TO_NUMBER (p_codempresa);
        reg1.plazo_segun_unidad := pplazocal;
        p_codagencia := pidagencia;
        reg1.codigo_agencia := TO_NUMBER (p_codagencia);
        reg1.tipo_credito := TO_NUMBER (ptipoproductos);     --ptipoproductos;
        reg1.f_apertura :=
            fecha_actual_calendario ('PR',
                                     p_codempresa,
                                     TO_NUMBER (p_codagencia));



        --Valida pais
        vresult :=
            pa_pkg_utl.pais_sb_exists (pidpais            => pidpais,
                                       errorcode          => errorcode,
                                       errordescription   => errordescription);


        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);

        IF NOT vresult
        THEN
            p_depura (
                   'error pidpais '
                || pidpais
                || ' Linea '
                || $$plsql_line
                || ' errordescription '
                || errordescription);
            errordescription :=
                   'error pidpais '
                || pidpais
                || ' Linea '
                || $$plsql_line
                || ' errordescription '
                || errordescription;
            RETURN;
        ELSE
            v_codpais := ia.pa_pkg_utl.fn_obtiene_codpais (pidpais); --malmanzar 11-03-2022

            DBMS_OUTPUT.put_line (
                'v_codpais: ' || v_codpais || '  Linea ' || $$plsql_line);

            v_pa_pais_list :=
                ia.pa_pkg_utl.pais_select (
                    pcod_pais          => NULL,
                    ppais              => NULL,
                    pnacionalidad      => NULL,
                    pcod_area          => NULL,
                    pabreviatura       => NULL,
                    ppais_sb           =>                      /* v_codpais,*/
                                          pidpais,      --malmanzar 11-03-2022
                    pcod_pais_iso      => NULL,
                    prequiere_iban     => NULL,
                    pcod_pais_iso2     => NULL,
                    prequiere_aba      => NULL,
                    prequiere_swift    => NULL,
                    pid_pais_fc        => NULL,
                    pcodigo_pais       => NULL,
                    pid_pais_ls        => NULL,
                    pcalificacion      => NULL,
                    errorcode          => errorcode,
                    errordescription   => errordescription);

            FOR i IN 1 .. v_pa_pais_list.COUNT
            LOOP
                --v_codpais := v_pa_pais_list (i).cod_pais;
                v_nompais := v_pa_pais_list (i).nacionalidad;
            END LOOP;
        END IF;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        --------------------------------------------------------------------------------
        -- Validaci¿n del cliente
        --------------------------------------------------------------------------------
        --       --Pendiente Lenin de la Rosa Homologar tabla tipos id
        --      vTipoId := CASE
        --                    WHEN pTIPODOCUMENTOIDENTIDADCO = 'C'
        --                 THEN '1'
        --                    WHEN pTIPODOCUMENTOIDENTIDADCO = 'R'
        --                 THEN '2'
        --                    WHEN pTIPODOCUMENTOIDENTIDADCO = 'P'
        --                 THEN '4'
        --                 END;
        /*SELECT DECODE (pNUMDOCUMENTOIDENTIDAD,
                       'C', '1',
                       'R', '2',
                       'P', '6',
                       '1')


          INTO vtipodocumentoidentidad
          FROM DUAL;*/
        --malmanzar 09-06-2022

        vtipodocumentoidentidad := NULL;                          --04-08-2022

        vtipodocumentoidentidad :=
            f_tipoid_pda_core (ptipo_id_pda => ptipodocumentoidentidad); --malmanzar 09-06-2022

        vnumidformat :=
            pa.formatear_identifi (pnumdocumentoidentidad,
                                   vtipodocumentoidentidad -- ptipodocumentoidentidad  03-03-2023
                                                          );
        --pTIPODOCUMENTOIDENTIDAD);
        ---p_depura (' crear fud Linea ' || $$plsql_line);
        --        p_depura (
        --               'Linea '
        --            || $$PLSQL_LINE
        --            || ' Program Unit = '
        --            || $$plsql_unit
        --            || ' pnumdocumentoidentidad '
        --            || pnumdocumentoidentidad
        --            ||' pTIPODOCUMENTOIDENTIDAD '
        --            ||pTIPODOCUMENTOIDENTIDAD
        --            || ' pid_tempfud '
        --            || pid_tempfud);
        --

        v_pa_id_personas_list :=
            ia.pa_pkg_utl.pa_id_personas_select (
                pcod_persona       => NULL,
                pcod_tipo_id       => vtipodocumentoidentidad, --pTIPODOCUMENTOIDENTIDAD,  --03-03-2023
                pnum_id            => vnumidformat,        -- '001-1077741-4',
                pfec_vencimiento   => NULL,
                pcod_pais          => NULL,
                errorcode          => errorcode,
                errordescription   => errordescription);

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);

        vcount := v_pa_id_personas_list.COUNT;

        --        p_depura (
        --               'Vcount '
        --            || vcount
        --            || ' pNUMDOCUMENTOIDENTIDAD '
        --            || pNUMDOCUMENTOIDENTIDAD
        --            || ' vNumIdFormat '
        --            || vNumIdFormat);

        FOR i IN 1 .. v_pa_id_personas_list.COUNT
        LOOP
            v_persona := v_pa_id_personas_list (i).cod_persona;
        --p_depura ('v_persona ' || v_persona);
        END LOOP;

        ----V_Pa_Id_Personas_List.DELETE;

        ---p_depura (' crear fud Linea ' || $$plsql_line);
        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);

        IF v_persona IS NULL AND reg1.codigo_cliente IS NULL
        THEN
            SELECT s_cod_persona.NEXTVAL INTO v_persona FROM DUAL;

            --            p_depura ('v_persona ' || v_persona);
            --            p_depura (
            --                'reg1.codigo_cliente ' || reg1.codigo_cliente);
            --            p_depura (
            --                'pTIPODOCUMENTOIDENTIDAD ' || pTIPODOCUMENTOIDENTIDAD);
            --            p_depura ('vNumIdFormat ' || vNumIdFormat);

            -- p_depura( v_persona || ' PERSONA JMM' );
            reg1.codigo_cliente := TO_NUMBER (v_persona);
            vpasextco := 'S';                                --realizar prueba

            BEGIN
                SELECT concepto, grupo --<<I.SSANMIGUEL|SYSDECL-508|13042016>>
                  INTO vactividadp, vcodsubactividadp
                  FROM pa.actividades_economicas_bc_ciiu
                 WHERE segregacion_rd = pidrama_ciiu AND estado = 'S';
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '5-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Agregando Personas Fisicas '
                        || 'pIDRAMA_CIIU '
                        || pidrama_ciiu
                        || SQLERRM;
                    p_depura (errordescription);
                    ROLLBACK;
                    RETURN;
            ---pidestado              := 'R';
            -- :New.mensaje               := 'Rechazado';
            --               If ia.api_portacredit.fnupdatefud( :New.id_tempfud, 0, 'R', v_error, 0 ) Then
            --                  ---- Dbms_output.put_line(' codigo de pais no se encuentra registrado'|| :New.idpais);
            --                  raise_application_error( num => -20000, msg => v_error );
            --               End If;
            END;

            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            --p_depura (' crear fud Linea ' || $$plsql_line);



            ---malmanzar 10-06-2022 Trabajar creacion persona fisica, utilizar pkg_cliente.generar_ciente ==> TC

            --Insertar Persona Fisica
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            BEGIN
                pa_pkg_utl.pa_personas_fisicas_insert (
                    pcod_per_fisica         => v_persona,
                    pest_civil              => pidestadocivil,
                    psexo                   => psexo,
                    pfec_nacimiento         =>
                        TO_DATE (pfechanacimiento, 'dd-mm-yyyy'),
                    pprimer_apellido        => pprimerapellido, --pPrimer_Apellido ,
                    psegundo_apellido       => psegundoapellido, --pSegundo_Apellido ,
                    pprimer_nombre          => pprimernombre, --pPrimer_Nombre,
                    psegundo_nombre         => psegundonombre, ---pSegundo_Nombre,
                    pprofesion              => NULL,
                    pidioma_correo          => 'ESPA',
                    pes_mal_deudor          => NULL,
                    pconyugue               => NULL,
                    pnacionalidad           => v_nompais,
                    pcod_sector             => TO_NUMBER (psectoreconomico),
                    pestatal                => NULL,
                    pemail_usuario          => pemail,
                    pemail_servidor         => NULL,
                    pnivel_estudios         => NULL,
                    ptipo_vivienda          => NULL,
                    pnum_hijos              => pnohijos,
                    pnum_dependientes       => pdependientes,
                    pes_residente           => NULL,
                    ptiempo_vivien_act      => NULL,
                    peval_ref_bancaria      => 'V',
                    peval_ref_tarjetas      => 'V',
                    peval_ref_laboral       => 'C',
                    ptotal_ingresos         => 0,
                    pcod_pais               => v_codpais, --malmanzar 10-03-2022
                    pincluido_por           => USER,
                    pfec_inclusion          => SYSDATE,
                    pmodificado_por         => NULL,
                    pfec_modificacion       => NULL,
                    pscoring                => NULL,
                    pactividad              => vactividadp,
                    prango_ingresos         => 1,
                    pcasada_apellido        => NULL,
                    pes_funcionario         => NULL,
                    pes_peps                => NULL,
                    pcod_actividad          => pidrama_ciiu,             ---39
                    pcod_subactividad       => vcodsubactividadp,
                    ptipo_persona           => ptipopersona2, ---pTIPOPERSONA,
                    ptipo_cliente           => ptipocliente,
                    pcod_pais_padre         => v_codpais,
                    pcod_pais_madre         => v_codpais,
                    pcod_pais_conyugue      => v_codpais,
                    pmas_180_dias_eeuu      => NULL,
                    pcod_finalidad          => NULL,
                    ppeso                   => NULL,
                    pestatura               => NULL,
                    pactividad_polizah      => NULL,
                    pdeporte_polizah        => NULL,
                    ppeso_polizah           => NULL,
                    pestatura_polizah       => NULL,
                    papellido_casada        => NULL,
                    ptercer_nombre          => NULL,
                    ptipo_soc_conyugal      => NULL,
                    pind_fallecimiento      => NULL,
                    pfec_fallecimiento      => NULL,
                    pgpo_riesgo             => NULL,
                    pnum_empleados          => NULL,
                    pventas_ingresos        => NULL,
                    pcp_total_activo        => NULL,
                    pind_clte_vip           => NULL,
                    pocupacion_clasif_nac   => NULL, --15-10-2024  --Solo para compilar PC1
                    ptipo_gen_divisas       => NULL, --15-10-2024   --Solo para compilar PC1
                    errorcode               => errorcode,
                    errordescription        => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '6-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Creando persona fisica >>  Program Unit = '
                        || $$plsql_unit
                        || ' $$PLSQL_LINE = '
                        || $$plsql_line
                        || ' Sqlerrm '
                        || SQLERRM;
                    p_depura (
                           'errorCode '
                        || errorcode
                        || ' errorDescription '
                        || errordescription);
                    RETURN;
            END;

            --
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            --
            --            p_depura (' crear fud Linea ' || $$plsql_line);

            -- Insertar Persona
            BEGIN
                pa_pkg_utl.pa_personas_insert (
                    pcod_persona          => v_persona,
                    pcod_per_fisica       => v_persona,
                    pcod_per_juridica     => NULL,
                    pes_fisica            => 'S',
                    pnombre               =>
                           pprimernombre
                        || ' '
                        || psegundonombre
                        || ' '
                        || pprimerapellido
                        || ' '
                        || psegundoapellido,
                    pind_clte_i2000       => 'N',
                    ppaga_imp_ley288      => 'S',
                    pbenef_pag_ley288     => 'S',
                    pcod_vinculacion      => pidtipovinculado,
                    pcod_sec_contable     => '030202', --pSECTORECONOMICO, --11-04-2023
                    padicionado_por       => USER,
                    pfecha_adicion        => SYSDATE,
                    pmodificado_por       => NULL,
                    pfecha_modificacion   => NULL,
                    pcodigo_sustituto     => NULL,
                    pestado_persona       => 'A',
                    pcobr_nodgii_132011   => 'N',
                    plleno_fatca          => 'N',
                    pimprimio_fatca       => 'N',
                    pes_fatca             => 'N',
                    pfec_actualizacion    => NULL,
                    ptel_verificado       => 'N',
                    errorcode             => errorcode,
                    errordescription      => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '7-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Creando persona  >>Sqlerrm '
                        || SQLERRM;
                    RETURN;
            END;

            --
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            --p_depura (' crear fud Linea ' || $$plsql_line);

            --Get Provincia
            BEGIN
                v_pa_distritos_list :=
                    pa_pkg_utl.pa_distritos_select (
                        pcod_pais          => NULL,
                        pcod_provincia     => NULL,
                        pcod_canton        =>
                            TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 1, 2)),
                        pcod_distrito      =>
                            TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 3, 2)),
                        pdescripcion       => NULL,
                        pabreviatura       => NULL,
                        ptipo              => NULL,
                        pcod_serie         => NULL,
                        plocalidad_sb      => NULL,
                        pid_ciudad_fc      => NULL,
                        pid_ciudad_ls      => NULL,
                        errorcode          => errorcode,
                        errordescription   => errorcode);

                FOR i IN 1 .. v_pa_distritos_list.COUNT
                LOOP
                    vidprovincia := v_pa_distritos_list (i).cod_provincia;
                END LOOP;
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '8-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Consultando distrito  >>Sqlerrm '
                        || SQLERRM;
                    RETURN;
            END;

            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            -- Insertar direcci¿n

            --            DBMS_OUTPUT.put_line (
            --                   'Pa_Dir_Personas_Insert Linea'
            --                || $$plsql_line
            --                || ' v_persona '
            --                || v_persona
            --                || ' v_codpais '
            --                || v_codpais
            --                || ' vidprovincia '
            --                || vidprovincia
            --                || ' pdireccion_idmunicipio '
            --                || pdireccion_idmunicipio);

            BEGIN
                pa_pkg_utl.pa_dir_personas_insert (
                    pcod_persona          => v_persona,
                    pcod_direccion        => 1,
                    ptip_direccion        => 1,
                    papartado_postal      => NULL,
                    pcod_postal           => NULL,
                    pdetalle              => pdireccion,
                    pcod_pais             => v_codpais,
                    pcod_provincia        => vidprovincia,
                    pcod_canton           =>
                        TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 1, 2)),
                    pcod_distrito         =>
                        TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 3, 2)),
                    pcod_pueblo           => '1', --NULL,  malmanzar 11-03-2023
                    pes_default           => 'S',
                    pcolonia              => NULL,
                    pzona                 => NULL,
                    pind_estado           => 'S',
                    pincluido_por         => USER,
                    pfec_inclusion        => SYSDATE,
                    pmodificado_por       => NULL,
                    pfecha_modificacion   => NULL,
                    errorcode             => errorcode,
                    errordescription      => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '9-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Insertando direcci¿n Pa_Dir_Personas_Insert >>Sqlerrm '
                        || SQLERRM;
                    p_depura (
                           'pdireccion_id_municipio '
                        || TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 1, 2))
                        || ' Linea '
                        || $$plsql_line
                        || ' v_codpais '
                        || v_codpais
                        || ' vidprovincia '
                        || vidprovincia);

                    RETURN;
            END;

            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            --            ---p_depura (' crear fud Linea ' || $$plsql_line);
            tidprovincia := vidprovincia;

            --Inserta Direccion Trabajo
            BEGIN
                pa_pkg_utl.pa_dir_personas_insert (
                    pcod_persona          => v_persona,
                    pcod_direccion        => 2,
                    ptip_direccion        => 2,
                    papartado_postal      => NULL,
                    pcod_postal           => NULL,
                    pdetalle              => ptrabajo_direccion,
                    pcod_pais             => v_codpais,
                    pcod_provincia        => tidprovincia,
                    pcod_canton           =>
                        TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 1, 2)),
                    pcod_distrito         =>
                        TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 3, 2)),
                    pcod_pueblo           => '1',       --malmanzar 11-03-2023
                    pes_default           => 'N',
                    pcolonia              => NULL,
                    pzona                 => NULL,
                    pind_estado           => 'S',
                    pincluido_por         => USER,
                    pfec_inclusion        => SYSDATE,
                    pmodificado_por       => NULL,
                    pfecha_modificacion   => NULL,
                    errorcode             => errorcode,
                    errordescription      => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '10-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Insertando direcci¿n trabajo Pa_Dir_Personas_Insert >>Sqlerrm '
                        || SQLERRM;
                    p_depura (
                           'pdireccion_id_municipio '
                        || TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 1, 2))
                        || ' Linea '
                        || $$plsql_line);
                    RETURN;
            END;



            BEGIN
                pa_pkg_utl.pa_dir_envio_x_pers_insert (
                    pcod_persona       => v_persona,
                    ptipo_envio        => 'D',
                    papdo_postal       => 1,
                    pcodigo_postal     => NULL,
                    pcod_direccion     => '1',    --NULL, malmanzar 14-03-2023
                    pcod_area          => NULL,
                    pnum_telefono      => NULL,
                    pnum_casilla       => NULL,
                    pcod_empresa       => NULL,
                    pcod_agencia       => NULL,
                    pemail_usuario     => NULL,
                    pemail_servidor    => NULL,
                    errorcode          => errorcode,
                    errordescription   => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '11-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Insertando direcci¿n trabajo Pa_Dir_Personas_Insert >>Sqlerrm '
                        || SQLERRM;
                    p_depura (
                           'pdireccion_id_municipio '
                        || TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 1, 2))
                        || ' Linea '
                        || $$plsql_line);
                    RETURN;
            END;


            p_depura (
                   'Linea '
                || $$plsql_line
                || ' Program Unit = '
                || $$plsql_unit);

            -----------------------------------------------------------------------
            -- Telefonos del cliente
            -----------------------------------------------------------------------
            --Se valida que tenga al menos un telefono
            -----------------------------------------------------------------------
            BEGIN
                IF     TO_NUMBER (REPLACE (TRIM (ptelefono_casa), '-')) = 0
                   AND TO_NUMBER (REPLACE (TRIM (ptelefono_celular), '-')) =
                       0
                THEN
                    errorcode := '12';
                    errordescription :=
                        'El cliente debe tener minimo un telefono de casa o celular.';
                    RETURN;
                END IF;
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '13';
                    errordescription :=
                        'Validando telefonos Deudor' || SQLERRM;
                    RETURN;
            END;



            --Insertar Telefono
            IF TO_NUMBER (REPLACE (TRIM (ptelefono_casa), '-')) != 0
            THEN
                BEGIN
                    pa_pkg_utl.pa_tel_personas_insert (
                        pcod_persona          => v_persona,
                        pcod_area             => SUBSTR (ptelefono_casa, 1, 3),
                        pnum_telefono         =>
                            REPLACE (SUBSTR (ptelefono_casa, 4), '-', NULL),
                        ptip_telefono         => 'R',
                        ptel_ubicacion        => 'O',
                        pextension            => NULL,
                        pnota                 => 'PortaCredit',
                        pes_default           => 'N', --'S',  ---malmanzar 22-03-2023
                        pposicion             => NULL,
                        pcod_direccion        => 1,
                        pcod_pais             => v_codpais,
                        pmodificado_por       => NULL,
                        pfecha_modificacion   => NULL,
                        pincluido_por         => USER,
                        pfec_inclusion        => SYSDATE,
                        errorcode             => errorcode,
                        errordescription      => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '14-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Validando telefonos Deudor'
                            || SQLERRM;
                        RETURN;
                END;
            END IF;                                            --telefono casa


            IF TO_NUMBER (REPLACE (TRIM (ptelefono_celular), '-')) != 0
            THEN
                BEGIN
                    pa_pkg_utl.pa_tel_personas_insert (
                        pcod_persona          => v_persona,
                        pcod_area             => SUBSTR (ptelefono_celular, 1, 3),
                        pnum_telefono         =>
                            REPLACE (SUBSTR (ptelefono_celular, 4),
                                     '-',
                                     NULL),
                        ptip_telefono         => 'C',
                        ptel_ubicacion        => 'O',
                        pextension            => NULL,
                        pnota                 => 'PortaCredit',
                        pes_default           => 'S',
                        pposicion             => NULL,
                        pcod_direccion        => 1,
                        pcod_pais             => v_codpais,
                        pmodificado_por       => NULL,
                        pfecha_modificacion   => NULL,
                        pincluido_por         => USER,
                        pfec_inclusion        => SYSDATE,
                        errorcode             => errorcode,
                        errordescription      => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '15-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Validando telefono Celular Deudor'
                            || SQLERRM;
                        RETURN;
                END;
            END IF;                                         --Telefono Celular



            --malmanzar 09-06-2022 Begin
            IF pcodpaisiso IS NULL
            THEN
                nacionalidadpe := v_nompais;
            ELSE
                SELECT nacionalidad
                  INTO nacionalidadpe
                  FROM pais
                 WHERE pais_sb = pcodpaisiso AND ROWNUM <= 1;
            END IF;

            --p_depura ('Nacionalidad  ' || nacionalidadPE);

            --malmanzar 09-06-2022 End


            vpasext := 'S';                             --malmanzar 03-03-2023

            IF vpasext = 'S'
            THEN
                BEGIN
                    pa_pkg_utl.pa_id_personas_insert (
                        pcod_persona       => v_persona,
                        pcod_tipo_id       => vtipodocumentoidentidad, --pTIPODOCUMENTOIDENTIDAD,  --03-03-2023 ptipodocumentoidentidad,
                        pnum_id            => vnumidformat, --pnumdocumentoidentidad, --03-03-2023
                        pfec_vencimiento   =>
                            TO_DATE ('31/12/2050', 'dd/mm/yyyy'),
                        pcod_pais          => v_codpais,
                        pnacionalidadpe    => nacionalidadpe, --malmanzar 09-06-2022
                        errorcode          => errorcode,
                        errordescription   => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '17-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-insertando Pa_Id_Personas_Insert'
                            || SQLERRM;
                        RETURN;
                END;
            END IF;


            BEGIN
                pa_pkg_utl.pa_infofisicanacion_insert (
                    pcod_persona                    => v_persona,
                    ppind_cedula                    => 'S',
                    ppind_licencia_conducir         => 'N',
                    ppind_residencia                => 'N',
                    ppind_id_otro                   => 'N',
                    pid_otro_desc                   => NULL,
                    ppind_certificado_nacimiento    => 'N',
                    ppind_pensionado_jubilado       => 'N',
                    ppind_lab_tiempo                => 'N',
                    ppind_lab_ingreso_anual         => 'N',
                    ppind_lab_puesto_desempena      => 'N',
                    ppind_trabaja_independiente     => 'N',
                    ppind_independiente_actividad   => 'N',
                    ppindindependientejustificaa    => 'N',
                    pcomentarios_adicionales        => 'Registrado por PDA',
                    errorcode                       => errorcode,
                    errordescription                => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '18-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-insertando Pa_Id_Personas_Insert'
                        || SQLERRM;
                    RETURN;
            END;


            BEGIN
                BEGIN
                    v_pr_pr_analistas_list :=
                        ia.pr_pkg_utl.pr_analistas_select (
                            pcodigo_empresa       => p_codempresa,
                            pcodigo_analista      => pidoficial,
                            pnombre_analista      => NULL,
                            pcodigo_persona       => NULL,
                            pes_analista          => NULL,
                            pes_aprobador         => NULL,
                            padicionado_por       => NULL,
                            pfecha_adicion        => NULL,
                            pmodificado_por       => NULL,
                            pfecha_modificacion   => NULL,
                            errorcode             => errorcode,
                            errordescription      => errordescription);


                    FOR i IN 1 .. v_pr_pr_analistas_list.COUNT
                    LOOP
                        vcodoficial :=
                            v_pr_pr_analistas_list (i).codigo_persona;
                    END LOOP;

                    IF vcodoficial IS NOT NULL
                    THEN
                        v_pa_empleados_list :=
                            ia.pa_pkg_utl.pa_empleados_select (
                                pcod_empresa           => p_codempresa,
                                pid_empleado           => vcodoficial,
                                pcod_per_fisica        => NULL,
                                pcod_puesto            => NULL,
                                pcod_agencia           => NULL,
                                pcod_agencia_labora    => NULL,
                                pesta_activo           => NULL,
                                pfec_ingreso           => NULL,
                                pextension             => NULL,
                                patiende_quejas        => NULL,
                                patiende_publico       => NULL,
                                pcrosselling           => NULL,
                                prentabilidad          => NULL,
                                pes_oficial            => NULL,
                                pes_promotor           => NULL,
                                pes_externo            => NULL,
                                pcod_canal             => NULL,
                                pemail1                => NULL,
                                pemail2                => NULL,
                                psupervisor            => NULL,
                                pfirma_autorizada      => NULL,
                                ptipo_firma            => NULL,
                                pimp_corte_cta         => NULL,
                                pcod_motivo            => NULL,
                                pes_oficial_cta        => NULL,
                                pind_autosegesp        => NULL,
                                pnivel_aprobacion      => NULL,
                                pver_todos_referidos   => NULL,
                                pid_jefe               => NULL,
                                pcateg_empleados       => NULL,
                                parea_trabaja          => NULL,
                                presponsab_emple       => NULL,
                                errorcode              => errorcode,
                                errordescription       => errordescription);

                        IF v_pa_empleados_list.COUNT = 0
                        THEN
                            errorcode := '19-' || errorcode;
                            errordescription :=
                                   errordescription
                                || '-No existe oficial como empleado '
                                || SQLERRM;
                            RETURN;
                        END IF;
                    END IF;
                EXCEPTION
                    WHEN NO_DATA_FOUND
                    THEN
                        errorcode := '20';
                        errordescription := 'No existe oficial ' || SQLERRM;
                        RETURN;
                END;
            END;

            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            --            p_depura (' crear fud Linea ' || $$plsql_line);

            --Inserta cliente
            BEGIN
                ia.pa_pkg_utl.pa_cliente_insert (
                    pcod_empresa              => p_codempresa,
                    pcod_cliente              => v_persona,
                    pnum_cliente              => v_persona,
                    pcod_agencia              => TO_NUMBER (p_codagencia),
                    pcod_cat_clte             => v_cod_cat_clte,
                    pcod_grupo                => NULL,
                    pesta_activo              => 'S',
                    ppaga_impto_renta         => 'S',
                    pfec_ingreso              => SYSDATE,
                    pcat_riesgo               => 'A',
                    pcod_oficial              => vcodoficial,
                    pcod_promotor             => vcodoficial,
                    pcod_zona                 => NULL,
                    pcliente_especial         => 'N',
                    ptipo_deudor              => 1,
                    pcross_estimado           => 30,
                    pcross_calculado          => 0,
                    prentabilidad             => 0,
                    pmon_ingreso_bco          => 0,
                    pmon_egreso_bco           => 0,
                    pcod_sub_agencia          => NULL,
                    pestado_cliente           => 'A',
                    pcod_nicho                => '99',
                    pfec_actualiza_ingresos   => NULL,
                    pcomentario_act_ingreso   => 'INGRESO POR PDA',
                    pnum_carpeta              => NULL,
                    pcod_linea_credito        => NULL,
                    pincluido_por             => USER,
                    pfec_inclusion            => SYSDATE,
                    pmodificado_por           => NULL,
                    pfec_modificacion         => NULL,
                    errorcode                 => errorcode,
                    errordescription          => errordescription);
            EXCEPTION
                WHEN NO_DATA_FOUND
                THEN
                    errorcode := '21-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error ia.pa_pkg_utl.Pa_Cliente_Inser  '
                        || SQLERRM;
                    RETURN;
            END;
        ELSE
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            --            p_depura (' crear fud Linea ' || $$plsql_line);
            --Cliente existe
            reg1.codigo_cliente := TO_NUMBER (v_persona);

            -- Excello:JPH:2019-02-12:Req._93767: Begin >>
            -- Actualizacion datos clientes  ---

            --1- Datos Persona --
            IF pidtipovinculado IS NOT NULL
            THEN                                          --- Tipo Vinculacion
                pa.pa_mant_datos_personas.p_act_datos_cliente_persona (
                    v_persona,
                    'TIP_VINCULO',
                    pidtipovinculado,
                    v_procesado,
                    v_error);

                IF v_error IS NOT NULL
                THEN
                    v_error :=
                        'FUD Error procesando cliente ' || ' ' || v_error;
                    errorcode := '22';
                    errordescription := v_error || SQLERRM;
                    RETURN;
                END IF;
            END IF;

            IF pemail IS NOT NULL
            THEN
                pa.pa_mant_datos_personas.p_act_datos_cliente_persona (
                    v_persona,
                    'EMAIL',
                    pemail,
                    v_procesado,
                    v_error);

                IF v_error IS NOT NULL
                THEN
                    v_error :=
                        'FUD Error procesando cliente ' || ' ' || v_error;
                    errorcode := '23';
                    errordescription := v_error || SQLERRM;
                    RETURN;
                END IF;
            END IF;

            -- 2- Direcciones  --
            -- 2.1- Direccion Domicilio ---
            IF LENGTH (pdireccion) > 0
            THEN
                pa.pa_mant_datos_personas.p_inserta_direccion (
                    v_persona,
                    pdireccion,
                    pdireccion_idmunicipio,
                    v_codpais,
                    '1',
                    'S',
                    v_procesado,
                    v_msgerr);

                IF v_error IS NOT NULL
                THEN
                    v_error :=
                        'FUD Error procesando cliente ' || ' ' || v_error;
                    errorcode := '24';
                    errordescription := v_error || SQLERRM;
                    RETURN;
                END IF;
            END IF;

            --            p_depura (' crear fud Linea ' || $$plsql_line);
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            -- 2.2- Direccion Trabajo ---
            IF LENGTH (ptrabajo_direccion) > 0
            THEN
                pa.pa_mant_datos_personas.p_inserta_direccion (
                    v_persona,
                    ptrabajo_direccion,
                    ptrabajo_idmunicipio,
                    v_codpais,
                    '2',
                    'N',
                    v_procesado,
                    v_msgerr);

                IF v_msgerr IS NOT NULL
                THEN
                    v_error :=
                        'FUD Error procesando cliente ' || ' ' || v_msgerr;
                    errorcode := '24';
                    errordescription := v_error || SQLERRM;
                    RETURN;
                END IF;
            END IF;

            --2.2.1 Informaci¿n Laboral  --
            --            p_depura (' crear fud Linea ' || $$plsql_line);
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            IF plugartrabajo IS NOT NULL AND pfechaingreso IS NOT NULL
            THEN
                pa.pa_mant_datos_personas.p_inserta_info_laboral (
                    v_persona,
                    TO_DATE (pfechaingreso, 'DD/MM/YYYY'),
                    plugartrabajo,
                    0,                     -- Sueldo (Campo no existe en tabla
                    NVL (pcargo, 'NO ESPECIFICADO'),
                    ptrabajo_direccion,
                    REPLACE (ptelefono, '-'),
                    TO_CHAR (TO_NUMBER (pextension)),
                    --Excello:malmanzar: 2022-02-15:REQ_99362:Begin >>
                    pnomarchivo,                --P_Archivo_FUD  In  Varchar2,
                    pnumdocumentoidentidad,     --P_TIdper_FUD   In  Varchar2,
                    vnumidformat,               --P_NumIdoer_FUD In  Varchar2,
                    --Excello:malmanzar: 2022-02-15:REQ_99362:End >>
                    v_procesado,
                    v_msgerr);

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                IF v_msgerr IS NOT NULL
                THEN
                    v_error :=
                           'FUD Error procesando informaci¿n laboral'
                        || ' '
                        || v_msgerr;
                    errorcode := '25';
                    errordescription := v_error || SQLERRM;
                    RETURN;
                END IF;
            END IF;

            --            p_depura (' crear fud Linea ' || $$plsql_line);
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            -- 3- Telefonos  --
            -- 3.1- Residencial --
            IF TO_NUMBER (REPLACE (ptelefono_casa, '-')) != 0
            THEN
                pa.pa_mant_datos_personas.p_inserta_telefono (
                    v_persona,
                    REPLACE (ptelefono_casa, '-'),
                    NULL,
                    'R',
                    'PortaCredit',
                    v_codpais,
                    'S',
                    v_procesado,
                    v_msgerr);

                IF v_msgerr IS NOT NULL
                THEN
                    v_error :=
                        'FUD Error procesando cliente ' || ' ' || v_msgerr;
                    errorcode := '26';
                    errordescription := v_error || SQLERRM;
                    RETURN;
                END IF;
            END IF;

            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            --            p_depura (' crear fud Linea ' || $$plsql_line);

            -- 3.2- celular --
            IF TO_NUMBER (REPLACE (ptelefono_celular, '-')) != 0
            THEN
                pa.pa_mant_datos_personas.p_inserta_telefono (
                    v_persona,
                    REPLACE (ptelefono_celular, '-'),
                    NULL,
                    'C',
                    'PortaCredit',
                    v_codpais,
                    'N',
                    v_procesado,
                    v_msgerr);

                IF v_msgerr IS NOT NULL
                THEN
                    v_error :=
                        'FUD Error procesando cliente ' || ' ' || v_msgerr;
                    errorcode := '27';
                    errordescription := v_error || SQLERRM;
                    RETURN;
                END IF;
            END IF;
        -- Excello:JPH:2019-02-12:Req._93767: End <<

        END IF;                                            --Cliente no existe



        ---Insertar referencias personales Begin 01-04-2023

        --select * from ref_personales
        --1.

        --        p_depura (
        --               ' p_ref_personales Linea: '
        --            || $$plsql_line
        --            || ' pREFPERSONALES_NOMBRES '
        --            || pREFPERSONALES_NOMBRES
        --            || ' pREFPERSONALES_APELLIDOS: '
        --            || pREFPERSONALES_APELLIDOS);

        p_ref_personales (
            pcod_persona        => v_persona,
            pcod_empresa        => '1',
            pcod_tipo_id        => '1',                           -- VARCHAR2,
            pnombre_ref         =>
                prefpersonales_nombres || ' ' || prefpersonales_apellidos,
            pnum_id             => '000-0000000-1',
            pcod_area           => SUBSTR (prefpersonales_telefono, 1, 3),
            pnum_telefono       => SUBSTR (prefpersonales_telefono, 4, 7),
            ppuesto             => NULL,
            plugar_trabajo      => NULL,
            prelacion_persona   => 'AMIGO',
            pobservaciones      => NULL,
            pextension_tel      => NULL);
        --2.
        --
        --        p_depura (
        --               ' p_ref_personales Linea: '
        --            || $$plsql_line
        --            || ' pREFPERSONALES_NOMBRES2 '
        --            || pREFPERSONALES_NOMBRES2
        --            || ' pREFPERSONALES_APELLIDOS2: '
        --            || pREFPERSONALES_APELLIDOS2);
        p_ref_personales (
            pcod_persona        => v_persona,
            pcod_empresa        => '1',
            pcod_tipo_id        => '1',
            pnombre_ref         =>
                prefpersonales_nombres2 || ' ' || prefpersonales_apellidos2,
            pnum_id             => '000-0000000-2',
            pcod_area           => SUBSTR (prefpersonales_telefono2, 1, 3),
            pnum_telefono       => SUBSTR (prefpersonales_telefono2, 4, 7),
            ppuesto             => NULL,
            plugar_trabajo      => NULL,
            prelacion_persona   => 'AMIGO',
            pobservaciones      => NULL,
            pextension_tel      => NULL);

        ------End Insertar referencias personales Begin 01-04-2023


        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        --        p_depura (' crear fud Linea ' || $$plsql_line);


        --DBMS_OUTPUT.put_line ('Antes Codeudor .. Linea ' || $$plsql_line);

        ----------25-03-2023 Mover logica codeudor Begin
        -- Verificacion de Codeudor
        IF     pnumdocumentoidentidadco IS NOT NULL
           AND UPPER (ptipopersonaco) = 'CONYUGE' --malmanzar 28-03-2023, se incluye tipopersona Conyuge,
 --anteriormente tratada como codeudor, ahora crea persona y la relaciona a persona f¿sica, pero no la vincula al cr¿dito.
        THEN
            vtipodocumentoidentidadco :=
                f_tipoid_pda_core (ptipo_id_pda => ptipodocumentoidentidadco);

            vnumidformatco :=
                pa.formatear_identifi (pnumdocumentoidentidadco,
                                       vtipodocumentoidentidadco --pTIPODOCUMENTOIDENTIDAD,  --03-03-2023pTIPODOCUMENTOIDENTIDADCO
                                                                );

            --            DBMS_OUTPUT.put_line (
            --                   'Procesando Codeudor .. Linea: '
            --                || $$plsql_line
            --                || ' vtipodocumentoidentidadco: '
            --                || vtipodocumentoidentidadco
            --                || ' vNumIdFormatco:'
            --                || vNumIdFormatco);


            BEGIN
                v_pa_id_personas_list :=
                    ia.pa_pkg_utl.pa_id_personas_select (
                        pcod_persona       => NULL,
                        pcod_tipo_id       => vtipodocumentoidentidadco, --pTIPODOCUMENTOIDENTIDADCO, --malmanzar 03-03-2023
                        pnum_id            => vnumidformatco,
                        pfec_vencimiento   => NULL,
                        pcod_pais          => NULL,
                        errorcode          => errorcode,
                        errordescription   => errordescription);

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit
                --                    || ' pNUMDOCUMENTOIDENTIDADCO '
                --                    || pNUMDOCUMENTOIDENTIDADCO
                --                    || ' errorCode: '
                --                    || errorCode
                --                    || ' errorDescription: '
                --                    || errorDescription);

                FOR i IN 1 .. v_pa_id_personas_list.COUNT
                LOOP
                    v_persona2 := v_pa_id_personas_list (i).cod_persona;
                END LOOP;

                --reg1.codigo_clienteco := v_persona2;    28-03-2023       -- JMM 20160423
                vpasextco := 'S';
            EXCEPTION
                WHEN OTHERS
                THEN
                    reg1.codigo_clienteco := NULL;
            END;



            --            DBMS_OUTPUT.put_line (
            --                   'antes  v_persona2 '
            --                || v_persona2
            --                || ' Linea: '
            --                || $$plsql_line
            --                || 'reg1.codigo_clienteco '
            --                || reg1.codigo_clienteco);

            IF v_persona2 IS NULL --AND reg1.codigo_clienteco IS NULL ---IS NULL 26-07-2022 malmanzar
            THEN
                --                DBMS_OUTPUT.put_line (
                --                       'Entro  v_persona2 '
                --                    || v_persona2
                --                    || ' Linea: '
                --                    || $$plsql_line);
                ---Crear codeudor

                --A nd :New.numdocumentoidentidadco Is Not Null Then
                SELECT s_cod_persona.NEXTVAL INTO v_persona2 FROM DUAL;

                ---
                --reg1.codigo_clienteco := TO_NUMBER (v_persona2);
                --reg1.codigo_relacionco := 'O';

                BEGIN
                    SELECT concepto, grupo --<<I.SSANMIGUEL|SYSDECL-508|13042016>>
                      INTO vactividadc, vcodsubactividadc
                      FROM pa.actividades_economicas_bc_ciiu
                     WHERE segregacion_rd = pidrama_ciiuco AND estado = 'S';
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '28-' || errorcode;
                        errordescription :=
                               errordescription
                            || ' pidrama_ciiuco: '
                            || pidrama_ciiuco
                            || ' -error consultando actividades_economicas_bc_ciiu codeudor '
                            || SQLERRM;
                        RETURN;
                END;

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);


                v_codpaisco := pa_pkg_utl.fn_obtiene_codpais (pidpaisco);

                --Insertar Persona Fisica codeudor
                BEGIN
                    p_depura (' crear fud Linea ' || $$plsql_line);

                    pa_pkg_utl.pa_personas_fisicas_insert (
                        pcod_per_fisica         => v_persona2,
                        pest_civil              => pidestadocivilco,
                        psexo                   => psexoco,
                        pfec_nacimiento         =>
                            TO_DATE (pfechanacimientoco, 'dd/mm/yyyy'), --pFECHANACIMIENTOCO,
                        pprimer_apellido        => pprimerapellidoco, --pPrimer_Apellido ,
                        psegundo_apellido       => psegundonombreco, --NULL,    --pSegundo_Apellido ,
                        pprimer_nombre          => pprimernombreco, --pPrimer_Nombre,
                        psegundo_nombre         => NULL,   ---pSegundo_Nombre,
                        pprofesion              => NULL,
                        pidioma_correo          => 'ESPA',
                        pes_mal_deudor          => NULL,
                        pconyugue               => NULL,
                        pnacionalidad           => v_nompaisco,
                        pcod_sector             => TO_NUMBER (psectoreconomico),
                        pestatal                => NULL,
                        pemail_usuario          => pemailco,
                        pemail_servidor         => NULL,
                        pnivel_estudios         => NULL,
                        ptipo_vivienda          => NULL,
                        pnum_hijos              => pnohijosco,
                        pnum_dependientes       => pdependientesco,
                        pes_residente           => NULL,
                        ptiempo_vivien_act      => NULL,
                        peval_ref_bancaria      => 'V',
                        peval_ref_tarjetas      => 'V',
                        peval_ref_laboral       => 'C',
                        ptotal_ingresos         => 0,
                        pcod_pais               => v_codpaisco,
                        pincluido_por           => USER,
                        pfec_inclusion          => SYSDATE,
                        pmodificado_por         => NULL,
                        pfec_modificacion       => NULL,
                        pscoring                => NULL,
                        pactividad              => vactividadc,
                        prango_ingresos         => 1,
                        pcasada_apellido        => NULL,
                        pes_funcionario         => NULL,
                        pes_peps                => NULL,
                        pcod_actividad          => pidrama_ciiuco, --vactividadc,  --39
                        pcod_subactividad       => vcodsubactividadc,
                        ptipo_persona           => ptipopersona2,
                        ptipo_cliente           => ptipocliente,
                        pcod_pais_padre         => v_codpaisco,
                        pcod_pais_madre         => v_codpaisco,
                        pcod_pais_conyugue      => v_codpaisco,
                        pmas_180_dias_eeuu      => NULL,
                        pcod_finalidad          => NULL,
                        ppeso                   => NULL,
                        pestatura               => NULL,
                        pactividad_polizah      => NULL,
                        pdeporte_polizah        => NULL,
                        ppeso_polizah           => NULL,
                        pestatura_polizah       => NULL,
                        papellido_casada        => NULL,
                        ptercer_nombre          => NULL,
                        ptipo_soc_conyugal      => NULL,
                        pind_fallecimiento      => NULL,
                        pfec_fallecimiento      => NULL,
                        pgpo_riesgo             => NULL,
                        pnum_empleados          => NULL,
                        pventas_ingresos        => NULL,
                        pcp_total_activo        => NULL,
                        pind_clte_vip           => NULL,
                        pocupacion_clasif_nac   => NULL, --15-10-2024  --Solo para compilar PC1
                        ptipo_gen_divisas       => NULL, --15-10-2024   --Solo para compilar PC1
                        errorcode               => errorcode,
                        errordescription        => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '29-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Error Creando persona fisica codeudor  Linea '
                            || $$plsql_line
                            || ' '
                            || SQLERRM;
                        p_depura (errordescription);
                        RETURN;
                END;

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);
                --                p_depura (' crear fud Linea ' || $$plsql_line);

                -- Insertar Persona
                BEGIN
                    pa_pkg_utl.pa_personas_insert (
                        pcod_persona          => v_persona2,
                        pcod_per_fisica       => v_persona2,
                        pcod_per_juridica     => NULL,
                        pes_fisica            => 'S',
                        pnombre               =>
                            pprimernombreco || ' ' || pprimerapellidoco,
                        pind_clte_i2000       => 'N',
                        ppaga_imp_ley288      => 'S',
                        pbenef_pag_ley288     => 'S',
                        pcod_vinculacion      => pidtipovinculadoco,
                        pcod_sec_contable     => '030202', --pSECTORECONOMICOCO, 11-04-2023
                        padicionado_por       => USER,
                        pfecha_adicion        => SYSDATE,
                        pmodificado_por       => NULL,
                        pfecha_modificacion   => NULL,
                        pcodigo_sustituto     => NULL,
                        pestado_persona       => 'A',
                        pcobr_nodgii_132011   => 'N',
                        plleno_fatca          => 'N',
                        pimprimio_fatca       => 'N',
                        pes_fatca             => 'N',
                        pfec_actualizacion    => NULL,
                        ptel_verificado       => 'N',
                        errorcode             => errorcode,
                        errordescription      => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '30-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Agregando Personas-Codeudor'
                            || SQLERRM;
                        RETURN;
                END;

                --                p_depura (' crear fud Linea ' || $$plsql_line);
                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                --------------------------------------------------------------------------
                -- Direcci¿n del cliente
                --------------------------------------------------------------------------
                --Get Provincia
                BEGIN
                    v_pa_distritos_list :=
                        pa_pkg_utl.pa_distritos_select (
                            pcod_pais          => NULL,
                            pcod_provincia     => NULL,
                            pcod_canton        =>
                                TO_NUMBER (SUBSTR (pidmunicipioco, 1, 2)),
                            pcod_distrito      =>
                                TO_NUMBER (SUBSTR (pidmunicipioco, 3, 2)),
                            pdescripcion       => NULL,
                            pabreviatura       => NULL,
                            ptipo              => NULL,
                            pcod_serie         => NULL,
                            plocalidad_sb      => NULL,
                            pid_ciudad_fc      => NULL,
                            pid_ciudad_ls      => NULL,
                            errorcode          => errorcode,
                            errordescription   => errorcode);

                    FOR i IN 1 .. v_pa_distritos_list.COUNT
                    LOOP
                        vidprovinciaco :=
                            v_pa_distritos_list (i).cod_provincia;
                    END LOOP;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '31-' || errorcode;
                        errordescription :=
                            'Error Consultando distrito codeudor ' || SQLERRM;
                        RETURN;
                END;

                --                p_depura (' crear fud Linea ' || $$plsql_line);
                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);


                tidprovinciaco := vidprovinciaco;

                -- Insertar direcci¿n
                BEGIN
                    pa_pkg_utl.pa_dir_personas_insert (
                        pcod_persona          => v_persona2,
                        pcod_direccion        => 1,
                        ptip_direccion        => 1,
                        papartado_postal      => NULL,
                        pcod_postal           => NULL,
                        pdetalle              => ptrabajo_direccionco,
                        pcod_pais             => v_codpaisco,
                        pcod_provincia        => tidprovinciaco, --vidprovincia, --12-03-2023
                        pcod_canton           =>
                            TO_NUMBER (SUBSTR (pidmunicipioco, 1, 2)),
                        pcod_distrito         =>
                            TO_NUMBER (SUBSTR (pidmunicipioco, 3, 2)),
                        pcod_pueblo           => '1',   --malmanzar 12-03-2023
                        pes_default           => 'S',
                        pcolonia              => NULL,
                        pzona                 => NULL,
                        pind_estado           => 'S',
                        pincluido_por         => USER,
                        pfec_inclusion        => SYSDATE,
                        pmodificado_por       => NULL,
                        pfecha_modificacion   => NULL,
                        errorcode             => errorcode,
                        errordescription      => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '32-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Error Insertando direcci¿n codeudor Pa_Dir_Personas_Insert >>Sqlerrm '
                            || SQLERRM;
                        --                        P_DEPURA (
                        --                               'pdireccion_id_municipio '
                        --                            || TO_NUMBER (
                        --                                   SUBSTR (pdireccion_idmunicipio, 1, 2))
                        --                            || ' Linea '
                        --                            || $$plsql_line);
                        RETURN;
                END;

                --- p_depura (' crear fud Linea ' || $$plsql_line);


                --
                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                --Inserta Direccion Trabajo
                BEGIN
                    pa_pkg_utl.pa_dir_personas_insert (
                        pcod_persona          => v_persona2,
                        pcod_direccion        => 2,
                        ptip_direccion        => 2,
                        papartado_postal      => NULL,
                        pcod_postal           => NULL,
                        pdetalle              => ptrabajo_direccionco,
                        pcod_pais             => v_codpaisco,
                        pcod_provincia        => tidprovinciaco,
                        pcod_canton           =>
                            TO_NUMBER (SUBSTR (pidmunicipioco, 1, 2)),
                        pcod_distrito         =>
                            TO_NUMBER (SUBSTR (pidmunicipioco, 3, 2)),
                        pcod_pueblo           => '1',
                        pes_default           => 'N',
                        pcolonia              => NULL,
                        pzona                 => NULL,
                        pind_estado           => 'S',
                        pincluido_por         => USER,
                        pfec_inclusion        => SYSDATE,
                        pmodificado_por       => NULL,
                        pfecha_modificacion   => NULL,
                        errorcode             => errorcode,
                        errordescription      => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '33-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Error Insertando direcci¿n trabajo Pa_Dir_Personas_Insert >>Sqlerrm '
                            || SQLERRM;
                        p_depura (
                               'pdireccion_id_municipio '
                            || TO_NUMBER (
                                   SUBSTR (pdireccion_idmunicipio, 1, 2))
                            || ' Linea '
                            || $$plsql_line);
                        RETURN;
                END;

                --                p_depura (' crear fud Linea ' || $$plsql_line);
                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                BEGIN
                    pa_pkg_utl.pa_dir_envio_x_pers_insert (
                        pcod_persona       => v_persona2,
                        ptipo_envio        => 'D',
                        papdo_postal       => 1,
                        pcodigo_postal     => NULL,
                        pcod_direccion     => '1', --NULL, --malmanzar 14-03-2023
                        pcod_area          => NULL,
                        pnum_telefono      => NULL,
                        pnum_casilla       => NULL,
                        pcod_empresa       => NULL,
                        pcod_agencia       => NULL,
                        pemail_usuario     => NULL,
                        pemail_servidor    => NULL,
                        errorcode          => errorcode,
                        errordescription   => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '34-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Error Insertando direcci¿n envio codeudor Pa_Dir_Personas_Insert >>Sqlerrm '
                            || SQLERRM;
                        p_depura (errorcode || '-' || errordescription);
                        p_depura (
                               'pdireccion_id_municipio '
                            || TO_NUMBER (
                                   SUBSTR (pdireccion_idmunicipio, 1, 2))
                            || ' Linea '
                            || $$plsql_line);
                        RETURN;
                END;

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);
                -- Telefonos del codeudor
                -----------------------------------------------------------------------
                -- JMoraM 20180503 valida que no venga 0 en el numero telefono
                -----------------------------------------------------------------------
                /* --malmanzar 14-03-2022, comentado hasta colocar validaci¿n en la APP
                 BEGIN
                     IF TO_NUMBER (REPLACE (TRIM (ptelefonoco), '-')) = 0
                     THEN
                         errorCode := '35';
                         errorDescription :=errorDescription||
                             '-Codeudor tiene que tener al menos un telefono valido';
                         RETURN;
                     END IF;
                 EXCEPTION
                     WHEN OTHERS
                     THEN
                         errorCode := '36';
                         errorDescription := errorDescription||
                             '-error validando telefono codeudor ' || SQLERRM;
                         RETURN;
                 END;
                 */

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                --Insertar Telefono codeudor
                IF TO_NUMBER (REPLACE (TRIM (ptelefonoco), '-')) != 0
                THEN
                    BEGIN
                        pa_pkg_utl.pa_tel_personas_insert (
                            pcod_persona          => v_persona2,
                            pcod_area             => SUBSTR (ptelefonoco, 1, 3),
                            pnum_telefono         =>
                                REPLACE (SUBSTR (ptelefonoco, 4), '-', NULL),
                            ptip_telefono         => 'R',
                            ptel_ubicacion        => 'O',
                            pextension            => NULL,
                            pnota                 => 'PortaCredit',
                            pes_default           => 'N', ---'S', malmanzar 22-03-2023
                            pposicion             => NULL,
                            pcod_direccion        => 1,
                            pcod_pais             => v_codpaisco,
                            pmodificado_por       => NULL,
                            pfecha_modificacion   => NULL,
                            pincluido_por         => USER,
                            pfec_inclusion        => SYSDATE,
                            errorcode             => errorcode,
                            errordescription      => errordescription);
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            errorcode := '37-' || errorcode;
                            errordescription :=
                                   errordescription
                                || '-Insertando telefonos coDeudor'
                                || SQLERRM;
                            RETURN;
                    END;
                END IF;                                        --telefono casa

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                IF TO_NUMBER (REPLACE (TRIM (ptelefonoco), '-')) != 0
                THEN             ---insert repetido no viende celular codeudor
                    BEGIN
                        pa_pkg_utl.pa_tel_personas_insert (
                            pcod_persona          => v_persona2,
                            pcod_area             => SUBSTR (ptelefonoco, 3),
                            pnum_telefono         =>
                                REPLACE (SUBSTR (ptelefonoco, 4), '-', NULL),
                            ptip_telefono         => 'C',
                            ptel_ubicacion        => 'O',
                            pextension            => NULL,
                            pnota                 => 'PortaCredit',
                            pes_default           => 'S',
                            pposicion             => NULL,
                            pcod_direccion        => 1,
                            pcod_pais             => v_codpaisco,
                            pmodificado_por       => NULL,
                            pfecha_modificacion   => NULL,
                            pincluido_por         => USER,
                            pfec_inclusion        => SYSDATE,
                            errorcode             => errorcode,
                            errordescription      => errordescription);
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            errorcode := '38-' || errorcode;
                            errordescription :=
                                   errordescription
                                || '-Insertando telefono Celular coDeudor'
                                || SQLERRM;
                            RETURN;
                    END;
                END IF;                                     --Telefono Celular

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                IF vpasextco = 'S'
                THEN --Pendiente confirmar c¿digo , con Else tambien realizaba
                    --el insert aunque con con parametros diferentes ref. linea 1187 Trigger tempfud
                    BEGIN
                        pa_pkg_utl.pa_id_personas_insert (
                            pcod_persona       => v_persona2,
                            pcod_tipo_id       => vtipodocumentoidentidadco, --ptipodocumentoidentidadco,  11-03-2023
                            pnum_id            => vnumidformatco, --pnumdocumentoidentidadco, 11-03-2023
                            pfec_vencimiento   =>
                                TO_DATE ('31/12/2050', 'dd/mm/yyyy'),
                            pcod_pais          => v_codpaisco,
                            pnacionalidadpe    => nacionalidadpe, --malmanzar 09-06-2022
                            errorcode          => errorcode,
                            errordescription   => errordescription);
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            errorcode := '39-' || errorcode;
                            errordescription :=
                                   errordescription
                                || '-insertando Pa_Id_Personas_Insert'
                                || SQLERRM;
                            RETURN;
                    END;
                END IF;

                --
                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                BEGIN
                    pa_pkg_utl.pa_infofisicanacion_insert (
                        pcod_persona                    => v_persona2,
                        ppind_cedula                    => 'S',
                        ppind_licencia_conducir         => 'N',
                        ppind_residencia                => 'N',
                        ppind_id_otro                   => 'N',
                        pid_otro_desc                   => NULL,
                        ppind_certificado_nacimiento    => 'N',
                        ppind_pensionado_jubilado       => 'N',
                        ppind_lab_tiempo                => 'N',
                        ppind_lab_ingreso_anual         => 'N',
                        ppind_lab_puesto_desempena      => 'N',
                        ppind_trabaja_independiente     => 'N',
                        ppind_independiente_actividad   => 'N',
                        ppindindependientejustificaa    => 'N',
                        pcomentarios_adicionales        =>
                            'Registrado codeudor por PDA',
                        errorcode                       => errorcode,
                        errordescription                => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '40-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-insertando codeudor pa_infofisicanacion_insert '
                            || SQLERRM;
                        RETURN;
                END;

                --                p_depura (' crear fud Linea ' || $$plsql_line);
                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                --Inserta cliente codeudor
                BEGIN
                    ia.pa_pkg_utl.pa_cliente_insert (
                        pcod_empresa              => p_codempresa,
                        pcod_cliente              => v_persona2,
                        pnum_cliente              => v_persona2,
                        pcod_agencia              => TO_NUMBER (p_codagencia),
                        pcod_cat_clte             => v_cod_cat_clte,
                        pcod_grupo                => NULL,
                        pesta_activo              => 'S',
                        ppaga_impto_renta         => 'S',
                        pfec_ingreso              => SYSDATE,
                        pcat_riesgo               => 'A',
                        pcod_oficial              => vcodoficial,
                        pcod_promotor             => vcodoficial,
                        pcod_zona                 => NULL,
                        pcliente_especial         => 'N',
                        ptipo_deudor              => 1,
                        pcross_estimado           => 30,
                        pcross_calculado          => 0,
                        prentabilidad             => 0,
                        pmon_ingreso_bco          => 0,
                        pmon_egreso_bco           => 0,
                        pcod_sub_agencia          => NULL,
                        pestado_cliente           => 'A',
                        pcod_nicho                => '99',
                        pfec_actualiza_ingresos   => NULL,
                        pcomentario_act_ingreso   => 'INGRESO POR PDA',
                        pnum_carpeta              => NULL,
                        pcod_linea_credito        => NULL,
                        pincluido_por             => USER,
                        pfec_inclusion            => SYSDATE,
                        pmodificado_por           => NULL,
                        pfec_modificacion         => NULL,
                        errorcode                 => errorcode,
                        errordescription          => errordescription);
                EXCEPTION
                    WHEN NO_DATA_FOUND
                    THEN
                        errorcode := '41-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-Error ia.pa_pkg_utl.Pa_Cliente_Insert  '
                            || SQLERRM;
                        RETURN;
                END;
            ELSE                                      --v_persona2 Is not Null
                --- modificar aca
                --reg1.codigo_relacionco := 'O';
                -- reg1.codigo_clienteco := TO_NUMBER (v_persona2);
                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                -- Excello:JPH:2019-02-12:Req._93767: Begin >>
                -- Actualizacion datos Codeudores  ---

                --1- Datos Persona --
                IF pidtipovinculadoco IS NOT NULL
                THEN                                      --- Tipo Vinculacion
                    pa.pa_mant_datos_personas.p_act_datos_cliente_persona (
                        v_persona2,
                        'TIP_VINCULO',
                        pidtipovinculadoco,
                        v_procesado,
                        v_error);

                    IF v_error IS NOT NULL
                    THEN
                        v_error :=
                               'FUD Error procesando codeudor '
                            || ' '
                            || v_error;
                        errorcode := '42';
                        errordescription := v_error || SQLERRM;
                        RETURN;
                    END IF;
                END IF;

                IF pemailco IS NOT NULL
                THEN
                    pa.pa_mant_datos_personas.p_act_datos_cliente_persona (
                        v_persona2,
                        'EMAIL',
                        pemailco,
                        v_procesado,
                        v_error);

                    IF v_error IS NOT NULL
                    THEN
                        v_error :=
                               'FUD Error procesando codeudor '
                            || ' '
                            || v_error;
                        errorcode := '43';
                        errordescription := v_error || SQLERRM;
                    END IF;
                END IF;

                --                p_depura (
                --                       'Linea '
                --                    || $$PLSQL_LINE
                --                    || ' Program Unit = '
                --                    || $$plsql_unit);

                -- 2- Direcciones  --
                -- 2.1- Direccion Trabajo ---
                IF LENGTH (ptrabajo_direccionco) > 0
                THEN
                    pa.pa_mant_datos_personas.p_inserta_direccion (
                        v_persona2,
                        ptrabajo_direccionco,
                        ptrabajo_idmunicipioco,
                        v_codpaisco,
                        '2',
                        'S',
                        v_procesado,
                        v_msgerr);

                    IF v_msgerr IS NOT NULL
                    THEN
                        v_error :=
                               'FUD Error procesando codeudor '
                            || ' '
                            || v_msgerr;
                        errorcode := '44';
                        errordescription := v_error || SQLERRM;
                    END IF;
                END IF;

                -- 3- Telefonos  --
                -- 3.1- Residencial --
                IF TO_NUMBER (REPLACE (ptelefonoco, '-')) != 0
                THEN
                    IF LENGTH (pextensionco) > 0
                    THEN
                        v_tipotco := 'T';
                    ELSE
                        v_tipotco := 'R';
                    END IF;

                    --                    p_depura (
                    --                           'Linea '
                    --                        || $$PLSQL_LINE
                    --                        || ' Program Unit = '
                    --                        || $$plsql_unit);
                    pa.pa_mant_datos_personas.p_inserta_telefono (
                        v_persona2,
                        REPLACE (ptelefonoco, '-'),
                        pextensionco,
                        v_tipotco,
                        'PortaCredit',
                        pidpaisco,                                --V_Codpais,
                        'S',
                        v_procesado,
                        v_msgerr);

                    IF v_msgerr IS NOT NULL
                    THEN
                        v_error :=
                               'FUD Error procesando codeudor '
                            || ' '
                            || v_msgerr;
                        errorcode := '44';
                        errordescription := v_error || SQLERRM;
                    END IF;
                END IF;
            -- Excello:JPH:2019-02-12:Req._93767: End <<


            END IF;                                      -- v_persona2 Is Null

            IF v_persona2 IS NOT NULL                             --28-03-2023
            THEN
                BEGIN
                    UPDATE personas_fisicas
                       SET conyugue = v_persona2
                     WHERE cod_per_fisica = v_persona;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        NULL;
                END;
            END IF;
        END IF;                        ---pnumdocumentoidentidadco is not null

        --  malmanzar eliminia codeudor en fud principal 25-03-2023

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        --        --Get datos Tipo Cr¿dito
        --        p_depura (' crear fud Linea ' || $$plsql_line);

        BEGIN
            v_pr_pr_tipo_credito_list :=
                ia.pr_pkg_utl.pr_tipo_credito_select (
                    pcodigo_empresa                 => p_codempresa,
                    ptipo_credito                   => TO_NUMBER (pcodigoproyecto),
                    pdescripcion                    => NULL,
                    pcodigo_sub_aplicacion          => NULL,
                    pes_linea_credito               => NULL,
                    pcodigo_moneda                  => NULL,
                    pcodigo_plazo                   => NULL,
                    pcodigo_origen                  => NULL,
                    pmodalidad_cobro                => NULL,
                    ptiene_vencimiento              => NULL,
                    ptipo_intereses                 => NULL,
                    ptipo_calendario                => NULL,
                    ptipo_linea                     => NULL,
                    pmanejo                         => NULL,
                    pplazo_minimo                   => NULL,
                    pplazo_maximo                   => NULL,
                    pmonto_minimo                   => NULL,
                    pmonto_maximo                   => NULL,
                    ptipo_tasa                      => NULL,
                    pcodigo_tipo_de_tasa            => NULL,
                    pvariacion_base                 => NULL,
                    ptasa_interes                   => NULL,
                    pcodigo_tasa_moratorios         => NULL,
                    pvariacion_mora                 => NULL,
                    ptasa_moratorios                => NULL,
                    pgracia_principal               => NULL,
                    pgracia_mora                    => NULL,
                    pdias_atraso_cobro_jud          => NULL,
                    pcontinua_cobro_intereses       => NULL,
                    pcomision_normal                => NULL,
                    pcomision_normal_minima         => NULL,
                    pcomision_normal_maxima         => NULL,
                    pperiodo_comision_normal        => NULL,
                    prevaloriza                     => NULL,
                    paprobacion_con_garantia        => NULL,
                    padicionado_por                 => NULL,
                    pfecha_adicion                  => NULL,
                    pmodificado_por                 => NULL,
                    pfecha_modificacion             => NULL,
                    ptipo_comision                  => NULL,
                    ptipo_mora                      => NULL,
                    pporcentaje_tasa_mora           => NULL,
                    pmax_dias_vencido_cobro         => NULL,
                    ppermite_sobregiro              => NULL,
                    pporcentaje_sobregiro           => NULL,
                    pcargo_comision                 => NULL,
                    pcargo_poliza                   => NULL,
                    pcodigo_corte                   => NULL,
                    pvariacion_minima               => NULL,
                    pvariacion_maxima               => NULL,
                    pperiodos_gracia_principal      => NULL,
                    pcargo_comision_atrasada        => NULL,
                    pmnemonico                      => NULL,
                    pcargo_cobro_administrativo     => NULL,
                    pcobra_comision_atrasada        => NULL,
                    pcobra_cobro_administrativo     => NULL,
                    pdias_atraso_cobro_admin        => NULL,
                    pbase_calculo_moratorios        => NULL,
                    pcomision_sobre_saldos          => NULL,
                    psaldos_teoricos                => NULL,
                    pcargo_iva                      => NULL,
                    pcobra_saldo_no_utilizado       => NULL,
                    pcargo_saldo_no_utilizado       => NULL,
                    pcomision_genera_iva            => NULL,
                    pcobra_intereses_dia_pago       => NULL,
                    pcargo_interes_prorrogado       => NULL,
                    pcargo_moratorio_prorrogado     => NULL,
                    pcargo_comision_prorrogada      => NULL,
                    ptipo_calculo_mora              => NULL,
                    pcargo_mora_flat                => NULL,
                    pdia_pago                       => NULL,
                    ptipo_cartera                   => NULL,
                    pdias_atraso_en_vigente         => NULL,
                    pes_pre_aprobado                => NULL,
                    pvigencia_solicitud             => NULL,
                    pcobro_aut_poliza               => NULL,
                    pes_cuota_multiple              => NULL,
                    ptipo_credito_hijos             => NULL,
                    pdescuentainteresesdesembolso   => NULL,
                    pcantidad_cuotas_descontar      => NULL,
                    pind_poliza_bco                 => NULL,
                    pind_pr_vehiculo                => NULL,
                    pmax_porc_extraordinario        => NULL,
                    pcon_garantia_certificado       => NULL,
                    pporcentaje_pignoracion_cd      => NULL,
                    poficial_autorizado             => NULL,
                    pgrupo_tipo_credito             => NULL,
                    ptipo_de_persona                => NULL,
                    pllamada_atraso                 => NULL,
                    pind_es_reserva                 => NULL,
                    pind_credito_universitario      => NULL,
                    pind_micro_credito              => NULL,
                    plimite_tolerable_ea            => NULL,
                    plimite_tolerable_lc            => NULL,
                    plimite_tolerable_gf            => NULL,
                    plimite_tolerable_cp            => NULL,
                    pfacilidad_creditic             => NULL,
                    pind_cobra_mora                 => NULL,
                    pestado                         => NULL,
                    ptipo_cuota                     => NULL,
                    pmultiples_desembolsos          => NULL,
                    pdesembolso_pactado             => NULL,
                    pgracia_mora_principal          => NULL,
                    errorcode                       => errorcode,
                    errordescription                => errordescription);

            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            IF v_pr_pr_tipo_credito_list.COUNT = 0
            THEN
                errorcode := '45-' || errorcode;
                errordescription :=
                       errordescription
                    || '-Tipo de cr¿dito '
                    || pcodigoproyecto
                    || ' no encontrado';
                ROLLBACK;
                RETURN;
            ELSE
                FOR i IN 1 .. v_pr_pr_tipo_credito_list.COUNT
                LOOP
                    reg1.codigo_moneda :=
                        v_pr_pr_tipo_credito_list (i).codigo_moneda;
                    reg1.tipo_credito :=
                        v_pr_pr_tipo_credito_list (i).tipo_credito;
                    reg1.es_linea_credito :=
                        v_pr_pr_tipo_credito_list (i).es_linea_credito;
                    reg1.tipo_linea :=
                        v_pr_pr_tipo_credito_list (i).tipo_linea;
                    reg1.manejo := v_pr_pr_tipo_credito_list (i).manejo;
                    reg1.modalidad_cobro :=
                        v_pr_pr_tipo_credito_list (i).modalidad_cobro;
                    reg1.tipo_intereses :=
                        v_pr_pr_tipo_credito_list (i).tipo_intereses;
                    reg1.tipo_calendario :=
                        v_pr_pr_tipo_credito_list (i).tipo_calendario;
                    reg1.periodo_comision_normal :=
                        v_pr_pr_tipo_credito_list (i).periodo_comision_normal;
                    reg1.comision_normal :=
                        v_pr_pr_tipo_credito_list (i).comision_normal;
                    reg1.tipo_tasa := v_pr_pr_tipo_credito_list (i).tipo_tasa;
                    reg1.codigo_tipo_de_tasa :=
                        v_pr_pr_tipo_credito_list (i).codigo_tipo_de_tasa;
                    reg1.variacion_base :=
                        v_pr_pr_tipo_credito_list (i).variacion_base;
                    reg1.tasa_interes :=
                        v_pr_pr_tipo_credito_list (i).tasa_interes;
                    reg1.codigo_tasa_moratorios :=
                        v_pr_pr_tipo_credito_list (i).codigo_tasa_moratorios;
                    reg1.variacion_mora :=
                        v_pr_pr_tipo_credito_list (i).variacion_mora;
                    reg1.tasa_moratorios :=
                        v_pr_pr_tipo_credito_list (i).tasa_moratorios;
                    reg1.gracia_principal :=
                        v_pr_pr_tipo_credito_list (i).gracia_principal;
                    reg1.gracia_mora :=
                        v_pr_pr_tipo_credito_list (i).gracia_mora;
                    reg1.codigo_origen :=
                        v_pr_pr_tipo_credito_list (i).codigo_origen;
                    reg1.continua_cobro_intereses :=
                        v_pr_pr_tipo_credito_list (i).continua_cobro_intereses;
                    reg1.dia_pago := v_pr_pr_tipo_credito_list (i).dia_pago;
                    reg1.revaloriza :=
                        v_pr_pr_tipo_credito_list (i).revaloriza;
                    reg1.codigo_sub_aplicacion :=
                        v_pr_pr_tipo_credito_list (i).codigo_sub_aplicacion;
                    reg1.tipo_comision :=
                        v_pr_pr_tipo_credito_list (i).tipo_comision;
                    reg1.tipo_mora := v_pr_pr_tipo_credito_list (i).tipo_mora;
                    reg1.porcentaje_tasa_mora :=
                        v_pr_pr_tipo_credito_list (i).porcentaje_tasa_mora;
                    -- reg1.codigo_plazo,
                    reg1.permite_sobregiro :=
                        v_pr_pr_tipo_credito_list (i).permite_sobregiro;
                    reg1.porcentaje_sobregiro :=
                        v_pr_pr_tipo_credito_list (i).porcentaje_sobregiro;
                    reg1.variacion_minima :=
                        v_pr_pr_tipo_credito_list (i).variacion_minima;
                    reg1.variacion_maxima :=
                        v_pr_pr_tipo_credito_list (i).variacion_maxima;
                    reg1.periodos_gracia_principal :=
                        v_pr_pr_tipo_credito_list (i).periodos_gracia_principal;
                    reg1.base_calculo_moratorios :=
                        v_pr_pr_tipo_credito_list (i).base_calculo_moratorios;
                    reg1.descuenta_intereses_desembolso :=
                        v_pr_pr_tipo_credito_list (i).descuenta_intereses_desembolso;
                    reg1.cantidad_cuotas_descontar :=
                        v_pr_pr_tipo_credito_list (i).cantidad_cuotas_descontar;
                    reg1.ind_pr_vehiculo :=
                        v_pr_pr_tipo_credito_list (i).ind_pr_vehiculo;
                    -- reg1.dias_periodo_cuota,
                    -- reg1.plazo,
                    reg1.tipo_desembolso := 'C'; ---V_Pr_Pr_Tipo_Credito_List(i).tipo_desembolso;
                    reg1.codigo_actividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_actividad;
                    reg1.codigo_subactividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_subactividad;
                    reg1.codigo_sub_clase := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_sub_clase;
                    reg1.codigo_plazo :=
                        v_pr_pr_tipo_credito_list (i).codigo_plazo;
                    vplazo_minimo :=
                        v_pr_pr_tipo_credito_list (i).plazo_minimo;
                    vplazo_maximo :=
                        v_pr_pr_tipo_credito_list (i).plazo_maximo;
                    vmonto_minimo :=
                        v_pr_pr_tipo_credito_list (i).monto_minimo;
                    vmonto_maximo :=
                        v_pr_pr_tipo_credito_list (i).monto_maximo;
                    vvariacion_base :=
                        v_pr_pr_tipo_credito_list (i).variacion_base;
                END LOOP;
            END IF;
        END;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        reg1.estado := 'R';
        reg1.tipo_cuota := 'N';


        --malmanzar 17-02-2022 reactiva codigo comentado    2019
        BEGIN
            ---malmanzar 09-06-2022
            reg1.codigo_periodo_cuota :=
                f_periodicidad_pda_core (
                    TO_NUMBER (SUBSTR (pfrecuenciacal, 1, 2)));
        --malmanzar verificar para eliminar codigo
        /* SELECT codigo_periodo
           INTO reg1.codigo_periodo_cuota
           FROM pr_periodicidad pp
          WHERE pp.codigo_periodo =
                DECODE (TO_NUMBER (SUBSTR (pfrecuenciacal, 1, 2)),
                        1, 'SM',                                --  Semanal
                        2, 'BS',                              --  Bisemanal
                        3, 'TS',                             --  Trisemanal
                        4, 'VO',                          --  CuatriSemanal
                        5, 'ME',                                --  Mensual
                        6, 'BI',                              --  Bimestral
                        7, 'TR',                             --  Trimestral
                        8, 'CU',                          --  Cuatrimestral
                        9, 'SE',                              --  Semestral
                        10, 'AN');
     EXCEPTION
         WHEN OTHERS
         THEN
             v_plazo := 0;
             v_error := 'p_mensajeerror = Revisar el campo Frecuenciacal';
             errorCode := '45';
             errorDescription := v_error;
             ROLLBACK;
             RETURN;*/
        END;

        /* Begin--verificar para eliminar codigo malmanzar 09-07-2019
            Select dias_periodo * :New.plazocal   --, codigo_periodo
              Into v_plazo   --, reg1.codigo_periodo_cuota
              From pr_periodicidad pp
             Where pp.codigo_periodo = 'ME';
         Exception
            When Others Then
               v_plazo                    := 0;
               v_error                    := 'p_mensajeerror = Revisar el campo Frecuenciacal';
               :New.idestado              := 'R';
               -- :New.mensaje               := 'Rechazado';
               If ia.api_portacredit.fnupdatefud( :New.id_tempfud, 0, 'R', v_error, 0 ) Then
                  -- Dbms_output.put_line( 'p_mensajeerror= Frecuenciacal' );
                  raise_application_error( num => -20000, msg => v_error );
               End If;
         End;  */

        reg1.plazo :=
              pr_proyeccion.my_add_month (reg1.f_apertura, pplazocal)
            - reg1.f_apertura;

        --        p_depura (' crear fud Linea ' || $$plsql_line);
        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);

        BEGIN
            SELECT codigo_plazo
              INTO reg1.codigo_plazo
              FROM pr_tipos_plazos
             WHERE     codigo_plazo = reg1.codigo_plazo
                   AND reg1.plazo BETWEEN plazo_minimo AND plazo_maximo;
        --Between vPlazo_Minimo And vPlazo_Maximo;
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                v_error :=
                       'Revisar el campo Plazo: '
                    || reg1.plazo
                    || ' Codigo_Plazo '
                    || reg1.codigo_plazo
                    || ' '
                    || $$plsql_unit
                    || ' $$PLSQL_LINE = '
                    || $$plsql_line
                    || ' Sqlerrm '
                    || SQLERRM;


                errorcode := '46';
                errordescription := v_error;

                --p_depura ('errorCode ' || errorCode || ': ' || v_error);
                ROLLBACK;
                RETURN;
        END;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        reg1.f_vencimiento := reg1.f_apertura + reg1.plazo;
        --
        reg1.monto_credito := pmontocal;

        -- p_depura (' crear fud Linea ' || $$plsql_line);

        --
        IF reg1.monto_credito NOT BETWEEN vmonto_minimo AND vmonto_maximo
        THEN
            v_error := --'p_mensajeerror = Revisar el campo : Monto del Credito Solicitado, no se encuentra dentro de los rangos minimo y maximo del codigo de proyecto asignado ';
                   ' reg1.monto_credito '
                || TO_CHAR (reg1.monto_credito)
                || ' vmonto_minimo '
                || TO_CHAR (vmonto_minimo)
                || ' vmonto_maximo '
                || TO_CHAR (vmonto_maximo);
            errorcode := '47';
            errordescription := v_error;
            ROLLBACK;
            RETURN;
        END IF;

        BEGIN
            reg1.cuota := TO_NUMBER (pcuotaprestamocal);
        EXCEPTION
            WHEN OTHERS
            THEN
                v_error :=
                    'El valor del campo cuota no esta siendo enviado en el formato correcto.';
                errorcode := '48';
                errordescription := v_error;
                ROLLBACK;
                RETURN;
        END;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        --        p_depura (' crear fud Linea ' || $$plsql_line);

        -- p_depura( 'valida :new.CUOTAPRESTAMOCAL ' || :New.cuotaprestamocal || ' ' || reg1.cuota );
        reg1.codigo_analista := pidoficial;

        --10-07-2019 Begin
        BEGIN
            SELECT b.porcentaje, a.variacion_min, a.variacion_max
              INTO vporcentaje, vvariacion_min, vvariacion_max
              /* into :BKCredit.Desc_TASA_INTERES_BASE, :BKCredit.Desc_valor_tasa_corrientes,
              :BKCredit.variacion_min_interes, :BKCredit.variacion_max_interes*/
              FROM tipos_de_tasas_de_interes a, valores_de_tasas_de_interes b
             WHERE     a.codigo_tipo_de_tasa = b.codigo_tipo_de_tasa
                   AND b.codigo_empresa = p_codempresa
                   AND a.codigo_tipo_de_tasa =
                       TO_NUMBER (reg1.codigo_tipo_de_tasa)
                   --To_number( :New.tipocal )--LMVR
                   AND b.fecha_inicio =
                       (SELECT MAX (fecha_inicio)
                          FROM valores_de_tasas_de_interes
                         WHERE     codigo_empresa = p_codempresa
                               AND codigo_tipo_de_tasa =
                                   a.codigo_tipo_de_tasa
                               AND fecha_inicio <= TRUNC (SYSDATE) /*pfecha_registro*/
                                                                  );
        -- p_depura( 'ejecuto tasa de interes?:' || Sqlerrm );
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                p_depura (' crear fud Linea ' || $$plsql_line);
                v_error :=
                    'no encontro registros, revisar campos : Validaci¿n de Tasa de Interes';
                errorcode := '49';
                errordescription := v_error;
                ROLLBACK;
                RETURN;
            WHEN OTHERS
            THEN
                -- p_depura( 'others tasa de interes:' || Sqlerrm );
                v_error :=
                       'p_mensajeerror = revisar campos para consulta de tipos de tasas de interes '
                    || SQLERRM;
        END;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        reg1.variacion_base := ptasacal - (vporcentaje);
        ---- p_depura('salio de validaciones 2 '||sqlerrm);
        reg1.tasa_interes := ptasacal;
        reg1.segregacion_rd := pidrama_ciiu;

        --        p_depura (
        --               ' crear fud Linea '
        --            || $$plsql_line
        --            || ' pclientepertenece '
        --            || pclientepertenece);


        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);

        IF TRIM (pclientepertenece) IS NULL
        THEN
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            -- p_depura (' crear fud Linea ' || $$plsql_line);
            pr_credito.obtiene_planinversion (p_codempresa,
                                              'ESPA',
                                              reg1.plan_inversion,
                                              v_desc_plan_inversion);

            pr_credito.busca_extras_cliente (p_codempresa,
                                             reg1.codigo_actividad,
                                             reg1.codigo_cliente, --:New.idaperturacliente,--LMVR
                                             v_desc_ejecutivo,
                                             v_desc_ejecutivo,
                                             v_desc_actividad,
                                             v_agencia_labora,
                                             --FAMH --- 22-04-2005 PROBLEMA CON LA AGENCIA
                                             reg1,
                                             'ESPA');

            --p_depura (' crear fud Linea ' || $$plsql_line);

            --
            -----------------------------------------------------------------------------
            -- JMoraM   02/08/2016
            -- Se valida si hay un cr¿dito en estado Registrado,
            -- Se anula los que est¿n para que cree el nuevo.
            -----------------------------------------------------------------------------



            IF v_persona IS NOT NULL
            THEN
                BEGIN
                    SELECT COUNT (no_credito)
                      INTO v_credito_anula
                      FROM pr.pr_creditos
                     WHERE     codigo_empresa = 1
                           AND estado = 'R'
                           AND codigo_cliente = v_persona;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        v_credito_anula := 0;
                END;

                IF v_credito_anula > 0
                THEN
                    BEGIN
                        FOR a
                            IN (SELECT no_credito
                                  FROM pr_creditos
                                 WHERE     codigo_empresa = 1
                                       AND estado = 'R'
                                       AND codigo_cliente = v_persona)
                        LOOP
                            anula_credito_at (a.no_credito);
                        END LOOP;
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            v_error := 'Error Anulacion AT ' || SQLERRM;
                            errorcode := '50';
                            errordescription := v_error;
                            ROLLBACK;
                            RETURN;
                    END;
                --LMVR
                --  p_depura (' crear fud Linea ' || $$plsql_line);
                --
                END IF;
            ---p_depura (' crear fud Linea ' || $$plsql_line);
            END IF;

            --
            --            p_depura (
            --                   'Linea '
            --                || $$PLSQL_LINE
            --                || ' Program Unit = '
            --                || $$plsql_unit);
            --            p_depura (' crear fud Linea ' || $$plsql_line);

            -----------------------------------------------------------------------------
            --  JMORAM 22022018 -- Dinero mas rapido solo la primera vez               --
            -----------------------------------------------------------------------------
            DECLARE
                v_existe_credito   VARCHAR2 (1) := 'N';
            BEGIN
                BEGIN
                    SELECT DISTINCT esta
                      INTO v_existe_credito
                      FROM (SELECT 'S'     esta
                              FROM pr_creditos
                             WHERE     codigo_empresa = 1
                                   AND estado IN ('D',
                                                  'V',
                                                  'M',
                                                  'E',
                                                  'J',
                                                  'C')
                                   AND codigo_cliente = v_persona
                            UNION ALL
                            SELECT 'S'     esta
                              FROM pr_creditos_hi
                             WHERE     codigo_empresa = 1
                                   AND estado = 'C'
                                   AND codigo_cliente = v_persona);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        v_existe_credito := 'N';
                END;


                IF     v_existe_credito = 'S'
                   AND INSTR (
                           param.parametro_x_empresa (1,
                                                      'TIPCRED_VAL_CLT_NEW',
                                                      'PR'),
                           pcodigoproyecto) >
                       0
                THEN
                    v_error :=
                           'El codigo de proyecto '
                        || pcodigoproyecto
                        || ' solo aplica para clientes nuevos.';
                    errorcode := '51';
                    errordescription := v_error;
                    ROLLBACK;
                    RETURN;
                ELSE
                    --- p_depura (' crear fud Linea ' || $$plsql_line);

                    BEGIN
                        pr_credito.inserta_credito (p_codempresa,
                                                    TO_NUMBER (p_codagencia),
                                                    p_nrocredito,
                                                    reg1,
                                                    p_mensajeerror);
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            errorcode := '51.5';
                            errordescription :=
                                   'Error pr_credito.inserta_credito sqlerrm '
                                || SQLERRM
                                || ' Linea '
                                || $$plsql_line
                                || ' p_mensajeerror '
                                || p_mensajeerror;
                            -- p_depura (errorDescription);
                            RETURN;                     --malmanzar 04-08-2022
                    END;
                END IF;
            END;
        -----------------------------------------------------------------------------
        --  JMORAM 22022018 -- Dinero mas rapido solo la primera vez               --
        -----------------------------------------------------------------------------
        ELSE             ---malmanzar 26-03-2023, clientepertenece is not null
            IF UPPER (ptipopersona) IN ('CODEUDOR', 'FIADOR') ---malmanzar 30-09-2023, Se incluye Fiador
                                        --IF UPPER (ptipopersona) = 'CODEUDOR'
            THEN
                BEGIN
                    SELECT nocredito
                      INTO p_nrocredito
                      FROM tempfud
                     WHERE     numdocumentoidentidad =
                               TRIM (pclientepertenece)
                           AND id_tempfud =
                               (SELECT MAX (id_tempfud)
                                  FROM tempfud
                                 WHERE numdocumentoidentidad =
                                       TRIM (pclientepertenece));
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        p_nrocredito := NULL;
                END;

                IF p_nrocredito IS NOT NULL
                THEN
                    vestadocre := NULL;

                    BEGIN
                        SELECT estado, esvida
                          INTO vestadocre, vesvida
                          FROM pr_creditos
                         WHERE no_credito = p_nrocredito;
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            vestadocre := NULL;
                    END;
                END IF;


                IF vestadocre = 'R'
                THEN
                    IF UPPER (ptipopersona) = 'CODEUDOR'
                    THEN                                --malmanzar 30-09-2023
                        BEGIN
                            --Inserta en tabla cuenta cliente relaci¿n
                            INSERT INTO cuenta_cliente_relacion (
                                            num_cuenta,
                                            codigo_cliente,
                                            tipo_relacion,
                                            principal,
                                            cod_sistema,
                                            estado,
                                            numero_linea)
                                 VALUES (p_nrocredito,
                                         v_persona,
                                         'O',
                                         'N',
                                         'PR',
                                         NULL,
                                         2);
                        EXCEPTION
                            WHEN DUP_VAL_ON_INDEX
                            THEN
                                NULL;
                        END;

                        --                    END IF;   ---malmanzar 30-09-2023

                        --Recalcular seguro de vida 28-03-2023 para incluir codeudor en el c¿lculo
                        IF NVL (vesvida, 'N') = 'S'
                        THEN
                            DECLARE
                                cmensaje         VARCHAR2 (500);
                                vmonto_calculo   NUMBER;
                            BEGIN
                                DELETE pr_polizas_x_credito
                                 WHERE     codigo_empresa = 1
                                       AND no_credito = p_nrocredito
                                       AND tipo_poliza IN
                                               (SELECT tipo_poliza
                                                  FROM pr_tipos_polizas
                                                 WHERE uso = 'V');

                                pkg_polizas.agrega_poliza (
                                    pempresa        => 1,
                                    pcredito        => p_nrocredito, ---p_no_credito,
                                    pfecha          => TRUNC (SYSDATE), ---p_credito.f_apertura,
                                    --Sysdate,
                                    pesvida         => 'S',
                                    pesvehiculo     => 'N',
                                    pesincendio     => 'N',
                                    pesincendiopy   => 'N',
                                    pmensajeerror   => cmensaje,
                                    pcodeudor       => v_persona, --vncodeudor,
                                    paccion         => 'I', --C = Solo c¿lculo, I = Calcula e inserta
                                    ptipopoliza     => NULL,
                                    pmontocalculo   => vmonto_calculo);
                            EXCEPTION
                                WHEN OTHERS
                                THEN
                                    NULL;
                            END;
                        END IF;                                       --ESVIDA
                    END IF;                -- 13-11-2023 -malmanzar 30-09-2023
                ELSE
                    ROLLBACK;
                    errordescription :=
                           'El estado ('
                        || vestadocre
                        || ') del cr¿dito ('
                        || p_nrocredito
                        || ') no permite agregar aval ('
                        || v_persona
                        || ')';
                    p_depura ('Linea ' || $$plsql_line);
                    /*malmanzar 04-03-2022
                    En caso de error en vez de realizar de actualizar  via WebService
                    se realiza rollback se devuelve mensaje de error.
                    */
                    --  pIdtempFud                   := 0;

                    --pMensajeFec := pmensajeerror;
                    p_nrocredito := NULL;
                    RETURN;
                END IF;
            END IF;
        END IF;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        --
        --        p_depura (' crear fud Linea ' || $$plsql_line || ' ');

        IF p_mensajeerror IS NOT NULL                 --Or :New.idestado = 'R'
        THEN
            --            --:New.idestado              := 'R';
            --            utilitarios.obt_mensaje_error (p_mensajeerror,
            --                                           'PR',
            --                                           v_error_sysde,
            --                                           NULL);

            --            IF v_error_sysde LIKE
            --                   '%PA-000000 El Mensaje de error no fue encontrado%'
            --            THEN
            --                v_error :=
            --                    SUBSTR (
            --                        REPLACE (
            --                            '[' || v_error || '-' || p_mensajeerror || ']',
            --                            'p_mensajeerror = '),
            --                        1,
            --                        200);
            --            ELSE
            --                v_error := v_error_sysde || '-' || v_error;
            --            END IF;

            -- :New.mensaje               := v_error;
            --
            --             utilitarios.obt_mensaje_error (substr(p_mensajeerror,4, length(p_mensajeerror)),
            --                                            'PR',
            --                                            v_error_sysde,
            --                                            NULL);

            v_error_sysde :=
                pr_pkg_desembolso.get_mensaje_err (TRIM (p_mensajeerror),
                                                   'PR');


            errorcode := '52';
            errordescription :=
                TRIM (p_mensajeerror) || ': ' || v_error_sysde;
            p_depura (
                   'Linea: '
                || $$plsql_line
                || ' errorDescription: '
                || errordescription
                || ' Traza: '
                || DBMS_UTILITY.format_error_backtrace);
            DBMS_OUTPUT.put_line (
                   'Linea: '
                || $$plsql_line
                || ' errorDescription: '
                || errordescription);
            raise_application_error (
                -20000,
                   SQLERRM
                || ' -> traza: '
                || DBMS_UTILITY.format_error_backtrace
                || DBMS_UTILITY.format_error_backtrace);
            --raise;
            ROLLBACK;
            RETURN;
        ELSE
            pnocredito := p_nrocredito;

            DBMS_OUTPUT.put_line (
                'Linea: ' || $$plsql_line || ' pNOCREDITO: ' || pnocredito);
        --:New.idestado              := 'A';
        --:New.mensaje               := 'Procesado';
        --      If ia.api_portacredit.fnupdatefud( :New.id_tempfud, 0, 'A',
        --                                         'Procesado Correctamente', p_nrocredito ) Then
        --         Null;
        --      End If;
        END IF;

        --    EXCEPTION
        --        WHEN OTHERS
        --        THEN
        --            errorCode := '52';
        --            errorDescription := NVL (v_error || '-' || SQLERRM, 'Rechazado');
        --            ROLLBACK;
        --            RETURN;

        BEGIN
            pnocredito := p_nrocredito;

            p_depura (
                   'Linea '
                || $$plsql_line
                || ' Program Unit = '
                || $$plsql_unit);
            vfundinsert :=
                fninsertfud (pid_tempfud,
                             pnomarchivo,
                             pprocesado,
                             pidaperturacliente,
                             ptipodocumentoidentidad,
                             pnumdocumentoidentidad,
                             pidoficial,
                             pidagencia,
                             pprimernombre,
                             pprimerapellido,
                             psexo,
                             pfechanacimiento,
                             papodo,
                             pidempleado,
                             pidpais,
                             pidprovincia,
                             pidmunicipio,
                             piddistrito,
                             pidestadocivil,
                             pnohijos,
                             pdependientes,
                             pgradoint,
                             pidocupacion,
                             pidvinculado,
                             pnombrevinculado,
                             pidtipovinculado,
                             pidcomosuponosotros,
                             pdireccion,
                             pdireccion_idsector,
                             pdireccion_idprovincia,
                             pdireccion_idmunicipio,
                             pdireccion_distrito,
                             pdireccion_idtipovivienda,
                             pref_domicilio,
                             ptelefono_casa,
                             ptelefono_celular,
                             pnombrenegocio,
                             pnoempleados,
                             prnc,
                             pfax,
                             pemail,
                             psectoreconomico,
                             pactividad_ciiu,
                             pidrama_ciiu,
                             pinicio_mes,
                             pinicio_ano,
                             pubicacion_neg,
                             plugartrabajo,
                             pfechaingreso,
                             pcargo,
                             ptrabajo_direccion,
                             ptrabajo_idsector,
                             ptrabajo_idprovincia,
                             ptrabajo_idmunicipio,
                             ptrabajo_iddistrito,
                             ppuntoreferencia,
                             ptelefono,
                             pextension,
                             prefpersonales_apellidos,
                             prefpersonales_nombres,
                             prefpersonales_telefono,
                             prefpersonales_relfamiliar,
                             prefpersonales_nombres2,
                             prefpersonales_apellidos2,
                             prefpersonales_telefono2,
                             prefpersonales_relfam2,
                             pactualmenteenmora,
                             pcumpliorequisitos,
                             ppresento_doc_fraudulenta,
                             pdijolaverdad,
                             pclienteesfiador,
                             pclientemoroso,
                             psobreendeudamiento_sf,
                             pactividadcliente,
                             ptipopersona,
                             ptipodocumentoidentidadco,
                             pnumdocumentoidentidadco,
                             SUBSTR (TRIM (pprimernombreco), 1, 50), --malmanzar 05-12-2023  v_nombresco, --pPRIMERNOMBRECO,  --malmanzar PENDIENTE VERIFICAR CAMBIO CARLOS ZORRILLA
                             SUBSTR (TRIM (pprimerapellidoco), 1, 50), --malmanzar 05-12-2023 v_apellido1co, --pPRIMERAPELLIDOCO,--malmanzar PENDIENTE VERIFICAR CAMBIO CARLOS ZORRILLA
                             psexoco,
                             pfechanacimientoco,
                             papodoco,
                             pidempleadoco,
                             pidpaisco,
                             pidprovinciaco,
                             pidmunicipioco,
                             piddistritoco,
                             pidestadocivilco,
                             pnohijosco,
                             pdependientesco,
                             pgradointco,
                             pidocupacionco,
                             pidvinculadoco,
                             pnombrevinculadoco,
                             pidtipovinculadoco,
                             pidcomosuponosotrosco,
                             pnombrenegocioco,
                             pnoempleadosco,
                             prncco,
                             pfaxco,
                             pemailco,
                             psectoreconomicoco,
                             pactividad_ciiuco,
                             pidrama_ciiuco,
                             pinicio_mesco,
                             pinicio_anoco,
                             pubicacion_negco,
                             plugartrabajoco,
                             pfechaingresoco,
                             ptrabajo_direccionco,
                             ptrabajo_idsectorco,
                             ptrabajo_idprovinciaco,
                             ptrabajo_idmunicipioco,
                             ptrabajo_iddistritoco,
                             ppuntoreferenciaco,
                             ptelefonoco,
                             pextensionco,
                             pcargoco,
                             preside_mes,
                             preside_ano,
                             pactividadco,
                             ptipopersonaco,
                             ptiposolicitud,
                             pcodigoproyecto,
                             pdestinocredito,
                             pespecifiquedestino,
                             ptipopersonacal,
                             pedadcal,
                             pmontocal,
                             pplazocal,
                             pmonedacal,
                             pdiapagocal,
                             pfrecuenciacal,
                             pgraciacal,
                             pgarantiacal,
                             pseguro_vehiculocal,
                             pseguro_vidacal,
                             pseguro_incendiocal,
                             pgastoscal,
                             ptipoprestamocal,
                             pgarantiasolidariacal,
                             phipotecariacal,
                             pprendariacal,
                             pliquidacal,
                             pcuotasegurocal,
                             pcuotaprestamocal,
                             ptotalfinanciarcal,
                             ptasacal,
                             pgastoslegalescal,
                             psegurovidacal,
                             pseguroaliadacal,
                             psegurovehcal,
                             pclasificacion,
                             pfirmacliente,
                             pfirmaco,
                             pclientepertenece,
                             SYSDATE,  --pFECHA_REGISTRO, MALMANZAR 10-03-2022
                             ptipocal,
                             ptipoparentesco,
                             ptipoparentescoco,
                             ptipopersona2,
                             ptipocliente,
                             ptipoproductos,
                             pactividadciiu_sol,
                             pidramaciiu_sol,
                             p_nrocredito, --pNOCREDITO, --malmanzar 28-06-2022
                             psegundonombre,
                             psegundoapellido,
                             psegundonombreco,
                             psegundoapellidoco,
                             pcodpaisiso,
                             papellidocasadacliente,
                             pcedulaextranjera);
            --                    api_portacredit.fnInsertFud (
            --                        pID_TEMPFUD                => pID_TEMPFUD,
            --                        pNOMARCHIVO                => pNOMARCHIVO,
            --                        pPROCESADO                 => pPROCESADO,
            --                        pIDAPERTURACLIENTE         => pIDAPERTURACLIENTE,
            --                        pTIPODOCUMENTOIDENTIDAD    => pTIPODOCUMENTOIDENTIDAD,
            --                        pNUMDOCUMENTOIDENTIDAD     => pNUMDOCUMENTOIDENTIDAD,
            --                        pIDOFICIAL                 => pIDOFICIAL,
            --                        pIDAGENCIA                 => pIDAGENCIA,
            --                        pPRIMERNOMBRE              => pPRIMERNOMBRE,
            --                        pPRIMERAPELLIDO            => pPRIMERAPELLIDO,
            --                        pSEXO                      => pSEXO,
            --                        pFECHANACIMIENTO           => pFECHANACIMIENTO,
            --                        pAPODO                     => pAPODO,
            --                        pIDEMPLEADO                => pIDEMPLEADO,
            --                        pIDPAIS                    => pIDPAIS,
            --                        pIDPROVINCIA               => pIDPROVINCIA,
            --                        pIDMUNICIPIO               => pIDMUNICIPIO,
            --                        pIDDISTRITO                => pIDDISTRITO,
            --                        pIDESTADOCIVIL             => pIDESTADOCIVIL,
            --                        pNOHIJOS                   => pNOHIJOS,
            --                        pDEPENDIENTES              => pDEPENDIENTES,
            --                        pGRADOINT                  => pGRADOINT,
            --                        pIDOCUPACION               => pIDOCUPACION,
            --                        pIDVINCULADO               => pIDVINCULADO,
            --                        pNOMBREVINCULADO           => pNOMBREVINCULADO,
            --                        pIDTIPOVINCULADO           => pIDTIPOVINCULADO,
            --                        pIDCOMOSUPONOSOTROS        => pIDCOMOSUPONOSOTROS,
            --                        pDIRECCION                 => pDIRECCION,
            --                        pDIRECCION_IDSECTOR        => pDIRECCION_IDSECTOR,
            --                        pDIRECCION_IDPROVINCIA     => pDIRECCION_IDPROVINCIA,
            --                        pDIRECCION_IDMUNICIPIO     => pDIRECCION_IDMUNICIPIO,
            --                        pDIRECCION_DISTRITO        => pDIRECCION_DISTRITO,
            --                        pDIRECCION_IDTIPOVIVIENDA   =>
            --                            pDIRECCION_IDTIPOVIVIENDA,
            --                        pREF_DOMICILIO             => pREF_DOMICILIO,
            --                        pTELEFONO_CASA             => pTELEFONO_CASA,
            --                        pTELEFONO_CELULAR          => pTELEFONO_CELULAR,
            --                        pNOMBRENEGOCIO             => pNOMBRENEGOCIO,
            --                        pNOEMPLEADOS               => pNOEMPLEADOS,
            --                        pRNC                       => pRNC,
            --                        pFAX                       => pFAX,
            --                        pEMAIL                     => pEMAIL,
            --                        pSECTORECONOMICO           => pSECTORECONOMICO,
            --                        pACTIVIDAD_CIIU            => pACTIVIDAD_CIIU,
            --                        pIDRAMA_CIIU               => pIDRAMA_CIIU,
            --                        pINICIO_MES                => pINICIO_MES,
            --                        pINICIO_ANO                => pINICIO_ANO,
            --                        pUBICACION_NEG             => pUBICACION_NEG,
            --                        pLUGARTRABAJO              => pLUGARTRABAJO,
            --                        pFECHAINGRESO              => pFECHAINGRESO,
            --                        pCARGO                     => pCARGO,
            --                        pTRABAJO_DIRECCION         => pTRABAJO_DIRECCION,
            --                        pTRABAJO_IDSECTOR          => pTRABAJO_IDSECTOR,
            --                        pTRABAJO_IDPROVINCIA       => pTRABAJO_IDPROVINCIA,
            --                        pTRABAJO_IDMUNICIPIO       => pTRABAJO_IDMUNICIPIO,
            --                        pTRABAJO_IDDISTRITO        => pTRABAJO_IDDISTRITO,
            --                        pPUNTOREFERENCIA           => pPUNTOREFERENCIA,
            --                        pTELEFONO                  => pTELEFONO,
            --                        pEXTENSION                 => pEXTENSION,
            --                        pREFPERSONALES_APELLIDOS   => pREFPERSONALES_APELLIDOS,
            --                        pREFPERSONALES_NOMBRES     => pREFPERSONALES_NOMBRES,
            --                        pREFPERSONALES_TELEFONO    => pREFPERSONALES_TELEFONO,
            --                        pREFPERSONALES_RELFAMILIAR   =>
            --                            pREFPERSONALES_RELFAMILIAR,
            --                        pREFPERSONALES_NOMBRES2    => pREFPERSONALES_NOMBRES2,
            --                        pREFPERSONALES_APELLIDOS2   =>
            --                            pREFPERSONALES_APELLIDOS2,
            --                        pREFPERSONALES_TELEFONO2   => pREFPERSONALES_TELEFONO2,
            --                        pREFPERSONALES_RELFAM2     => pREFPERSONALES_RELFAM2,
            --                        pACTUALMENTEENMORA         => pACTUALMENTEENMORA,
            --                        pCUMPLIOREQUISITOS         => pCUMPLIOREQUISITOS,
            --                        pPRESENTO_DOC_FRAUDULENTA   =>
            --                            pPRESENTO_DOC_FRAUDULENTA,
            --                        pDIJOLAVERDAD              => pDIJOLAVERDAD,
            --                        pCLIENTEESFIADOR           => pCLIENTEESFIADOR,
            --                        pCLIENTEMOROSO             => pCLIENTEMOROSO,
            --                        pSOBREENDEUDAMIENTO_SF     => pSOBREENDEUDAMIENTO_SF,
            --                        pACTIVIDADCLIENTE          => pACTIVIDADCLIENTE,
            --                        pTIPOPERSONA               => pTIPOPERSONA,
            --                        pTIPODOCUMENTOIDENTIDADCO   =>
            --                            pTIPODOCUMENTOIDENTIDADCO,
            --                        pNUMDOCUMENTOIDENTIDADCO   => pNUMDOCUMENTOIDENTIDADCO,
            --                        pNOMBRESCO                 => pNOMBRESCO,
            --                        pAPELLIDOSCO               => pAPELLIDOSCO,
            --                        pSEXOCO                    => pSEXOCO,
            --                        pFECHANACIMIENTOCO         => pFECHANACIMIENTOCO,
            --                        pAPODOCO                   => pAPODOCO,
            --                        pIDEMPLEADOCO              => pIDEMPLEADOCO,
            --                        pIDPAISCO                  => pIDPAISCO,
            --                        pIDPROVINCIACO             => pIDPROVINCIACO,
            --                        pIDMUNICIPIOCO             => pIDMUNICIPIOCO,
            --                        pIDDISTRITOCO              => pIDDISTRITOCO,
            --                        pIDESTADOCIVILCO           => pIDESTADOCIVILCO,
            --                        pNOHIJOSCO                 => pNOHIJOSCO,
            --                        pDEPENDIENTESCO            => pDEPENDIENTESCO,
            --                        pGRADOINTCO                => pGRADOINTCO,
            --                        pIDOCUPACIONCO             => pIDOCUPACIONCO,
            --                        pIDVINCULADOCO             => pIDVINCULADOCO,
            --                        pNOMBREVINCULADOCO         => pNOMBREVINCULADOCO,
            --                        pIDTIPOVINCULADOCO         => pIDTIPOVINCULADOCO,
            --                        pIDCOMOSUPONOSOTROSCO      => pIDCOMOSUPONOSOTROSCO,
            --                        pNOMBRENEGOCIOCO           => pNOMBRENEGOCIOCO,
            --                        pNOEMPLEADOSCO             => pNOEMPLEADOSCO,
            --                        pRNCCO                     => pRNCCO,
            --                        pFAXCO                     => pFAXCO,
            --                        pEMAILCO                   => pEMAILCO,
            --                        pSECTORECONOMICOCO         => pSECTORECONOMICOCO,
            --                        pACTIVIDAD_CIIUCO          => pACTIVIDAD_CIIUCO,
            --                        pIDRAMA_CIIUCO             => pIDRAMA_CIIUCO,
            --                        pINICIO_MESCO              => pINICIO_MESCO,
            --                        pINICIO_ANOCO              => pINICIO_ANOCO,
            --                        pUBICACION_NEGCO           => pUBICACION_NEGCO,
            --                        pLUGARTRABAJOCO            => pLUGARTRABAJOCO,
            --                        pFECHAINGRESOCO            => pFECHAINGRESOCO,
            --                        pTRABAJO_DIRECCIONCO       => pTRABAJO_DIRECCIONCO,
            --                        pTRABAJO_IDSECTORCO        => pTRABAJO_IDSECTORCO,
            --                        pTRABAJO_IDPROVINCIACO     => pTRABAJO_IDPROVINCIACO,
            --                        pTRABAJO_IDMUNICIPIOCO     => pTRABAJO_IDMUNICIPIOCO,
            --                        pTRABAJO_IDDISTRITOCO      => pTRABAJO_IDDISTRITOCO,
            --                        pPUNTOREFERENCIACO         => pPUNTOREFERENCIACO,
            --                        pTELEFONOCO                => pTELEFONOCO,
            --                        pEXTENSIONCO               => pEXTENSIONCO,
            --                        pCARGOCO                   => pCARGOCO,
            --                        pRESIDE_MES                => pRESIDE_MES,
            --                        pRESIDE_ANO                => pRESIDE_ANO,
            --                        pACTIVIDADCO               => pACTIVIDADCO,
            --                        pTIPOPERSONACO             => pTIPOPERSONACO,
            --                        pTIPOSOLICITUD             => pTIPOSOLICITUD,
            --                        pCODIGOPROYECTO            => pCODIGOPROYECTO,
            --                        pDESTINOCREDITO            => pDESTINOCREDITO,
            --                        pESPECIFIQUEDESTINO        => pESPECIFIQUEDESTINO,
            --                        pTIPOPERSONACAL            => pTIPOPERSONACAL,
            --                        pEDADCAL                   => pEDADCAL,
            --                        pMONTOCAL                  => pMONTOCAL,
            --                        pPLAZOCAL                  => pPLAZOCAL,
            --                        pMONEDACAL                 => pMONEDACAL,
            --                        pDIAPAGOCAL                => pDIAPAGOCAL,
            --                        pFRECUENCIACAL             => pFRECUENCIACAL,
            --                        pGRACIACAL                 => pGRACIACAL,
            --                        pGARANTIACAL               => pGARANTIACAL,
            --                        pSEGURO_VEHICULOCAL        => pSEGURO_VEHICULOCAL,
            --                        pSEGURO_VIDACAL            => pSEGURO_VIDACAL,
            --                        pSEGURO_INCENDIOCAL        => pSEGURO_INCENDIOCAL,
            --                        pGASTOSCAL                 => pGASTOSCAL,
            --                        pTIPOPRESTAMOCAL           => pTIPOPRESTAMOCAL,
            --                        pGARANTIASOLIDARIACAL      => pGARANTIASOLIDARIACAL,
            --                        pHIPOTECARIACAL            => pHIPOTECARIACAL,
            --                        pPRENDARIACAL              => pPRENDARIACAL,
            --                        pLIQUIDACAL                => pLIQUIDACAL,
            --                        pCUOTASEGUROCAL            => pCUOTASEGUROCAL,
            --                        pCUOTAPRESTAMOCAL          => pCUOTAPRESTAMOCAL,
            --                        pTOTALFINANCIARCAL         => pTOTALFINANCIARCAL,
            --                        pTASACAL                   => pTASACAL,
            --                        pGASTOSLEGALESCAL          => pGASTOSLEGALESCAL,
            --                        pSEGUROVIDACAL             => pSEGUROVIDACAL,
            --                        pSEGUROALIADACAL           => pSEGUROALIADACAL,
            --                        pSEGUROVEHCAL              => pSEGUROVEHCAL,
            --                        pCLASIFICACION             => pCLASIFICACION,
            --                        pFIRMACLIENTE              => pFIRMACLIENTE,
            --                        pFIRMACO                   => pFIRMACO,
            --                        pCLIENTEPERTENECE          => pCLIENTEPERTENECE,
            --                        pFECHA_REGISTRO            => pFECHA_REGISTRO,
            --                        pTIPOCAL                   => pTIPOCAL,
            --                        pTIPOPARENTESCO            => pTIPOPARENTESCO,
            --                        pTIPOPARENTESCOCO          => pTIPOPARENTESCOCO,
            --                        pTIPOPERSONA2              => pTIPOPERSONA2,
            --                        pTIPOCLIENTE               => pTIPOCLIENTE,
            --                        pTIPOPRODUCTOS             => pTIPOPRODUCTOS,
            --                        pACTIVIDADCIIU_SOL         => pACTIVIDADCIIU_SOL,
            --                        pIDRAMACIIU_SOL            => pIDRAMACIIU_SOL,
            --                        pNOCREDITO                 => p_nrocredito,
            --                        pSEGUNDONOMBRE             => pSEGUNDONOMBRE,
            --                        pSEGUNDOAPELLIDO           => pSEGUNDOAPELLIDO,
            --                        pSEGUNDONOMBRECO           => pSEGUNDONOMBRECO,
            --                        pSEGUNDOAPELLIDOCO         => pSEGUNDOAPELLIDOCO,
            --                        pCODPAISISO                => pCODPAISISO,
            --                        pAPELLIDOCASADACLIENTE     => pAPELLIDOCASADACLIENTE,
            --                        PCEDULAEXTRANJERA          => PCEDULAEXTRANJERA);
            p_depura ('Credito procesado: No_Credito ' || p_nrocredito);


            pid_tempfud := NULL;
            pnomarchivo := NULL;
            pprocesado := NULL;
            pidaperturacliente := NULL;
            ptipodocumentoidentidad := NULL;
            pnumdocumentoidentidad := NULL;
            pidoficial := NULL;
            pidagencia := NULL;
            pprimernombre := NULL;
            pprimerapellido := NULL;
            psexo := NULL;
            pfechanacimiento := NULL;
            papodo := NULL;
            pidempleado := NULL;
            pidpais := NULL;
            pidprovincia := NULL;
            pidmunicipio := NULL;
            piddistrito := NULL;
            pidestadocivil := NULL;
            pnohijos := NULL;
            pdependientes := NULL;
            pgradoint := NULL;
            pidocupacion := NULL;
            pidvinculado := NULL;
            pnombrevinculado := NULL;
            pidtipovinculado := NULL;
            pidcomosuponosotros := NULL;
            pdireccion := NULL;
            pdireccion_idsector := NULL;
            pdireccion_idprovincia := NULL;
            pdireccion_idmunicipio := NULL;
            pdireccion_distrito := NULL;
            pdireccion_idtipovivienda := NULL;
            pref_domicilio := NULL;
            ptelefono_casa := NULL;
            ptelefono_celular := NULL;
            pnombrenegocio := NULL;
            pnoempleados := NULL;
            prnc := NULL;
            pfax := NULL;
            pemail := NULL;
            psectoreconomico := NULL;
            pactividad_ciiu := NULL;
            pidrama_ciiu := NULL;
            pinicio_mes := NULL;
            pinicio_ano := NULL;
            pubicacion_neg := NULL;
            plugartrabajo := NULL;
            pfechaingreso := NULL;
            pcargo := NULL;
            ptrabajo_direccion := NULL;
            ptrabajo_idsector := NULL;
            ptrabajo_idprovincia := NULL;
            ptrabajo_idmunicipio := NULL;
            ptrabajo_iddistrito := NULL;
            ppuntoreferencia := NULL;
            ptelefono := NULL;
            pextension := NULL;
            prefpersonales_apellidos := NULL;
            prefpersonales_nombres := NULL;
            prefpersonales_telefono := NULL;
            prefpersonales_relfamiliar := NULL;
            prefpersonales_nombres2 := NULL;
            prefpersonales_apellidos2 := NULL;
            prefpersonales_telefono2 := NULL;
            prefpersonales_relfam2 := NULL;
            pactualmenteenmora := NULL;
            pcumpliorequisitos := NULL;
            ppresento_doc_fraudulenta := NULL;
            pdijolaverdad := NULL;
            pclienteesfiador := NULL;
            pclientemoroso := NULL;
            psobreendeudamiento_sf := NULL;
            pactividadcliente := NULL;
            ptipopersona := NULL;
            ptipodocumentoidentidadco := NULL;
            pnumdocumentoidentidadco := NULL;
            pprimernombreco := NULL;
            pprimerapellidoco := NULL;
            psexoco := NULL;
            pfechanacimientoco := NULL;
            papodoco := NULL;
            pidempleadoco := NULL;
            pidpaisco := NULL;
            pidprovinciaco := NULL;
            pidmunicipioco := NULL;
            piddistritoco := NULL;
            pidestadocivilco := NULL;
            pnohijosco := NULL;
            pdependientesco := NULL;
            pgradointco := NULL;
            pidocupacionco := NULL;
            pidvinculadoco := NULL;
            pnombrevinculadoco := NULL;
            pidtipovinculadoco := NULL;
            pidcomosuponosotrosco := NULL;
            pnombrenegocioco := NULL;
            pnoempleadosco := NULL;
            prncco := NULL;
            pfaxco := NULL;
            pemailco := NULL;
            psectoreconomicoco := NULL;
            pactividad_ciiuco := NULL;
            pidrama_ciiuco := NULL;
            pinicio_mesco := NULL;
            pinicio_anoco := NULL;
            pubicacion_negco := NULL;
            plugartrabajoco := NULL;
            pfechaingresoco := NULL;
            ptrabajo_direccionco := NULL;
            ptrabajo_idsectorco := NULL;
            ptrabajo_idprovinciaco := NULL;
            ptrabajo_idmunicipioco := NULL;
            ptrabajo_iddistritoco := NULL;
            ppuntoreferenciaco := NULL;
            ptelefonoco := NULL;
            pextensionco := NULL;
            pcargoco := NULL;
            preside_mes := NULL;
            preside_ano := NULL;
            pactividadco := NULL;
            ptipopersonaco := NULL;
            ptiposolicitud := NULL;
            pcodigoproyecto := NULL;
            pdestinocredito := NULL;
            pespecifiquedestino := NULL;
            ptipopersonacal := NULL;
            pedadcal := NULL;
            pmontocal := NULL;
            pplazocal := NULL;
            pmonedacal := NULL;
            pdiapagocal := NULL;
            pfrecuenciacal := NULL;
            pgraciacal := NULL;
            pgarantiacal := NULL;
            pseguro_vehiculocal := NULL;
            pseguro_vidacal := NULL;
            pseguro_incendiocal := NULL;
            pgastoscal := NULL;
            ptipoprestamocal := NULL;
            pgarantiasolidariacal := NULL;
            phipotecariacal := NULL;
            pprendariacal := NULL;
            pliquidacal := NULL;
            pcuotasegurocal := NULL;
            pcuotaprestamocal := NULL;
            ptotalfinanciarcal := NULL;
            ptasacal := NULL;
            pgastoslegalescal := NULL;
            psegurovidacal := NULL;
            pseguroaliadacal := NULL;
            psegurovehcal := NULL;
            pclasificacion := NULL;
            pfirmacliente := NULL;
            pfirmaco := NULL;
            pclientepertenece := NULL;
            pfecha_registro := NULL;
            ptipocal := NULL;
            ptipoparentesco := NULL;
            ptipoparentescoco := NULL;
            ptipopersona2 := NULL;
            ptipocliente := NULL;
            ptipoproductos := NULL;
            pactividadciiu_sol := NULL;
            pidramaciiu_sol := NULL;
            errorcode := NULL;
            errordescription := NULL;
            --pNOCREDITO                :=  NULL;
            psegundonombre := NULL;
            psegundoapellido := NULL;
            psegundonombreco := NULL;
            psegundoapellidoco := NULL;
            pcodpaisiso := NULL;
            papellidocasadacliente := NULL;
            pcedulaextranjera := NULL;


            IF NVL (vfundinsert, 'N') = 'S'
            THEN
                COMMIT;
            ELSE
                errorcode := '53.1';
                errordescription :=
                    v_error || '-' || 'Rechazado: ' || vfundinsert;
                p_depura (
                       'Error generar creando fud errorCode '
                    || errorcode
                    || ' errorDescription '
                    || errordescription);
                ROLLBACK;
                RETURN;
            END IF;
        --        EXCEPTION
        --            WHEN OTHERS
        --            THEN
        --                errorCode := '53';
        --                errorDescription :=
        --                    NVL (v_error || '-' || SQLERRM, 'Rechazado');
        --                p_depura (
        --                       'Error generar creando fud errorCode '
        --                    || errorCode
        --                    || ' errorDescription '
        --                    || errorDescription);
        --                ROLLBACK;
        --Return
        END;
    --10-07-2019 End;
    END pcrearfud;

    FUNCTION f_periodicidad_pda_core (pfrecuenciacal_pda VARCHAR2)
        RETURN VARCHAR2
    IS
        CURSOR c_data (periodicidadpda VARCHAR2)
        IS
            SELECT codigo_periodo
              FROM pr_periodicidad
             WHERE frecuenciacal_pda = periodicidadpda;

        vperiodicidad   pr_periodicidad.codigo_periodo%TYPE;
    BEGIN
        OPEN c_data (pfrecuenciacal_pda); ---C = 1, R = 2, P = 4, X = 5, PE = 6

        FETCH c_data INTO vperiodicidad;

        CLOSE c_data;

        RETURN vperiodicidad;
    END;

    FUNCTION fninsertfud (pid_tempfud                  NUMBER,
                          pnomarchivo                  VARCHAR2,
                          pprocesado                   VARCHAR2,
                          pidaperturacliente           VARCHAR2,
                          ptipodocumentoidentidad      VARCHAR2,
                          pnumdocumentoidentidad       VARCHAR2,
                          pidoficial                   VARCHAR2,
                          pidagencia                   VARCHAR2,
                          pprimernombre                VARCHAR2,
                          pprimerapellido              VARCHAR2,
                          psexo                        VARCHAR2,
                          pfechanacimiento             VARCHAR2,
                          papodo                       VARCHAR2,
                          pidempleado                  VARCHAR2,
                          pidpais                      VARCHAR2,
                          pidprovincia                 VARCHAR2,
                          pidmunicipio                 VARCHAR2,
                          piddistrito                  VARCHAR2,
                          pidestadocivil               VARCHAR2,
                          pnohijos                     VARCHAR2,
                          pdependientes                VARCHAR2,
                          pgradoint                    VARCHAR2,
                          pidocupacion                 VARCHAR2,
                          pidvinculado                 VARCHAR2,
                          pnombrevinculado             VARCHAR2,
                          pidtipovinculado             VARCHAR2,
                          pidcomosuponosotros          VARCHAR2,
                          pdireccion                   VARCHAR2,
                          pdireccion_idsector          VARCHAR2,
                          pdireccion_idprovincia       VARCHAR2,
                          pdireccion_idmunicipio       VARCHAR2,
                          pdireccion_distrito          VARCHAR2,
                          pdireccion_idtipovivienda    VARCHAR2,
                          pref_domicilio               VARCHAR2,
                          ptelefono_casa               VARCHAR2,
                          ptelefono_celular            VARCHAR2,
                          pnombrenegocio               VARCHAR2,
                          pnoempleados                 VARCHAR2,
                          prnc                         VARCHAR2,
                          pfax                         VARCHAR2,
                          pemail                       VARCHAR2,
                          psectoreconomico             VARCHAR2,
                          pactividad_ciiu              VARCHAR2,
                          pidrama_ciiu                 VARCHAR2,
                          pinicio_mes                  VARCHAR2,
                          pinicio_ano                  VARCHAR2,
                          pubicacion_neg               VARCHAR2,
                          plugartrabajo                VARCHAR2,
                          pfechaingreso                VARCHAR2,
                          pcargo                       VARCHAR2,
                          ptrabajo_direccion           VARCHAR2,
                          ptrabajo_idsector            VARCHAR2,
                          ptrabajo_idprovincia         VARCHAR2,
                          ptrabajo_idmunicipio         VARCHAR2,
                          ptrabajo_iddistrito          VARCHAR2,
                          ppuntoreferencia             VARCHAR2,
                          ptelefono                    VARCHAR2,
                          pextension                   VARCHAR2,
                          prefpersonales_apellidos     VARCHAR2,
                          prefpersonales_nombres       VARCHAR2,
                          prefpersonales_telefono      VARCHAR2,
                          prefpersonales_relfamiliar   VARCHAR2,
                          prefpersonales_nombres2      VARCHAR2,
                          prefpersonales_apellidos2    VARCHAR2,
                          prefpersonales_telefono2     VARCHAR2,
                          prefpersonales_relfam2       VARCHAR2,
                          pactualmenteenmora           VARCHAR2,
                          pcumpliorequisitos           VARCHAR2,
                          ppresento_doc_fraudulenta    VARCHAR2,
                          pdijolaverdad                VARCHAR2,
                          pclienteesfiador             VARCHAR2,
                          pclientemoroso               VARCHAR2,
                          psobreendeudamiento_sf       VARCHAR2,
                          pactividadcliente            VARCHAR2,
                          ptipopersona                 VARCHAR2,
                          ptipodocumentoidentidadco    VARCHAR2,
                          pnumdocumentoidentidadco     VARCHAR2,
                          pprimernombreco              VARCHAR2,
                          pprimerapellidoco            VARCHAR2,
                          psexoco                      VARCHAR2,
                          pfechanacimientoco           VARCHAR2,
                          papodoco                     VARCHAR2,
                          pidempleadoco                VARCHAR2,
                          pidpaisco                    VARCHAR2,
                          pidprovinciaco               VARCHAR2,
                          pidmunicipioco               VARCHAR2,
                          piddistritoco                VARCHAR2,
                          pidestadocivilco             VARCHAR2,
                          pnohijosco                   VARCHAR2,
                          pdependientesco              VARCHAR2,
                          pgradointco                  VARCHAR2,
                          pidocupacionco               VARCHAR2,
                          pidvinculadoco               VARCHAR2,
                          pnombrevinculadoco           VARCHAR2,
                          pidtipovinculadoco           VARCHAR2,
                          pidcomosuponosotrosco        VARCHAR2,
                          pnombrenegocioco             VARCHAR2,
                          pnoempleadosco               VARCHAR2,
                          prncco                       VARCHAR2,
                          pfaxco                       VARCHAR2,
                          pemailco                     VARCHAR2,
                          psectoreconomicoco           VARCHAR2,
                          pactividad_ciiuco            VARCHAR2,
                          pidrama_ciiuco               VARCHAR2,
                          pinicio_mesco                VARCHAR2,
                          pinicio_anoco                VARCHAR2,
                          pubicacion_negco             VARCHAR2,
                          plugartrabajoco              VARCHAR2,
                          pfechaingresoco              VARCHAR2,
                          ptrabajo_direccionco         VARCHAR2,
                          ptrabajo_idsectorco          VARCHAR2,
                          ptrabajo_idprovinciaco       VARCHAR2,
                          ptrabajo_idmunicipioco       VARCHAR2,
                          ptrabajo_iddistritoco        VARCHAR2,
                          ppuntoreferenciaco           VARCHAR2,
                          ptelefonoco                  VARCHAR2,
                          pextensionco                 VARCHAR2,
                          pcargoco                     VARCHAR2,
                          preside_mes                  VARCHAR2,
                          preside_ano                  VARCHAR2,
                          pactividadco                 VARCHAR2,
                          ptipopersonaco               VARCHAR2,
                          ptiposolicitud               VARCHAR2,
                          pcodigoproyecto              VARCHAR2,
                          pdestinocredito              VARCHAR2,
                          pespecifiquedestino          VARCHAR2,
                          ptipopersonacal              VARCHAR2,
                          pedadcal                     VARCHAR2,
                          pmontocal                    VARCHAR2,
                          pplazocal                    VARCHAR2,
                          pmonedacal                   VARCHAR2,
                          pdiapagocal                  VARCHAR2,
                          pfrecuenciacal               VARCHAR2,
                          pgraciacal                   VARCHAR2,
                          pgarantiacal                 VARCHAR2,
                          pseguro_vehiculocal          VARCHAR2,
                          pseguro_vidacal              VARCHAR2,
                          pseguro_incendiocal          VARCHAR2,
                          pgastoscal                   VARCHAR2,
                          ptipoprestamocal             VARCHAR2,
                          pgarantiasolidariacal        VARCHAR2,
                          phipotecariacal              VARCHAR2,
                          pprendariacal                VARCHAR2,
                          pliquidacal                  VARCHAR2,
                          pcuotasegurocal              VARCHAR2,
                          pcuotaprestamocal            VARCHAR2,
                          ptotalfinanciarcal           VARCHAR2,
                          ptasacal                     VARCHAR2,
                          pgastoslegalescal            VARCHAR2,
                          psegurovidacal               VARCHAR2,
                          pseguroaliadacal             VARCHAR2,
                          psegurovehcal                VARCHAR2,
                          pclasificacion               VARCHAR2,
                          pfirmacliente                VARCHAR2,
                          pfirmaco                     VARCHAR2,
                          pclientepertenece            VARCHAR2,
                          pfecha_registro              VARCHAR2,
                          ptipocal                     NUMBER,
                          ptipoparentesco              VARCHAR2,
                          ptipoparentescoco            VARCHAR2,
                          ptipopersona2                VARCHAR2,
                          ptipocliente                 VARCHAR2,
                          ptipoproductos               VARCHAR2,
                          pactividadciiu_sol           VARCHAR2,
                          pidramaciiu_sol              VARCHAR2,
                          pnocredito                   VARCHAR2,
                          psegundonombre               VARCHAR2,
                          psegundoapellido             VARCHAR2,
                          psegundonombreco             VARCHAR2,
                          psegundoapellidoco           VARCHAR2,
                          pcodpaisiso                  VARCHAR2,
                          papellidocasadacliente       VARCHAR2,
                          pcedulaextranjera            VARCHAR2)
        RETURN VARCHAR2
    IS
        verror   VARCHAR2 (2000);
    BEGIN
        --- P_DEPURA (' pNOCREDITO ' || pNOCREDITO || ' Linea ' || $$plsql_line);

        BEGIN
            INSERT INTO pr.tempfud (id_tempfud,
                                    nomarchivo,
                                    procesado,
                                    idaperturacliente,
                                    tipodocumentoidentidad,
                                    numdocumentoidentidad,
                                    idoficial,
                                    idagencia,
                                    primernombre, --NOMBRES, malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    --- SEGUNDONOMBRE,-- Nueva columna malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    primerapellido, --APELLIDOS, malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    -- SEGUNDOAPELLIDO,-- Nueva columna malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    sexo,
                                    fechanacimiento,
                                    apodo,
                                    idempleado,
                                    idpais,
                                    idprovincia,
                                    idmunicipio,
                                    iddistrito,
                                    idestadocivil,
                                    nohijos,
                                    dependientes,
                                    gradoint,
                                    idocupacion,
                                    idvinculado,
                                    nombrevinculado,
                                    idtipovinculado,
                                    idcomosuponosotros,
                                    direccion,
                                    direccion_idsector,
                                    direccion_idprovincia,
                                    direccion_idmunicipio,
                                    direccion_distrito,
                                    direccion_idtipovivienda,
                                    ref_domicilio,
                                    telefono_casa,
                                    telefono_celular,
                                    nombrenegocio,
                                    noempleados,
                                    rnc,
                                    fax,
                                    email,
                                    sectoreconomico,
                                    actividad_ciiu,
                                    idrama_ciiu,
                                    inicio_mes,
                                    inicio_ano,
                                    ubicacion_neg,
                                    lugartrabajo,
                                    fechaingreso,
                                    cargo,
                                    trabajo_direccion,
                                    trabajo_idsector,
                                    trabajo_idprovincia,
                                    trabajo_idmunicipio,
                                    trabajo_iddistrito,
                                    puntoreferencia,
                                    telefono,
                                    extension,
                                    refpersonales_apellidos,
                                    refpersonales_nombres,
                                    refpersonales_telefono,
                                    refpersonales_relacionfamiliar,
                                    refpersonales_nombres2,
                                    refpersonales_apellidos2,
                                    refpersonales_telefono2,
                                    refpersonales_relfam2,
                                    actualmenteenmora,
                                    cumpliorequisitos,
                                    presento_doc_fraudulenta,
                                    dijolaverdad,
                                    clienteesfiador,
                                    clientemoroso,
                                    sobreendeudamiento_sf,
                                    actividadcliente,
                                    tipopersona,
                                    tipodocumentoidentidadco,
                                    numdocumentoidentidadco,
                                    primernombreco, --NOMBRESCO, malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    --SEGUNDONOMBRECO,  --nueva columna  malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    primerapellidoco, --APELLIDOSCO, malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    --SEGUNDOAPELLIDOCO,  --nueva columna  malmanzar 15-02-2022 Modificaciones Carlos Zorrilla
                                    sexoco,
                                    fechanacimientoco,
                                    apodoco,
                                    idempleadoco,
                                    idpaisco,
                                    idprovinciaco,
                                    idmunicipioco,
                                    iddistritoco,
                                    idestadocivilco,
                                    nohijosco,
                                    dependientesco,
                                    gradointco,
                                    idocupacionco,
                                    idvinculadoco,
                                    nombrevinculadoco,
                                    idtipovinculadoco,
                                    idcomosuponosotrosco,
                                    nombrenegocioco,
                                    noempleadosco,
                                    rncco,
                                    faxco,
                                    emailco,
                                    sectoreconomicoco,
                                    actividad_ciiuco,
                                    idrama_ciiuco,
                                    inicio_mesco,
                                    inicio_anoco,
                                    ubicacion_negco,
                                    lugartrabajoco,
                                    fechaingresoco,
                                    trabajo_direccionco,
                                    trabajo_idsectorco,
                                    trabajo_idprovinciaco,
                                    trabajo_idmunicipioco,
                                    trabajo_iddistritoco,
                                    puntoreferenciaco,
                                    telefonoco,
                                    extensionco,
                                    cargoco,
                                    reside_mes,
                                    reside_ano,
                                    actividadco,
                                    tipopersonaco,
                                    tiposolicitud,
                                    codigoproyecto,
                                    destinocredito,
                                    especifiquedestino,
                                    tipopersonacal,
                                    edadcal,
                                    montocal,
                                    plazocal,
                                    monedacal,
                                    diapagocal,
                                    frecuenciacal,
                                    graciacal,
                                    garantiacal,
                                    seguro_vehiculocal,
                                    seguro_vidacal,
                                    seguro_incendiocal,
                                    gastoscal,
                                    tipoprestamocal,
                                    garantiasolidariacal,
                                    hipotecariacal,
                                    prendariacal,
                                    liquidacal,
                                    cuotasegurocal,
                                    cuotaprestamocal,
                                    totalfinanciarcal,
                                    tasacal,
                                    gastoslegalescal,
                                    segurovidacal,
                                    seguroaliadacal,
                                    segurovehcal,
                                    clasificacion,
                                    firmacliente,
                                    firmaco,
                                    clientepertenece,
                                    fecha_registro,
                                    tipocal,
                                    tipoparentesco,
                                    tipoparentescoco,
                                    tipopersona2,
                                    tipocliente,
                                    tipoproductos,
                                    actividadciiu_sol,
                                    idramaciiu_sol,
                                    nocredito,
                                    segundonombre,
                                    segundoapellido,
                                    segundonombreco,
                                    segundoapellidoco,
                                    codpaisiso,
                                    apellidocasadacliente,
                                    cedulaextranjera,
                                    sectorcontable,
                                    idestado,
                                    dispara_trg)
                 VALUES (pid_tempfud,
                         pnomarchivo,
                         pprocesado,
                         pidaperturacliente,
                         ptipodocumentoidentidad,
                         pnumdocumentoidentidad,
                         pidoficial,
                         pidagencia,
                         pprimernombre,
                         pprimerapellido,
                         psexo,
                         pfechanacimiento,
                         papodo,
                         pidempleado,
                         pidpais,
                         pidprovincia,
                         pidmunicipio,
                         piddistrito,
                         pidestadocivil,
                         pnohijos,
                         pdependientes,
                         pgradoint,
                         pidocupacion,
                         pidvinculado,
                         pnombrevinculado,
                         pidtipovinculado,
                         pidcomosuponosotros,
                         pdireccion,
                         pdireccion_idsector,
                         pdireccion_idprovincia,
                         pdireccion_idmunicipio,
                         pdireccion_distrito,
                         pdireccion_idtipovivienda,
                         pref_domicilio,
                         ptelefono_casa,
                         ptelefono_celular,
                         pnombrenegocio,
                         pnoempleados,
                         prnc,
                         pfax,
                         pemail,
                         psectoreconomico,
                         pactividad_ciiu,
                         pidrama_ciiu,
                         pinicio_mes,
                         pinicio_ano,
                         pubicacion_neg,
                         plugartrabajo,
                         pfechaingreso,
                         pcargo,
                         ptrabajo_direccion,
                         ptrabajo_idsector,
                         ptrabajo_idprovincia,
                         ptrabajo_idmunicipio,
                         ptrabajo_iddistrito,
                         ppuntoreferencia,
                         ptelefono,
                         pextension,
                         prefpersonales_apellidos,
                         prefpersonales_nombres,
                         prefpersonales_telefono,
                         prefpersonales_relfamiliar,
                         prefpersonales_nombres2,
                         prefpersonales_apellidos2,
                         prefpersonales_telefono2,
                         prefpersonales_relfam2,
                         pactualmenteenmora,
                         pcumpliorequisitos,
                         ppresento_doc_fraudulenta,
                         pdijolaverdad,
                         pclienteesfiador,
                         pclientemoroso,
                         psobreendeudamiento_sf,
                         pactividadcliente,
                         ptipopersona,
                         ptipodocumentoidentidadco,
                         pnumdocumentoidentidadco,
                         pprimernombreco,
                         pprimerapellidoco,
                         psexoco,
                         pfechanacimientoco,
                         papodoco,
                         pidempleadoco,
                         pidpaisco,
                         pidprovinciaco,
                         pidmunicipioco,
                         piddistritoco,
                         pidestadocivilco,
                         pnohijosco,
                         pdependientesco,
                         pgradointco,
                         pidocupacionco,
                         pidvinculadoco,
                         pnombrevinculadoco,
                         pidtipovinculadoco,
                         pidcomosuponosotrosco,
                         pnombrenegocioco,
                         pnoempleadosco,
                         prncco,
                         pfaxco,
                         pemailco,
                         psectoreconomicoco,
                         pactividad_ciiuco,
                         pidrama_ciiuco,
                         pinicio_mesco,
                         pinicio_anoco,
                         pubicacion_negco,
                         plugartrabajoco,
                         pfechaingresoco,
                         ptrabajo_direccionco,
                         ptrabajo_idsectorco,
                         ptrabajo_idprovinciaco,
                         ptrabajo_idmunicipioco,
                         ptrabajo_iddistritoco,
                         ppuntoreferenciaco,
                         ptelefonoco,
                         pextensionco,
                         pcargoco,
                         preside_mes,
                         preside_ano,
                         pactividadco,
                         ptipopersonaco,
                         ptiposolicitud,
                         pcodigoproyecto,
                         pdestinocredito,
                         pespecifiquedestino,
                         ptipopersonacal,
                         pedadcal,
                         pmontocal,
                         pplazocal,
                         pmonedacal,
                         pdiapagocal,
                         pfrecuenciacal,
                         pgraciacal,
                         pgarantiacal,
                         pseguro_vehiculocal,
                         pseguro_vidacal,
                         pseguro_incendiocal,
                         pgastoscal,
                         ptipoprestamocal,
                         pgarantiasolidariacal,
                         phipotecariacal,
                         pprendariacal,
                         pliquidacal,
                         pcuotasegurocal,
                         pcuotaprestamocal,
                         ptotalfinanciarcal,
                         ptasacal,
                         pgastoslegalescal,
                         psegurovidacal,
                         pseguroaliadacal,
                         psegurovehcal,
                         pclasificacion,
                         pfirmacliente,
                         pfirmaco,
                         pclientepertenece,
                         SYSDATE,                           --pFECHA_REGISTRO,
                         ptipocal,
                         ptipoparentesco,
                         ptipoparentescoco,
                         ptipopersona2,
                         ptipocliente,
                         ptipoproductos,
                         pactividadciiu_sol,
                         pidramaciiu_sol,
                         pnocredito,                   ---malmanzar 28-06-2022
                         psegundonombre,
                         psegundoapellido,
                         psegundonombreco,
                         psegundoapellidoco,
                         pcodpaisiso,
                         papellidocasadacliente,
                         pcedulaextranjera,
                         '030202',
                         'A',                           --malmanzar 22-09-2022
                         'N'); --malmanzar 05-10-2022--req. 99362 para que no dispare Trigger despues del llamado desde el package

            RETURN 'S';
        EXCEPTION
            WHEN OTHERS
            THEN
                verror := SQLERRM;

                INSERT INTO bitacora_interfaz (nombre_objeto,
                                               datos_recibidos,
                                               mensaje_respuesta,
                                               tipo_mensaje,
                                               incluido_por,
                                               fec_inclusion,
                                               hora_inclusion)
                     VALUES ('fnTransCuentCliente',
                             verror,
                             ' ',
                             'FALLIDO',
                             'IA',
                             SYSDATE,
                             CURRENT_TIMESTAMP);


                RETURN verror;
        END;
    END;

    --malmanzar REq. 99362 Begin Codito Trigger TempFec 21-02-2022
    PROCEDURE pcrearfec (pidtempfec                       IN OUT NUMBER,
                         pnomarchivo                      IN OUT VARCHAR2,
                         pidevaluacioncrediticia          IN OUT VARCHAR2,
                         ptipodocumentoidentidad          IN OUT VARCHAR2,
                         pdocumentoidentidad              IN OUT VARCHAR2,
                         pnombrecliente                   IN OUT VARCHAR2,
                         pnumerosolicitud                 IN OUT NUMBER,
                         pmontorecomendado                IN OUT NUMBER,
                         pfrecuencia                      IN OUT VARCHAR2, --malmanzar 14-07-222
                         pplazo                           IN OUT NUMBER,
                         ppro1ventasmensuales             IN OUT NUMBER,
                         ppro2ventasmensuales             IN OUT NUMBER,
                         ppro3ventasmensuales             IN OUT NUMBER,
                         pprootroventasmensuales          IN OUT NUMBER,
                         pventasmensuales1                IN OUT NUMBER,
                         pventasmensuales2                IN OUT NUMBER,
                         pventasmensuales3                IN OUT NUMBER,
                         pventasmensuales4                IN OUT NUMBER,
                         pventasmensuales5                IN OUT NUMBER,
                         pventasmensuales6                IN OUT NUMBER,
                         pventasmensuales7                IN OUT NUMBER,
                         pventasmensuales8                IN OUT NUMBER,
                         pventasmensualesot               IN OUT NUMBER,
                         pventas_ingresos                 IN OUT NUMBER,
                         ppro1costosventasmensuales       IN OUT NUMBER,
                         ppro2costosventasmensuales       IN OUT NUMBER,
                         ppro3costosventasmensuales       IN OUT NUMBER,
                         pprootrocostosventasmensuales    IN OUT NUMBER,
                         pcostoventas1                    IN OUT NUMBER,
                         pcostoventas2                    IN OUT NUMBER,
                         pcostoventas3                    IN OUT NUMBER,
                         pcostoventas4                    IN OUT NUMBER,
                         pcostoventas5                    IN OUT NUMBER,
                         pcostoventas6                    IN OUT NUMBER,
                         pcostoventas7                    IN OUT NUMBER,
                         pcostoventas8                    IN OUT NUMBER,
                         pcostoventasot                   IN OUT NUMBER,
                         pcostoventas                     IN OUT NUMBER,
                         psueldo                          IN OUT NUMBER,
                         pservicio                        IN OUT NUMBER,
                         palquiler                        IN OUT NUMBER,
                         ptransporte_combs                IN OUT NUMBER,
                         ppagointereses                   IN OUT NUMBER,
                         potrosingresos_operacionales     IN OUT NUMBER,
                         palimentacion                    IN OUT NUMBER,
                         pvivienda                        IN OUT NUMBER,
                         pvestido                         IN OUT NUMBER,
                         ptransporte                      IN OUT NUMBER,
                         pservicios                       IN OUT NUMBER,
                         pmedicinas                       IN OUT NUMBER,
                         peducacion                       IN OUT NUMBER,
                         pdeudasfamiliares                IN OUT NUMBER,
                         potros_gastos                    IN OUT NUMBER,
                         ptotalgastos_familiares          IN OUT NUMBER,
                         pexcedentefamiliar               IN OUT NUMBER,
                         potros                           IN OUT NUMBER,
                         pmaquinaria_mueblesequipos       IN OUT NUMBER,
                         pefectivo_cajabanco              IN OUT NUMBER,
                         pcuentaxcobrar                   IN OUT NUMBER,
                         pinventario_prod_tem             IN OUT NUMBER,
                         pinventario_prod_proc            IN OUT NUMBER,
                         pinventario_materiaprima         IN OUT NUMBER,
                         pmercancia                       IN OUT NUMBER,
                         panticipo_proveedores            IN OUT NUMBER,
                         plocalnegocio                    IN OUT NUMBER,
                         pobligacionesfinancieras         IN OUT NUMBER,
                         ptotal_pasivo_lp                 IN OUT NUMBER,
                         pmueble_vehiculo                 IN OUT NUMBER,
                         pdeudacomercial                  IN OUT NUMBER,
                         ptasa                            IN OUT NUMBER,
                         pcuota                           IN OUT NUMBER,
                         pcuentapagarprovedor             IN OUT NUMBER,
                         pcuentapagarvarias               IN OUT NUMBER,
                         pinmuebles                       IN OUT NUMBER,
                         ptotal_activofamiliar            IN OUT NUMBER,
                         pdeudabancaria                   IN OUT NUMBER,
                         ptotal_pasivofamiliar            IN OUT NUMBER,
                         ppatrio_fam_balgen               IN OUT NUMBER,   ---
                         ptotal_activocorriente           IN OUT NUMBER,
                         ptotal_activofijo                IN OUT NUMBER,
                         ptotal_activos1                  IN OUT NUMBER,
                         ptotal_pasivocorrientes          IN OUT NUMBER,
                         ptotal_pasivo                    IN OUT NUMBER,
                         ptotal_pasivopatrimonio          IN OUT NUMBER,
                         ppasivo_patrimonio               IN OUT NUMBER,
                         ppatrimonio                      IN OUT NUMBER,
                         pactivocorte_pascte              IN OUT NUMBER,
                         potrosingresos_excedente         IN OUT NUMBER,
                         pcuotarecomendada_excedfam       IN OUT NUMBER,
                         ptotalpasivo_patrimonio          IN OUT NUMBER,
                         putilidadneta_patrimonio         IN OUT NUMBER,
                         putilidadneta_totalactivos1      IN OUT NUMBER,
                         putilidadneta_ventas             IN OUT NUMBER,
                         pcuentasxcobrar_ventas           IN OUT NUMBER,
                         pcostoventa_inventario           IN OUT NUMBER,
                         pgastoslegales                   IN OUT NUMBER,    --
                         pmoneda                          IN OUT VARCHAR2,
                         pcapital_trabajo                 IN OUT NUMBER,
                         pfechabalancegeneral             IN OUT VARCHAR2,
                         pdesde                           IN OUT VARCHAR2,
                         phasta                           IN OUT VARCHAR2,
                         ptotalcostooperacional           IN OUT NUMBER,
                         putilidadneta                    IN OUT NUMBER,
                         pventasdiarias_promedio          IN OUT NUMBER,
                         pdiastrabajados                  IN OUT NUMBER,
                         pcomprassemanalesdeclaradas      IN OUT NUMBER,
                         pventasmensualesdeclaradas       IN OUT NUMBER,
                         pmargendeclarado                 IN OUT NUMBER,
                         pmontomesalto                    IN OUT NUMBER,
                         pmontomesmedio                   IN OUT NUMBER,
                         pcomprasmensualesdeclaradas      IN OUT NUMBER,
                         pmontomesbajo                    IN OUT NUMBER,
                         pventasmensuales                 IN OUT NUMBER,
                         pcostoventamensual               IN OUT NUMBER,
                         putilidadbruta                   IN OUT NUMBER,
                         pmargenganancia                  IN OUT NUMBER,
                         pprimera_ref_vecinos             IN OUT VARCHAR2,
                         psegunda_ref_vecinos             IN OUT VARCHAR2,
                         pambientefamiliar                IN OUT VARCHAR2,
                         pdependientes                    IN OUT NUMBER,
                         pedad                            IN OUT VARCHAR2, --Number  27-07-2022
                         pestadosaludfamilia              IN OUT VARCHAR2, --Number  27-07-2022
                         pingresos                        IN OUT VARCHAR2, --Number  27-07-2022
                         potrosingresos                   IN OUT VARCHAR2, --Number  27-07-2022
                         pexperiencia_neg                 IN OUT NUMBER, --malmanzar 27-07-2022
                         phoras_neg                       IN OUT NUMBER,
                         plocalpropio                     IN OUT VARCHAR2, --malmanzar 14-07-2022
                         ptiempoempleo                    IN OUT NUMBER,
                         pubicacionnegocio                IN OUT VARCHAR2,
                         pllevaregistro                   IN OUT VARCHAR2,
                         pmejorasnegocio                  IN OUT VARCHAR2,
                         pclientesfrecuentes              IN OUT NUMBER,
                         pnivelcompetencia                IN OUT VARCHAR2, --malmanzar 14-07-2022
                         pfecha_balancegeneral_al         IN OUT VARCHAR2,
                         --                             IN OUT
                         pdestinocredito                  IN OUT VARCHAR2,
                         pespecifiquedestino              IN OUT VARCHAR2,
                         pestadosolicitud                 IN OUT NUMBER,
                         pactividadeconomica              IN OUT VARCHAR2,
                         pactividadeconomicadinrap        IN OUT VARCHAR2,
                         pmargenbrutoestandar             IN OUT NUMBER,
                         pgastosoperacionalesestandar     IN OUT NUMBER,
                         palto_indicadores                IN OUT NUMBER,
                         pbajo_indicadores                IN OUT NUMBER,
                         plunes                           IN OUT VARCHAR2,
                         pmartes                          IN OUT VARCHAR2,
                         pmiercoles                       IN OUT VARCHAR2,
                         pjueves                          IN OUT VARCHAR2,
                         pviernes                         IN OUT VARCHAR2,
                         psabado                          IN OUT VARCHAR2,
                         pdomingo                         IN OUT VARCHAR2,
                         ptotal_ventasaltas               IN OUT NUMBER,
                         ptotal_ventasbajas               IN OUT NUMBER,
                         ptotal_ventassemanales           IN OUT NUMBER,
                         ptotal_ventasmensuales           IN OUT NUMBER,
                         pmargenbrutodeclarado            IN OUT NUMBER,
                         palimentacion_gastos             IN OUT NUMBER,
                         pvivienda_gastos                 IN OUT NUMBER,
                         peducacion_gastos                IN OUT NUMBER,
                         psalud_gastos                    IN OUT NUMBER,
                         ptransporte_gastos               IN OUT NUMBER,
                         pvestido_gastos                  IN OUT NUMBER,
                         ppagodeudas_gastos               IN OUT NUMBER,
                         potros_gastos_familiares         IN OUT NUMBER,
                         ptotal_gastos                    IN OUT NUMBER,
                         pventas_gastos                   IN OUT NUMBER,
                         pcostosventas_gastos             IN OUT NUMBER,
                         pgastosoperativos                IN OUT NUMBER,
                         potros_ingresos_gastos           IN OUT NUMBER,
                         ptotal_gastos_familiares         IN OUT NUMBER,
                         pexcedentefamiliar_gastos        IN OUT NUMBER,
                         pcuotasolicitada                 IN OUT NUMBER,
                         prelcuotasolicitada_excfam       IN OUT NUMBER,
                         pmonto_recomendacion             IN OUT NUMBER,
                         pmoneda_recomendacion            IN OUT VARCHAR2,
                         pplazo_recomendacion             IN OUT NUMBER,
                         ptasa_recomendacion              IN OUT NUMBER,
                         pfrecuencia_recomendacion        IN OUT VARCHAR2,
                         pcuota_recomendacion             IN OUT NUMBER,
                         pestadosolicitud_recomendacion   IN OUT NUMBER,
                         pcuotarecomendada_excfamiliar    IN OUT NUMBER,
                         pventasevalanterior              IN OUT NUMBER,
                         pactual_ventas                   IN OUT NUMBER,
                         pvariacionventas                 IN OUT NUMBER,
                         pcomentario1                     IN OUT VARCHAR2,
                         pcomentario2                     IN OUT VARCHAR2,
                         ppro1nombre                      IN OUT VARCHAR2,
                         ppro1materiaprima1               IN OUT NUMBER,
                         ppro1materiaprima2               IN OUT NUMBER,
                         ppro1materiaprima3               IN OUT NUMBER,
                         ppro1totalmp                     IN OUT NUMBER,
                         ppro1sueldo1                     IN OUT NUMBER,
                         ppro1sueldo2                     IN OUT NUMBER,
                         ppro1totalsueldo                 IN OUT NUMBER,
                         ppro1otroscostos                 IN OUT NUMBER,
                         ppro1totalcostos                 IN OUT NUMBER,
                         ppro1costounitario               IN OUT NUMBER,
                         ppro1preciounitario              IN OUT NUMBER,
                         ppro1unidadesvendidas            IN OUT NUMBER,
                         ppro1margenganancia              IN OUT NUMBER,
                         ppro2nombre                      IN OUT VARCHAR2,
                         ppro2materiaprima1               IN OUT NUMBER,
                         ppro2materiaprima2               IN OUT NUMBER,
                         ppro2materiaprima3               IN OUT NUMBER,
                         ppro2totalmp                     IN OUT NUMBER,
                         ppro2sueldo1                     IN OUT NUMBER,
                         ppro2sueldo2                     IN OUT NUMBER,
                         ppro2totalsueldo                 IN OUT NUMBER,
                         ppro2otroscostos                 IN OUT NUMBER,
                         ppro2totalcostos                 IN OUT NUMBER,
                         ppro2costounitario               IN OUT NUMBER,
                         ppro2preciounitario              IN OUT NUMBER,
                         ppro2unidadesvendidas            IN OUT NUMBER,
                         ppro2margenganancia              IN OUT NUMBER,
                         ppro3nombre                      IN OUT VARCHAR2,
                         ppro3materiaprima1               IN OUT NUMBER,
                         ppro3materiaprima2               IN OUT NUMBER,
                         ppro3materiaprima3               IN OUT NUMBER,
                         ppro3totalmp                     IN OUT NUMBER,
                         ppro3sueldo1                     IN OUT NUMBER,
                         ppro3sueldo2                     IN OUT NUMBER,
                         ppro3totalsueldo                 IN OUT NUMBER,
                         ppro3otroscostos                 IN OUT NUMBER,
                         ppro3totalcostos                 IN OUT NUMBER,
                         ppro3costounitario               IN OUT NUMBER,
                         ppro3preciounitario              IN OUT NUMBER,
                         ppro3unidadesvendidas            IN OUT NUMBER,
                         ppro3margenganancia              IN OUT NUMBER,
                         pprootromateriaprima1            IN OUT NUMBER,
                         pprootromateriaprima2            IN OUT NUMBER,
                         pprootromateriaprima3            IN OUT NUMBER,
                         pprootrototalmp                  IN OUT NUMBER,
                         pprootrosueldo1                  IN OUT NUMBER,
                         pprootrosueldo2                  IN OUT NUMBER,
                         pprootrototalsueldo              IN OUT NUMBER,
                         pprootrootroscostos              IN OUT NUMBER,
                         pprootrototalcostos              IN OUT NUMBER,
                         pprootrocostounitario            IN OUT NUMBER,
                         pprootropreciounitario           IN OUT NUMBER,
                         pprootrounidadesvendidas         IN OUT NUMBER,
                         pprootromargenganancia           IN OUT NUMBER,
                         plinea1                          IN OUT VARCHAR2,
                         ppreciounitario1                 IN OUT NUMBER,
                         pcostounitario1                  IN OUT NUMBER,
                         pmargendeganancia1               IN OUT NUMBER,
                         punidadesvendidas1               IN OUT NUMBER,
                         plinea2                          IN OUT VARCHAR2,
                         ppreciounitario2                 IN OUT NUMBER,
                         pcostounitario2                  IN OUT NUMBER,
                         pmargendeganancia2               IN OUT NUMBER,
                         punidadesvendidas2               IN OUT NUMBER,
                         plinea3                          IN OUT VARCHAR2,
                         ppreciounitario3                 IN OUT NUMBER,
                         pcostounitario3                  IN OUT NUMBER,
                         pmargendeganancia3               IN OUT NUMBER,
                         punidadesvendidas3               IN OUT NUMBER,
                         plineaot                         IN OUT VARCHAR2,
                         ppreciounitarioot                IN OUT NUMBER,
                         pcostounitarioot                 IN OUT NUMBER,
                         pmargendegananciaot              IN OUT NUMBER,
                         punidadesvendidasot              IN OUT NUMBER,
                         ptipocredito                     IN OUT VARCHAR2,
                         pgarantias                       IN OUT VARCHAR2,
                         pvalorgarantia                   IN OUT VARCHAR2,
                         pdescripciongarantia             IN OUT VARCHAR2,
                         pprestamodescontar               IN OUT VARCHAR2,
                         plinea4                          IN OUT VARCHAR2,
                         ppreciounitario4                 IN OUT NUMBER,
                         pcostounitario4                  IN OUT NUMBER,
                         pmargendeganancia4               IN OUT NUMBER,
                         punidadesvendidas4               IN OUT NUMBER,
                         plinea5                          IN OUT VARCHAR2,
                         ppreciounitario5                 IN OUT NUMBER,
                         pcostounitario5                  IN OUT NUMBER,
                         pmargendeganancia5               IN OUT NUMBER,
                         punidadesvendidas5               IN OUT NUMBER,
                         plinea6                          IN OUT VARCHAR2,
                         ppreciounitario6                 IN OUT NUMBER,
                         pcostounitario6                  IN OUT NUMBER,
                         pmargendeganancia6               IN OUT NUMBER,
                         punidadesvendidas6               IN OUT NUMBER,
                         plinea7                          IN OUT VARCHAR2,
                         ppreciounitario7                 IN OUT NUMBER,
                         pcostounitario7                  IN OUT NUMBER,
                         pmargendeganancia7               IN OUT NUMBER,
                         punidadesvendidas7               IN OUT NUMBER,
                         plinea8                          IN OUT VARCHAR2,
                         ppreciounitario8                 IN OUT NUMBER,
                         pcostounitario8                  IN OUT NUMBER,
                         pmargendeganancia8               IN OUT NUMBER,
                         punidadesvendidas8               IN OUT NUMBER,
                         pcomentario                      IN OUT VARCHAR2,
                         pidoficial                       IN OUT VARCHAR2,
                         pfecharegistro                   IN OUT DATE,
                         pfechafija                       IN OUT VARCHAR2,
                         pidestado                        IN OUT VARCHAR2,
                         pmensaje                         IN OUT VARCHAR2,
                         pnosubida                        IN OUT VARCHAR2,
                         pidgrupo                         IN OUT VARCHAR2,
                         pimpreso                         IN OUT VARCHAR2,
                         /*Valores a retornar para eliminar uso Funci¿n fnupdatefud que ejecuta via WS
                            proceso debe implementarse en el llamado de SQL/Server
                           */
                         pestadofec                       IN OUT VARCHAR2,
                         pmensajefec                      IN OUT VARCHAR2,
                         pnosolicitud                     IN OUT NUMBER)    --
    IS
        --- tmpvar                      NUMBER;
        vresult                     BOOLEAN;
        pmensajeerror               VARCHAR2 (4000);
        p_solicitud                 NUMBER (7);
        p_codcliente                VARCHAR2 (15);
        p_codempresa                NUMBER (5) := 1;
        p_codagencia                NUMBER (5);
        --
        reg1                        pr_carga_analisis_solic.t_rec_analisis_solic;
        --
        v_reg_credito               pr_credito.t_rec_pr_creditos;
        v_error                     VARCHAR2 (1000);
        v_mensaje_error             VARCHAR2 (600);
        v_no_credito                pr_creditos.no_credito%TYPE;
        v_frecuencia                VARCHAR2 (10);
        v_plazo                     pr_creditos.plazo%TYPE;
        v_tipopersona               tempfud.tipopersona%TYPE;
        --
        v_totalventasmensuales      NUMBER;
        v_totalcostoventas          NUMBER;
        v_utilidadbruta             NUMBER;
        v_tcon                      NUMBER;
        v_utilidad_neta             NUMBER;
        v_total_gastos_familiares   NUMBER;
        v_excedentefamiliar         NUMBER;
        v_total_activo_fijo         NUMBER;
        v_total_activo_corriente    NUMBER;
        v_total_activos             NUMBER;
        v_total_pasivo_corriente    NUMBER;
        v_total_pasivo              NUMBER;
        v_patrimonio                NUMBER;
        v_total_pasivo_patrimonio   NUMBER;
        v_activos_familiares        NUMBER;
        v_total_pasivo_familiar     NUMBER;
        v_patrimonio_familiar       NUMBER;
        v_utilidadneta_ventas       NUMBER;
        v_cxc_patrimonio            NUMBER;
        v_exd_familiar              NUMBER;
        v_excedente_familiar        NUMBER;
        --
        vcuotasegurocal             tempfud.cuotasegurocal%TYPE;
        vclientepertenece           tempfud.clientepertenece%TYPE;
        v_cuota_excedentefamiliar   NUMBER;
        --
        vmonedacal                  tempfud.monedacal%TYPE;
        vdestinocredito             tempfud.destinocredito%TYPE;
        vespecifiquedestino         tempfud.especifiquedestino%TYPE;
        vcuotasegurocallv           NUMBER (16, 2);                     --LMVR
        vestadocre                  VARCHAR2 (1);
        v_credito_anula             NUMBER (7);
        v_procesado                 VARCHAR2 (1) := NULL; --Excello:JPH:2020-03-27:REQ_ 108967
        -- PRAGMA AUTONOMOUS_TRANSACTION;

        vtipodocumentoidentidad     id_personas.cod_tipo_id%TYPE;
        vnumidformat                id_personas.num_id%TYPE;
    --vId_tempfec                 NUMBER;
    BEGIN
        ---p_depura ('Inicio pCrearFec ' || $$plsql_line);           --04-08-2022
        ---Return;

        pnomarchivo := REPLACE (pnomarchivo, 'FEC_');

        pidestado := NULL;            --malmanzar 18-07-2022 para evitar error

        ---antes limpieza
        --        p_depura ('pmedicinas               ' || pmedicinas);
        --        p_depura ('peducacion               ' || peducacion);
        --        p_depura ('pdeudasfamiliares        ' || pdeudasfamiliares);
        --        p_depura ('potros_gastos            ' || potros_gastos);
        --        p_depura ('pTotalgastos_familiares  ' || pTotalgastos_familiares);
        --        p_depura ('pExcedentefamiliar       ' || pExcedentefamiliar);
        --        p_depura ('potros                   ' || potros);
        --        p_depura (
        --            'pmaquinaria_mueblesequipos ' || pmaquinaria_mueblesequipos);
        --        p_depura ('pefectivo_cajabanco      ' || pefectivo_cajabanco);
        --        p_depura ('pcuentaxcobrar           ' || pcuentaxcobrar);
        --        p_depura ('pinventario_prod_tem     ' || pinventario_prod_tem);
        --        p_depura ('pinventario_prod_proc    ' || pinventario_prod_proc);
        --        p_depura ('pinventario_materiaprima ' || pinventario_materiaprima);
        --        p_depura ('pmercancia               ' || pmercancia);
        --        p_depura ('panticipo_proveedores    ' || panticipo_proveedores);
        --        p_depura ('plocalnegocio            ' || plocalnegocio);
        --        p_depura ('pobligacionesfinancieras ' || pobligacionesfinancieras);
        --        p_depura ('ptotal_pasivo_lp         ' || ptotal_pasivo_lp);
        --        p_depura ('pmueble_vehiculo         ' || pmueble_vehiculo);
        --        p_depura ('pdeudacomercial          ' || pdeudacomercial);
        --        p_depura ('ptasa                    ' || ptasa);
        --        p_depura ('pcuota                   ' || pcuota);
        --        p_depura ('pcuentapagarprovedor     ' || pcuentapagarprovedor);
        --        p_depura ('pcuentapagarvarias       ' || pcuentapagarvarias);
        --        p_depura ('pinmuebles               ' || pinmuebles);
        --        p_depura ('pTotal_activofamiliar    ' || pTotal_activofamiliar);
        --        p_depura ('pdeudabancaria           ' || pdeudabancaria);
        --        p_depura ('pTotal_pasivofamiliar    ' || pTotal_pasivofamiliar);
        --        p_depura ('pPATRIO_FAM_BALGEN       ' || pPATRIO_FAM_BALGEN);
        --        p_depura ('pTOTAL_ACTIVOCORRIENTE   ' || pTOTAL_ACTIVOCORRIENTE);
        --        p_depura ('pTOTAL_ACTIVOFIJO        ' || pTOTAL_ACTIVOFIJO);
        --        p_depura ('pTOTAL_ACTIVOS1          ' || pTOTAL_ACTIVOS1);
        --        p_depura ('pTOTAL_PASIVOCORRIENTES  ' || pTOTAL_PASIVOCORRIENTES);
        --        p_depura ('pTOTAL_PASIVO            ' || pTOTAL_PASIVO);
        --        p_depura ('pTOTAL_PASIVOPATRIMONIO  ' || pTOTAL_PASIVOPATRIMONIO);
        --        p_depura ('pPASIVO_PATRIMONIO       ' || pPASIVO_PATRIMONIO);
        --        p_depura ('pPATRIMONIO              ' || pPATRIMONIO);
        --        p_depura ('pACTIVOCORTE_PASCTE      ' || pACTIVOCORTE_PASCTE);
        --        p_depura ('pOTROSINGRESOS_EXCEDENTE ' || pOTROSINGRESOS_EXCEDENTE);
        --        p_depura (
        --            'pCUOTARECOMENDADA_EXCFAMILIAR ' || pCUOTARECOMENDADA_EXCFAMILIAR);
        --        p_depura ('pTOTALPASIVO_PATRIMONIO  ' || pTOTALPASIVO_PATRIMONIO);
        --        p_depura ('pUTILIDADNETA_PATRIMONIO ' || pUTILIDADNETA_PATRIMONIO);
        --        p_depura (
        --            'pUTILIDADNETA_TOTALACTIVOS1 ' || pUTILIDADNETA_TOTALACTIVOS1);
        --        p_depura ('pUTILIDADNETA_VENTAS     ' || pUTILIDADNETA_VENTAS);
        --        p_depura ('pCUENTASXCOBRAR_VENTAS   ' || pCUENTASXCOBRAR_VENTAS);
        --        p_depura ('pCOSTOVENTA_INVENTARIO   ' || pCOSTOVENTA_INVENTARIO);
        --        p_depura ('pGASTOSLEGALES           ' || pGASTOSLEGALES);
        --        p_depura ('pMONEDA                  ' || pMONEDA);
        --        p_depura ('pcapital_trabajo         ' || pcapital_trabajo);
        --        p_depura ('pfechabalancegeneral     ' || pfechabalancegeneral);
        --        p_depura ('pdesde                   ' || pdesde);
        --        p_depura ('phasta                   ' || phasta);
        --        p_depura ('ptotalcostooperacional   ' || ptotalcostooperacional);
        --        p_depura ('putilidadneta            ' || putilidadneta);
        --        p_depura ('pventasdiarias_promedio  ' || pventasdiarias_promedio);
        --        p_depura ('pdiastrabajados          ' || pdiastrabajados);
        --        p_depura (
        --            'pCOMPRASSEMANALESDECLARADAS ' || pCOMPRASSEMANALESDECLARADAS);
        --        p_depura (
        --            'pventasmensualesdeclaradas ' || pventasmensualesdeclaradas);
        --        p_depura ('pmargendeclarado         ' || pmargendeclarado);
        --        p_depura ('pmontomesalto            ' || pmontomesalto);
        --        p_depura ('pmontomesmedio           ' || pmontomesmedio);
        --        p_depura (
        --            'pcomprasmensualesdeclaradas ' || pcomprasmensualesdeclaradas);
        --        p_depura ('pmontomesbajo            ' || pmontomesbajo);
        --        p_depura ('pventasmensuales         ' || pventasmensuales);
        --        p_depura ('pcostoventamensual       ' || pcostoventamensual);
        --        p_depura ('pUtilidadbruta           ' || pUtilidadbruta);
        --        p_depura ('pmargenganancia          ' || pmargenganancia);
        --        p_depura ('pprimera_ref_vecinos     ' || pprimera_ref_vecinos);
        --        p_depura ('psegunda_ref_vecinos     ' || psegunda_ref_vecinos);
        --        p_depura ('pambientefamiliar        ' || pambientefamiliar);
        --        p_depura ('pdependientes            ' || pdependientes);
        --        p_depura ('pedad                    ' || pedad);
        --        p_depura ('pestadosaludfamilia      ' || pestadosaludfamilia);
        --        p_depura ('pingresos                ' || pingresos);
        --        p_depura ('potrosingresos           ' || potrosingresos);
        --        p_depura ('pexperiencia_neg         ' || pexperiencia_neg);
        --        p_depura ('phoras_neg               ' || phoras_neg);
        --        p_depura ('plocalpropio             ' || plocalpropio);
        --        p_depura ('ptiempoempleo            ' || ptiempoempleo);
        --        p_depura ('pubicacionnegocio        ' || pubicacionnegocio);
        --        p_depura ('pllevaregistro           ' || pllevaregistro);
        --        p_depura ('pmejorasnegocio          ' || pmejorasnegocio);
        --        p_depura ('pclientesfrecuentes      ' || pclientesfrecuentes);
        --        p_depura ('pnivelcompetencia        ' || pnivelcompetencia);
        --        p_depura ('pfecha_balancegeneral_al ' || pfecha_balancegeneral_al);
        --        --p_depura('-- := IA.PA_PKG_UTL.F_DEP'URA_CADENA(--);
        --        p_depura ('pDESTINOCREDITO          ' || pDESTINOCREDITO);
        --        p_depura ('pESPECIFIQUEDESTINO      ' || pESPECIFIQUEDESTINO);
        --        p_depura ('pESTADOSOLICITUD         ' || pESTADOSOLICITUD);
        --        p_depura ('pACTIVIDADECONOMICA      ' || pACTIVIDADECONOMICA);
        --        p_depura ('pACTIVIDADECONOMICADINRAP' || pACTIVIDADECONOMICADINRAP);
        --        p_depura ('pMARGENBRUTOESTANDAR     ' || pMARGENBRUTOESTANDAR);
        --        p_depura (
        --            'pGASTOSOPERACIONALESESTANDAR ' || pGASTOSOPERACIONALESESTANDAR);
        --        p_depura ('pALTO_INDICADORES        ' || pALTO_INDICADORES);
        --        p_depura ('pBAJO_INDICADORES        ' || pBAJO_INDICADORES);
        --        p_depura ('pLUNES                   ' || pLUNES);
        --        p_depura ('pMARTES                  ' || pMARTES);
        --        p_depura ('pMIERCOLES               ' || pMIERCOLES);
        --        p_depura ('pJUEVES                  ' || pJUEVES);
        --        p_depura ('pVIERNES                 ' || pVIERNES);
        --        p_depura ('pSABADO                  ' || pSABADO);
        --        p_depura ('pDOMINGO                 ' || pDOMINGO);
        --        p_depura ('pTOTAL_VENTASALTAS       ' || pTOTAL_VENTASALTAS);
        --        p_depura ('pTOTAL_VENTASBAJAS       ' || pTOTAL_VENTASBAJAS);
        --        p_depura ('pTOTAL_VENTASSEMANALES   ' || pTOTAL_VENTASSEMANALES);
        --        p_depura ('pTOTAL_VENTASMENSUALES   ' || pTOTAL_VENTASMENSUALES);
        --        p_depura ('pMARGENBRUTODECLARADO    ' || pMARGENBRUTODECLARADO);
        --        p_depura ('pALIMENTACION_GASTOS     ' || pALIMENTACION_GASTOS);
        --        p_depura ('pVIVIENDA_GASTOS         ' || pVIVIENDA_GASTOS);
        --        p_depura ('pEDUCACION_GASTOS        ' || pEDUCACION_GASTOS);
        --        p_depura ('pSALUD_GASTOS            ' || pSALUD_GASTOS);
        --        p_depura ('pTRANSPORTE_GASTOS       ' || pTRANSPORTE_GASTOS);
        --        p_depura ('pVESTIDO_GASTOS          ' || pVESTIDO_GASTOS);
        --        p_depura ('pPAGODEUDAS_GASTOS       ' || pPAGODEUDAS_GASTOS);
        --        p_depura ('pOTROS_GASTOS_FAMILIARES ' || pOTROS_GASTOS_FAMILIARES);
        --        p_depura ('pTOTAL_GASTOS            ' || pTOTAL_GASTOS);
        --        p_depura ('pVENTAS_GASTOS           ' || pVENTAS_GASTOS);
        --        p_depura ('pCOSTOSVENTAS_GASTOS     ' || pCOSTOSVENTAS_GASTOS);
        --        p_depura ('pGASTOSOPERATIVOS        ' || pGASTOSOPERATIVOS);
        --        p_depura ('pOTROS_INGRESOS_GASTOS   ' || pOTROS_INGRESOS_GASTOS);
        --        p_depura ('pTOTAL_GASTOS_FAMILIARES ' || pTOTAL_GASTOS_FAMILIARES);
        --        p_depura ('pEXCEDENTEFAMILIAR_GASTOS' || pEXCEDENTEFAMILIAR_GASTOS);
        --        p_depura ('pCUOTASOLICITADA         ' || pCUOTASOLICITADA);
        --        p_depura (
        --            'pRELCUOTASOLICITADA_EXCFAM ' || pRELCUOTASOLICITADA_EXCFAM);
        --        p_depura ('pMONTO_RECOMENDACION     ' || pMONTO_RECOMENDACION);
        --        p_depura ('pMONEDA_RECOMENDACION    ' || pMONEDA_RECOMENDACION);
        --        p_depura ('pPLAZO_RECOMENDACION     ' || pPLAZO_RECOMENDACION);
        --        p_depura ('pTASA_RECOMENDACION      ' || pTASA_RECOMENDACION);
        --        p_depura ('pFRECUENCIA_RECOMENDACION' || pFRECUENCIA_RECOMENDACION);
        --        p_depura ('pCUOTA_RECOMENDACION     ' || pCUOTA_RECOMENDACION);
        --        p_depura (
        --               'pESTADOSOLICITUD_RECOMENDACION '
        --            || pESTADOSOLICITUD_RECOMENDACION);
        --        p_depura (
        --               'pCUOTARECOMENDADA_EXCFAMI LIAR '
        --            || pCUOTARECOMENDADA_EXCFAMILIAR);
        --        p_depura ('pVENTASEVALANTERIOR      ' || pVENTASEVALANTERIOR);
        --        p_depura ('pACTUAL_VENTAS           ' || pACTUAL_VENTAS);
        --        p_depura ('pVARIACIONVENTAS         ' || pVARIACIONVENTAS);
        --        p_depura ('pCOMENTARIO1             ' || pCOMENTARIO1);
        --        p_depura ('pCOMENTARIO2             ' || pCOMENTARIO2);
        --        p_depura ('pPRO1NOMBRE              ' || pPRO1NOMBRE);
        --        p_depura ('pPRO1MATERIAPRIMA1       ' || pPRO1MATERIAPRIMA1);
        --        p_depura ('pPRO1MATERIAPRIMA2       ' || pPRO1MATERIAPRIMA2);
        --        p_depura ('pPRO1MATERIAPRIMA3       ' || pPRO1MATERIAPRIMA3);
        --        p_depura ('pPRO1TOTALMP             ' || pPRO1TOTALMP);
        --        p_depura ('pPRO1SUELDO1             ' || pPRO1SUELDO1);
        --        p_depura ('pPRO1SUELDO2             ' || pPRO1SUELDO2);
        --        p_depura ('pPRO1TOTALSUELDO         ' || pPRO1TOTALSUELDO);
        --        p_depura ('pPRO1OTROSCOSTOS         ' || pPRO1OTROSCOSTOS);
        --        p_depura ('pPRO1TOTALCOSTOS         ' || pPRO1TOTALCOSTOS);
        --        p_depura ('pPRO1COSTOUNITARIO       ' || pPRO1COSTOUNITARIO);
        --        p_depura ('pPRO1PRECIOUNITARIO      ' || pPRO1PRECIOUNITARIO);
        --        p_depura ('pPRO1UNIDADESVENDIDAS    ' || pPRO1UNIDADESVENDIDAS);
        --        p_depura ('pPRO1MARGENGANANCIA      ' || pPRO1MARGENGANANCIA);
        --        p_depura ('pPRO2NOMBRE              ' || pPRO2NOMBRE);
        --        p_depura ('pPRO2MATERIAPRIMA1       ' || pPRO2MATERIAPRIMA1);
        --        p_depura ('pPRO2MATERIAPRIMA2       ' || pPRO2MATERIAPRIMA2);
        --        p_depura ('pPRO2MATERIAPRIMA3       ' || pPRO2MATERIAPRIMA3);
        --        p_depura ('pPRO2TOTALMP             ' || pPRO2TOTALMP);
        --        p_depura ('pPRO2SUELDO1             ' || pPRO2SUELDO1);
        --        p_depura ('pPRO2SUELDO2             ' || pPRO2SUELDO2);
        --        p_depura ('pPRO2TOTALSUELDO         ' || pPRO2TOTALSUELDO);
        --        p_depura ('pPRO2OTROSCOSTOS         ' || pPRO2OTROSCOSTOS);
        --        p_depura ('pPRO2TOTALCOSTOS         ' || pPRO2TOTALCOSTOS);
        --        p_depura ('pPRO2COSTOUNITARIO       ' || pPRO2COSTOUNITARIO);
        --        p_depura ('pPRO2PRECIOUNITARIO      ' || pPRO2PRECIOUNITARIO);
        --        p_depura ('pPRO2UNIDADESVENDIDAS    ' || pPRO2UNIDADESVENDIDAS);
        --        p_depura ('pPRO2MARGENGANANCIA      ' || pPRO2MARGENGANANCIA);
        --        p_depura ('pPRO3NOMBRE              ' || pPRO3NOMBRE);
        --        p_depura ('pPRO3MATERIAPRIMA1       ' || pPRO3MATERIAPRIMA1);
        --        p_depura ('pPRO3MATERIAPRIMA2       ' || pPRO3MATERIAPRIMA2);
        --        p_depura ('pPRO3MATERIAPRIMA3       ' || pPRO3MATERIAPRIMA3);
        --        p_depura ('pPRO3TOTALMP             ' || pPRO3TOTALMP);
        --        p_depura ('pPRO3SUELDO1             ' || pPRO3SUELDO1);
        --        p_depura ('pPRO3SUELDO2             ' || pPRO3SUELDO2);
        --        p_depura ('pPRO3TOTALSUELDO         ' || pPRO3TOTALSUELDO);
        --        p_depura ('pPRO3OTROSCOSTOS         ' || pPRO3OTROSCOSTOS);
        --        p_depura ('pPRO3TOTALCOSTOS         ' || pPRO3TOTALCOSTOS);
        --        p_depura ('pIdTempFec               ' || pIdTempFec);
        --        p_depura ('pNomarchivo              ' || pNomarchivo);
        --        p_depura ('pIdevaluacioncrediticia  ' || pIdevaluacioncrediticia);
        --        p_depura ('pTipodocumentoidentidad  ' || pTipodocumentoidentidad);
        --        p_depura ('pDocumentoidentidad      ' || pDocumentoidentidad);
        --        p_depura ('pNombrecliente           ' || pNombrecliente);
        --        p_depura ('pNumerosolicitud         ' || pNumerosolicitud);
        --        p_depura ('pMontorecomendado        ' || pMontorecomendado);
        --        p_depura ('PFRECUENCIA              ' || pFrecuencia);
        --        p_depura ('pPlazo                   ' || pPlazo);
        --        p_depura ('Ppro1ventasmensuales     ' || Ppro1ventasmensuales);
        --        p_depura ('ppro2ventasmensuales     ' || ppro2ventasmensuales);
        --        p_depura ('ppro3ventasmensuales     ' || ppro3ventasmensuales);
        --        p_depura ('pprootroventasmensuales  ' || pprootroventasmensuales);
        --        p_depura ('pventasmensuales1        ' || pventasmensuales1);
        --        p_depura ('pventasmensuales2        ' || pventasmensuales2);
        --        p_depura ('pventasmensuales3        ' || pventasmensuales3);
        --        p_depura ('pventasmensuales4        ' || pventasmensuales4);
        --        p_depura ('pventasmensuales5        ' || pventasmensuales5);
        --        p_depura ('pventasmensuales6        ' || pventasmensuales6);
        --        p_depura ('pventasmensuales7        ' || pventasmensuales7);
        --        p_depura ('pventasmensuales8        ' || pventasmensuales8);
        --        p_depura ('pventasmensualesot       ' || pventasmensualesot);
        --        p_depura ('pVENTAS_INGRESOS         ' || pVENTAS_INGRESOS);
        --        p_depura (
        --            'ppro1costosventasmensuales ' || ppro1costosventasmensuales);
        --        p_depura (
        --            'ppro2costosventasmensuales ' || ppro2costosventasmensuales);
        --        p_depura (
        --            'ppro3costosventasmensuales ' || ppro3costosventasmensuales);
        --        p_depura (
        --            'pprootrocostosventasmensuales ' || pprootrocostosventasmensuales);
        --        p_depura ('pcostoventas1            ' || pcostoventas1);
        --        p_depura ('pcostoventas2            ' || pcostoventas2);
        --        p_depura ('pcostoventas3            ' || pcostoventas3);
        --        p_depura ('pcostoventas4            ' || pcostoventas4);
        --        p_depura ('pcostoventas5            ' || pcostoventas5);
        --        p_depura ('pcostoventas6            ' || pcostoventas6);
        --        p_depura ('pcostoventas7            ' || pcostoventas7);
        --        p_depura ('pcostoventas8            ' || pcostoventas8);
        --        p_depura ('pcostoventasot           ' || pcostoventasot);
        --        p_depura ('pCOSTOVENTAS             ' || pCOSTOVENTAS);
        --        p_depura ('psueldo                  ' || psueldo);
        --        p_depura ('pservicio                ' || pservicio);
        --        p_depura ('palquiler                ' || palquiler);
        --        p_depura ('ptransporte_combs        ' || ptransporte_combs);
        --        p_depura ('ppagointereses           ' || ppagointereses);
        --        p_depura (
        --            'potrosingresos_operacionales ' || potrosingresos_operacionales);
        --        p_depura ('palimentacion            ' || palimentacion);
        --        p_depura ('pvivienda                ' || pvivienda);
        --        p_depura ('pvestido                 ' || pvestido);
        --        p_depura ('ptransporte              ' || ptransporte);
        --        p_depura ('pservicios               ' || pservicios);
        --        p_depura ('pPRO3COSTOUNITARIO       ' || pPRO3COSTOUNITARIO);
        --        p_depura ('pPRO3PRECIOUNITARIO      ' || pPRO3PRECIOUNITARIO);
        --        p_depura ('pPRO3UNIDADESVENDIDAS    ' || pPRO3UNIDADESVENDIDAS);
        --        p_depura ('pPRO3MARGENGANANCIA      ' || pPRO3MARGENGANANCIA);
        --        p_depura ('pPROOTROMATERIAPRIMA1    ' || pPROOTROMATERIAPRIMA1);
        --        p_depura ('pPROOTROMATERIAPRIMA2    ' || pPROOTROMATERIAPRIMA2);
        --        p_depura ('pPROOTROMATERIAPRIMA3    ' || pPROOTROMATERIAPRIMA3);
        --        p_depura ('pPROOTROTOTALMP          ' || pPROOTROTOTALMP);
        --        p_depura ('pPROOTROSUELDO1          ' || pPROOTROSUELDO1);
        --        p_depura ('pPROOTROSUELDO2          ' || pPROOTROSUELDO2);
        --        p_depura ('pPROOTROTOTALSUELDO      ' || pPROOTROTOTALSUELDO);
        --        p_depura ('pPROOTROOTROSCOSTOS      ' || pPROOTROOTROSCOSTOS);
        --        p_depura ('pPROOTROTOTALCOSTOS      ' || pPROOTROTOTALCOSTOS);
        --        p_depura ('pPROOTROCOSTOUNITARIO    ' || pPROOTROCOSTOUNITARIO);
        --        p_depura ('pPROOTROPRECIOUNITARIO   ' || pPROOTROPRECIOUNITARIO);
        --        p_depura ('pPROOTROUNIDADESVENDIDAS ' || pPROOTROUNIDADESVENDIDAS);
        --        p_depura ('pPROOTROMARGENGANANCIA   ' || pPROOTROMARGENGANANCIA);
        --        p_depura ('pLINEA1                  ' || pLINEA1);
        --        p_depura ('pPRECIOUNITARIO1         ' || pPRECIOUNITARIO1);
        --        p_depura ('pCOSTOUNITARIO1          ' || pCOSTOUNITARIO1);
        --        p_depura ('pMARGENDEGANANCIA1       ' || pMARGENDEGANANCIA1);
        --        p_depura ('pUNIDADESVENDIDAS1       ' || pUNIDADESVENDIDAS1);
        --        p_depura ('pLINEA2                  ' || pLINEA2);
        --        p_depura ('pPRECIOUNITARIO2         ' || pPRECIOUNITARIO2);
        --        p_depura ('pCOSTOUNITARIO2          ' || pCOSTOUNITARIO2);
        --        p_depura ('pMARGENDEGANANCIA2       ' || pMARGENDEGANANCIA2);
        --        p_depura ('pUNIDADESVENDIDAS2       ' || pUNIDADESVENDIDAS2);
        --        p_depura ('pLINEA3                  ' || pLINEA3);
        --        p_depura ('pPRECIOUNITARIO3         ' || pPRECIOUNITARIO3);
        --        p_depura ('pCOSTOUNITARIO3          ' || pCOSTOUNITARIO3);
        --        p_depura ('pMARGENDEGANANCIA3       ' || pMARGENDEGANANCIA3);
        --        p_depura ('pUNIDADESVENDIDAS3       ' || pUNIDADESVENDIDAS3);
        --        p_depura ('pLINEAOT                 ' || pLINEAOT);
        --        p_depura ('pPRECIOUNITARIOOT        ' || pPRECIOUNITARIOOT);
        --        p_depura ('pCOSTOUNITARIOOT         ' || pCOSTOUNITARIOOT);
        --        p_depura ('pMARGENDEGANANCIAOT      ' || pMARGENDEGANANCIAOT);
        --        p_depura ('pUNIDADESVENDIDASOT      ' || pUNIDADESVENDIDASOT);
        --        p_depura ('pTIPOCREDITO             ' || pTIPOCREDITO);
        --        p_depura ('pGARANTIAS               ' || pGARANTIAS);
        --        p_depura ('pVALORGARANTIA           ' || pVALORGARANTIA);
        --        p_depura ('pDESCRIPCIONGARANTIA     ' || pDESCRIPCIONGARANTIA);
        --        p_depura ('pPRESTAMODESCONTAR       ' || pPRESTAMODESCONTAR);
        --        p_depura ('pLINEA4                  ' || pLINEA4);
        --        p_depura ('pPRECIOUNITARIO4         ' || pPRECIOUNITARIO4);
        --        p_depura ('pCOSTOUNITARIO4          ' || pCOSTOUNITARIO4);
        --        p_depura ('pMARGENDEGANANCIA4       ' || pMARGENDEGANANCIA4);
        --        p_depura ('pUNIDADESVENDIDAS4       ' || pUNIDADESVENDIDAS4);
        --        p_depura ('pLINEA5                  ' || pLINEA5);
        --        p_depura ('pPRECIOUNITARIO5         ' || pPRECIOUNITARIO5);
        --        p_depura ('pCOSTOUNITARIO5          ' || pCOSTOUNITARIO5);
        --        p_depura ('pMARGENDEGANANCIA5       ' || pMARGENDEGANANCIA5);
        --        p_depura ('pUNIDADESVENDIDAS5       ' || pUNIDADESVENDIDAS5);
        --        p_depura ('pLINEA6                  ' || pLINEA6);
        --        p_depura ('pPRECIOUNITARIO6         ' || pPRECIOUNITARIO6);
        --        p_depura ('pCOSTOUNITARIO6          ' || pCOSTOUNITARIO6);
        --        p_depura ('pMARGENDEGANANCIA6       ' || pMARGENDEGANANCIA6);
        --        p_depura ('pUNIDADESVENDIDAS6       ' || pUNIDADESVENDIDAS6);
        --        p_depura ('pLINEA7                  ' || pLINEA7);
        --        p_depura ('pPRECIOUNITARIO7         ' || pPRECIOUNITARIO7);
        --        p_depura ('pCOSTOUNITARIO7          ' || pCOSTOUNITARIO7);
        --        p_depura ('pMARGENDEGANANCIA7       ' || pMARGENDEGANANCIA7);
        --        p_depura ('pUNIDADESVENDIDAS7       ' || pUNIDADESVENDIDAS7);
        --        p_depura ('pLINEA8                  ' || pLINEA8);
        --        p_depura ('pPRECIOUNITARIO8         ' || pPRECIOUNITARIO8);
        --        p_depura ('pCOSTOUNITARIO8          ' || pCOSTOUNITARIO8);
        --        p_depura ('pMARGENDEGANANCIA8       ' || pMARGENDEGANANCIA8);
        --        p_depura ('pUNIDADESVENDIDAS8       ' || pUNIDADESVENDIDAS8);
        --        p_depura ('pCOMENTARIO              ' || pCOMENTARIO);
        --        p_depura ('pIDOFICIAL               ' || pIDOFICIAL);
        --        p_depura ('pFECHAREGISTRO           ' || pFECHAREGISTRO);
        --        p_depura ('pFECHAFIJA               ' || pFECHAFIJA);
        --        p_depura ('pIDESTADO                ' || pIDESTADO);
        --        p_depura ('pMENSAJE                 ' || pMENSAJE);
        --        p_depura ('pNOSUBIDA                ' || pNOSUBIDA);
        --        p_depura ('pIDGRUPO                 ' || pIDGRUPO);
        --        p_depura ('pIMPRESO                 ' || pIMPRESO);
        --        p_depura ('pEstadoFec               ' || pEstadoFec);
        --        p_depura ('pMensajeFec              ' || pMensajeFec);
        --        p_depura ('pNoSolicitud             ' || pNoSolicitud);

        ---eliminar caracteres especiales en los parametros recibidos
        --      pmedicinas               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmedicinas              );
        --peducacion               := IA.PA_PKG_UTL.F_DEPURA_CADENA(peducacion              );
        --pdeudasfamiliares        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pdeudasfamiliares       );
        --potros_gastos            := IA.PA_PKG_UTL.F_DEPURA_CADENA(potros_gastos           );
        --pTotalgastos_familiares  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTotalgastos_familiares );
        --pExcedentefamiliar       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pExcedentefamiliar      );
        --potros                   := IA.PA_PKG_UTL.F_DEPURA_CADENA(potros                  );
        --pmaquinaria_mueblesequipos := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmaquinaria_mueblesequipos);
        --pefectivo_cajabanco      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pefectivo_cajabanco     );
        --pcuentaxcobrar           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcuentaxcobrar          );
        --pinventario_prod_tem     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pinventario_prod_tem    );
        --pinventario_prod_proc    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pinventario_prod_proc   );
        --pinventario_materiaprima := IA.PA_PKG_UTL.F_DEPURA_CADENA(pinventario_materiaprima);
        --pmercancia               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmercancia              );
        --panticipo_proveedores    := IA.PA_PKG_UTL.F_DEPURA_CADENA(panticipo_proveedores   );
        --plocalnegocio            := IA.PA_PKG_UTL.F_DEPURA_CADENA(plocalnegocio           );
        --pobligacionesfinancieras := IA.PA_PKG_UTL.F_DEPURA_CADENA(pobligacionesfinancieras);
        --ptotal_pasivo_lp         := IA.PA_PKG_UTL.F_DEPURA_CADENA(ptotal_pasivo_lp        );
        --pmueble_vehiculo         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmueble_vehiculo        );
        --pdeudacomercial          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pdeudacomercial         );
        --ptasa                    := IA.PA_PKG_UTL.F_DEPURA_CADENA(ptasa                   );
        --pcuota                   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcuota                  );
        --pcuentapagarprovedor     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcuentapagarprovedor    );
        --pcuentapagarvarias       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcuentapagarvarias      );
        --pinmuebles               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pinmuebles              );
        --pTotal_activofamiliar    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTotal_activofamiliar   );
        --pdeudabancaria           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pdeudabancaria          );
        --pTotal_pasivofamiliar    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTotal_pasivofamiliar   );
        --pPATRIO_FAM_BALGEN       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPATRIO_FAM_BALGEN      );
        --pTOTAL_ACTIVOCORRIENTE   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_ACTIVOCORRIENTE  );
        --pTOTAL_ACTIVOFIJO        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_ACTIVOFIJO       );
        --pTOTAL_ACTIVOS1          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_ACTIVOS1         );
        --pTOTAL_PASIVOCORRIENTES  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_PASIVOCORRIENTES );
        --pTOTAL_PASIVO            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_PASIVO           );
        --pTOTAL_PASIVOPATRIMONIO  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_PASIVOPATRIMONIO );
        --pPASIVO_PATRIMONIO       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPASIVO_PATRIMONIO      );
        --pPATRIMONIO              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPATRIMONIO             );
        --pACTIVOCORTE_PASCTE      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pACTIVOCORTE_PASCTE     );
        --pOTROSINGRESOS_EXCEDENTE := IA.PA_PKG_UTL.F_DEPURA_CADENA(pOTROSINGRESOS_EXCEDENTE);
        --pCUOTARECOMENDADA_EXCFAMILIAR := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCUOTARECOMENDADA_EXCFAMILIAR);
        --pTOTALPASIVO_PATRIMONIO  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTALPASIVO_PATRIMONIO );
        --pUTILIDADNETA_PATRIMONIO := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUTILIDADNETA_PATRIMONIO);
        --pUTILIDADNETA_TOTALACTIVOS1 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUTILIDADNETA_TOTALACTIVOS1);
        --pUTILIDADNETA_VENTAS     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUTILIDADNETA_VENTAS    );
        --pCUENTASXCOBRAR_VENTAS   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCUENTASXCOBRAR_VENTAS  );
        --pCOSTOVENTA_INVENTARIO   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOVENTA_INVENTARIO  );
        --pGASTOSLEGALES           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pGASTOSLEGALES          );
        --pMONEDA                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMONEDA                 );
        --pcapital_trabajo         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcapital_trabajo        );
        --pfechabalancegeneral     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pfechabalancegeneral    );
        --pdesde                   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pdesde                  );
        --phasta                   := IA.PA_PKG_UTL.F_DEPURA_CADENA(phasta                  );
        --ptotalcostooperacional   := IA.PA_PKG_UTL.F_DEPURA_CADENA(ptotalcostooperacional  );
        --putilidadneta            := IA.PA_PKG_UTL.F_DEPURA_CADENA(putilidadneta           );
        --pventasdiarias_promedio  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasdiarias_promedio );
        --pdiastrabajados          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pdiastrabajados         );
        --pCOMPRASSEMANALESDECLARADAS := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOMPRASSEMANALESDECLARADAS);
        --pventasmensualesdeclaradas := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensualesdeclaradas);
        --pmargendeclarado         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmargendeclarado        );
        --pmontomesalto            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmontomesalto           );
        --pmontomesmedio           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmontomesmedio          );
        --pcomprasmensualesdeclaradas := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcomprasmensualesdeclaradas);
        --pmontomesbajo            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmontomesbajo           );
        --pventasmensuales         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales        );
        --pcostoventamensual       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventamensual      );
        --pUtilidadbruta           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUtilidadbruta          );
        --pmargenganancia          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmargenganancia         );
        --pprimera_ref_vecinos     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pprimera_ref_vecinos    );
        --psegunda_ref_vecinos     := IA.PA_PKG_UTL.F_DEPURA_CADENA(psegunda_ref_vecinos    );
        --pambientefamiliar        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pambientefamiliar       );
        --pdependientes            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pdependientes           );
        --pedad                    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pedad                   );
        --pestadosaludfamilia      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pestadosaludfamilia     );
        --pingresos                := IA.PA_PKG_UTL.F_DEPURA_CADENA(pingresos               );
        --potrosingresos           := IA.PA_PKG_UTL.F_DEPURA_CADENA(potrosingresos          );
        --pexperiencia_neg         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pexperiencia_neg        );
        --phoras_neg               := IA.PA_PKG_UTL.F_DEPURA_CADENA(phoras_neg              );
        --plocalpropio             := IA.PA_PKG_UTL.F_DEPURA_CADENA(plocalpropio            );
        --ptiempoempleo            := IA.PA_PKG_UTL.F_DEPURA_CADENA(ptiempoempleo           );
        --pubicacionnegocio        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pubicacionnegocio       );
        --pllevaregistro           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pllevaregistro          );
        --pmejorasnegocio          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pmejorasnegocio         );
        --pclientesfrecuentes      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pclientesfrecuentes     );
        --pnivelcompetencia        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pnivelcompetencia       );
        --pfecha_balancegeneral_al := IA.PA_PKG_UTL.F_DEPURA_CADENA(pfecha_balancegeneral_al);
        ---- := IA.PA_PKG_UTL.F_DEPURA_CADENA(--);
        --pDESTINOCREDITO          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pDESTINOCREDITO         );
        --pESPECIFIQUEDESTINO      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pESPECIFIQUEDESTINO     );
        --pESTADOSOLICITUD         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pESTADOSOLICITUD        );
        --pACTIVIDADECONOMICA      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pACTIVIDADECONOMICA     );
        --pACTIVIDADECONOMICADINRAP := IA.PA_PKG_UTL.F_DEPURA_CADENA(pACTIVIDADECONOMICADINRAP);
        --pMARGENBRUTOESTANDAR     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENBRUTOESTANDAR    );
        --pGASTOSOPERACIONALESESTANDAR := IA.PA_PKG_UTL.F_DEPURA_CADENA(pGASTOSOPERACIONALESESTANDAR);
        --pALTO_INDICADORES        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pALTO_INDICADORES       );
        --pBAJO_INDICADORES        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pBAJO_INDICADORES       );
        --pLUNES                   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLUNES                  );
        --pMARTES                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARTES                 );
        --pMIERCOLES               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMIERCOLES              );
        --pJUEVES                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pJUEVES                 );
        --pVIERNES                 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVIERNES                );
        --pSABADO                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pSABADO                 );
        --pDOMINGO                 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pDOMINGO                );
        --pTOTAL_VENTASALTAS       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_VENTASALTAS      );
        --pTOTAL_VENTASBAJAS       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_VENTASBAJAS      );
        --pTOTAL_VENTASSEMANALES   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_VENTASSEMANALES  );
        --pTOTAL_VENTASMENSUALES   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_VENTASMENSUALES  );
        --pMARGENBRUTODECLARADO    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENBRUTODECLARADO   );
        --pALIMENTACION_GASTOS     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pALIMENTACION_GASTOS    );
        --pVIVIENDA_GASTOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVIVIENDA_GASTOS        );
        --pEDUCACION_GASTOS        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pEDUCACION_GASTOS       );
        --pSALUD_GASTOS            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pSALUD_GASTOS           );
        --pTRANSPORTE_GASTOS       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTRANSPORTE_GASTOS      );
        --pVESTIDO_GASTOS          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVESTIDO_GASTOS         );
        --pPAGODEUDAS_GASTOS       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPAGODEUDAS_GASTOS      );
        --pOTROS_GASTOS_FAMILIARES := IA.PA_PKG_UTL.F_DEPURA_CADENA(pOTROS_GASTOS_FAMILIARES);
        --pTOTAL_GASTOS            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_GASTOS           );
        --pVENTAS_GASTOS           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVENTAS_GASTOS          );
        --pCOSTOSVENTAS_GASTOS     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOSVENTAS_GASTOS    );
        --pGASTOSOPERATIVOS        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pGASTOSOPERATIVOS       );
        --pOTROS_INGRESOS_GASTOS   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pOTROS_INGRESOS_GASTOS  );
        --pTOTAL_GASTOS_FAMILIARES := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTOTAL_GASTOS_FAMILIARES);
        --pEXCEDENTEFAMILIAR_GASTOS := IA.PA_PKG_UTL.F_DEPURA_CADENA(pEXCEDENTEFAMILIAR_GASTOS);
        --pCUOTASOLICITADA         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCUOTASOLICITADA        );
        --pRELCUOTASOLICITADA_EXCFAM := IA.PA_PKG_UTL.F_DEPURA_CADENA(pRELCUOTASOLICITADA_EXCFAM);
        --pMONTO_RECOMENDACION     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMONTO_RECOMENDACION    );
        --pMONEDA_RECOMENDACION    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMONEDA_RECOMENDACION   );
        --pPLAZO_RECOMENDACION     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPLAZO_RECOMENDACION    );
        --pTASA_RECOMENDACION      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTASA_RECOMENDACION     );
        --pFRECUENCIA_RECOMENDACION := IA.PA_PKG_UTL.F_DEPURA_CADENA(pFRECUENCIA_RECOMENDACION);
        --pCUOTA_RECOMENDACION     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCUOTA_RECOMENDACION    );
        --pESTADOSOLICITUD_RECOMENDACION := IA.PA_PKG_UTL.F_DEPURA_CADENA(pESTADOSOLICITUD_RECOMENDACION);
        --pCUOTARECOMENDADA_EXCFAMILIAR := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCUOTARECOMENDADA_EXCFAMILIAR);
        --pVENTASEVALANTERIOR      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVENTASEVALANTERIOR     );
        --pACTUAL_VENTAS           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pACTUAL_VENTAS          );
        --pVARIACIONVENTAS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVARIACIONVENTAS        );
        --pCOMENTARIO1             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOMENTARIO1            );
        --pCOMENTARIO2             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOMENTARIO2            );
        --pPRO1NOMBRE              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1NOMBRE             );
        --pPRO1MATERIAPRIMA1       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1MATERIAPRIMA1      );
        --pPRO1MATERIAPRIMA2       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1MATERIAPRIMA2      );
        --pPRO1MATERIAPRIMA3       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1MATERIAPRIMA3      );
        --pPRO1TOTALMP             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1TOTALMP            );
        --pPRO1SUELDO1             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1SUELDO1            );
        --pPRO1SUELDO2             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1SUELDO2            );
        --pPRO1TOTALSUELDO         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1TOTALSUELDO        );
        --pPRO1OTROSCOSTOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1OTROSCOSTOS        );
        --pPRO1TOTALCOSTOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1TOTALCOSTOS        );
        --pPRO1COSTOUNITARIO       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1COSTOUNITARIO      );
        --pPRO1PRECIOUNITARIO      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1PRECIOUNITARIO     );
        --pPRO1UNIDADESVENDIDAS    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1UNIDADESVENDIDAS   );
        --pPRO1MARGENGANANCIA      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO1MARGENGANANCIA     );
        --pPRO2NOMBRE              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2NOMBRE             );
        --pPRO2MATERIAPRIMA1       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2MATERIAPRIMA1      );
        --pPRO2MATERIAPRIMA2       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2MATERIAPRIMA2      );
        --pPRO2MATERIAPRIMA3       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2MATERIAPRIMA3      );
        --pPRO2TOTALMP             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2TOTALMP            );
        --pPRO2SUELDO1             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2SUELDO1            );
        --pPRO2SUELDO2             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2SUELDO2            );
        --pPRO2TOTALSUELDO         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2TOTALSUELDO        );
        --pPRO2OTROSCOSTOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2OTROSCOSTOS        );
        --pPRO2TOTALCOSTOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2TOTALCOSTOS        );
        --pPRO2COSTOUNITARIO       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2COSTOUNITARIO      );
        --pPRO2PRECIOUNITARIO      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2PRECIOUNITARIO     );
        --pPRO2UNIDADESVENDIDAS    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2UNIDADESVENDIDAS   );
        --pPRO2MARGENGANANCIA      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO2MARGENGANANCIA     );
        --pPRO3NOMBRE              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3NOMBRE             );
        --pPRO3MATERIAPRIMA1       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3MATERIAPRIMA1      );
        --pPRO3MATERIAPRIMA2       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3MATERIAPRIMA2      );
        --pPRO3MATERIAPRIMA3       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3MATERIAPRIMA3      );
        --pPRO3TOTALMP             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3TOTALMP            );
        --pPRO3SUELDO1             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3SUELDO1            );
        --pPRO3SUELDO2             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3SUELDO2            );
        --pPRO3TOTALSUELDO         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3TOTALSUELDO        );
        --pPRO3OTROSCOSTOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3OTROSCOSTOS        );
        --pPRO3TOTALCOSTOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3TOTALCOSTOS        );
        --pIdTempFec               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pIdTempFec              );
        --pNomarchivo              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pNomarchivo             );
        --pIdevaluacioncrediticia  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pIdevaluacioncrediticia );
        --pTipodocumentoidentidad  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTipodocumentoidentidad );
        --pDocumentoidentidad      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pDocumentoidentidad     );
        --pNombrecliente           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pNombrecliente          );
        --pNumerosolicitud         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pNumerosolicitud        );
        --pMontorecomendado        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMontorecomendado       );
        --pFrecuencia              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pFrecuencia             );
        --pPlazo                   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPlazo                  );
        --Ppro1ventasmensuales     := IA.PA_PKG_UTL.F_DEPURA_CADENA(Ppro1ventasmensuales    );
        --ppro2ventasmensuales     := IA.PA_PKG_UTL.F_DEPURA_CADENA(ppro2ventasmensuales    );
        --ppro3ventasmensuales     := IA.PA_PKG_UTL.F_DEPURA_CADENA(ppro3ventasmensuales    );
        --pprootroventasmensuales  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pprootroventasmensuales );
        --pventasmensuales1        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales1       );
        --pventasmensuales2        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales2       );
        --pventasmensuales3        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales3       );
        --pventasmensuales4        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales4       );
        --pventasmensuales5        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales5       );
        --pventasmensuales6        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales6       );
        --pventasmensuales7        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales7       );
        --pventasmensuales8        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensuales8       );
        --pventasmensualesot       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pventasmensualesot      );
        --pVENTAS_INGRESOS         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVENTAS_INGRESOS        );
        --ppro1costosventasmensuales := IA.PA_PKG_UTL.F_DEPURA_CADENA(ppro1costosventasmensuales);
        --ppro2costosventasmensuales := IA.PA_PKG_UTL.F_DEPURA_CADENA(ppro2costosventasmensuales);
        --ppro3costosventasmensuales := IA.PA_PKG_UTL.F_DEPURA_CADENA(ppro3costosventasmensuales);
        --pprootrocostosventasmensuales := IA.PA_PKG_UTL.F_DEPURA_CADENA(pprootrocostosventasmensuales);
        --pcostoventas1            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas1           );
        --pcostoventas2            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas2           );
        --pcostoventas3            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas3           );
        --pcostoventas4            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas4           );
        --pcostoventas5            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas5           );
        --pcostoventas6            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas6           );
        --pcostoventas7            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas7           );
        --pcostoventas8            := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventas8           );
        --pcostoventasot           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pcostoventasot          );
        --pCOSTOVENTAS             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOVENTAS            );
        --psueldo                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(psueldo                 );
        --pservicio                := IA.PA_PKG_UTL.F_DEPURA_CADENA(pservicio               );
        --palquiler                := IA.PA_PKG_UTL.F_DEPURA_CADENA(palquiler               );
        --ptransporte_combs        := IA.PA_PKG_UTL.F_DEPURA_CADENA(ptransporte_combs       );
        --ppagointereses           := IA.PA_PKG_UTL.F_DEPURA_CADENA(ppagointereses          );
        --potrosingresos_operacionales := IA.PA_PKG_UTL.F_DEPURA_CADENA(potrosingresos_operacionales);
        --palimentacion            := IA.PA_PKG_UTL.F_DEPURA_CADENA(palimentacion           );
        --pvivienda                := IA.PA_PKG_UTL.F_DEPURA_CADENA(pvivienda               );
        --pvestido                 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pvestido                );
        --ptransporte              := IA.PA_PKG_UTL.F_DEPURA_CADENA(ptransporte             );
        --pservicios               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pservicios              );
        --pPRO3COSTOUNITARIO       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3COSTOUNITARIO      );
        --pPRO3PRECIOUNITARIO      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3PRECIOUNITARIO     );
        --pPRO3UNIDADESVENDIDAS    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3UNIDADESVENDIDAS   );
        --pPRO3MARGENGANANCIA      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRO3MARGENGANANCIA     );
        --pPROOTROMATERIAPRIMA1    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROMATERIAPRIMA1   );
        --pPROOTROMATERIAPRIMA2    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROMATERIAPRIMA2   );
        --pPROOTROMATERIAPRIMA3    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROMATERIAPRIMA3   );
        --pPROOTROTOTALMP          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROTOTALMP         );
        --pPROOTROSUELDO1          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROSUELDO1         );
        --pPROOTROSUELDO2          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROSUELDO2         );
        --pPROOTROTOTALSUELDO      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROTOTALSUELDO     );
        --pPROOTROOTROSCOSTOS      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROOTROSCOSTOS     );
        --pPROOTROTOTALCOSTOS      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROTOTALCOSTOS     );
        --pPROOTROCOSTOUNITARIO    := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROCOSTOUNITARIO   );
        --pPROOTROPRECIOUNITARIO   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROPRECIOUNITARIO  );
        --pPROOTROUNIDADESVENDIDAS := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROUNIDADESVENDIDAS);
        --pPROOTROMARGENGANANCIA   := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPROOTROMARGENGANANCIA  );
        --pLINEA1                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA1                 );
        --pPRECIOUNITARIO1         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO1        );
        --pCOSTOUNITARIO1          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO1         );
        --pMARGENDEGANANCIA1       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA1      );
        --pUNIDADESVENDIDAS1       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS1      );
        --pLINEA2                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA2                 );
        --pPRECIOUNITARIO2         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO2        );
        --pCOSTOUNITARIO2          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO2         );
        --pMARGENDEGANANCIA2       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA2      );
        --pUNIDADESVENDIDAS2       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS2      );
        --pLINEA3                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA3                 );
        --pPRECIOUNITARIO3         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO3        );
        --pCOSTOUNITARIO3          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO3         );
        --pMARGENDEGANANCIA3       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA3      );
        --pUNIDADESVENDIDAS3       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS3      );
        --pLINEAOT                 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEAOT                );
        --pPRECIOUNITARIOOT        := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIOOT       );
        --pCOSTOUNITARIOOT         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIOOT        );
        --pMARGENDEGANANCIAOT      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIAOT     );
        --pUNIDADESVENDIDASOT      := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDASOT     );
        --pTIPOCREDITO             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pTIPOCREDITO            );
        --pGARANTIAS               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pGARANTIAS              );
        --pVALORGARANTIA           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pVALORGARANTIA          );
        --pDESCRIPCIONGARANTIA     := IA.PA_PKG_UTL.F_DEPURA_CADENA(pDESCRIPCIONGARANTIA    );
        --pPRESTAMODESCONTAR       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRESTAMODESCONTAR      );
        --pLINEA4                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA4                 );
        --pPRECIOUNITARIO4         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO4        );
        --pCOSTOUNITARIO4          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO4         );
        --pMARGENDEGANANCIA4       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA4      );
        --pUNIDADESVENDIDAS4       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS4      );
        --pLINEA5                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA5                 );
        --pPRECIOUNITARIO5         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO5        );
        --pCOSTOUNITARIO5          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO5         );
        --pMARGENDEGANANCIA5       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA5      );
        --pUNIDADESVENDIDAS5       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS5      );
        --pLINEA6                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA6                 );
        --pPRECIOUNITARIO6         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO6        );
        --pCOSTOUNITARIO6          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO6         );
        --pMARGENDEGANANCIA6       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA6      );
        --pUNIDADESVENDIDAS6       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS6      );
        --pLINEA7                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA7                 );
        --pPRECIOUNITARIO7         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO7        );
        --pCOSTOUNITARIO7          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO7         );
        --pMARGENDEGANANCIA7       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA7      );
        --pUNIDADESVENDIDAS7       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS7      );
        --pLINEA8                  := IA.PA_PKG_UTL.F_DEPURA_CADENA(pLINEA8                 );
        --pPRECIOUNITARIO8         := IA.PA_PKG_UTL.F_DEPURA_CADENA(pPRECIOUNITARIO8        );
        --pCOSTOUNITARIO8          := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOSTOUNITARIO8         );
        --pMARGENDEGANANCIA8       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMARGENDEGANANCIA8      );
        --pUNIDADESVENDIDAS8       := IA.PA_PKG_UTL.F_DEPURA_CADENA(pUNIDADESVENDIDAS8      );
        --pCOMENTARIO              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pCOMENTARIO             );
        --pIDOFICIAL               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pIDOFICIAL              );
        --pFECHAREGISTRO           := IA.PA_PKG_UTL.F_DEPURA_CADENA(pFECHAREGISTRO          );
        --pFECHAFIJA               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pFECHAFIJA              );
        --pIDESTADO                := IA.PA_PKG_UTL.F_DEPURA_CADENA(pIDESTADO               );
        --pMENSAJE                 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMENSAJE                );
        --pNOSUBIDA                := IA.PA_PKG_UTL.F_DEPURA_CADENA(pNOSUBIDA               );
        --pIDGRUPO                 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pIDGRUPO                );
        --pIMPRESO                 := IA.PA_PKG_UTL.F_DEPURA_CADENA(pIMPRESO                );
        --pEstadoFec               := IA.PA_PKG_UTL.F_DEPURA_CADENA(pEstadoFec              );
        --pMensajeFec              := IA.PA_PKG_UTL.F_DEPURA_CADENA(pMensajeFec             );
        --pNoSolicitud             := IA.PA_PKG_UTL.F_DEPURA_CADENA(pNoSolicitud            );

        ----Despues limpieza
        --p_depura('pmedicinas               '||pmedicinas              );
        --p_depura('peducacion               '||peducacion              );
        --p_depura('pdeudasfamiliares        '||pdeudasfamiliares       );
        --p_depura('potros_gastos            '||potros_gastos           );
        --p_depura('pTotalgastos_familiares  '||pTotalgastos_familiares );
        --p_depura('pExcedentefamiliar       '||pExcedentefamiliar      );
        --p_depura('potros                   '  ||potros                  );
        --p_depura('pmaquinaria_mueblesequipos ' ||pmaquinaria_mueblesequipos);
        --p_depura('pefectivo_cajabanco      '   ||pefectivo_cajabanco     );
        --p_depura('pcuentaxcobrar           '||pcuentaxcobrar          );
        --p_depura('pinventario_prod_tem     '||pinventario_prod_tem    );
        --p_depura('pinventario_prod_proc    '||pinventario_prod_proc   );
        --p_depura('pinventario_materiaprima '||pinventario_materiaprima);
        --p_depura('pmercancia               '||pmercancia              );
        --p_depura('panticipo_proveedores    '||panticipo_proveedores   );
        --p_depura('plocalnegocio            '||plocalnegocio           );
        --p_depura('pobligacionesfinancieras '||pobligacionesfinancieras);
        --p_depura('ptotal_pasivo_lp         '||ptotal_pasivo_lp        );
        --p_depura('pmueble_vehiculo         '||pmueble_vehiculo        );
        --p_depura('pdeudacomercial          '||pdeudacomercial         );
        --p_depura('ptasa                    '||ptasa                   );
        --p_depura('pcuota                   '||pcuota                  );
        --p_depura('pcuentapagarprovedor     '||pcuentapagarprovedor    );
        --p_depura('pcuentapagarvarias       '||pcuentapagarvarias      );
        --p_depura('pinmuebles               '||pinmuebles              );
        --p_depura('pTotal_activofamiliar    '||pTotal_activofamiliar   );
        --p_depura('pdeudabancaria           '||pdeudabancaria          );
        --p_depura('pTotal_pasivofamiliar    '||pTotal_pasivofamiliar   );
        --p_depura('pPATRIO_FAM_BALGEN       '||pPATRIO_FAM_BALGEN      );
        --p_depura('pTOTAL_ACTIVOCORRIENTE   '||pTOTAL_ACTIVOCORRIENTE  );
        --p_depura('pTOTAL_ACTIVOFIJO        '||pTOTAL_ACTIVOFIJO       );
        --p_depura('pTOTAL_ACTIVOS1          '||pTOTAL_ACTIVOS1         );
        --p_depura('pTOTAL_PASIVOCORRIENTES  '||pTOTAL_PASIVOCORRIENTES );
        --p_depura('pTOTAL_PASIVO            '||pTOTAL_PASIVO           );
        --p_depura('pTOTAL_PASIVOPATRIMONIO  '||pTOTAL_PASIVOPATRIMONIO );
        --p_depura('pPASIVO_PATRIMONIO       '||pPASIVO_PATRIMONIO      );
        --p_depura('pPATRIMONIO              '||pPATRIMONIO             );
        --p_depura('pACTIVOCORTE_PASCTE      '||pACTIVOCORTE_PASCTE     );
        --p_depura('pOTROSINGRESOS_EXCEDENTE '||pOTROSINGRESOS_EXCEDENTE);
        --p_depura('pCUOTARECOMENDADA_EXCFAMILIAR ' ||pCUOTARECOMENDADA_EXCFAMILIAR);
        --p_depura('pTOTALPASIVO_PATRIMONIO  '||pTOTALPASIVO_PATRIMONIO );
        --p_depura('pUTILIDADNETA_PATRIMONIO '||pUTILIDADNETA_PATRIMONIO);
        --p_depura('pUTILIDADNETA_TOTALACTIVOS1 ' ||pUTILIDADNETA_TOTALACTIVOS1);
        --p_depura('pUTILIDADNETA_VENTAS     '||pUTILIDADNETA_VENTAS    );
        --p_depura('pCUENTASXCOBRAR_VENTAS   '||pCUENTASXCOBRAR_VENTAS  );
        --p_depura('pCOSTOVENTA_INVENTARIO   '||pCOSTOVENTA_INVENTARIO  );
        --p_depura('pGASTOSLEGALES           '||pGASTOSLEGALES          );
        --p_depura('pMONEDA                  '||pMONEDA                 );
        --p_depura('pcapital_trabajo         '||pcapital_trabajo        );
        --p_depura('pfechabalancegeneral     '||pfechabalancegeneral    );
        --p_depura('pdesde                   '||pdesde                  );
        --p_depura('phasta                   '||phasta                  );
        --p_depura('ptotalcostooperacional   '||ptotalcostooperacional  );
        --p_depura('putilidadneta            '||putilidadneta           );
        --p_depura('pventasdiarias_promedio  '||pventasdiarias_promedio );
        --p_depura('pdiastrabajados          '||pdiastrabajados         );
        --p_depura('pCOMPRASSEMANALESDECLARADAS ' ||pCOMPRASSEMANALESDECLARADAS);
        --p_depura('pventasmensualesdeclaradas ' ||pventasmensualesdeclaradas);
        --p_depura('pmargendeclarado         '||pmargendeclarado        );
        --p_depura('pmontomesalto            '||pmontomesalto           );
        --p_depura('pmontomesmedio           '||pmontomesmedio          );
        --p_depura('pcomprasmensualesdeclaradas ' ||pcomprasmensualesdeclaradas);
        --p_depura('pmontomesbajo            '||pmontomesbajo           );
        --p_depura('pventasmensuales         '||pventasmensuales        );
        --p_depura('pcostoventamensual       '||pcostoventamensual      );
        --p_depura('pUtilidadbruta           '||pUtilidadbruta          );
        --p_depura('pmargenganancia          '||pmargenganancia         );
        --p_depura('pprimera_ref_vecinos     '||pprimera_ref_vecinos    );
        --p_depura('psegunda_ref_vecinos     '||psegunda_ref_vecinos    );
        --p_depura('pambientefamiliar        '||pambientefamiliar       );
        --p_depura('pdependientes            '||pdependientes           );
        --p_depura('pedad                    '||pedad                   );
        --p_depura('pestadosaludfamilia      '||pestadosaludfamilia     );
        --p_depura('pingresos                '||pingresos               );
        --p_depura('potrosingresos           '||potrosingresos          );
        --p_depura('pexperiencia_neg         '||pexperiencia_neg        );
        --p_depura('phoras_neg               '||phoras_neg              );
        --p_depura('plocalpropio             '||plocalpropio            );
        --p_depura('ptiempoempleo            '||ptiempoempleo           );
        --p_depura('pubicacionnegocio        '||pubicacionnegocio       );
        --p_depura('pllevaregistro           '||pllevaregistro          );
        --p_depura('pmejorasnegocio          '||pmejorasnegocio         );
        --p_depura('pclientesfrecuentes      '||pclientesfrecuentes     );
        --p_depura('pnivelcompetencia        '||pnivelcompetencia       );
        --p_depura('pfecha_balancegeneral_al '||pfecha_balancegeneral_al);
        ----p_depura('-- := IA.PA_PKG_UTL.F_DEP'URA_CADENA(--);
        --p_depura('pDESTINOCREDITO          '||pDESTINOCREDITO         );
        --p_depura('pESPECIFIQUEDESTINO      '||pESPECIFIQUEDESTINO     );
        --p_depura('pESTADOSOLICITUD         '||pESTADOSOLICITUD        );
        --p_depura('pACTIVIDADECONOMICA      '||pACTIVIDADECONOMICA     );
        --p_depura('pACTIVIDADECONOMICADINRAP' ||pACTIVIDADECONOMICADINRAP);
        --p_depura('pMARGENBRUTOESTANDAR     '||pMARGENBRUTOESTANDAR    );
        --p_depura('pGASTOSOPERACIONALESESTANDAR ' ||pGASTOSOPERACIONALESESTANDAR);
        --p_depura('pALTO_INDICADORES        '||pALTO_INDICADORES       );
        --p_depura('pBAJO_INDICADORES        '||pBAJO_INDICADORES       );
        --p_depura('pLUNES                   '||pLUNES                  );
        --p_depura('pMARTES                  '||pMARTES                 );
        --p_depura('pMIERCOLES               '||pMIERCOLES              );
        --p_depura('pJUEVES                  '||pJUEVES                 );
        --p_depura('pVIERNES                 '||pVIERNES                );
        --p_depura('pSABADO                  '||pSABADO                 );
        --p_depura('pDOMINGO                 '||pDOMINGO                );
        --p_depura('pTOTAL_VENTASALTAS       '||pTOTAL_VENTASALTAS      );
        --p_depura('pTOTAL_VENTASBAJAS       '||pTOTAL_VENTASBAJAS      );
        --p_depura('pTOTAL_VENTASSEMANALES   '||pTOTAL_VENTASSEMANALES  );
        --p_depura('pTOTAL_VENTASMENSUALES   '||pTOTAL_VENTASMENSUALES  );
        --p_depura('pMARGENBRUTODECLARADO    '||pMARGENBRUTODECLARADO   );
        --p_depura('pALIMENTACION_GASTOS     '||pALIMENTACION_GASTOS    );
        --p_depura('pVIVIENDA_GASTOS         '||pVIVIENDA_GASTOS        );
        --p_depura('pEDUCACION_GASTOS        '||pEDUCACION_GASTOS       );
        --p_depura('pSALUD_GASTOS            '||pSALUD_GASTOS           );
        --p_depura('pTRANSPORTE_GASTOS       '||pTRANSPORTE_GASTOS      );
        --p_depura('pVESTIDO_GASTOS          '||pVESTIDO_GASTOS         );
        --p_depura('pPAGODEUDAS_GASTOS       '||pPAGODEUDAS_GASTOS      );
        --p_depura('pOTROS_GASTOS_FAMILIARES '||pOTROS_GASTOS_FAMILIARES);
        --p_depura('pTOTAL_GASTOS            '||pTOTAL_GASTOS           );
        --p_depura('pVENTAS_GASTOS           '||pVENTAS_GASTOS          );
        --p_depura('pCOSTOSVENTAS_GASTOS     '||pCOSTOSVENTAS_GASTOS    );
        --p_depura('pGASTOSOPERATIVOS        '||pGASTOSOPERATIVOS       );
        --p_depura('pOTROS_INGRESOS_GASTOS   '||pOTROS_INGRESOS_GASTOS  );
        --p_depura('pTOTAL_GASTOS_FAMILIARES '||pTOTAL_GASTOS_FAMILIARES);
        --p_depura('pEXCEDENTEFAMILIAR_GASTOS' ||pEXCEDENTEFAMILIAR_GASTOS);
        --p_depura('pCUOTASOLICITADA         '||pCUOTASOLICITADA        );
        --p_depura('pRELCUOTASOLICITADA_EXCFAM ' ||pRELCUOTASOLICITADA_EXCFAM);
        --p_depura('pMONTO_RECOMENDACION     '||pMONTO_RECOMENDACION    );
        --p_depura('pMONEDA_RECOMENDACION    '||pMONEDA_RECOMENDACION   );
        --p_depura('pPLAZO_RECOMENDACION     '||pPLAZO_RECOMENDACION    );
        --p_depura('pTASA_RECOMENDACION      '||pTASA_RECOMENDACION     );
        --p_depura('pFRECUENCIA_RECOMENDACION' ||pFRECUENCIA_RECOMENDACION);
        --p_depura('pCUOTA_RECOMENDACION     '||pCUOTA_RECOMENDACION    );
        --p_depura('pESTADOSOLICITUD_RECOMENDACION ' ||pESTADOSOLICITUD_RECOMENDACION);
        --p_depura('pCUOTARECOMENDADA_EXCFAMILIAR ' ||pCUOTARECOMENDADA_EXCFAMILIAR);
        --p_depura('pVENTASEVALANTERIOR      '||pVENTASEVALANTERIOR     );
        --p_depura('pACTUAL_VENTAS           '||pACTUAL_VENTAS          );
        --p_depura('pVARIACIONVENTAS         '||pVARIACIONVENTAS        );
        --p_depura('pCOMENTARIO1             '||pCOMENTARIO1            );
        --p_depura('pCOMENTARIO2             '||pCOMENTARIO2            );
        --p_depura('pPRO1NOMBRE              '||pPRO1NOMBRE             );
        --p_depura('pPRO1MATERIAPRIMA1       '||pPRO1MATERIAPRIMA1      );
        --p_depura('pPRO1MATERIAPRIMA2       '||pPRO1MATERIAPRIMA2      );
        --p_depura('pPRO1MATERIAPRIMA3       '||pPRO1MATERIAPRIMA3      );
        --p_depura('pPRO1TOTALMP             '||pPRO1TOTALMP            );
        --p_depura('pPRO1SUELDO1             '||pPRO1SUELDO1            );
        --p_depura('pPRO1SUELDO2             '||pPRO1SUELDO2            );
        --p_depura('pPRO1TOTALSUELDO         '||pPRO1TOTALSUELDO        );
        --p_depura('pPRO1OTROSCOSTOS         '||pPRO1OTROSCOSTOS        );
        --p_depura('pPRO1TOTALCOSTOS         '||pPRO1TOTALCOSTOS        );
        --p_depura('pPRO1COSTOUNITARIO       '||pPRO1COSTOUNITARIO      );
        --p_depura('pPRO1PRECIOUNITARIO      '||pPRO1PRECIOUNITARIO     );
        --p_depura('pPRO1UNIDADESVENDIDAS    '||pPRO1UNIDADESVENDIDAS   );
        --p_depura('pPRO1MARGENGANANCIA      '||pPRO1MARGENGANANCIA     );
        --p_depura('pPRO2NOMBRE              '||pPRO2NOMBRE             );
        --p_depura('pPRO2MATERIAPRIMA1       '||pPRO2MATERIAPRIMA1      );
        --p_depura('pPRO2MATERIAPRIMA2       '||pPRO2MATERIAPRIMA2      );
        --p_depura('pPRO2MATERIAPRIMA3       '||pPRO2MATERIAPRIMA3      );
        --p_depura('pPRO2TOTALMP             '||pPRO2TOTALMP            );
        --p_depura('pPRO2SUELDO1             '||pPRO2SUELDO1            );
        --p_depura('pPRO2SUELDO2             '||pPRO2SUELDO2            );
        --p_depura('pPRO2TOTALSUELDO         '||pPRO2TOTALSUELDO        );
        --p_depura('pPRO2OTROSCOSTOS         '||pPRO2OTROSCOSTOS        );
        --p_depura('pPRO2TOTALCOSTOS         '||pPRO2TOTALCOSTOS        );
        --p_depura('pPRO2COSTOUNITARIO       '||pPRO2COSTOUNITARIO      );
        --p_depura('pPRO2PRECIOUNITARIO      '||pPRO2PRECIOUNITARIO     );
        --p_depura('pPRO2UNIDADESVENDIDAS    '||pPRO2UNIDADESVENDIDAS   );
        --p_depura('pPRO2MARGENGANANCIA      '||pPRO2MARGENGANANCIA     );
        --p_depura('pPRO3NOMBRE              '||pPRO3NOMBRE             );
        --p_depura('pPRO3MATERIAPRIMA1       '||pPRO3MATERIAPRIMA1      );
        --p_depura('pPRO3MATERIAPRIMA2       '||pPRO3MATERIAPRIMA2      );
        --p_depura('pPRO3MATERIAPRIMA3       '||pPRO3MATERIAPRIMA3      );
        --p_depura('pPRO3TOTALMP             '||pPRO3TOTALMP            );
        --p_depura('pPRO3SUELDO1             '||pPRO3SUELDO1            );
        --p_depura('pPRO3SUELDO2             '||pPRO3SUELDO2            );
        --p_depura('pPRO3TOTALSUELDO         '||pPRO3TOTALSUELDO        );
        --p_depura('pPRO3OTROSCOSTOS         '||pPRO3OTROSCOSTOS        );
        --p_depura('pPRO3TOTALCOSTOS         '||pPRO3TOTALCOSTOS        );
        --p_depura('pIdTempFec               '||pIdTempFec              );
        --p_depura('pNomarchivo              '||pNomarchivo             );
        --p_depura('pIdevaluacioncrediticia  '||pIdevaluacioncrediticia );
        --p_depura('pTipodocumentoidentidad  '||pTipodocumentoidentidad );
        --p_depura('pDocumentoidentidad      '||pDocumentoidentidad     );
        --p_depura('pNombrecliente           '||pNombrecliente          );
        --p_depura('pNumerosolicitud         '||pNumerosolicitud        );
        --p_depura('pMontorecomendado        '||pMontorecomendado       );
        --p_depura('pFrecuencia              '||pFrecuencia             );
        --p_depura('pPlazo                   '||pPlazo                  );
        --p_depura('Ppro1ventasmensuales     '||Ppro1ventasmensuales    );
        --p_depura('ppro2ventasmensuales     '||ppro2ventasmensuales    );
        --p_depura('ppro3ventasmensuales     '||ppro3ventasmensuales    );
        --p_depura('pprootroventasmensuales  '||pprootroventasmensuales );
        --p_depura('pventasmensuales1        '||pventasmensuales1       );
        --p_depura('pventasmensuales2        '||pventasmensuales2       );
        --p_depura('pventasmensuales3        '||pventasmensuales3       );
        --p_depura('pventasmensuales4        '||pventasmensuales4       );
        --p_depura('pventasmensuales5        '||pventasmensuales5       );
        --p_depura('pventasmensuales6        '||pventasmensuales6       );
        --p_depura('pventasmensuales7        '||pventasmensuales7       );
        --p_depura('pventasmensuales8        '||pventasmensuales8       );
        --p_depura('pventasmensualesot       '||pventasmensualesot      );
        --p_depura('pVENTAS_INGRESOS         '||pVENTAS_INGRESOS        );
        --p_depura('ppro1costosventasmensuales ' ||ppro1costosventasmensuales);
        --p_depura('ppro2costosventasmensuales ' ||ppro2costosventasmensuales);
        --p_depura('ppro3costosventasmensuales ' ||ppro3costosventasmensuales);
        --p_depura('pprootrocostosventasmensuales ' ||pprootrocostosventasmensuales);
        --p_depura('pcostoventas1            '||pcostoventas1           );
        --p_depura('pcostoventas2            '||pcostoventas2           );
        --p_depura('pcostoventas3            '||pcostoventas3           );
        --p_depura('pcostoventas4            '||pcostoventas4           );
        --p_depura('pcostoventas5            '||pcostoventas5           );
        --p_depura('pcostoventas6            '||pcostoventas6           );
        --p_depura('pcostoventas7            '||pcostoventas7           );
        --p_depura('pcostoventas8            '||pcostoventas8           );
        --p_depura('pcostoventasot           '||pcostoventasot          );
        --p_depura('pCOSTOVENTAS             '||pCOSTOVENTAS            );
        --p_depura('psueldo                  '||psueldo                 );
        --p_depura('pservicio                '||pservicio               );
        --p_depura('palquiler                '||palquiler               );
        --p_depura('ptransporte_combs        '||ptransporte_combs       );
        --p_depura('ppagointereses           '||ppagointereses          );
        --p_depura('potrosingresos_operacionales ' ||potrosingresos_operacionales);
        --p_depura('palimentacion            '||palimentacion           );
        --p_depura('pvivienda                '||pvivienda               );
        --p_depura('pvestido                 '||pvestido                );
        --p_depura('ptransporte              '||ptransporte             );
        --p_depura('pservicios               '||pservicios              );
        --p_depura('pPRO3COSTOUNITARIO       '||pPRO3COSTOUNITARIO      );
        --p_depura('pPRO3PRECIOUNITARIO      '||pPRO3PRECIOUNITARIO     );
        --p_depura('pPRO3UNIDADESVENDIDAS    '||pPRO3UNIDADESVENDIDAS   );
        --p_depura('pPRO3MARGENGANANCIA      '||pPRO3MARGENGANANCIA     );
        --p_depura('pPROOTROMATERIAPRIMA1    '||pPROOTROMATERIAPRIMA1   );
        --p_depura('pPROOTROMATERIAPRIMA2    '||pPROOTROMATERIAPRIMA2   );
        --p_depura('pPROOTROMATERIAPRIMA3    '||pPROOTROMATERIAPRIMA3   );
        --p_depura('pPROOTROTOTALMP          '||pPROOTROTOTALMP         );
        --p_depura('pPROOTROSUELDO1          '||pPROOTROSUELDO1         );
        --p_depura('pPROOTROSUELDO2          '||pPROOTROSUELDO2         );
        --p_depura('pPROOTROTOTALSUELDO      '||pPROOTROTOTALSUELDO     );
        --p_depura('pPROOTROOTROSCOSTOS      '||pPROOTROOTROSCOSTOS     );
        --p_depura('pPROOTROTOTALCOSTOS      '||pPROOTROTOTALCOSTOS     );
        --p_depura('pPROOTROCOSTOUNITARIO    '||pPROOTROCOSTOUNITARIO   );
        --p_depura('pPROOTROPRECIOUNITARIO   '||pPROOTROPRECIOUNITARIO  );
        --p_depura('pPROOTROUNIDADESVENDIDAS '||pPROOTROUNIDADESVENDIDAS);
        --p_depura('pPROOTROMARGENGANANCIA   '||pPROOTROMARGENGANANCIA  );
        --p_depura('pLINEA1                  '||pLINEA1                 );
        --p_depura('pPRECIOUNITARIO1         '||pPRECIOUNITARIO1        );
        --p_depura('pCOSTOUNITARIO1          '||pCOSTOUNITARIO1         );
        --p_depura('pMARGENDEGANANCIA1       '||pMARGENDEGANANCIA1      );
        --p_depura('pUNIDADESVENDIDAS1       '||pUNIDADESVENDIDAS1      );
        --p_depura('pLINEA2                  '||pLINEA2                 );
        --p_depura('pPRECIOUNITARIO2         '||pPRECIOUNITARIO2        );
        --p_depura('pCOSTOUNITARIO2          '||pCOSTOUNITARIO2         );
        --p_depura('pMARGENDEGANANCIA2       '||pMARGENDEGANANCIA2      );
        --p_depura('pUNIDADESVENDIDAS2       '||pUNIDADESVENDIDAS2      );
        --p_depura('pLINEA3                  '||pLINEA3                 );
        --p_depura('pPRECIOUNITARIO3         '||pPRECIOUNITARIO3        );
        --p_depura('pCOSTOUNITARIO3          '||pCOSTOUNITARIO3         );
        --p_depura('pMARGENDEGANANCIA3       '||pMARGENDEGANANCIA3      );
        --p_depura('pUNIDADESVENDIDAS3       '||pUNIDADESVENDIDAS3      );
        --p_depura('pLINEAOT                 '||pLINEAOT                );
        --p_depura('pPRECIOUNITARIOOT        '||pPRECIOUNITARIOOT       );
        --p_depura('pCOSTOUNITARIOOT         '||pCOSTOUNITARIOOT        );
        --p_depura('pMARGENDEGANANCIAOT      '||pMARGENDEGANANCIAOT     );
        --p_depura('pUNIDADESVENDIDASOT      '||pUNIDADESVENDIDASOT     );
        --p_depura('pTIPOCREDITO             '||pTIPOCREDITO            );
        --p_depura('pGARANTIAS               '||pGARANTIAS              );
        --p_depura('pVALORGARANTIA           '||pVALORGARANTIA          );
        --p_depura('pDESCRIPCIONGARANTIA     '||pDESCRIPCIONGARANTIA    );
        --p_depura('pPRESTAMODESCONTAR       '||pPRESTAMODESCONTAR      );
        --p_depura('pLINEA4                  '||pLINEA4                 );
        --p_depura('pPRECIOUNITARIO4         '||pPRECIOUNITARIO4        );
        --p_depura('pCOSTOUNITARIO4          '||pCOSTOUNITARIO4         );
        --p_depura('pMARGENDEGANANCIA4       '||pMARGENDEGANANCIA4      );
        --p_depura('pUNIDADESVENDIDAS4       '||pUNIDADESVENDIDAS4      );
        --p_depura('pLINEA5                  '||pLINEA5                 );
        --p_depura('pPRECIOUNITARIO5         '||pPRECIOUNITARIO5        );
        --p_depura('pCOSTOUNITARIO5          '||pCOSTOUNITARIO5         );
        --p_depura('pMARGENDEGANANCIA5       '||pMARGENDEGANANCIA5      );
        --p_depura('pUNIDADESVENDIDAS5       '||pUNIDADESVENDIDAS5      );
        --p_depura('pLINEA6                  '||pLINEA6                 );
        --p_depura('pPRECIOUNITARIO6         '||pPRECIOUNITARIO6        );
        --p_depura('pCOSTOUNITARIO6          '||pCOSTOUNITARIO6         );
        --p_depura('pMARGENDEGANANCIA6       '||pMARGENDEGANANCIA6      );
        --p_depura('pUNIDADESVENDIDAS6       '||pUNIDADESVENDIDAS6      );
        --p_depura('pLINEA7                  '||pLINEA7                 );
        --p_depura('pPRECIOUNITARIO7         '||pPRECIOUNITARIO7        );
        --p_depura('pCOSTOUNITARIO7          '||pCOSTOUNITARIO7         );
        --p_depura('pMARGENDEGANANCIA7       '||pMARGENDEGANANCIA7      );
        --p_depura('pUNIDADESVENDIDAS7       '||pUNIDADESVENDIDAS7      );
        --p_depura('pLINEA8                  '||pLINEA8                 );
        --p_depura('pPRECIOUNITARIO8         '||pPRECIOUNITARIO8        );
        --p_depura('pCOSTOUNITARIO8          '||pCOSTOUNITARIO8         );
        --p_depura('pMARGENDEGANANCIA8       '||pMARGENDEGANANCIA8      );
        --p_depura('pUNIDADESVENDIDAS8       '||pUNIDADESVENDIDAS8      );
        --p_depura('pCOMENTARIO              '||pCOMENTARIO             );
        --p_depura('pIDOFICIAL               '||pIDOFICIAL              );
        --p_depura('pFECHAREGISTRO           '||pFECHAREGISTRO          );
        --p_depura('pFECHAFIJA               '||pFECHAFIJA              );
        --p_depura('pIDESTADO                '||pIDESTADO               );
        --p_depura('pMENSAJE                 '||pMENSAJE                );
        --p_depura('pNOSUBIDA                '||pNOSUBIDA               );
        --p_depura('pIDGRUPO                 '||pIDGRUPO                );
        --p_depura('pIMPRESO                 '||pIMPRESO                );
        --p_depura('pEstadoFec               '||pEstadoFec              );
        --p_depura('pMensajeFec              '||pMensajeFec             );
        --p_depura('pNoSolicitud             '||pNoSolicitud            );
        ----


        ---malmanzar 04-05-2023

        vtipodocumentoidentidad := NULL;                          --04-08-2022

        vtipodocumentoidentidad :=
            f_tipoid_pda_core (ptipo_id_pda => ptipodocumentoidentidad); --malmanzar 09-06-2022

        vnumidformat :=
            pa.formatear_identifi (pdocumentoidentidad,
                                   vtipodocumentoidentidad -- ptipodocumentoidentidad  03-03-2023
                                                          );

        BEGIN                                                       --Bloque 1
            SELECT cod_persona
              INTO p_codcliente
              FROM id_personas b
             WHERE     b.num_id = vnumidformat
                   AND b.cod_tipo_id = vtipodocumentoidentidad;
        --                       pa.formatear_identifi (
        --                           pDocumentoidentidad,
        --                           DECODE (pTipodocumentoidentidad,
        --                                   'C', '1',
        --                                   'R', '2',
        --                                   'P', '4'))
        --                   AND b.cod_tipo_id =
        --                       DECODE (pTipodocumentoidentidad,
        --                               'C', '1',
        --                               'R', '2',
        --                               'P', '4');
        -- EXCEPTION
        --            WHEN OTHERS
        --            THEN
        --                BEGIN
        --                    SELECT cod_persona
        --                      INTO p_codcliente
        --                      FROM id_personas b
        --                     WHERE     b.num_id =
        --                               pa.formatear_identifi (
        --                                   pDocumentoidentidad,
        --                                   DECODE (pTipodocumentoidentidad,
        --                                           'C', '1',
        --                                           'R', '2',
        --                                           'P', '6'))
        --                           AND b.cod_tipo_id =
        --                               DECODE (pTipodocumentoidentidad,
        --                                       'C', '1',
        --                                       'R', '2',
        --                                       'P', '6');
        EXCEPTION
            WHEN OTHERS
            THEN
                ROLLBACK;
                pmensajeerror :=
                       'Revisar campos tipodocumentoidentidad y documentoidentidad: '
                    || ptipodocumentoidentidad
                    || ' pDocumentoidentidad: '
                    || pdocumentoidentidad
                    || '...';

                /*malmanzar 04-03-2022
                En caso de error en vez de realizar de actualizar  via WebService
                se realiza rollback se devuelve mensaje de error.
                */
                --pIdtempFud                   := 0;
                pestadofec := 'R';
                pmensajefec := pmensajeerror;
                pnosolicitud := 0;
                RETURN;
        --:new.idestado := 'R';
        ---vId_tempfec := 999;
        --:new.mensaje := 'Rechazado';
        /*IF ia.api_portacredit.fnupdatefud (0,   --malmanzar 04-03-2022
                                           pIdTempFec,
                                           'R',
                                           pmensajeerror,
                                           0)
        THEN
            raise_application_error (num   => -20000,
                                     msg   => pmensajeerror);
        END IF;*/
        --   END;
        END;                                                    --End Bloque 1

        --Begin Bloque 2
        BEGIN
            SELECT TO_NUMBER (idagencia),
                   b.nocredito,                      --to_number(b.nocredito),
                   UPPER (b.tipopersona),
                   --cuotasegurocal,--to_number(replace(cuotasegurocal,'.',',')),
                   monedacal,
                   destinocredito,
                   especifiquedestino,
                   clientepertenece
              INTO p_codagencia,
                   v_no_credito,
                   v_tipopersona,
                   --vcuotasegurocal,
                   vmonedacal,
                   vdestinocredito,
                   vespecifiquedestino,
                   vclientepertenece
              FROM tempfud b
             WHERE nomarchivo = pnomarchivo;
        --- 31-10-2022-WHERE nomarchivo = SUBSTR(pNomarchivo,5,LENGTH(pNomarchivo)); --malmanzar 15-07-2022
        EXCEPTION
            WHEN OTHERS
            THEN
                ROLLBACK;
                pmensajeerror :=
                       'Revisar campo nomarchivo '
                    || pnomarchivo
                    || ', se esta realizando la busqueda del registro en Tempfud sqlerrm '
                    || SQLERRM;
                p_depura (
                       'pmensajeerror '
                    || pmensajeerror
                    || ' Linea '
                    || $$plsql_line);

                /*malmanzar 04-03-2022
                En caso de error en vez de realizar de actualizar  via WebService
                se realiza rollback se devuelve mensaje de error.
                */
                --pIdtempFud                   := 0;
                pestadofec := 'R';
                pmensajefec := pmensajeerror;
                pnosolicitud := 0;
                RETURN;
        --:new.idestado := 'R';

        --:new.mensaje := 'Rechazado';
        --                IF ia.api_portacredit.fnupdatefud (0,
        --                                                   pIdTempFec,
        --                                                   'R',
        --                                                   pmensajeerror,
        --                                                   0)
        --                THEN
        --                    raise_application_error (num   => -20000,
        --                                             msg   => pmensajeerror);
        --                END IF;
        END;

        --End Bloque 2

        ---        p_depura ('Linea ' || $$plsql_line);

        --Begin Bloque 3
        IF v_no_credito IS NULL
        THEN
            IF vclientepertenece IS NOT NULL
            THEN
                SELECT MAX (TO_NUMBER (b.nocredito))
                  INTO v_no_credito
                  FROM tempfud b
                 WHERE numdocumentoidentidad = vclientepertenece;
            --AND idestado = 'A';
            --                       AND idestado = 'E';              --MALMANZAR 12-08-2022 , malmanzar 28-03-2023
            END IF;

            IF v_no_credito IS NULL AND vclientepertenece IS NOT NULL
            THEN
                ROLLBACK;
                pmensajeerror :=
                       'Revisar campo cliente pertenece, para validar el no_credito creado asociado a este fiador, cliente pertenece: '
                    || vclientepertenece;

                /*malmanzar 04-03-2022
                     En caso de error en vez de realizar de actualizar  via WebService
                     se realiza rollback se devuelve mensaje de error.
                     */
                --pIdtempFud                   := 0;
                pestadofec := 'R';
                pmensajefec := pmensajeerror;
                pnosolicitud := 0;
                RETURN;
            --:new.idestado := 'R';
            --- p_depura ('Linea ' || $$plsql_line);
            --:new.mensaje := 'Rechazado';
            --                IF ia.api_portacredit.fnupdatefud (0,
            --                                                   pIdTempFec,
            --                                                   'R',
            --                                                   pmensajeerror,
            --                                                   0)
            --                THEN
            --                    raise_application_error (num   => -20000,
            --                                             msg   => pmensajeerror);
            --                END IF;
            ELSIF v_no_credito IS NULL AND vclientepertenece IS NULL
            THEN
                ROLLBACK;

                p_depura ('Linea ' || $$plsql_line);
                pmensajeerror := 'Revisar el error presentado en FUD.';

                /*malmanzar 04-03-2022
                        En caso de error en vez de realizar de actualizar  via WebService
                        se realiza rollback se devuelve mensaje de error.
                        */
                -- pIdtempFud                   := 0;
                pestadofec := 'R';
                pmensajefec := pmensajeerror;
                pnosolicitud := 0;
                RETURN;
            --:new.idestado := 'R';

            --                --:new.mensaje := 'Rechazado';
            --                IF ia.api_portacredit.fnupdatefud (0,
            --                                                   pIdTempFec,
            --                                                   'R',
            --                                                   pmensajeerror,
            --                                                   0)
            --                THEN
            --                    raise_application_error (num   => -20000,
            --                                             msg   => pmensajeerror);
            --                END IF;
            END IF;
        END IF;

        --  p_depura ('Linea ' || $$plsql_line);

        --
        SELECT cuota
          INTO vcuotasegurocallv
          FROM pr_creditos
         WHERE no_credito = v_no_credito;

        --p_depura ('tempfec p_codcliente ' || v_no_credito || ' ' || :new.nomarchivo || ' ' || :new.frecuencia);
        v_reg_credito.codigo_cliente := p_codcliente;
        v_reg_credito.monto_credito := pmontorecomendado;


        --
        --p_depura ('tempfec v_tipopersona ' || v_tipopersona);
        IF v_tipopersona = 'CLIENTE'
        THEN
            SELECT DECODE (pfrecuencia,
                           1, 'SM',                                --  Semanal
                           2, 'BS',                              --  Bisemanal
                           3, 'TS',                             --  Trisemanal
                           4, 'VO',                          --  CuatriSemanal
                           5, 'ME',                                --  Mensual
                           6, 'BI',                              --  Bimestral
                           7, 'TR',                             --  Trimestral
                           8, 'CU',                          --  Cuatrimestral
                           9, 'SE',                              --  Semestral
                           10, 'AN')
              INTO v_frecuencia
              FROM DUAL;

            --            p_depura ('Linea ' || $$plsql_line);                            --

            --p_depura ('tempfec v_frecuencia ' || v_frecuencia);
            --
            --p_depura('pmensajeerror '||pmensajeerror||' linea '||$$plsql_line);
            BEGIN
                SELECT dias_periodo * pplazo
                  INTO v_plazo
                  FROM pr_periodicidad pp
                 WHERE pp.codigo_periodo =
                       DECODE (pfrecuencia,
                               1, 'SM',                            --  Semanal
                               2, 'BS',                          --  Bisemanal
                               3, 'TS',                         --  Trisemanal
                               4, 'VO',                      --  CuatriSemanal
                               5, 'ME',                            --  Mensual
                               6, 'BI',                          --  Bimestral
                               7, 'TR',                         --  Trimestral
                               8, 'CU',                      --  Cuatrimestral
                               9, 'SE',                          --  Semestral
                               10, 'AN');
            EXCEPTION
                WHEN OTHERS
                THEN
                    ROLLBACK;
                    v_plazo := 0;
                    pmensajeerror :=
                           'Revisar el campo Frecuenciacal >>>'
                        || pfrecuencia
                        || '<<< Linea '
                        || $$plsql_line
                        || ' sqlerr '
                        || SQLERRM;

                    /*malmanzar 04-03-2022
                        En caso de error en vez de realizar de actualizar  via WebService
                        se realiza rollback se devuelve mensaje de error.
                        */
                    -- pIdtempFud                   := 0;
                    pestadofec := 'R';
                    pmensajefec := pmensajeerror;
                    pnosolicitud := 0;
                    p_depura (
                           'Linea '
                        || $$plsql_line
                        || ' Antes Return '
                        || pmensajeerror);
                    RETURN;
            --:new.idestado := 'R';

            --:new.mensaje := 'Rechazado';
            --                    IF ia.api_portacredit.fnupdatefud (0,
            --                                                       pIdTempFec,
            --                                                       'R',
            --                                                       'Frecuenciacal',
            --                                                       0)
            --                    THEN
            --                        DBMS_OUTPUT.put_line (
            --                            'p_mensajeerror= Frecuenciacal');
            --                        raise_application_error (num   => -20000,
            --                                                 msg   => pmensajeerror);
            --                    END IF;
            END;
        --

        END IF;

        --p_depura ('tempfec v_plazo ' || v_plazo);
        --p_depura ('tempfec registra valores');
        BEGIN
            --Calculos de Totales
            v_totalventasmensuales :=
                  NVL (ppro1ventasmensuales, 0)
                + NVL (ppro2ventasmensuales, 0)
                + NVL (ppro3ventasmensuales, 0)
                + NVL (pprootroventasmensuales, 0)
                + NVL (pventasmensuales1, 0)
                + NVL (pventasmensuales2, 0)
                + NVL (pventasmensuales3, 0)
                + NVL (pventasmensuales4, 0)
                + NVL (pventasmensuales5, 0)
                + NVL (pventasmensuales6, 0)
                + NVL (pventasmensuales7, 0)
                + NVL (pventasmensuales8, 0)
                + NVL (pventasmensualesot, 0)
                + (CASE
                       WHEN vclientepertenece IS NULL THEN 0
                       ELSE NVL (pventas_ingresos, 0)
                   END);
            v_totalcostoventas :=
                  NVL (ppro1costosventasmensuales, 0)
                + NVL (ppro2costosventasmensuales, 0)
                + NVL (ppro3costosventasmensuales, 0)
                + NVL (pprootrocostosventasmensuales, 0)
                + NVL (pcostoventas1, 0)
                + NVL (pcostoventas2, 0)
                + NVL (pcostoventas3, 0)
                + NVL (pcostoventas4, 0)
                + NVL (pcostoventas5, 0)
                + NVL (pcostoventas6, 0)
                + NVL (pcostoventas7, 0)
                + NVL (pcostoventas8, 0)
                + NVL (pcostoventasot, 0)
                + (CASE
                       WHEN vclientepertenece IS NULL THEN 0
                       ELSE NVL (pcostoventas, 0)
                   END);
            v_utilidadbruta := v_totalventasmensuales - v_totalcostoventas;
            v_tcon :=
                  NVL (psueldo, 0)
                + NVL (pservicio, 0)
                + NVL (palquiler, 0)
                + NVL (ptransporte_combs, 0)
                + NVL (ppagointereses, 0)
                + NVL (potrosingresos_operacionales, 0);
            v_utilidad_neta := v_utilidadbruta - v_tcon;
            v_total_gastos_familiares :=
                  NVL (palimentacion, 0)                                    --
                + NVL (pvivienda, 0)                                        --
                + NVL (pvestido, 0)                                         --
                + NVL (ptransporte, 0)                                      --
                + NVL (pservicios, 0)                                       --
                + NVL (pmedicinas, 0)
                + NVL (peducacion, 0)                                       --
                + NVL (pdeudasfamiliares, 0)                                --
                + NVL (potros_gastos, 0);                                   --
            v_exd_familiar :=
                  (v_utilidad_neta + NVL (potros, 0))
                - v_total_gastos_familiares;
            v_excedentefamiliar := v_exd_familiar;
            -- Calculos Balance General
            v_total_activo_fijo :=
                NVL (pmaquinaria_mueblesequipos, 0) + NVL (plocalnegocio, 0);
            v_total_activo_corriente :=
                  NVL (pefectivo_cajabanco, 0)
                + NVL (pcuentaxcobrar, 0)
                + NVL (pinventario_prod_tem, 0)
                + NVL (pinventario_prod_proc, 0)
                + NVL (pinventario_materiaprima, 0)
                + NVL (pmercancia, 0)
                + NVL (panticipo_proveedores, 0);
            v_total_activos := v_total_activo_corriente + v_total_activo_fijo;
            v_total_pasivo_corriente :=
                  NVL (pobligacionesfinancieras, 0)
                + NVL (pcuentapagarprovedor, 0)
                + NVL (pcuentapagarvarias, 0);
            v_total_pasivo :=
                v_total_pasivo_corriente + NVL (ptotal_pasivo_lp, 0);
            v_patrimonio := v_total_activos - v_total_pasivo;
            v_total_pasivo_patrimonio := v_patrimonio + v_total_pasivo;
            v_activos_familiares :=
                NVL (pmueble_vehiculo, 0) + NVL (pinmuebles, 0);
            v_total_pasivo_familiar :=
                NVL (pdeudacomercial, 0) + NVL (pdeudabancaria, 0);
            v_patrimonio_familiar :=
                v_activos_familiares - v_total_pasivo_familiar;

            ----p_depura('cuota tempfec:'||vcuotasegurocal);

            p_depura ('excedente familiar tempfec:' || v_excedentefamiliar);
            p_depura (
                ' round(nvl(vcuotasegurocallv, 0): ' || vcuotasegurocallv);

            -- Calculo de indicadores
            IF v_excedentefamiliar <> 0
            THEN
                v_cuota_excedentefamiliar :=
                    ROUND (NVL (vcuotasegurocallv, 0) / v_excedentefamiliar,
                           2);
            ELSE
                v_cuota_excedentefamiliar := 0;
            END IF;

            p_depura ('Linea ' || $$plsql_line);

            --to_number(replace(vcuotasegurocal,'.',','))
            /*v_total_pasivo_corriente :=
             nvl(:New.obligacionesfinancieras, 0)

                                        + nvl(:New.cuentapagarprovedor, 0)

                                        + nvl(:New.cuentapagarvarias, 0);

            v_total_pasivo :=
             v_total_pasivo_corriente +
                              nvl(:New.total_pasivo_lp, 0);

            v_patrimonio := v_total_activos - v_total_pasivo;

            v_total_pasivo_patrimonio := v_patrimonio + v_total_pasivo;*/
            IF NVL (pventas_ingresos, 0) <> 0
            THEN
                v_utilidadneta_ventas :=
                    v_utilidad_neta / NVL (pventas_ingresos, 0);
                v_cxc_patrimonio :=
                    NVL (pcuentaxcobrar, 0) / NVL (pventas_ingresos, 0);
            ELSE
                v_utilidadneta_ventas := 0;
                v_cxc_patrimonio := 0;
            END IF;
        EXCEPTION
            WHEN OTHERS
            THEN
                --p_depura ('error ' || sqlerrm);
                NULL;
        END;

        --

        --:New.total_activofijo := v_Total_Activo_Fijo;

        --:New.total_activocorriente := v_Total_Activo_Corriente;

        --:New.patrimonio  := v_Patrimonio;

        --:New.total_activofamiliar :=  v_Activos_Familiares;

        --:New.total_pasivofamiliar := v_Total_Pasivo_Familiar;

        --:new.totalgastos_familiares:= v_Total_Gastos_Familiares;

        --:new.excedentefamiliar := v_ExcedenteFamiliar;

        --:New.patrio_fam_balgen := v_Patrimonio_Familiar;

        --:new.total_activos1 := v_Total_Activos;

        --:New.cuotarecomendada_excedfamiliar := vcuotasegurocal / v_ExcedenteFamiliar;

        --        --:New.totalpasivo_patrimonio := to_number(:new.obligacionesfinancieras) + to_number(:new.cuentapagarprovedor)+to_number(:new.cuentapagarvarias);
        --        p_depura ('Linea ' || $$plsql_line);

        --
        BEGIN
            --*****************************************

            --Insercion package carga_maestro_credito

            --*****************************************    vmonedacal,vDESTINOCREDITO,vESPECIFIQUEDESTINO
            reg1.monto_rec := pmontorecomendado;
            reg1.plazo_rec := pplazo;
            reg1.tasa_rec := ptasa;
            reg1.frecuencia_rec := pfrecuencia;
            reg1.cuota_cr := pcuota;
            reg1.destino_credito_rec := vdestinocredito;
            reg1.detalle_destino_rec := vespecifiquedestino;
            reg1.moneda_rec := vmonedacal;
            reg1.cod_estado_solici_rec := 'R';         --:new.estadosolicitud;
            --

            --****************************************

            --Insercion package carga_balance_general

            --****************************************
            reg1.maquinaria_computacion_bge := pmaquinaria_mueblesequipos;
            reg1.puesto_propio_bge := plocalnegocio;
            reg1.prestamos_pagar_bge := pobligacionesfinancieras;
            reg1.cuentas_pagar_bge := 0;
            reg1.tarjetas_credito_bge := pcuentapagarprovedor;
            --:New.cuentapagarvarias;
            reg1.otros_pas_bge := pcuentapagarvarias;
            reg1.activo_corriente_bge := v_total_activo_corriente;
            reg1.activo_no_corriente_bge := v_total_activo_fijo;
            reg1.pasivo_corriente_bge := v_total_pasivo_corriente;
            --:New.total_pasivocorrientes;
            reg1.pasivo_no_corriente_bge := ptotal_pasivo_lp;
            reg1.suma_pasivo_bge := v_total_pasivo_patrimonio;
            --v_patrimonio + nvl(:New.total_pasivo, 0);
            reg1.suma_patrimonio_bge := v_patrimonio;
            reg1.suma_activo_bge :=
                  NVL (pobligacionesfinancieras, 0)
                + NVL (pcuentapagarprovedor, 0)
                + NVL (pcuentapagarvarias, 0);  --:New.total_pasivopatrimonio;
            reg1.capital_bge := pcapital_trabajo;
            reg1.fecha_bge := TO_DATE (pfechabalancegeneral, 'DD/MM/YYYY');
            --reg1.fecha_bge             := To_date( :New.fechabalancegeneral, 'DD/MM/YYYY' );
            reg1.efectivo_bge := pefectivo_cajabanco;
            reg1.cuentas_cobrar_bge := pcuentaxcobrar;
            reg1.inventario_prod_term_bge := pinventario_prod_tem;
            reg1.inventario_prod_proc_bge := pinventario_prod_proc;
            reg1.inventario_mercaderias_bge := pinventario_materiaprima;
            reg1.herramientas_bge := pmercancia;
            reg1.anticipo_proveedores_bge := panticipo_proveedores;
            reg1.suma_total_activo_bge := v_total_activos; --:new.total_activos1;
            reg1.vehiculos_bge := pmueble_vehiculo;
            reg1.cuentas_bancarias_bge := pdeudabancaria;
            --****************************************

            --Insercion package carga_estado_resultados

            --****************************************
            reg1.fecha_desde_neg := TO_DATE (pdesde, 'DD/MM/YYYY');
            reg1.fecha_hasta_neg := TO_DATE (phasta, 'DD/MM/YYYY');
            reg1.ventas_mensuales_neg := v_totalventasmensuales;
            --:New.ventas_ingresos;
            reg1.costo_ventas_neg := v_totalcostoventas;   --:New.costoventas;
            reg1.utilidad_bruta_ventas_neg := v_utilidadbruta; --:New.utilidadbruta;
            reg1.salarios_neg := psueldo;
            reg1.servicios_varios_neg := pservicio;
            reg1.alquiler_local_neg := palquiler;
            reg1.transporte_neg := ptransporte_combs;
            reg1.intereses_neg := ppagointereses;
            ---reg1.otros_neg := potrosingresos_operacionales;  ---11-04-2023
            reg1.otros_neg := potros;                  ---malmanzar 11-04-2023
            reg1.gastos_operacion_neg :=
                  NVL (psueldo, 0)
                + NVL (pservicio, 0)
                + NVL (palquiler, 0)
                + NVL (ptransporte_combs, 0)
                + NVL (ppagointereses, 0)
                + NVL (potros, 0);                      --malmanzar 11-04-2023
            ---ptotalcostooperacional;
            /****+ (CASE
                   WHEN vclientepertenece IS NULL THEN 0
                   ELSE NVL (v_tcon, 0)
               END);****/
            reg1.excedente_neg := v_utilidadbruta - reg1.gastos_operacion_neg; ---malmanzar 11-04-2023
            /****   putilidadneta
             + (CASE
                    WHEN vclientepertenece IS NULL THEN 0
                    ELSE v_utilidadbruta - reg1.gastos_operacion_neg
                END);*****/
            --reg1.otros_ingresos_fam := potros;    ----malmanzar 11-04-2023
            reg1.otros_ingresos_fam := potrosingresos_operacionales; ----malmanzar 11-04-2023
            reg1.alimentacion_fam := palimentacion;
            reg1.alquiler_fam := pvivienda;
            reg1.vestido_fam := pvestido;
            reg1.transporte_fam := ptransporte;
            reg1.servicios_varios_fam := pservicios;
            reg1.medicinas_fam := pmedicinas;
            reg1.educacion_fam := peducacion;
            reg1.gastos_imprevistos_fam := pdeudasfamiliares;
            reg1.otros_gastos_fam := potros_gastos;
            reg1.gastos_fam := v_total_gastos_familiares;
            --:New.totalgastos_familiares;
            --reg1.excedente_mensual_fam := v_excedentefamiliar; --------------*******----------  11-04-2023    reg1.excedente_mensual_fam := nvl(reg1.excedente_neg,0) + nvl(reg1.otros_ingresos_fam,0)   - nvl(reg1.gastos_fam,0)
            reg1.excedente_mensual_fam :=
                  NVL (reg1.excedente_neg, 0)
                + NVL (reg1.otros_ingresos_fam, 0)
                - NVL (reg1.gastos_fam, 0);                       --11-04-2023
            --:new.excedentefamiliar;
            --****************************************

            --Insercion package carga_evaluacion_financiera

            --****************************************
            reg1.ventas_diarias_evf := pventasdiarias_promedio;
            reg1.dias_trabmes_evf := pdiastrabajados;
            reg1.ventas_mensual_evf := pventasmensualesdeclaradas;
            reg1.compras_semprom_evf := pcomprassemanalesdeclaradas;
            reg1.compras_mendecl_evf := pcomprasmensualesdeclaradas;
            reg1.margen_decl_evf := pmargendeclarado;
            reg1.monto_mesalto_evf := pmontomesalto;
            reg1.monto_mesmedio_evf := pmontomesmedio;
            reg1.monto_mesbajo_evf := pmontomesbajo;
            reg1.venta_mes_evf := pventasmensuales;
            reg1.costo_ventames_evf := pcostoventamensual;
            reg1.margen_ganancia_evf := pmargenganancia;
            --****************************************

            --Insercion package carga_evaluacion_nofinanciera

            --****************************************
            reg1.pri_ref_enf := pprimera_ref_vecinos;
            reg1.seg_ref_enf := psegunda_ref_vecinos;
            reg1.ambiente_fam_enf := pambientefamiliar;
            reg1.dependientes_enf := pdependientes;
            reg1.edad_enf :=
                TO_NUMBER (
                    SUBSTR (NVL (pedad, 0), 1, INSTR (NVL (pedad, 0), ' , ')));
            reg1.est_salud_enf := pestadosaludfamilia;
            reg1.estabilidad_enf := pingresos;
            reg1.otros_ing_enf := potrosingresos;
            reg1.experiencia_enf := pexperiencia_neg;
            reg1.horas_enf := phoras_neg;
            reg1.local_propio_enf := plocalpropio;
            reg1.tiempo_local_enf := ptiempoempleo;
            reg1.ubic_negocio_enf := pubicacionnegocio;
            reg1.lleva_registros_enf := pllevaregistro;
            reg1.mejoras_negocio_enf := pmejorasnegocio;
            reg1.frecuencia_clte_enf := pclientesfrecuentes;
            reg1.nivel_compe_enf := pnivelcompetencia;

            --****************************************
            p_depura ('Linea ' || $$plsql_line);

            --Insercion package carga_indicadores

            --****************************************
            IF v_patrimonio <> 0
            THEN
                reg1.pasivo_patrimonio_ind :=
                    ROUND (v_total_pasivo / v_patrimonio, 2);
            ELSE
                reg1.pasivo_patrimonio_ind := 0;
            END IF;

            IF v_total_pasivo_corriente <> 0
            THEN
                reg1.activo_pasivo_ind :=
                    ROUND (
                        v_total_activo_corriente / v_total_pasivo_corriente,
                        2);
            --:New.activocorte_pascte;
            ELSE
                reg1.activo_pasivo_ind := 0;
            END IF;

            IF v_excedentefamiliar <> 0
            THEN
                reg1.otrosingresos_excedentefam :=
                    ROUND (
                          NVL (potrosingresos_operacionales, 0)
                        / v_excedentefamiliar,
                        2);
                --:= :New.otrosingresos_excedente;
                reg1.cuota_excedentefam :=
                    ROUND (NVL (vcuotasegurocallv, 0) / v_excedentefamiliar,
                           2);
            ELSE
                reg1.otrosingresos_excedentefam := 0;
                reg1.cuota_excedentefam := 0;
            END IF;

            --:New.cuotarecomendada_excedfamiliar;
            IF (v_patrimonio + v_patrimonio_familiar) <> 0
            THEN
                reg1.tot_pasivo_patrimonio :=
                    ROUND (
                          (v_total_pasivo + v_total_pasivo_familiar)
                        / (v_patrimonio + v_patrimonio_familiar),
                        2);
            ELSE
                reg1.tot_pasivo_patrimonio := 0;
            END IF;

            IF v_patrimonio <> 0
            THEN
                reg1.utilidadneta_patrimonio :=
                    ROUND (v_utilidad_neta / v_patrimonio, 2);
            ELSE
                reg1.utilidadneta_patrimonio := 0;
            END IF;

            --:New.utilidadneta_patrimonio;
            IF v_total_activos <> 0
            THEN
                reg1.utilidadneta_activostotal :=
                    ROUND (v_utilidad_neta / v_total_activos, 2);
            ELSE
                reg1.utilidadneta_activostotal := 0;
            END IF;

            --:New.utilidadneta_totalactivos1;
            reg1.utilidadneta_ingresos := v_utilidadneta_ventas;

            IF pventas_ingresos <> 0
            THEN
                reg1.ctasxcobrar_ingresos :=
                    pcuentaxcobrar / NVL (pventas_ingresos, 0);
            ELSE
                reg1.ctasxcobrar_ingresos := 0;
            END IF;

            IF (  NVL (pinventario_prod_tem, 0)
                + NVL (pinventario_prod_proc, 0)
                + NVL (pinventario_materiaprima, 0)
                + NVL (pmercancia, 0)) <>
               0
            THEN
                reg1.costoventas_inventario :=
                    ROUND (
                          pcostoventas
                        / (  NVL (pinventario_prod_tem, 0)
                           + NVL (pinventario_prod_proc, 0)
                           + NVL (pinventario_materiaprima, 0)
                           + NVL (pmercancia, 0)),
                        2);
            ELSE
                reg1.costoventas_inventario := 0;
            END IF;                              --:New.costoventa_inventario;

            --****************************************
            --            p_depura ('Linea ' || $$plsql_line);
            --Insercion package carga_balance_fam

            --****************************************
            reg1.fecha_bgf :=
                TO_DATE (pfecha_balancegeneral_al, 'DD/MM/YYYY');
            reg1.muebles_vehiculos_bgf := pmueble_vehiculo;
            --to_number(nvl(:New.mueble_vehiculo,0));
            --p_depura ('Balance General:' || reg1.muebles_vehiculos_bgf || ' ' || :new.mueble_vehiculo);
            reg1.inmuebles_bgf := pinmuebles;
            --to_number(nvl(:New.inmuebles,0));
            --p_depura ('Balance General:' || reg1.inmuebles_bgf || ' ' || :new.inmuebles);
            reg1.tot_activos_bgf := v_activos_familiares;
            --:New.total_activofamiliar;
            --p_depura ('Balance General:' || reg1.tot_activos_bgf || ' ' || v_activos_familiares);
            reg1.deuda_comercial_bgf := pdeudacomercial;
            --to_number(nvl(:New.deudacomercial,0));
            --p_depura ('Balance General:' || reg1.deuda_comercial_bgf || ' ' || :new.deudacomercial);
            reg1.deuda_bancaria_bgf := pdeudabancaria;
            --to_number(nvl(:New.deudabancaria,0));
            --p_depura ('Balance General:' || reg1.deuda_bancaria_bgf || ' ' || :new.deudabancaria);
            reg1.tot_pasivo_bgf := v_total_pasivo_familiar;
            --:New.total_pasivofamiliar;
            --p_depura ('Balance General:' || reg1.inmuebles_bgf || ' ' || v_total_pasivo_familiar);
            reg1.patrimonio_bgf := v_patrimonio_familiar;
        --:New.total_pasivopatrimonio;
        --p_depura ('Balance General:' || reg1.patrimonio_bgf || ' ' || v_patrimonio_familiar);
        --   p_depura ('Linea ' || $$plsql_line);
        EXCEPTION
            WHEN OTHERS
            THEN
                p_depura ('Linea ' || $$plsql_line);
                --p_depura ('tempfec ' || sqlerrm);
                NULL;
        END;

        ----p_depura('Balance General:'||reg1.muebles_vehiculos_bgf||' '||reg1.inmuebles_bgf||' '||v_activos_familiares||' '||reg1.deuda_comercial_bgf||' '||reg1.deuda_bancaria_bgf||' '||v_total_pasivo_familiar||' '||v_patrimonio_familiar);
        p_solicitud := v_no_credito;
        --- DBMS_OUTPUT.put_line ('Carga_Maestro_Credito');
        pr_carga_analisis_solic.carga_maestro_credito (p_codempresa,
                                                       p_solicitud,
                                                       p_codcliente,
                                                       reg1,
                                                       pmensajeerror);

        --p_depura ('Carga_Maestro_Credito fec' || nvl (pmensajeerror, 'A'));
        ---DBMS_OUTPUT.put_line ('Carga_Indicadores');
        pr_carga_analisis_solic.carga_indicadores (p_codempresa,
                                                   p_solicitud,
                                                   p_codcliente,
                                                   reg1,
                                                   pmensajeerror);

        --p_depura ('Carga_Indicadores fec' || nvl (pmensajeerror, 'A'));
        -- DBMS_OUTPUT.put_line ('Carga_Evaluacion_Nofinanc');
        pr_carga_analisis_solic.carga_evaluacion_nofinanc (p_codempresa,
                                                           p_solicitud,
                                                           p_codcliente,
                                                           reg1,
                                                           pmensajeerror);
        --- p_depura ('Linea ' || $$plsql_line);
        --p_depura ('Carga_Evaluacion_Nofinanc fec' || nvl (pmensajeerror, 'A'));
        ---DBMS_OUTPUT.put_line ('Carga_Evaluacion_Financ');
        pr_carga_analisis_solic.carga_evaluacion_financ (p_codempresa,
                                                         p_solicitud,
                                                         p_codcliente,
                                                         reg1,
                                                         pmensajeerror);

        --p_depura ('Carga_Evaluacion_Financ fec' || nvl (pmensajeerror, 'A'));
        -- DBMS_OUTPUT.put_line ('Carga_Estado_Resultados');
        pr_carga_analisis_solic.carga_estado_resultados (p_codempresa,
                                                         p_solicitud,
                                                         p_codcliente,
                                                         reg1,
                                                         pmensajeerror);
        -- p_depura ('Linea ' || $$plsql_line);
        --p_depura ('Carga_Estado_Resultados fec' || nvl (pmensajeerror, 'A'));
        --DBMS_OUTPUT.put_line ('Carga_Balance_General');
        pr_carga_analisis_solic.carga_balance_general (p_codempresa,
                                                       p_solicitud,
                                                       p_codcliente,
                                                       reg1,
                                                       pmensajeerror);

        --p_depura ('Carga_Balance_General fec' || nvl (pmensajeerror, 'A'));
        --- DBMS_OUTPUT.put_line ('Carga_Balance_Fam');
        pr_carga_analisis_solic.carga_balance_fam (p_codempresa,
                                                   p_solicitud,
                                                   p_codcliente,
                                                   reg1,
                                                   pmensajeerror);

        --- p_depura ('Linea ' || $$plsql_line);

        --p_depura ('Carga_Balance_Fam fec' || nvl (pmensajeerror, 'A'));

        --
        IF vclientepertenece IS NOT NULL AND UPPER (v_tipopersona) = 'FIADOR'
        THEN
            BEGIN
                SELECT estado
                  INTO vestadocre
                  FROM pr_creditos
                 WHERE no_credito = p_solicitud;

                IF vestadocre = 'R'
                THEN
                    BEGIN
                        -- Se agrega excepcion de llave ¿nica para que omita el error si se reprocesa y ya existe el aval.
                        INSERT INTO pr_aval_repre_x_credito (
                                        codigo_empresa,
                                        no_credito,
                                        tipo_aval_repre,
                                        codigo_aval_repre)
                             VALUES (p_codempresa,
                                     p_solicitud,
                                     'A',
                                     p_codcliente);
                    EXCEPTION
                        WHEN DUP_VAL_ON_INDEX
                        THEN
                            NULL;
                    END;
                ELSE
                    ROLLBACK;
                    pmensajeerror :=
                           'El estado ('
                        || vestadocre
                        || ') del cr¿dito ('
                        || p_solicitud
                        || ') no permite agregar aval ('
                        || p_codcliente
                        || ')';
                    p_depura ('Linea ' || $$plsql_line);
                    /*malmanzar 04-03-2022
                    En caso de error en vez de realizar de actualizar  via WebService
                    se realiza rollback se devuelve mensaje de error.
                    */
                    --  pIdtempFud                   := 0;
                    pestadofec := 'R';
                    pmensajefec := pmensajeerror;
                    pnosolicitud := 0;
                    RETURN;
                --PA.P_DEPURA_MAAP (pmensajeerror);
                --
                --                    IF ia.api_portacredit.fnupdatefud (0,
                --                                                       pIdTempFec,
                --                                                       'R',
                --                                                       pmensajeerror,
                --                                                       0)
                --                    THEN
                --                        ----p_depura( pmensajeerror );   --Null;
                --                        raise_application_error (num   => -20000,
                --                                                 msg   => pmensajeerror);
                --                    END IF;
                END IF;
            EXCEPTION
                WHEN OTHERS
                THEN
                    ROLLBACK;
                    pmensajeerror :=
                           'Error al intentar agregar el aval al cr¿dito. '
                        || SQLERRM
                        || ' '
                        || DBMS_UTILITY.format_error_backtrace;
                    pa.p_depura_maap (
                           'Solicitud: '
                        || p_solicitud
                        || ' Aval: '
                        || p_codcliente
                        || ' - Error al intentar agregar el aval al cr¿dito. '
                        || SQLERRM
                        || ' '
                        || DBMS_UTILITY.format_error_backtrace);
                    p_depura ('Linea ' || $$plsql_line);

                    /*malmanzar 04-03-2022
                      En caso de error en vez de realizar de actualizar  via WebService
                      se realiza rollback se devuelve mensaje de error.
                      */
                    --pIdtempFud                   := 0;
                    pestadofec := 'R';
                    pmensajefec := pmensajeerror;
                    pnosolicitud := 0;
                    RETURN;
            --                    IF ia.api_portacredit.fnupdatefud (0,
            --                                                       pIdTempFec,
            --                                                       'R',
            --                                                       pmensajeerror,
            --                                                       0)
            --                    THEN
            --                        ----p_depura( pmensajeerror );   --Null;
            --                        raise_application_error (num   => -20001,
            --                                                 msg   => pmensajeerror);
            --                    END IF;
            END;
        END IF;

        --        p_depura ('Linea ' || $$plsql_line);
        --

        --Excello:JPH:2020-03-27:REQ_ 108967:Begin >>
        --==================================================================- --
        --  Insetta Informaci¿n Laboral del Cliente                           --
        --==================================================================- --

        pa.pa_mant_datos_personas.p_inserta_info_laboral_fec (
            p_codcliente,
            NVL (pventas_ingresos, 0),
            pnomarchivo,
            ptipodocumentoidentidad,
            pdocumentoidentidad,
            v_procesado,
            v_mensaje_error);

        --        p_depura (
        --               'Linea '
        --            || $$plsql_line
        --            || ' v_mensaje_error '
        --            || v_mensaje_error);

        --p_depura('v_mensaje_error '||v_mensaje_error);
        IF v_mensaje_error IS NOT NULL
        THEN                                            --malmanzar 21-04-2021
            v_error :=
                   'FEX Error procesando informaci¿n laboral'
                || ' '
                || v_mensaje_error;
            pmensajeerror := v_error; ----:New.Mensaje := Substr(V_Error,1,200);
        END IF;

        --Excello:JPH:2020-03-27:REQ_ 108967:End <<

        -- Exitoso
        --p_depura ('exitoso fec' || nvl (pmensajeerror, 'A'));
        IF TRIM (pmensajeerror) IS NULL
        THEN
            pestadofec := 'A';
            pmensajefec := 'Procesado Correctamente';
            pnosolicitud := v_no_credito;
        --- RETURN;
        --malmanzar 04-03-2022 se retorna valores para que se ejecute en el llamado
        --            IF ia.api_portacredit.fnupdatefud (0,
        --                                               pIdTempFec,
        --                                               'A',
        --                                               'Procesado Correctamente',
        --                                               v_no_credito)
        --            THEN
        --                DBMS_OUTPUT.put_line ('Carga Exitosa');
        --            END IF;
        ELSE
            --p_depura ('con errores');
            --:new.idestado := 'R';

            --:new.mensaje := 'Rechazado';
            ROLLBACK;
            pestadofec := 'E';
            pmensajefec := 'Rechazado';
            pnosolicitud := 0;
            p_depura (
                   ' pmensajeerror '
                || pmensajeerror
                || ' Linea '
                || $$plsql_line);
            RETURN;
        --            IF ia.api_portacredit.fnupdatefud (0,
        --                                               pIdTempFec,
        --                                               'R',
        --                                               pmensajeerror,
        --                                               0)
        --            THEN
        --                --p_depura (pmensajeerror);                                                                                   --Null;
        --                raise_application_error (num => -20000, msg => pmensajeerror);
        --            END IF;
        END IF;

        --Inserta Fec
        BEGIN
            --            p_depura ('Linea ' || $$plsql_line);
            vresult :=
                fninsertfec (
                    pid_tempfec                     => pidtempfec,    --Number
                    pnomarchivo                     => pnomarchivo,
                    pprocesado                      => v_procesado,
                    pidevaluacioncrediticia         => pidevaluacioncrediticia,
                    ptipodocumentoidentidad         => ptipodocumentoidentidad,
                    pdocumentoidentidad             => pdocumentoidentidad,
                    pnombrecliente                  => pnombrecliente,
                    pnumerosolicitud                => pnumerosolicitud, --Number
                    pprimera_ref_vecinos            => pprimera_ref_vecinos,
                    psegunda_ref_vecinos            => psegunda_ref_vecinos,
                    pambientefamiliar               => pambientefamiliar,
                    pdependientes                   => pdependientes, -- Number
                    pedad                           => pedad,      -- Varchar2
                    pestadosaludfamilia             => pestadosaludfamilia,
                    pingresos                       => pingresos,
                    potrosingresos                  => potrosingresos,
                    pexperiencia_neg                => pexperiencia_neg,
                    phoras_neg                      => phoras_neg,
                    plocalpropio                    => plocalpropio,
                    ptiempoempleo                   => ptiempoempleo,
                    pubicacionnegocio               => pubicacionnegocio,
                    pllevaregistro                  => pllevaregistro,
                    pmejorasnegocio                 => pmejorasnegocio,
                    pclientesfrecuentes             => pclientesfrecuentes,
                    pnivelcompetencia               => pnivelcompetencia,
                    pventasdiarias_promedio         => pventasdiarias_promedio,
                    pdiastrabajados                 => pdiastrabajados,
                    pventasmensualesdeclaradas      => pventasmensualesdeclaradas,
                    pcomprassemanalesdeclaradas     =>
                        pcomprassemanalesdeclaradas,
                    pcomprasmensualesdeclaradas     =>
                        pcomprasmensualesdeclaradas,
                    pmargendeclarado                => pmargendeclarado,
                    pmontomesalto                   => pmontomesalto,
                    pmontomesmedio                  => pmontomesmedio,
                    pmontomesbajo                   => pmontomesbajo,
                    pventasmensuales                => pventasmensuales,
                    pcostoventamensual              => pcostoventamensual,
                    pmargenganancia                 => pmargenganancia,
                    pdesde                          => pdesde,
                    phasta                          => phasta,
                    pventas_ingresos                => pventas_ingresos,
                    pcostoventas                    => pcostoventas,
                    putilidadbruta                  => putilidadbruta,
                    psueldo                         => psueldo,
                    pservicio                       => pservicio,
                    palquiler                       => palquiler,
                    ptransporte_combs               => ptransporte_combs,
                    ppagointereses                  => ppagointereses,
                    potros                          => potros,
                    ptotalcostooperacional          => ptotalcostooperacional,
                    putilidadneta                   => putilidadneta,
                    potrosingresos_operacionales    =>
                        potrosingresos_operacionales,
                    palimentacion                   => palimentacion,
                    pvivienda                       => pvivienda,
                    pvestido                        => pvestido,
                    ptransporte                     => ptransporte,
                    pservicios                      => pservicios,
                    pmedicinas                      => pmedicinas,
                    peducacion                      => peducacion,
                    pdeudasfamiliares               => pdeudasfamiliares,
                    potros_gastos                   => potros_gastos,
                    ptotalgastos_familiares         => ptotalgastos_familiares,
                    pexcedentefamiliar              => pexcedentefamiliar,
                    pfechabalancegeneral            => pfechabalancegeneral,
                    pefectivo_cajabanco             => pefectivo_cajabanco,
                    pcuentaxcobrar                  => pcuentaxcobrar,
                    pinventario_prod_tem            => pinventario_prod_tem,
                    pinventario_prod_proc           => pinventario_prod_proc,
                    pinventario_materiaprima        => pinventario_materiaprima,
                    pmercancia                      => pmercancia,
                    panticipo_proveedores           => panticipo_proveedores,
                    pfecha_balancegeneral_al        => pfecha_balancegeneral_al,
                    pmueble_vehiculo                => pmueble_vehiculo,
                    pinmuebles                      => pinmuebles,
                    ptotal_activofamiliar           => ptotal_activofamiliar,
                    pdeudacomercial                 => pdeudacomercial,
                    pdeudabancaria                  => pdeudabancaria,
                    ptotal_pasivofamiliar           => ptotal_pasivofamiliar,
                    ppatrio_fam_balgen              => ppatrio_fam_balgen,
                    pmaquinaria_mueblesequipos      => pmaquinaria_mueblesequipos,
                    plocalnegocio                   => plocalnegocio,
                    pobligacionesfinancieras        => pobligacionesfinancieras,
                    pcuentapagarprovedor            => pcuentapagarprovedor,
                    pcuentapagarvarias              => pcuentapagarvarias,
                    ptotal_activocorriente          => ptotal_activocorriente,
                    ptotal_activofijo               => ptotal_activofijo,
                    ptotal_activos1                 => ptotal_activos1,
                    ptotal_pasivocorrientes         => ptotal_pasivocorrientes,
                    ptotal_pasivo_lp                => ptotal_pasivo_lp,
                    ptotal_pasivo                   => ptotal_pasivo,
                    ppatrimonio                     => ppatrimonio,
                    ptotal_pasivopatrimonio         => ptotal_pasivopatrimonio,
                    pcapital_trabajo                => pcapital_trabajo,
                    ppasivo_patrimonio              => ppasivo_patrimonio,
                    pactivocorte_pascte             => pactivocorte_pascte,
                    potrosingresos_excedente        => potrosingresos_excedente,
                    pcuotarecomendada_excedfam      => pcuotarecomendada_excedfam,
                    ptotalpasivo_patrimonio         => ptotalpasivo_patrimonio,
                    putilidadneta_patrimonio        => putilidadneta_patrimonio,
                    putilidadneta_totalactivos1     =>
                        putilidadneta_totalactivos1,
                    putilidadneta_ventas            => putilidadneta_ventas,
                    pcuentasxcobrar_ventas          => pcuentasxcobrar_ventas,
                    pcostoventa_inventario          => pcostoventa_inventario,
                    pmontorecomendado               => pmontorecomendado,
                    pgastoslegales                  => pgastoslegales,
                    pmoneda                         => pmoneda,
                    pplazo                          => pplazo,
                    ptasa                           => ptasa,
                    pfrecuencia                     => pfrecuencia,
                    pcuota                          => pcuota,
                    pdestinocredito                 => pdestinocredito,
                    pespecifiquedestino             => pespecifiquedestino,
                    pestadosolicitud                => pestadosolicitud,
                    pactividadeconomica             => pactividadeconomica,
                    pactividadeconomicadinrap       => pactividadeconomicadinrap,
                    pmargenbrutoestandar            => pmargenbrutoestandar,
                    pgastosoperacionalesestandar    =>
                        pgastosoperacionalesestandar,
                    palto_indicadores               => palto_indicadores,
                    pbajo_indicadores               => pbajo_indicadores,
                    plunes                          => plunes,
                    pmartes                         => pmartes,
                    pmiercoles                      => pmiercoles,
                    pjueves                         => pjueves,
                    pviernes                        => pviernes,
                    psabado                         => psabado,
                    pdomingo                        => pdomingo,
                    ptotal_ventasaltas              => ptotal_ventasaltas,
                    ptotal_ventasbajas              => ptotal_ventasbajas,
                    ptotal_ventassemanales          => ptotal_ventassemanales,
                    ptotal_ventasmensuales          => ptotal_ventasmensuales,
                    pmargenbrutodeclarado           => pmargenbrutodeclarado,
                    palimentacion_gastos            => palimentacion_gastos,
                    pvivienda_gastos                => pvivienda_gastos,
                    peducacion_gastos               => peducacion_gastos,
                    psalud_gastos                   => psalud_gastos,
                    ptransporte_gastos              => ptransporte_gastos,
                    pvestido_gastos                 => pvestido_gastos,
                    ppagodeudas_gastos              => ppagodeudas_gastos,
                    potros_gastos_familiares        => potros_gastos_familiares,
                    ptotal_gastos                   => ptotal_gastos,
                    pventas_gastos                  => pventas_gastos,
                    pcostosventas_gastos            => pcostosventas_gastos,
                    pgastosoperativos               => pgastosoperativos,
                    potros_ingresos_gastos          => potros_ingresos_gastos,
                    ptotal_gastos_familiares        => ptotal_gastos_familiares,
                    pexcedentefamiliar_gastos       => pexcedentefamiliar_gastos,
                    pcuotasolicitada                => pcuotasolicitada,
                    prelcuotasolicitada_excfam      => prelcuotasolicitada_excfam,
                    pmonto_recomendacion            => pmonto_recomendacion,
                    pmoneda_recomendacion           => pmoneda_recomendacion,
                    pplazo_recomendacion            => pplazo_recomendacion,
                    ptasa_recomendacion             => ptasa_recomendacion,
                    pfrecuencia_recomendacion       => pfrecuencia_recomendacion,
                    pcuota_recomendacion            => pcuota_recomendacion,
                    pestadosolicitud_recomendacion   =>
                        pestadosolicitud_recomendacion,
                    pcuotarecomendada_excfamiliar   =>
                        pcuotarecomendada_excfamiliar,
                    pventasevalanterior             => pventasevalanterior,
                    pactual_ventas                  => pactual_ventas,
                    pvariacionventas                => pvariacionventas,
                    pcomentario1                    => pcomentario1,
                    pcomentario2                    => pcomentario2,
                    ppro1nombre                     => ppro1nombre,
                    ppro1materiaprima1              => ppro1materiaprima1,
                    ppro1materiaprima2              => ppro1materiaprima2,
                    ppro1materiaprima3              => ppro1materiaprima3,
                    ppro1totalmp                    => ppro1totalmp,
                    ppro1sueldo1                    => ppro1sueldo1,
                    ppro1sueldo2                    => ppro1sueldo2,
                    ppro1totalsueldo                => ppro1totalsueldo,
                    ppro1otroscostos                => ppro1otroscostos,
                    ppro1totalcostos                => ppro1totalcostos,
                    ppro1costounitario              => ppro1costounitario,
                    ppro1preciounitario             => ppro1preciounitario,
                    ppro1unidadesvendidas           => ppro1unidadesvendidas,
                    ppro1ventasmensuales            => ppro1ventasmensuales,
                    ppro1costosventasmensuales      => ppro1costosventasmensuales,
                    ppro1margenganancia             => ppro1margenganancia,
                    ppro2nombre                     => ppro2nombre,
                    ppro2materiaprima1              => ppro2materiaprima1,
                    ppro2materiaprima2              => ppro2materiaprima2,
                    ppro2materiaprima3              => ppro2materiaprima3,
                    ppro2totalmp                    => ppro2totalmp,
                    ppro2sueldo1                    => ppro2sueldo1,
                    ppro2sueldo2                    => ppro2sueldo1,
                    ppro2totalsueldo                => ppro2totalsueldo,
                    ppro2otroscostos                => ppro2otroscostos,
                    ppro2totalcostos                => ppro2totalcostos,
                    ppro2costounitario              => ppro2costounitario,
                    ppro2preciounitario             => ppro2preciounitario,
                    ppro2unidadesvendidas           => ppro2unidadesvendidas,
                    ppro2ventasmensuales            => ppro2ventasmensuales,
                    ppro2costosventasmensuales      => ppro2costosventasmensuales,
                    ppro2margenganancia             => ppro2margenganancia,
                    ppro3nombre                     => ppro3nombre,
                    ppro3materiaprima1              => ppro3materiaprima1,
                    ppro3materiaprima2              => ppro3materiaprima2,
                    ppro3materiaprima3              => ppro3materiaprima3,
                    ppro3totalmp                    => ppro3totalmp,
                    ppro3sueldo1                    => ppro3sueldo1,
                    ppro3sueldo2                    => ppro3sueldo2,
                    ppro3totalsueldo                => ppro3totalsueldo,
                    ppro3otroscostos                => ppro3otroscostos,
                    ppro3totalcostos                => ppro3totalcostos,
                    ppro3costounitario              => ppro3costounitario,
                    ppro3preciounitario             => ppro3preciounitario,
                    ppro3unidadesvendidas           => ppro3unidadesvendidas,
                    ppro3ventasmensuales            => ppro3ventasmensuales,
                    ppro3costosventasmensuales      => ppro3costosventasmensuales,
                    ppro3margenganancia             => ppro3margenganancia,
                    pprootromateriaprima1           => pprootromateriaprima1,
                    pprootromateriaprima2           => pprootromateriaprima2,
                    pprootromateriaprima3           => pprootromateriaprima3,
                    pprootrototalmp                 => pprootrototalmp,
                    pprootrosueldo1                 => pprootrosueldo1,
                    pprootrosueldo2                 => pprootrosueldo2,
                    pprootrototalsueldo             => pprootrototalsueldo,
                    pprootrootroscostos             => pprootrootroscostos,
                    pprootrototalcostos             => pprootrototalcostos,
                    pprootrocostounitario           => pprootrocostounitario,
                    pprootropreciounitario          => pprootropreciounitario,
                    pprootrounidadesvendidas        => pprootrounidadesvendidas,
                    pprootroventasmensuales         => pprootroventasmensuales,
                    pprootrocostosventasmensuales   =>
                        pprootrocostosventasmensuales,
                    pprootromargenganancia          => pprootromargenganancia,
                    plinea1                         => plinea1,
                    ppreciounitario1                => ppreciounitario1,
                    pcostounitario1                 => pcostounitario1,
                    pmargendeganancia1              => pmargendeganancia1,
                    punidadesvendidas1              => punidadesvendidas1,
                    pventasmensuales1               => pventasmensuales1,
                    pcostoventas1                   => pcostoventas1,
                    plinea2                         => plinea2,
                    ppreciounitario2                => ppreciounitario2,
                    pcostounitario2                 => pcostounitario2,
                    pmargendeganancia2              => pmargendeganancia2,
                    punidadesvendidas2              => punidadesvendidas2,
                    pventasmensuales2               => pventasmensuales2,
                    pcostoventas2                   => pcostoventas2,
                    plinea3                         => plinea3,
                    ppreciounitario3                => ppreciounitario3,
                    pcostounitario3                 => pcostounitario3,
                    pmargendeganancia3              => pmargendeganancia3,
                    punidadesvendidas3              => punidadesvendidas3,
                    pventasmensuales3               => pventasmensuales3,
                    pcostoventas3                   => pcostoventas3,
                    plineaot                        => plineaot,
                    ppreciounitarioot               => ppreciounitarioot,
                    pcostounitarioot                => pcostounitarioot,
                    pmargendegananciaot             => pmargendegananciaot,
                    punidadesvendidasot             => punidadesvendidasot,
                    pventasmensualesot              => pventasmensualesot,
                    pcostoventasot                  => pcostoventasot,
                    ptipocredito                    => ptipocredito,
                    pgarantias                      => pgarantias,
                    pvalorgarantia                  => pvalorgarantia,
                    pdescripciongarantia            => pdescripciongarantia,
                    pprestamodescontar              => pprestamodescontar,
                    plinea4                         => plinea4,
                    ppreciounitario4                => ppreciounitario4,
                    pcostounitario4                 => pcostounitario4,
                    pmargendeganancia4              => pmargendeganancia4,
                    punidadesvendidas4              => punidadesvendidas4,
                    pventasmensuales4               => pventasmensuales4,
                    pcostoventas4                   => pcostoventas4,
                    plinea5                         => plinea5,
                    ppreciounitario5                => ppreciounitario5,
                    pcostounitario5                 => pcostounitario5,
                    pmargendeganancia5              => pmargendeganancia5,
                    punidadesvendidas5              => punidadesvendidas5,
                    pventasmensuales5               => pventasmensuales5,
                    pcostoventas5                   => pcostoventas5,
                    plinea6                         => plinea6,
                    ppreciounitario6                => ppreciounitario6,
                    pcostounitario6                 => pcostounitario6,
                    pmargendeganancia6              => pmargendeganancia6,
                    punidadesvendidas6              => punidadesvendidas6,
                    pventasmensuales6               => pventasmensuales6,
                    pcostoventas6                   => pcostoventas6,
                    plinea7                         => plinea7,
                    ppreciounitario7                => ppreciounitario7,
                    pcostounitario7                 => pcostounitario7,
                    pmargendeganancia7              => pmargendeganancia7,
                    punidadesvendidas7              => punidadesvendidas7,
                    pventasmensuales7               => pventasmensuales7,
                    pcostoventas7                   => pcostoventas7,
                    plinea8                         => plinea8,
                    ppreciounitario8                => ppreciounitario8,
                    pcostounitario8                 => pcostounitario8,
                    pmargendeganancia8              => pmargendeganancia8,
                    punidadesvendidas8              => punidadesvendidas8,
                    pventasmensuales8               => pventasmensuales8,
                    pcostoventas8                   => pcostoventas8,
                    pcomentario                     => pcomentario,
                    pidoficial                      => pidoficial,
                    pfecharegistro                  => pfecharegistro,
                    pfechafija                      => pfechafija,
                    pidestado                       => pidestado,
                    pmensaje                        => pmensaje,
                    pnosubida                       => pnosubida,
                    pidgrupo                        => pidgrupo,
                    pimpreso                        => pimpreso);
        END;

        --        p_depura (
        --               'Linea '
        --            || $$plsql_line
        --            || CASE WHEN vresult THEN ' Si crearfec ' ELSE 'No crearFEc' END
        --            || ' pMENSAJE '
        --            || pMENSAJE);
        COMMIT;
    --
    EXCEPTION
        WHEN OTHERS
        THEN
            -- Consider Logging The Error And Then Re-Raise

            --:new.idestado := 'R';

            --:new.mensaje := 'Rechazado';
            --            p_depura ('Linea ' || $$plsql_line);

            ROLLBACK;
            pestadofec := 'E';
            pmensajefec := 'Rechazado ' || SQLERRM;
            pnosolicitud := 0;
            RETURN;
    --            IF ia.api_portacredit.fnupdatefud (0,
    --                                               pIdTempFec,
    --                                               'R',
    --                                               pmensajeerror,
    --                                               0)
    --            THEN
    --                --p_depura (pmensajeerror);
    --                NULL;
    --                RAISE;
    --            END IF;
    --End Bloque 3
    END;

    FUNCTION fninsertfec (pid_tempfec                      NUMBER,
                          pnomarchivo                      VARCHAR2,
                          pprocesado                       VARCHAR2,
                          pidevaluacioncrediticia          VARCHAR2,
                          ptipodocumentoidentidad          VARCHAR2,
                          pdocumentoidentidad              VARCHAR2,
                          pnombrecliente                   VARCHAR2,
                          pnumerosolicitud                 NUMBER,
                          pprimera_ref_vecinos             VARCHAR2,
                          psegunda_ref_vecinos             VARCHAR2,
                          pambientefamiliar                VARCHAR2,
                          pdependientes                    NUMBER,
                          pedad                            VARCHAR2,
                          pestadosaludfamilia              VARCHAR2,
                          pingresos                        VARCHAR2,
                          potrosingresos                   VARCHAR2,
                          pexperiencia_neg                 NUMBER,
                          phoras_neg                       NUMBER,
                          plocalpropio                     VARCHAR2,
                          ptiempoempleo                    NUMBER,
                          pubicacionnegocio                VARCHAR2,
                          pllevaregistro                   VARCHAR2,
                          pmejorasnegocio                  VARCHAR2,
                          pclientesfrecuentes              NUMBER,
                          pnivelcompetencia                VARCHAR2,
                          pventasdiarias_promedio          NUMBER,
                          pdiastrabajados                  NUMBER,
                          pventasmensualesdeclaradas       NUMBER,
                          pcomprassemanalesdeclaradas      NUMBER,
                          pcomprasmensualesdeclaradas      NUMBER,
                          pmargendeclarado                 NUMBER,
                          pmontomesalto                    NUMBER,
                          pmontomesmedio                   NUMBER,
                          pmontomesbajo                    NUMBER,
                          pventasmensuales                 NUMBER,
                          pcostoventamensual               NUMBER,
                          pmargenganancia                  NUMBER,
                          pdesde                           VARCHAR2,
                          phasta                           VARCHAR2,
                          pventas_ingresos                 NUMBER,
                          pcostoventas                     NUMBER,
                          putilidadbruta                   NUMBER,
                          psueldo                          NUMBER,
                          pservicio                        NUMBER,
                          palquiler                        NUMBER,
                          ptransporte_combs                NUMBER,
                          ppagointereses                   NUMBER,
                          potros                           NUMBER,
                          ptotalcostooperacional           NUMBER,
                          putilidadneta                    NUMBER,
                          potrosingresos_operacionales     NUMBER,
                          palimentacion                    NUMBER,
                          pvivienda                        NUMBER,
                          pvestido                         NUMBER,
                          ptransporte                      NUMBER,
                          pservicios                       NUMBER,
                          pmedicinas                       NUMBER,
                          peducacion                       NUMBER,
                          pdeudasfamiliares                NUMBER,
                          potros_gastos                    NUMBER,
                          ptotalgastos_familiares          NUMBER,
                          pexcedentefamiliar               NUMBER,
                          pfechabalancegeneral             VARCHAR2,
                          pefectivo_cajabanco              NUMBER,
                          pcuentaxcobrar                   NUMBER,
                          pinventario_prod_tem             NUMBER,
                          pinventario_prod_proc            NUMBER,
                          pinventario_materiaprima         NUMBER,
                          pmercancia                       NUMBER,
                          panticipo_proveedores            NUMBER,
                          pfecha_balancegeneral_al         VARCHAR2,
                          pmueble_vehiculo                 NUMBER,
                          pinmuebles                       NUMBER,
                          ptotal_activofamiliar            NUMBER,
                          pdeudacomercial                  NUMBER,
                          pdeudabancaria                   NUMBER,
                          ptotal_pasivofamiliar            NUMBER,
                          ppatrio_fam_balgen               NUMBER,
                          pmaquinaria_mueblesequipos       NUMBER,
                          plocalnegocio                    NUMBER,
                          pobligacionesfinancieras         NUMBER,
                          pcuentapagarprovedor             NUMBER,
                          pcuentapagarvarias               NUMBER,
                          ptotal_activocorriente           NUMBER,
                          ptotal_activofijo                NUMBER,
                          ptotal_activos1                  NUMBER,
                          ptotal_pasivocorrientes          NUMBER,
                          ptotal_pasivo_lp                 NUMBER,
                          ptotal_pasivo                    NUMBER,
                          ppatrimonio                      NUMBER,
                          ptotal_pasivopatrimonio          NUMBER,
                          pcapital_trabajo                 NUMBER,
                          ppasivo_patrimonio               NUMBER,
                          pactivocorte_pascte              NUMBER,
                          potrosingresos_excedente         NUMBER,
                          pcuotarecomendada_excedfam       NUMBER,
                          ptotalpasivo_patrimonio          NUMBER,
                          putilidadneta_patrimonio         NUMBER,
                          putilidadneta_totalactivos1      NUMBER,
                          putilidadneta_ventas             NUMBER,
                          pcuentasxcobrar_ventas           NUMBER,
                          pcostoventa_inventario           NUMBER,
                          pmontorecomendado                NUMBER,
                          pgastoslegales                   NUMBER,
                          pmoneda                          VARCHAR2,
                          pplazo                           NUMBER,
                          ptasa                            NUMBER,
                          pfrecuencia                      VARCHAR2,
                          pcuota                           NUMBER,
                          pdestinocredito                  VARCHAR2,
                          pespecifiquedestino              VARCHAR2,
                          pestadosolicitud                 NUMBER,
                          pactividadeconomica              VARCHAR2,
                          pactividadeconomicadinrap        VARCHAR2,
                          pmargenbrutoestandar             NUMBER,
                          pgastosoperacionalesestandar     NUMBER,
                          palto_indicadores                NUMBER,
                          pbajo_indicadores                NUMBER,
                          plunes                           VARCHAR2,
                          pmartes                          VARCHAR2,
                          pmiercoles                       VARCHAR2,
                          pjueves                          VARCHAR2,
                          pviernes                         VARCHAR2,
                          psabado                          VARCHAR2,
                          pdomingo                         VARCHAR2,
                          ptotal_ventasaltas               NUMBER,
                          ptotal_ventasbajas               NUMBER,
                          ptotal_ventassemanales           NUMBER,
                          ptotal_ventasmensuales           NUMBER,
                          pmargenbrutodeclarado            NUMBER,
                          palimentacion_gastos             NUMBER,
                          pvivienda_gastos                 NUMBER,
                          peducacion_gastos                NUMBER,
                          psalud_gastos                    NUMBER,
                          ptransporte_gastos               NUMBER,
                          pvestido_gastos                  NUMBER,
                          ppagodeudas_gastos               NUMBER,
                          potros_gastos_familiares         NUMBER,
                          ptotal_gastos                    NUMBER,
                          pventas_gastos                   NUMBER,
                          pcostosventas_gastos             NUMBER,
                          pgastosoperativos                NUMBER,
                          potros_ingresos_gastos           NUMBER,
                          ptotal_gastos_familiares         NUMBER,
                          pexcedentefamiliar_gastos        NUMBER,
                          pcuotasolicitada                 NUMBER,
                          prelcuotasolicitada_excfam       NUMBER,
                          pmonto_recomendacion             NUMBER,
                          pmoneda_recomendacion            VARCHAR2,
                          pplazo_recomendacion             NUMBER,
                          ptasa_recomendacion              NUMBER,
                          pfrecuencia_recomendacion        VARCHAR2,
                          pcuota_recomendacion             NUMBER,
                          pestadosolicitud_recomendacion   NUMBER,
                          pcuotarecomendada_excfamiliar    NUMBER,
                          pventasevalanterior              NUMBER,
                          pactual_ventas                   NUMBER,
                          pvariacionventas                 NUMBER,
                          pcomentario1                     VARCHAR2,
                          pcomentario2                     VARCHAR2,
                          ppro1nombre                      VARCHAR2,
                          ppro1materiaprima1               NUMBER,
                          ppro1materiaprima2               NUMBER,
                          ppro1materiaprima3               NUMBER,
                          ppro1totalmp                     NUMBER,
                          ppro1sueldo1                     NUMBER,
                          ppro1sueldo2                     NUMBER,
                          ppro1totalsueldo                 NUMBER,
                          ppro1otroscostos                 NUMBER,
                          ppro1totalcostos                 NUMBER,
                          ppro1costounitario               NUMBER,
                          ppro1preciounitario              NUMBER,
                          ppro1unidadesvendidas            NUMBER,
                          ppro1ventasmensuales             NUMBER,
                          ppro1costosventasmensuales       NUMBER,
                          ppro1margenganancia              NUMBER,
                          ppro2nombre                      VARCHAR2,
                          ppro2materiaprima1               NUMBER,
                          ppro2materiaprima2               NUMBER,
                          ppro2materiaprima3               NUMBER,
                          ppro2totalmp                     NUMBER,
                          ppro2sueldo1                     NUMBER,
                          ppro2sueldo2                     NUMBER,
                          ppro2totalsueldo                 NUMBER,
                          ppro2otroscostos                 NUMBER,
                          ppro2totalcostos                 NUMBER,
                          ppro2costounitario               NUMBER,
                          ppro2preciounitario              NUMBER,
                          ppro2unidadesvendidas            NUMBER,
                          ppro2ventasmensuales             NUMBER,
                          ppro2costosventasmensuales       NUMBER,
                          ppro2margenganancia              NUMBER,
                          ppro3nombre                      VARCHAR2,
                          ppro3materiaprima1               NUMBER,
                          ppro3materiaprima2               NUMBER,
                          ppro3materiaprima3               NUMBER,
                          ppro3totalmp                     NUMBER,
                          ppro3sueldo1                     NUMBER,
                          ppro3sueldo2                     NUMBER,
                          ppro3totalsueldo                 NUMBER,
                          ppro3otroscostos                 NUMBER,
                          ppro3totalcostos                 NUMBER,
                          ppro3costounitario               NUMBER,
                          ppro3preciounitario              NUMBER,
                          ppro3unidadesvendidas            NUMBER,
                          ppro3ventasmensuales             NUMBER,
                          ppro3costosventasmensuales       NUMBER,
                          ppro3margenganancia              NUMBER,
                          pprootromateriaprima1            NUMBER,
                          pprootromateriaprima2            NUMBER,
                          pprootromateriaprima3            NUMBER,
                          pprootrototalmp                  NUMBER,
                          pprootrosueldo1                  NUMBER,
                          pprootrosueldo2                  NUMBER,
                          pprootrototalsueldo              NUMBER,
                          pprootrootroscostos              NUMBER,
                          pprootrototalcostos              NUMBER,
                          pprootrocostounitario            NUMBER,
                          pprootropreciounitario           NUMBER,
                          pprootrounidadesvendidas         NUMBER,
                          pprootroventasmensuales          NUMBER,
                          pprootrocostosventasmensuales    NUMBER,
                          pprootromargenganancia           NUMBER,
                          plinea1                          VARCHAR2,
                          ppreciounitario1                 NUMBER,
                          pcostounitario1                  NUMBER,
                          pmargendeganancia1               NUMBER,
                          punidadesvendidas1               NUMBER,
                          pventasmensuales1                NUMBER,
                          pcostoventas1                    NUMBER,
                          plinea2                          VARCHAR2,
                          ppreciounitario2                 NUMBER,
                          pcostounitario2                  NUMBER,
                          pmargendeganancia2               NUMBER,
                          punidadesvendidas2               NUMBER,
                          pventasmensuales2                NUMBER,
                          pcostoventas2                    NUMBER,
                          plinea3                          VARCHAR2,
                          ppreciounitario3                 NUMBER,
                          pcostounitario3                  NUMBER,
                          pmargendeganancia3               NUMBER,
                          punidadesvendidas3               NUMBER,
                          pventasmensuales3                NUMBER,
                          pcostoventas3                    NUMBER,
                          plineaot                         VARCHAR2,
                          ppreciounitarioot                NUMBER,
                          pcostounitarioot                 NUMBER,
                          pmargendegananciaot              NUMBER,
                          punidadesvendidasot              NUMBER,
                          pventasmensualesot               NUMBER,
                          pcostoventasot                   NUMBER,
                          ptipocredito                     VARCHAR2,
                          pgarantias                       VARCHAR2,
                          pvalorgarantia                   VARCHAR2,
                          pdescripciongarantia             VARCHAR2,
                          pprestamodescontar               VARCHAR2,
                          plinea4                          VARCHAR2,
                          ppreciounitario4                 NUMBER,
                          pcostounitario4                  NUMBER,
                          pmargendeganancia4               NUMBER,
                          punidadesvendidas4               NUMBER,
                          pventasmensuales4                NUMBER,
                          pcostoventas4                    NUMBER,
                          plinea5                          VARCHAR2,
                          ppreciounitario5                 NUMBER,
                          pcostounitario5                  NUMBER,
                          pmargendeganancia5               NUMBER,
                          punidadesvendidas5               NUMBER,
                          pventasmensuales5                NUMBER,
                          pcostoventas5                    NUMBER,
                          plinea6                          VARCHAR2,
                          ppreciounitario6                 NUMBER,
                          pcostounitario6                  NUMBER,
                          pmargendeganancia6               NUMBER,
                          punidadesvendidas6               NUMBER,
                          pventasmensuales6                NUMBER,
                          pcostoventas6                    NUMBER,
                          plinea7                          VARCHAR2,
                          ppreciounitario7                 NUMBER,
                          pcostounitario7                  NUMBER,
                          pmargendeganancia7               NUMBER,
                          punidadesvendidas7               NUMBER,
                          pventasmensuales7                NUMBER,
                          pcostoventas7                    NUMBER,
                          plinea8                          VARCHAR2,
                          ppreciounitario8                 NUMBER,
                          pcostounitario8                  NUMBER,
                          pmargendeganancia8               NUMBER,
                          punidadesvendidas8               NUMBER,
                          pventasmensuales8                NUMBER,
                          pcostoventas8                    NUMBER,
                          pcomentario                      VARCHAR2,
                          pidoficial                       VARCHAR2,
                          pfecharegistro                   DATE,
                          pfechafija                       VARCHAR2,
                          pidestado                        VARCHAR2,
                          pmensaje                         VARCHAR2,
                          pnosubida                        VARCHAR2,
                          pidgrupo                         VARCHAR2,
                          pimpreso                         VARCHAR2)
        RETURN BOOLEAN
    IS
    BEGIN
        INSERT INTO pr.tempfec (id_tempfec,
                                nomarchivo,
                                procesado,
                                idevaluacioncrediticia,
                                tipodocumentoidentidad,
                                documentoidentidad,
                                nombrecliente,
                                numerosolicitud,
                                primera_ref_vecinos,
                                segunda_ref_vecinos,
                                ambientefamiliar,
                                dependientes,
                                edad,
                                estadosaludfamilia,
                                ingresos,
                                otrosingresos,
                                experiencia_neg,
                                horas_neg,
                                localpropio,
                                tiempoempleo,
                                ubicacionnegocio,
                                llevaregistro,
                                mejorasnegocio,
                                clientesfrecuentes,
                                nivelcompetencia,
                                ventasdiarias_promedio,
                                diastrabajados,
                                ventasmensualesdeclaradas,
                                comprassemanalesdeclaradas,
                                comprasmensualesdeclaradas,
                                margendeclarado,
                                montomesalto,
                                montomesmedio,
                                montomesbajo,
                                ventasmensuales,
                                costoventamensual,
                                margenganancia,
                                desde,
                                hasta,
                                ventas_ingresos,
                                costoventas,
                                utilidadbruta,
                                sueldo,
                                servicio,
                                alquiler,
                                transporte_combs,
                                pagointereses,
                                otros,
                                totalcostooperacional,
                                utilidadneta,
                                otrosingresos_operacionales,
                                alimentacion,
                                vivienda,
                                vestido,
                                transporte,
                                servicios,
                                medicinas,
                                educacion,
                                deudasfamiliares,
                                otros_gastos,
                                totalgastos_familiares,
                                excedentefamiliar,
                                fechabalancegeneral,
                                efectivo_cajabanco,
                                cuentaxcobrar,
                                inventario_prod_tem,
                                inventario_prod_proc,
                                inventario_materiaprima,
                                mercancia,
                                anticipo_proveedores,
                                fecha_balancegeneral_al,
                                mueble_vehiculo,
                                inmuebles,
                                total_activofamiliar,
                                deudacomercial,
                                deudabancaria,
                                total_pasivofamiliar,
                                patrio_fam_balgen,
                                maquinaria_mueblesequipos,
                                localnegocio,
                                obligacionesfinancieras,
                                cuentapagarprovedor,
                                cuentapagarvarias,
                                total_activocorriente,
                                total_activofijo,
                                total_activos1,
                                total_pasivocorrientes,
                                total_pasivo_lp,
                                total_pasivo,
                                patrimonio,
                                total_pasivopatrimonio,
                                capital_trabajo,
                                pasivo_patrimonio,
                                activocorte_pascte,
                                otrosingresos_excedente,
                                cuotarecomendada_excedfam,
                                totalpasivo_patrimonio,
                                utilidadneta_patrimonio,
                                utilidadneta_totalactivos1,
                                utilidadneta_ventas,
                                cuentasxcobrar_ventas,
                                costoventa_inventario,
                                montorecomendado,
                                gastoslegales,
                                moneda,
                                plazo,
                                tasa,
                                frecuencia,
                                cuota,
                                destinocredito,
                                especifiquedestino,
                                estadosolicitud,
                                actividadeconomica,
                                actividadeconomicadinrap,
                                margenbrutoestandar,
                                gastosoperacionalesestandar,
                                alto_indicadores,
                                bajo_indicadores,
                                lunes,
                                martes,
                                miercoles,
                                jueves,
                                viernes,
                                sabado,
                                domingo,
                                total_ventasaltas,
                                total_ventasbajas,
                                total_ventassemanales,
                                total_ventasmensuales,
                                margenbrutodeclarado,
                                alimentacion_gastos,
                                vivienda_gastos,
                                educacion_gastos,
                                salud_gastos,
                                transporte_gastos,
                                vestido_gastos,
                                pagodeudas_gastos,
                                otros_gastos_familiares,
                                total_gastos,
                                ventas_gastos,
                                costosventas_gastos,
                                gastosoperativos,
                                otros_ingresos_gastos,
                                total_gastos_familiares,
                                excedentefamiliar_gastos,
                                cuotasolicitada,
                                relcuotasolicitada_excfam,
                                monto_recomendacion,
                                moneda_recomendacion,
                                plazo_recomendacion,
                                tasa_recomendacion,
                                frecuencia_recomendacion,
                                cuota_recomendacion,
                                estadosolicitud_recomendacion,
                                cuotarecomendada_excedfamiliar,
                                ventasevalanterior,
                                actual_ventas,
                                variacionventas,
                                comentario1,
                                comentario2,
                                pro1nombre,
                                pro1materiaprima1,
                                pro1materiaprima2,
                                pro1materiaprima3,
                                pro1totalmp,
                                pro1sueldo1,
                                pro1sueldo2,
                                pro1totalsueldo,
                                pro1otroscostos,
                                pro1totalcostos,
                                pro1costounitario,
                                pro1preciounitario,
                                pro1unidadesvendidas,
                                pro1ventasmensuales,
                                pro1costosventasmensuales,
                                pro1margenganancia,
                                pro2nombre,
                                pro2materiaprima1,
                                pro2materiaprima2,
                                pro2materiaprima3,
                                pro2totalmp,
                                pro2sueldo1,
                                pro2sueldo2,
                                pro2totalsueldo,
                                pro2otroscostos,
                                pro2totalcostos,
                                pro2costounitario,
                                pro2preciounitario,
                                pro2unidadesvendidas,
                                pro2ventasmensuales,
                                pro2costosventasmensuales,
                                pro2margenganancia,
                                pro3nombre,
                                pro3materiaprima1,
                                pro3materiaprima2,
                                pro3materiaprima3,
                                pro3totalmp,
                                pro3sueldo1,
                                pro3sueldo2,
                                pro3totalsueldo,
                                pro3otroscostos,
                                pro3totalcostos,
                                pro3costounitario,
                                pro3preciounitario,
                                pro3unidadesvendidas,
                                pro3ventasmensuales,
                                pro3costosventasmensuales,
                                pro3margenganancia,
                                prootromateriaprima1,
                                prootromateriaprima2,
                                prootromateriaprima3,
                                prootrototalmp,
                                prootrosueldo1,
                                prootrosueldo2,
                                prootrototalsueldo,
                                prootrootroscostos,
                                prootrototalcostos,
                                prootrocostounitario,
                                prootropreciounitario,
                                prootrounidadesvendidas,
                                prootroventasmensuales,
                                prootrocostosventasmensuales,
                                prootromargenganancia,
                                linea1,
                                preciounitario1,
                                costounitario1,
                                margendeganancia1,
                                unidadesvendidas1,
                                ventasmensuales1,
                                costoventas1,
                                linea2,
                                preciounitario2,
                                costounitario2,
                                margendeganancia2,
                                unidadesvendidas2,
                                ventasmensuales2,
                                costoventas2,
                                linea3,
                                preciounitario3,
                                costounitario3,
                                margendeganancia3,
                                unidadesvendidas3,
                                ventasmensuales3,
                                costoventas3,
                                lineaot,
                                preciounitarioot,
                                costounitarioot,
                                margendegananciaot,
                                unidadesvendidasot,
                                ventasmensualesot,
                                costoventasot,
                                tipocredito,
                                garantias,
                                valorgarantia,
                                descripciongarantia,
                                prestamodescontar,
                                linea4,
                                preciounitario4,
                                costounitario4,
                                margendeganancia4,
                                unidadesvendidas4,
                                ventasmensuales4,
                                costoventas4,
                                linea5,
                                preciounitario5,
                                costounitario5,
                                margendeganancia5,
                                unidadesvendidas5,
                                ventasmensuales5,
                                costoventas5,
                                linea6,
                                preciounitario6,
                                costounitario6,
                                margendeganancia6,
                                unidadesvendidas6,
                                ventasmensuales6,
                                costoventas6,
                                linea7,
                                preciounitario7,
                                costounitario7,
                                margendeganancia7,
                                unidadesvendidas7,
                                ventasmensuales7,
                                costoventas7,
                                linea8,
                                preciounitario8,
                                costounitario8,
                                margendeganancia8,
                                unidadesvendidas8,
                                ventasmensuales8,
                                costoventas8,
                                comentario,
                                idoficial,
                                fecharegistro,
                                fechafija,
                                idestado,
                                mensaje,
                                nosubida,
                                idgrupo,
                                impreso)
             VALUES (pid_tempfec,
                     pnomarchivo,
                     pprocesado,
                     pidevaluacioncrediticia,
                     ptipodocumentoidentidad,
                     pdocumentoidentidad,
                     pnombrecliente,
                     pnumerosolicitud,
                     pprimera_ref_vecinos,
                     psegunda_ref_vecinos,
                     pambientefamiliar,
                     pdependientes,
                     pedad,
                     pestadosaludfamilia,
                     pingresos,
                     potrosingresos,
                     pexperiencia_neg,
                     phoras_neg,
                     plocalpropio,
                     ptiempoempleo,
                     pubicacionnegocio,
                     pllevaregistro,
                     pmejorasnegocio,
                     pclientesfrecuentes,
                     pnivelcompetencia,
                     pventasdiarias_promedio,
                     pdiastrabajados,
                     pventasmensualesdeclaradas,
                     pcomprassemanalesdeclaradas,
                     pcomprasmensualesdeclaradas,
                     pmargendeclarado,
                     pmontomesalto,
                     pmontomesmedio,
                     pmontomesbajo,
                     pventasmensuales,
                     pcostoventamensual,
                     pmargenganancia,
                     pdesde,
                     phasta,
                     pventas_ingresos,
                     pcostoventas,
                     putilidadbruta,
                     psueldo,
                     pservicio,
                     palquiler,
                     ptransporte_combs,
                     ppagointereses,
                     potros,
                     ptotalcostooperacional,
                     putilidadneta,
                     potrosingresos_operacionales,
                     palimentacion,
                     pvivienda,
                     pvestido,
                     ptransporte,
                     pservicios,
                     pmedicinas,
                     peducacion,
                     pdeudasfamiliares,
                     potros_gastos,
                     ptotalgastos_familiares,
                     pexcedentefamiliar,
                     pfechabalancegeneral,
                     pefectivo_cajabanco,
                     pcuentaxcobrar,
                     pinventario_prod_tem,
                     pinventario_prod_proc,
                     pinventario_materiaprima,
                     pmercancia,
                     panticipo_proveedores,
                     pfecha_balancegeneral_al,
                     pmueble_vehiculo,
                     pinmuebles,
                     ptotal_activofamiliar,
                     pdeudacomercial,
                     pdeudabancaria,
                     ptotal_pasivofamiliar,
                     ppatrio_fam_balgen,
                     pmaquinaria_mueblesequipos,
                     plocalnegocio,
                     pobligacionesfinancieras,
                     pcuentapagarprovedor,
                     pcuentapagarvarias,
                     ptotal_activocorriente,
                     ptotal_activofijo,
                     ptotal_activos1,
                     ptotal_pasivocorrientes,
                     ptotal_pasivo_lp,
                     ptotal_pasivo,
                     ppatrimonio,
                     ptotal_pasivopatrimonio,
                     pcapital_trabajo,
                     ppasivo_patrimonio,
                     pactivocorte_pascte,
                     potrosingresos_excedente,
                     pcuotarecomendada_excedfam,
                     ptotalpasivo_patrimonio,
                     putilidadneta_patrimonio,
                     putilidadneta_totalactivos1,
                     putilidadneta_ventas,
                     pcuentasxcobrar_ventas,
                     pcostoventa_inventario,
                     pmontorecomendado,
                     pgastoslegales,
                     pmoneda,
                     pplazo,
                     ptasa,
                     pfrecuencia,
                     pcuota,
                     pdestinocredito,
                     pespecifiquedestino,
                     pestadosolicitud,
                     pactividadeconomica,
                     pactividadeconomicadinrap,
                     pmargenbrutoestandar,
                     pgastosoperacionalesestandar,
                     palto_indicadores,
                     pbajo_indicadores,
                     plunes,
                     pmartes,
                     pmiercoles,
                     pjueves,
                     pviernes,
                     psabado,
                     pdomingo,
                     ptotal_ventasaltas,
                     ptotal_ventasbajas,
                     ptotal_ventassemanales,
                     ptotal_ventasmensuales,
                     pmargenbrutodeclarado,
                     palimentacion_gastos,
                     pvivienda_gastos,
                     peducacion_gastos,
                     psalud_gastos,
                     ptransporte_gastos,
                     pvestido_gastos,
                     ppagodeudas_gastos,
                     potros_gastos_familiares,
                     ptotal_gastos,
                     pventas_gastos,
                     pcostosventas_gastos,
                     pgastosoperativos,
                     potros_ingresos_gastos,
                     ptotal_gastos_familiares,
                     pexcedentefamiliar_gastos,
                     pcuotasolicitada,
                     prelcuotasolicitada_excfam,
                     pmonto_recomendacion,
                     pmoneda_recomendacion,
                     pplazo_recomendacion,
                     ptasa_recomendacion,
                     pfrecuencia_recomendacion,
                     pcuota_recomendacion,
                     pestadosolicitud_recomendacion,
                     pcuotarecomendada_excfamiliar,
                     pventasevalanterior,
                     pactual_ventas,
                     pvariacionventas,
                     pcomentario1,
                     pcomentario2,
                     ppro1nombre,
                     ppro1materiaprima1,
                     ppro1materiaprima2,
                     ppro1materiaprima3,
                     ppro1totalmp,
                     ppro1sueldo1,
                     ppro1sueldo2,
                     ppro1totalsueldo,
                     ppro1otroscostos,
                     ppro1totalcostos,
                     ppro1costounitario,
                     ppro1preciounitario,
                     ppro1unidadesvendidas,
                     ppro1ventasmensuales,
                     ppro1costosventasmensuales,
                     ppro1margenganancia,
                     ppro2nombre,
                     ppro2materiaprima1,
                     ppro2materiaprima2,
                     ppro2materiaprima3,
                     ppro2totalmp,
                     ppro2sueldo1,
                     ppro2sueldo2,
                     ppro2totalsueldo,
                     ppro2otroscostos,
                     ppro2totalcostos,
                     ppro2costounitario,
                     ppro2preciounitario,
                     ppro2unidadesvendidas,
                     ppro2ventasmensuales,
                     ppro2costosventasmensuales,
                     ppro2margenganancia,
                     ppro3nombre,
                     ppro3materiaprima1,
                     ppro3materiaprima2,
                     ppro3materiaprima3,
                     ppro3totalmp,
                     ppro3sueldo1,
                     ppro3sueldo2,
                     ppro3totalsueldo,
                     ppro3otroscostos,
                     ppro3totalcostos,
                     ppro3costounitario,
                     ppro3preciounitario,
                     ppro3unidadesvendidas,
                     ppro3ventasmensuales,
                     ppro3costosventasmensuales,
                     ppro3margenganancia,
                     pprootromateriaprima1,
                     pprootromateriaprima2,
                     pprootromateriaprima3,
                     pprootrototalmp,
                     pprootrosueldo1,
                     pprootrosueldo2,
                     pprootrototalsueldo,
                     pprootrootroscostos,
                     pprootrototalcostos,
                     pprootrocostounitario,
                     pprootropreciounitario,
                     pprootrounidadesvendidas,
                     pprootroventasmensuales,
                     pprootrocostosventasmensuales,
                     pprootromargenganancia,
                     plinea1,
                     ppreciounitario1,
                     pcostounitario1,
                     pmargendeganancia1,
                     punidadesvendidas1,
                     pventasmensuales1,
                     pcostoventas1,
                     plinea2,
                     ppreciounitario2,
                     pcostounitario2,
                     pmargendeganancia2,
                     punidadesvendidas2,
                     pventasmensuales2,
                     pcostoventas2,
                     plinea3,
                     ppreciounitario3,
                     pcostounitario3,
                     pmargendeganancia3,
                     punidadesvendidas3,
                     pventasmensuales3,
                     pcostoventas3,
                     plineaot,
                     ppreciounitarioot,
                     pcostounitarioot,
                     pmargendegananciaot,
                     punidadesvendidasot,
                     pventasmensualesot,
                     pcostoventasot,
                     ptipocredito,
                     pgarantias,
                     pvalorgarantia,
                     pdescripciongarantia,
                     pprestamodescontar,
                     plinea4,
                     ppreciounitario4,
                     pcostounitario4,
                     pmargendeganancia4,
                     punidadesvendidas4,
                     pventasmensuales4,
                     pcostoventas4,
                     plinea5,
                     ppreciounitario5,
                     pcostounitario5,
                     pmargendeganancia5,
                     punidadesvendidas5,
                     pventasmensuales5,
                     pcostoventas5,
                     plinea6,
                     ppreciounitario6,
                     pcostounitario6,
                     pmargendeganancia6,
                     punidadesvendidas6,
                     pventasmensuales6,
                     pcostoventas6,
                     plinea7,
                     ppreciounitario7,
                     pcostounitario7,
                     pmargendeganancia7,
                     punidadesvendidas7,
                     pventasmensuales7,
                     pcostoventas7,
                     plinea8,
                     ppreciounitario8,
                     pcostounitario8,
                     pmargendeganancia8,
                     punidadesvendidas8,
                     pventasmensuales8,
                     pcostoventas8,
                     pcomentario,
                     pidoficial,
                     pfecharegistro,
                     pfechafija,
                     pidestado,
                     pmensaje,
                     pnosubida,
                     pidgrupo,
                     pimpreso);

        RETURN TRUE;
    EXCEPTION
        WHEN OTHERS
        THEN
            p_depura ('sqlerrm ' || SQLERRM || ' Linea ' || $$plsql_line);
            RETURN FALSE;
    END;

    PROCEDURE crea_fec_solicitud (pcodigo_empresa   IN     NUMBER,
                                  pid_represtamo    IN     NUMBER,
                                  pmensaje             OUT VARCHAR2,
                                  perror               OUT VARCHAR2)
    IS
        presultado          VARCHAR2 (1000);



        CURSOR c_data (codigo_empresap NUMBER, id_represtamop NUMBER)
        IS
            SELECT ROWID,
                   codigo_empresa,
                   id_represtamo,
                   nombres,                                                 --
                   apellidos,                                               --
                   identificacion,
                   fec_nacimiento,
                   sexo,
                   nacionalidad,
                   estado_civil,
                   telefono_celular,
                   telefono_residencia,
                   telefono_trabajo,
                   email,
                   cod_direccion,
                   tip_direccion,
                   direccion,
                   plazo,
                   opcion_rechazo,
                   no_credito,
                   estado,
                   adicionado_por,
                   fecha_adicion,
                   modificado_por,
                   fecha_modificacion,
                   codigo_agencia,
                   codigo_oficial,                                          --
                   codigo_actividad,                                        --
                   margen_bruto_std,                                        --
                   gasto_operativo_std,                                     --
                   ventas_mensual,                                          --
                   costo_ventas,                                            --
                   gasto_operativo,                                         --
                   otros_ingresos,                                          --
                   gastos_familiares,                                       --
                   excedente_familiares,                                    --
                   rel_cuota_exced_fam,
                   id_tempfud,
                   nomarchivo,
                   id_tempfec
              FROM pr.pr_solicitud_represtamo
             WHERE     codigo_empresa = codigo_empresap
                   AND id_represtamo = id_represtamop;           --2208203489;

        vrow                c_data%ROWTYPE;


        CURSOR c_fec (documentoidentidadp VARCHAR2)
        IS
            SELECT *
              FROM tempfec b
             WHERE     documentoidentidad = documentoidentidadp
                   AND id_tempfec =
                       (SELECT MAX (id_tempfec)
                          FROM tempfec a
                         WHERE a.documentoidentidad = b.documentoidentidad);



        vfecrow             c_fec%ROWTYPE;

        vid_tempfec         NUMBER;
        vnombrecompleto     VARCHAR2 (300);
        vfrecuencia         VARCHAR2 (5) := '05';
        vfecha_registro     DATE := SYSDATE;
        vcuota_solicitada   NUMBER := 0;

        vmensajefec         VARCHAR2 (300);
    BEGIN
        OPEN c_data (pcodigo_empresa, pid_represtamo);

        FETCH c_data INTO vrow;

        IF c_data%FOUND                                 --Solicitud encontrada
        THEN
            IF vrow.id_tempfec IS NOT NULL
            THEN
                pmensaje :=
                       'Solicitud:  '
                    || pid_represtamo
                    || ' Ya tiene id_tempfec: '
                    || vrow.id_tempfec;
                RETURN;
            END IF;


            vid_tempfec := pa.sq_tempfec.NEXTVAL;

            ---- DBMS_OUTPUT.PUT_LINE('vid_tempfec '||vid_tempfec);

            OPEN c_fec (vrow.identificacion);

            FETCH c_fec INTO vfecrow;

            IF c_fec%FOUND
            THEN
                vnombrecompleto := vrow.nombres || ' ' || vrow.apellidos;

                BEGIN
                    pkg_solicitud_credito.pcrearfec (
                        pidtempfec                      => vid_tempfec,
                        pnomarchivo                     => vrow.nomarchivo,
                        pidevaluacioncrediticia         =>
                            vfecrow.idevaluacioncrediticia,
                        ptipodocumentoidentidad         =>
                            vfecrow.tipodocumentoidentidad,
                        pdocumentoidentidad             => vfecrow.documentoidentidad,
                        pnombrecliente                  => vnombrecompleto,
                        pnumerosolicitud                => vfecrow.numerosolicitud,
                        pmontorecomendado               => vfecrow.montorecomendado,
                        pfrecuencia                     => vfrecuencia,
                        pplazo                          => vfecrow.plazo,
                        ppro1ventasmensuales            => vfecrow.pro1ventasmensuales,
                        ppro2ventasmensuales            => vfecrow.pro2ventasmensuales,
                        ppro3ventasmensuales            => vfecrow.pro3ventasmensuales,
                        pprootroventasmensuales         =>
                            vfecrow.prootroventasmensuales,
                        pventasmensuales1               => vrow.ventas_mensual, --vFecRow.ventasmensuales1,
                        pventasmensuales2               => vfecrow.ventasmensuales2,
                        pventasmensuales3               => vfecrow.ventasmensuales3,
                        pventasmensuales4               => vfecrow.ventasmensuales4,
                        pventasmensuales5               => vfecrow.ventasmensuales5,
                        pventasmensuales6               => vfecrow.ventasmensuales6,
                        pventasmensuales7               => vfecrow.ventasmensuales7,
                        pventasmensuales8               => vfecrow.ventasmensuales8,
                        pventasmensualesot              => vfecrow.ventasmensualesot,
                        pventas_ingresos                => vfecrow.ventas_ingresos,
                        ppro1costosventasmensuales      =>
                            vfecrow.pro1costosventasmensuales,
                        ppro2costosventasmensuales      =>
                            vfecrow.pro2costosventasmensuales,
                        ppro3costosventasmensuales      =>
                            vfecrow.pro3costosventasmensuales,
                        pprootrocostosventasmensuales   => vrow.costo_ventas, --vFecRow.costoventas1,
                        pcostoventas1                   =>
                            vfecrow.costoventas1,
                        pcostoventas2                   =>
                            vfecrow.costoventas1,
                        pcostoventas3                   =>
                            vfecrow.costoventas3,
                        pcostoventas4                   =>
                            vfecrow.costoventas4,
                        pcostoventas5                   =>
                            vfecrow.costoventas5,
                        pcostoventas6                   =>
                            vfecrow.costoventas6,
                        pcostoventas7                   =>
                            vfecrow.costoventas7,
                        pcostoventas8                   =>
                            vfecrow.costoventas8,
                        pcostoventasot                  =>
                            vfecrow.costoventasot,
                        pcostoventas                    => vfecrow.costoventas,
                        psueldo                         => vfecrow.sueldo,
                        pservicio                       => vfecrow.servicio,
                        palquiler                       => vfecrow.alquiler,
                        ptransporte_combs               =>
                            vfecrow.transporte_combs,
                        ppagointereses                  =>
                            vfecrow.pagointereses,
                        potrosingresos_operacionales    => vrow.otros_ingresos, --       vFecRow.otrosingresos_operacionales,
                        palimentacion                   =>
                            vfecrow.alimentacion,
                        pvivienda                       => vfecrow.vivienda,
                        pvestido                        => vfecrow.vestido,
                        ptransporte                     => vfecrow.transporte,
                        pservicios                      => vfecrow.servicios,
                        pmedicinas                      => vfecrow.medicinas,
                        peducacion                      => vfecrow.educacion,
                        pdeudasfamiliares               =>
                            vfecrow.deudasfamiliares,
                        potros_gastos                   =>
                            vfecrow.otros_gastos,
                        ptotalgastos_familiares         =>
                            vrow.gastos_familiares, -- vFecRow.Totalgastos_familiares,
                        pexcedentefamiliar              =>
                            vrow.excedente_familiares, --vFecRow.Excedentefamiliar,
                        potros                          => vfecrow.otros,
                        pmaquinaria_mueblesequipos      =>
                            vfecrow.maquinaria_mueblesequipos,
                        pefectivo_cajabanco             =>
                            vfecrow.efectivo_cajabanco,
                        pcuentaxcobrar                  =>
                            vfecrow.cuentaxcobrar,
                        pinventario_prod_tem            =>
                            vfecrow.inventario_prod_tem,
                        pinventario_prod_proc           =>
                            vfecrow.inventario_prod_proc,
                        pinventario_materiaprima        =>
                            vfecrow.inventario_materiaprima,
                        pmercancia                      => vfecrow.mercancia,
                        panticipo_proveedores           =>
                            vfecrow.anticipo_proveedores,
                        plocalnegocio                   =>
                            vfecrow.localnegocio,
                        pobligacionesfinancieras        =>
                            vfecrow.obligacionesfinancieras,
                        ptotal_pasivo_lp                =>
                            vfecrow.total_pasivo_lp,
                        pmueble_vehiculo                =>
                            vfecrow.mueble_vehiculo,
                        pdeudacomercial                 =>
                            vfecrow.deudacomercial,
                        ptasa                           => vfecrow.tasa,
                        pcuota                          => vfecrow.cuota,
                        pcuentapagarprovedor            =>
                            vfecrow.cuentapagarprovedor,
                        pcuentapagarvarias              =>
                            vfecrow.cuentapagarvarias,
                        pinmuebles                      => vfecrow.inmuebles,
                        ptotal_activofamiliar           =>
                            vfecrow.total_activofamiliar,
                        pdeudabancaria                  =>
                            vfecrow.deudabancaria,
                        ptotal_pasivofamiliar           =>
                            vfecrow.total_pasivofamiliar,
                        ppatrio_fam_balgen              =>
                            vfecrow.patrio_fam_balgen,
                        ptotal_activocorriente          =>
                            vfecrow.total_activocorriente,
                        ptotal_activofijo               =>
                            vfecrow.total_activofijo,
                        ptotal_activos1                 =>
                            vfecrow.total_activos1,
                        ptotal_pasivocorrientes         =>
                            vfecrow.total_pasivocorrientes,
                        ptotal_pasivo                   =>
                            vfecrow.total_pasivo,
                        ptotal_pasivopatrimonio         =>
                            vfecrow.total_pasivopatrimonio,
                        ppasivo_patrimonio              =>
                            vfecrow.pasivo_patrimonio,
                        ppatrimonio                     => vfecrow.patrimonio,
                        pactivocorte_pascte             =>
                            vfecrow.activocorte_pascte,
                        potrosingresos_excedente        =>
                            vfecrow.otrosingresos_excedente,
                        pcuotarecomendada_excedfam      =>
                            vfecrow.cuotarecomendada_excedfam,
                        ptotalpasivo_patrimonio         =>
                            vfecrow.totalpasivo_patrimonio,
                        putilidadneta_patrimonio        =>
                            vfecrow.utilidadneta_patrimonio,
                        putilidadneta_totalactivos1     =>
                            vfecrow.utilidadneta_totalactivos1,
                        putilidadneta_ventas            =>
                            vfecrow.utilidadneta_ventas,
                        pcuentasxcobrar_ventas          =>
                            vfecrow.cuentasxcobrar_ventas,
                        pcostoventa_inventario          =>
                            vfecrow.costoventa_inventario,
                        pgastoslegales                  =>
                            vfecrow.gastoslegales,
                        pmoneda                         => vfecrow.moneda,
                        pcapital_trabajo                =>
                            vfecrow.capital_trabajo,
                        pfechabalancegeneral            =>
                            vfecrow.fechabalancegeneral,
                        pdesde                          => vfecrow.desde,
                        phasta                          => vfecrow.hasta,
                        ptotalcostooperacional          =>
                            vfecrow.totalcostooperacional,
                        putilidadneta                   =>
                            vfecrow.utilidadneta,
                        pventasdiarias_promedio         =>
                            vfecrow.ventasdiarias_promedio,
                        pdiastrabajados                 =>
                            vfecrow.diastrabajados,
                        pcomprassemanalesdeclaradas     =>
                            vfecrow.comprassemanalesdeclaradas,
                        pventasmensualesdeclaradas      =>
                            vfecrow.ventasmensualesdeclaradas,
                        pmargendeclarado                =>
                            vfecrow.margendeclarado,
                        pmontomesalto                   =>
                            vfecrow.montomesalto,
                        pmontomesmedio                  =>
                            vfecrow.montomesmedio,
                        pcomprasmensualesdeclaradas     =>
                            vfecrow.comprasmensualesdeclaradas,
                        pmontomesbajo                   =>
                            vfecrow.montomesbajo,
                        pventasmensuales                =>
                            vfecrow.ventasmensuales,
                        pcostoventamensual              =>
                            vfecrow.costoventamensual,
                        putilidadbruta                  =>
                            vfecrow.utilidadbruta,
                        pmargenganancia                 =>
                            vfecrow.margenganancia,
                        pprimera_ref_vecinos            =>
                            vfecrow.primera_ref_vecinos,
                        psegunda_ref_vecinos            =>
                            vfecrow.segunda_ref_vecinos,
                        pambientefamiliar               =>
                            vfecrow.ambientefamiliar,
                        pdependientes                   =>
                            vfecrow.dependientes,
                        pedad                           => vfecrow.edad,
                        pestadosaludfamilia             =>
                            vfecrow.estadosaludfamilia,
                        pingresos                       => vfecrow.ingresos,
                        potrosingresos                  =>
                            vfecrow.otrosingresos,
                        pexperiencia_neg                =>
                            vfecrow.experiencia_neg,
                        phoras_neg                      => vfecrow.horas_neg,
                        plocalpropio                    => vfecrow.localpropio,
                        ptiempoempleo                   =>
                            vfecrow.tiempoempleo,
                        pubicacionnegocio               =>
                            vfecrow.ubicacionnegocio,
                        pllevaregistro                  =>
                            vfecrow.llevaregistro,
                        pmejorasnegocio                 =>
                            vfecrow.mejorasnegocio,
                        pclientesfrecuentes             =>
                            vfecrow.clientesfrecuentes,
                        pnivelcompetencia               =>
                            vfecrow.nivelcompetencia,
                        pfecha_balancegeneral_al        =>
                            vfecrow.fecha_balancegeneral_al,
                        pdestinocredito                 =>
                            vfecrow.destinocredito,
                        pespecifiquedestino             =>
                            vfecrow.especifiquedestino,
                        pestadosolicitud                =>
                            vfecrow.estadosolicitud,
                        pactividadeconomica             =>
                            vrow.codigo_actividad, -- vFecRow.ACTIVIDADECONOMICA,
                        pactividadeconomicadinrap       =>
                            vfecrow.actividadeconomicadinrap,
                        pmargenbrutoestandar            =>
                            vrow.margen_bruto_std, --vFecRow.MARGENBRUTOESTANDAR,
                        pgastosoperacionalesestandar    =>
                            vrow.gasto_operativo_std, -- vFecRow.GASTOSOPERACIONALESESTANDAR,
                        palto_indicadores               =>
                            vfecrow.alto_indicadores,
                        pbajo_indicadores               =>
                            vfecrow.bajo_indicadores,
                        plunes                          => vfecrow.lunes,
                        pmartes                         => vfecrow.martes,
                        pmiercoles                      => vfecrow.miercoles,
                        pjueves                         => vfecrow.jueves,
                        pviernes                        => vfecrow.viernes,
                        psabado                         => vfecrow.sabado,
                        pdomingo                        => vfecrow.domingo,
                        ptotal_ventasaltas              =>
                            vfecrow.total_ventasaltas,
                        ptotal_ventasbajas              =>
                            vfecrow.total_ventasbajas,
                        ptotal_ventassemanales          =>
                            vfecrow.total_ventassemanales,
                        ptotal_ventasmensuales          =>
                            vfecrow.total_ventasmensuales,
                        pmargenbrutodeclarado           =>
                            vfecrow.margenbrutodeclarado,
                        palimentacion_gastos            =>
                            vfecrow.alimentacion_gastos,
                        pvivienda_gastos                =>
                            vfecrow.vivienda_gastos,
                        peducacion_gastos               =>
                            vfecrow.educacion_gastos,
                        psalud_gastos                   =>
                            vfecrow.salud_gastos,
                        ptransporte_gastos              =>
                            vfecrow.transporte_gastos,
                        pvestido_gastos                 =>
                            vfecrow.vestido_gastos,
                        ppagodeudas_gastos              =>
                            vfecrow.pagodeudas_gastos,
                        potros_gastos_familiares        =>
                            vfecrow.otros_gastos_familiares,
                        ptotal_gastos                   =>
                            vfecrow.total_gastos,
                        pventas_gastos                  =>
                            vfecrow.ventas_gastos,
                        pcostosventas_gastos            =>
                            vfecrow.costosventas_gastos,
                        pgastosoperativos               =>
                            vrow.gasto_operativo, --  vFecRow.GASTOSOPERATIVOS,
                        potros_ingresos_gastos          =>
                            vfecrow.otros_ingresos_gastos,
                        ptotal_gastos_familiares        =>
                            vfecrow.total_gastos_familiares,
                        pexcedentefamiliar_gastos       =>
                            vfecrow.excedentefamiliar_gastos,
                        pcuotasolicitada                => vcuota_solicitada, --vFecRow.CUOTASOLICITADA,
                        prelcuotasolicitada_excfam      =>
                            vrow.rel_cuota_exced_fam, --  vFecRow.RELCUOTASOLICITADA_EXCFAM,
                        pmonto_recomendacion            =>
                            vfecrow.monto_recomendacion,
                        pmoneda_recomendacion           =>
                            vfecrow.moneda_recomendacion,
                        pplazo_recomendacion            =>
                            vfecrow.plazo_recomendacion,
                        ptasa_recomendacion             =>
                            vfecrow.tasa_recomendacion,
                        pfrecuencia_recomendacion       =>
                            vfecrow.frecuencia_recomendacion,
                        pcuota_recomendacion            =>
                            vfecrow.cuota_recomendacion,
                        pestadosolicitud_recomendacion   =>
                            vfecrow.estadosolicitud_recomendacion,
                        pcuotarecomendada_excfamiliar   =>
                            vfecrow.cuotarecomendada_excedfamiliar,
                        pventasevalanterior             =>
                            vfecrow.ventasevalanterior,
                        pactual_ventas                  =>
                            vfecrow.actual_ventas,
                        pvariacionventas                =>
                            vfecrow.variacionventas,
                        pcomentario1                    => vfecrow.comentario1,
                        pcomentario2                    => vfecrow.comentario2,
                        ppro1nombre                     => vfecrow.pro1nombre,
                        ppro1materiaprima1              =>
                            vfecrow.pro1materiaprima1,
                        ppro1materiaprima2              =>
                            vfecrow.pro1materiaprima2,
                        ppro1materiaprima3              =>
                            vfecrow.pro1materiaprima3,
                        ppro1totalmp                    => vfecrow.pro1totalmp,
                        ppro1sueldo1                    => vfecrow.pro1sueldo1,
                        ppro1sueldo2                    => vfecrow.pro1sueldo2,
                        ppro1totalsueldo                =>
                            vfecrow.pro1totalsueldo,
                        ppro1otroscostos                =>
                            vfecrow.pro1otroscostos,
                        ppro1totalcostos                =>
                            vfecrow.pro1totalcostos,
                        ppro1costounitario              =>
                            vfecrow.pro1costounitario,
                        ppro1preciounitario             =>
                            vfecrow.pro1preciounitario,
                        ppro1unidadesvendidas           =>
                            vfecrow.pro1unidadesvendidas,
                        ppro1margenganancia             =>
                            vfecrow.pro1margenganancia,
                        ppro2nombre                     => vfecrow.pro2nombre,
                        ppro2materiaprima1              =>
                            vfecrow.pro2materiaprima1,
                        ppro2materiaprima2              =>
                            vfecrow.pro2materiaprima2,
                        ppro2materiaprima3              =>
                            vfecrow.pro2materiaprima3,
                        ppro2totalmp                    => vfecrow.pro2totalmp,
                        ppro2sueldo1                    => vfecrow.pro2sueldo1,
                        ppro2sueldo2                    => vfecrow.pro2sueldo2,
                        ppro2totalsueldo                =>
                            vfecrow.pro2totalsueldo,
                        ppro2otroscostos                =>
                            vfecrow.pro2otroscostos,
                        ppro2totalcostos                =>
                            vfecrow.pro2totalcostos,
                        ppro2costounitario              =>
                            vfecrow.pro2costounitario,
                        ppro2preciounitario             =>
                            vfecrow.pro2preciounitario,
                        ppro2unidadesvendidas           =>
                            vfecrow.pro2unidadesvendidas,
                        ppro2margenganancia             =>
                            vfecrow.pro2margenganancia,
                        ppro3nombre                     => vfecrow.pro3nombre,
                        ppro3materiaprima1              =>
                            vfecrow.pro3materiaprima1,
                        ppro3materiaprima2              =>
                            vfecrow.pro3materiaprima2,
                        ppro3materiaprima3              =>
                            vfecrow.pro3materiaprima3,
                        ppro3totalmp                    => vfecrow.pro3totalmp,
                        ppro3sueldo1                    => vfecrow.pro3sueldo1,
                        ppro3sueldo2                    => vfecrow.pro3sueldo2,
                        ppro3totalsueldo                =>
                            vfecrow.pro3totalsueldo,
                        ppro3otroscostos                =>
                            vfecrow.pro3otroscostos,
                        ppro3totalcostos                =>
                            vfecrow.pro3totalcostos,
                        ppro3costounitario              =>
                            vfecrow.pro3costounitario,
                        ppro3preciounitario             =>
                            vfecrow.pro3preciounitario,
                        ppro3unidadesvendidas           =>
                            vfecrow.pro3unidadesvendidas,
                        ppro3margenganancia             =>
                            vfecrow.pro3margenganancia,
                        pprootromateriaprima1           =>
                            vfecrow.prootromateriaprima1,
                        pprootromateriaprima2           =>
                            vfecrow.prootromateriaprima2,
                        pprootromateriaprima3           =>
                            vfecrow.prootromateriaprima3,
                        pprootrototalmp                 =>
                            vfecrow.prootrototalmp,
                        pprootrosueldo1                 =>
                            vfecrow.prootrosueldo1,
                        pprootrosueldo2                 =>
                            vfecrow.prootrosueldo2,
                        pprootrototalsueldo             =>
                            vfecrow.prootrototalsueldo,
                        pprootrootroscostos             =>
                            vfecrow.prootrootroscostos,
                        pprootrototalcostos             =>
                            vfecrow.prootrototalcostos,
                        pprootrocostounitario           =>
                            vfecrow.prootrocostounitario,
                        pprootropreciounitario          =>
                            vfecrow.prootropreciounitario,
                        pprootrounidadesvendidas        =>
                            vfecrow.prootrounidadesvendidas,
                        pprootromargenganancia          =>
                            vfecrow.prootromargenganancia,
                        plinea1                         => vfecrow.linea1,
                        ppreciounitario1                =>
                            vfecrow.preciounitario1,
                        pcostounitario1                 =>
                            vfecrow.costounitario1,
                        pmargendeganancia1              =>
                            vfecrow.margendeganancia1,
                        punidadesvendidas1              =>
                            vfecrow.unidadesvendidas1,
                        plinea2                         => vfecrow.linea2,
                        ppreciounitario2                =>
                            vfecrow.preciounitario2,
                        pcostounitario2                 =>
                            vfecrow.costounitario2,
                        pmargendeganancia2              =>
                            vfecrow.margendeganancia2,
                        punidadesvendidas2              =>
                            vfecrow.unidadesvendidas2,
                        plinea3                         => vfecrow.linea3,
                        ppreciounitario3                =>
                            vfecrow.preciounitario3,
                        pcostounitario3                 =>
                            vfecrow.costounitario3,
                        pmargendeganancia3              =>
                            vfecrow.margendeganancia3,
                        punidadesvendidas3              =>
                            vfecrow.unidadesvendidas3,
                        plineaot                        => vfecrow.lineaot,
                        ppreciounitarioot               =>
                            vfecrow.preciounitarioot,
                        pcostounitarioot                =>
                            vfecrow.costounitarioot,
                        pmargendegananciaot             =>
                            vfecrow.margendegananciaot,
                        punidadesvendidasot             =>
                            vfecrow.unidadesvendidasot,
                        ptipocredito                    => vfecrow.tipocredito,
                        pgarantias                      => vfecrow.garantias,
                        pvalorgarantia                  =>
                            vfecrow.valorgarantia,
                        pdescripciongarantia            =>
                            vfecrow.descripciongarantia,
                        pprestamodescontar              =>
                            vfecrow.prestamodescontar,
                        plinea4                         => vfecrow.linea4,
                        ppreciounitario4                =>
                            vfecrow.preciounitario4,
                        pcostounitario4                 =>
                            vfecrow.costounitario4,
                        pmargendeganancia4              =>
                            vfecrow.margendeganancia4,
                        punidadesvendidas4              =>
                            vfecrow.unidadesvendidas4,
                        plinea5                         => vfecrow.linea5,
                        ppreciounitario5                =>
                            vfecrow.preciounitario5,
                        pcostounitario5                 =>
                            vfecrow.costounitario5,
                        pmargendeganancia5              =>
                            vfecrow.margendeganancia5,
                        punidadesvendidas5              =>
                            vfecrow.unidadesvendidas5,
                        plinea6                         => vfecrow.linea6,
                        ppreciounitario6                =>
                            vfecrow.preciounitario6,
                        pcostounitario6                 =>
                            vfecrow.costounitario6,
                        pmargendeganancia6              =>
                            vfecrow.margendeganancia6,
                        punidadesvendidas6              =>
                            vfecrow.unidadesvendidas6,
                        plinea7                         => vfecrow.linea7,
                        ppreciounitario7                =>
                            vfecrow.preciounitario7,
                        pcostounitario7                 =>
                            vfecrow.costounitario7,
                        pmargendeganancia7              =>
                            vfecrow.margendeganancia7,
                        punidadesvendidas7              =>
                            vfecrow.unidadesvendidas7,
                        plinea8                         => vfecrow.linea8,
                        ppreciounitario8                =>
                            vfecrow.preciounitario8,
                        pcostounitario8                 =>
                            vfecrow.margendeganancia8,
                        pmargendeganancia8              =>
                            vfecrow.margendeganancia8,
                        punidadesvendidas8              =>
                            vfecrow.unidadesvendidas8,
                        pcomentario                     => vfecrow.comentario,
                        pidoficial                      => vrow.codigo_oficial, ---vFecRow.IDOFICIAL,
                        pfecharegistro                  => vfecha_registro, --vFecRow.FECHAREGISTRO,
                        pfechafija                      => vfecrow.fechafija,
                        pidestado                       => vfecrow.idestado,
                        pmensaje                        => vfecrow.mensaje,
                        pnosubida                       => vfecrow.nosubida,
                        pidgrupo                        => vfecrow.idgrupo,
                        pimpreso                        => vfecrow.impreso,
                        pestadofec                      => vfecrow.idestado,
                        pmensajefec                     => vmensajefec, ---vFecRow.Mensaje,
                        pnosolicitud                    =>
                            vfecrow.numerosolicitud);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        presultado :=
                               SQLCODE
                            || ': '
                            || SQLERRM
                            || ' '
                            || DBMS_UTILITY.format_error_backtrace;
                        pmensaje :=
                            'Error en el proceso: Linea ' || $$plsql_line;
                        perror := presultado;
                END;

                CLOSE c_fec;
            END IF;
        ELSE
            pmensaje :=
                   'Solicitud:  '
                || pid_represtamo
                || ' NO fue encontrada, verificar.... ';
            ROLLBACK;
            RETURN;
        END IF;                                         --Solicitud Encontrada

        IF vid_tempfec IS NOT NULL
        THEN
            UPDATE pr_solicitud_represtamo
               SET id_tempfec = vid_tempfec
             WHERE ROWID = vrow.ROWID;

            pmensaje :=
                   'Id_tempfec: '
                || vid_tempfec
                || ' generado para la solicitud:  '
                || pid_represtamo;
        ELSE
            pmensaje :=
                   'Id_tempfec no fue generado para la solicitud:  '
                || pid_represtamo;
            ROLLBACK;
            RETURN;
        END IF;

        CLOSE c_data;
    ---DBMS_OUTPUT.PUT_LINE ('vid_tempfec ' || vid_tempfec);

    EXCEPTION
        WHEN OTHERS
        THEN
            presultado :=
                   SQLCODE
                || ': '
                || SQLERRM
                || ' '
                || DBMS_UTILITY.format_error_backtrace;
            pmensaje := 'Error en el proceso: Linea ' || $$plsql_line;
            perror := presultado;
    END;

    PROCEDURE p_crear_fudextendida (pid                             NUMBER,
                                    pid_tempfud                     NUMBER,
                                    pnomarchivo                     VARCHAR2,
                                    --Nacionalidad USA
                                    presidenteusa                   NUMBER, --VARCHAR2,
                                    pnropasaporteusa                VARCHAR2,
                                    pnroitin                        VARCHAR2,
                                    pnrossn                         VARCHAR2,
                                    pnroresidencia                  VARCHAR2, --green card
                                    ---
                                    pzona                           NUMBER,
                                    pcondicionvivienda              NUMBER,
                                    pnegociodomicilio               NUMBER, --VARCHAR2,
                                    ptiposervicio                   NUMBER,
                                    pmontoinicial                   NUMBER,
                                    porigenrecursos                 VARCHAR2, --NUMBER,
                                    pformaoperacion                 NUMBER,
                                    pingresosmensual                NUMBER,
                                    --PEPS
                                    pfuncionariogob                 NUMBER, --VARCHAR2, --PEPS
                                    pespeficiquefunci               VARCHAR2,
                                    pparentescofunci                NUMBER, --VARCHAR2, --PARENTESCO PEPS
                                    pexpecifiqueparen               VARCHAR2,
                                    preferenciacomernom1            VARCHAR2,
                                    preferenciacomertel1            VARCHAR2,
                                    preferenciacomernom2            VARCHAR2,
                                    preferenciacomertel2            VARCHAR2,
                                    preferenciabancanom1            VARCHAR2,
                                    preferenciabancatip1            VARCHAR2,
                                    preferenciabancanum1            VARCHAR2,
                                    preferenciabancanom2            VARCHAR2,
                                    preferenciabancatip2            VARCHAR2,
                                    preferenciabancanum2            VARCHAR2,
                                    preferenciaperapodo1            VARCHAR2,
                                    preferenciaperapodo2            VARCHAR2,
                                    preferenciafamnom               VARCHAR2,
                                    preferenciafamape               VARCHAR2,
                                    preferenciafamapodo             VARCHAR2,
                                    preferenciafamtelefono          VARCHAR2,
                                    --pSEGUROCONTRATADO            NUMBER,
                                    --pSEGUROOTROESPEFICIQUE       VARCHAR2,
                                    pseguroincendiopyme /*pSEGUROINCENDIOLINEA */
                                                                    NUMBER, --malmanzar 16-03-2023
                                    psegurodesempleodis             NUMBER,
                                    psegurootroespeficique          VARCHAR2,
                                    pfecha_carga                    DATE,
                                    --malmanzar 23-01-2023 Begin
                                    ptipomoneda                     NUMBER,
                                    pformasdeposito                 NUMBER,
                                    pactivostotal                   NUMBER,
                                    pvolumenventa                   NUMBER,
                                    ppatrimonioneto                 NUMBER,
                                    prangovolumenmensual            NUMBER,
                                    pcantidadtransacciones          NUMBER,
                                    ptieneebankingnumber            NUMBER,
                                    pposeedobleciudadania           VARCHAR2,
                                    pposeedobleciudadaniapais       VARCHAR2,
                                    --malmanzar 23-01-2023 end
                                    pmensaje                    OUT VARCHAR2,
                                    perrorcode                  OUT VARCHAR2,
                                    perrordescription           OUT VARCHAR2)
    IS
        CURSOR c_fud (id_tempfudp NUMBER, nomarchivop VARCHAR2)
        IS
            SELECT tipodocumentoidentidad,
                   numdocumentoidentidad,
                   nocredito,
                   TRUNC (fecha_registro)     fecha_registro,
                   codigoproyecto,
                   especifiquedestino
              FROM tempfud
             WHERE id_tempfud = id_tempfudp AND nomarchivo = nomarchivop;

        vfudrow                   c_fud%ROWTYPE;

        v_pa_id_personas_list     pa_pkg_utl.t_pa_id_personas_list
                                      := pa_pkg_utl.t_pa_id_personas_list ();

        vnumidformat              VARCHAR2 (30);
        vcount                    NUMBER := 0;
        v_persona                 id_personas.cod_persona%TYPE;
        vtipodocumentoidentidad   VARCHAR2 (5);        ---malmanzar 15-03-2023
    --pPOSEEDOBLECIUDADANIA       VARCHAR2 (30) := 'N';
    --pPOSEEDOBLECIUDADANIAPAIS   VARCHAR2 (100) := NULL;
    BEGIN
        --        p_depura ('Inicia fud extendida Linea: ' || $$plsql_line);

        OPEN c_fud (pid_tempfud, REPLACE (pnomarchivo, 'FUD_'));



        FETCH c_fud INTO vfudrow;

        IF c_fud%FOUND
        THEN
            vtipodocumentoidentidad :=
                f_tipoid_pda_core (
                    ptipo_id_pda   => vfudrow.tipodocumentoidentidad); --malmanzar 15-03-2023

            vnumidformat :=
                pa.formatear_identifi (vfudrow.numdocumentoidentidad,
                                       vtipodocumentoidentidad --malmanzar 15-03-2023
                                                              --vFudRow.TIPODOCUMENTOIDENTIDAD
                                                              );


            v_pa_id_personas_list :=
                ia.pa_pkg_utl.pa_id_personas_select (
                    pcod_persona       => NULL,
                    pcod_tipo_id       => vtipodocumentoidentidad, --vFudRow.TIPODOCUMENTOIDENTIDAD,
                    pnum_id            => vnumidformat,    -- '001-1077741-4',
                    pfec_vencimiento   => NULL,
                    pcod_pais          => NULL,
                    errorcode          => perrorcode,
                    errordescription   => perrordescription);

            vcount := v_pa_id_personas_list.COUNT;
            DBMS_OUTPUT.put_line (
                   'Vcount '
                || vcount
                || ' pNUMDOCUMENTOIDENTIDAD '
                || vtipodocumentoidentidad
                || ' vNumIdFormat '
                || vnumidformat);

            FOR i IN 1 .. v_pa_id_personas_list.COUNT
            LOOP
                v_persona := v_pa_id_personas_list (i).cod_persona;
                DBMS_OUTPUT.put_line ('v_persona ' || v_persona);
            END LOOP;


            IF v_persona IS NOT NULL
            THEN
                --Registra id

                IF pnropasaporteusa IS NOT NULL
                THEN
                    BEGIN
                        INSERT INTO id_personas (cod_persona,
                                                 cod_tipo_id,
                                                 num_id,
                                                 fec_vencimiento,
                                                 cod_pais,
                                                 nacionalidad)
                             VALUES (v_persona,
                                     '6',
                                     pnropasaporteusa,
                                     TO_DATE ('31-12-2050', 'dd-mm-yyyy'),
                                     '2',
                                     'Estadounidense');
                    EXCEPTION
                        WHEN DUP_VAL_ON_INDEX
                        THEN
                            NULL;
                    END;

                    BEGIN
                        ---Select * from datos_regulacion_fatca -- SELECT * FROM FUDEXTENDIDA order by Id_TempFud;

                        p_datos_reg_fatca (
                            pn_cod_cliente        => v_persona, --  IN datos_regulacion_fatca.cod_cliente%TYPE,  NOT NULL
                            pc_numero_pasaporte   => pnropasaporteusa, --   IN datos_regulacion_fatca.numero_pasaporte%TYPE,
                            pc_cod_pais           => 2, --IN datos_regulacion_fatca.cod_pais%TYPE,  NOT NULL
                            pc_numero_ss          => pnrossn, --  IN datos_regulacion_fatca.numero_ss%TYPE,
                            pc_numero_tin         => pnrossn, --pNROITIN, --       IN datos_regulacion_fatca.numero_tin%TYPE,
                            pc_numero_greencard   => pnroresidencia, --  IN datos_regulacion_fatca.num_green_card%TYPE,  --05-04-2023
                            pc_direccion          => pnroitin, --      IN datos_regulacion_fatca.direccion%TYPE,  05-04-2023 Jose,Fermin Miguel, Osiris
                            pc_ciudad             => NULL, --        IN datos_regulacion_fatca.ciudad%TYPE,
                            pc_num_telefono       => NULL, --    IN datos_regulacion_fatca.num_telefono%TYPE,
                            pc_num_telefono2      => NULL, --      IN datos_regulacion_fatca.num_telefono2%TYPE,
                            pc_es_residente       =>
                                CASE
                                    WHEN presidenteusa = '2' THEN 'S'
                                    ELSE 'N'
                                END, --    IN datos_regulacion_fatca.es_residente%TYPE,
                            pc_form_impresion     => NULL, --   IN datos_regulacion_fatca.form_impresion%TYPE,
                            pc_form_cambio        => NULL,    --   IN BOOLEAN,
                            pn_opcion             => NULL,    --    IN NUMBER,
                            pc_mensaje            => perrordescription --   IN out VARCHAR2
                                                                      );
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            NULL;
                    END;
                END IF;


                --Actualiza persona

                BEGIN
                    pa_pkg_utl.pa_personas_fisicas_update (
                        pcod_per_fisica         => v_persona,
                        pest_civil              => NULL,
                        psexo                   => NULL,
                        pfec_nacimiento         => NULL,
                        pprimer_apellido        => NULL,
                        psegundo_apellido       => NULL,
                        pprimer_nombre          => NULL,
                        psegundo_nombre         => NULL,
                        pprofesion              => NULL,
                        pidioma_correo          => NULL,
                        pes_mal_deudor          => NULL,
                        pconyugue               => NULL,
                        pnacionalidad           => NULL,
                        pcod_sector             => NULL,
                        pestatal                => NULL,
                        pemail_usuario          => NULL,
                        pemail_servidor         => NULL,
                        pnivel_estudios         => NULL,
                        ptipo_vivienda          => NULL,
                        pnum_hijos              => NULL,
                        pnum_dependientes       => NULL,
                        pes_residente           => NULL,
                        ptiempo_vivien_act      => NULL,
                        peval_ref_bancaria      => NULL,
                        peval_ref_tarjetas      => NULL,
                        peval_ref_laboral       => NULL,
                        ptotal_ingresos         => NULL,
                        pcod_pais               => NULL,
                        pincluido_por           => NULL,
                        pfec_inclusion          => NULL,
                        pmodificado_por         => NULL,
                        pfec_modificacion       => NULL,
                        pscoring                => NULL,
                        pactividad              => NULL,
                        prango_ingresos         => NULL,
                        pcasada_apellido        => NULL,
                        pes_funcionario         =>
                            CASE
                                WHEN pfuncionariogob = 2 THEN 'S'
                                ELSE 'N'
                            END, --malmanzar 02-12-2022 por cambio tipo de dato
                        pes_peps                =>
                            CASE
                                WHEN pparentescofunci = 2 THEN 'S'
                                ELSE 'N'
                            END, --malmanzar 02-12-2022 por cambio tipo de dato
                        pcod_actividad          => NULL,
                        pcod_subactividad       => NULL,
                        ptipo_persona           => NULL,
                        ptipo_cliente           => NULL,
                        pcod_pais_padre         => NULL,
                        pcod_pais_madre         => NULL,
                        pcod_pais_conyugue      => NULL,
                        pmas_180_dias_eeuu      => NULL,
                        pcod_finalidad          => NULL,
                        ppeso                   => NULL,
                        pestatura               => NULL,
                        pactividad_polizah      => NULL,
                        pdeporte_polizah        => NULL,
                        ppeso_polizah           => NULL,
                        pestatura_polizah       => NULL,
                        papellido_casada        => NULL,
                        ptercer_nombre          => NULL,
                        ptipo_soc_conyugal      => NULL,
                        pind_fallecimiento      => NULL,
                        pfec_fallecimiento      => NULL,
                        pgpo_riesgo             => NULL,
                        pnum_empleados          => NULL,
                        pventas_ingresos        => pvolumenventa, --NULL,malmanzar 23-01-2023
                        pcp_total_activo        => pactivostotal, --NULL,  malmanzar 23-01-2023
                        pind_clte_vip           => NULL,
                        pocupacion_clasif_nac   => NULL, --15-10-2024  --Solo para compilar PC1
                        ptipo_gen_divisas       => NULL, --15-10-2024   --Solo para compilar PC1
                        errorcode               => perrorcode,
                        errordescription        => perrordescription);

                    IF perrordescription IS NOT NULL
                    THEN                      --malmanzar 24-07-2023 Req. 9272
                        ROLLBACK;
                        RETURN;
                    END IF;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        perrordescription := 'SQLERRM: ' || SQLERRM;
                        RETURN;
                END;                          --malmanzar 24-07-2023 Req. 9272

                --04-04-2023


                --Consultar lógica cuando el cliente esta registrado en la tabla LISTA_PEP (crear pk )
                IF pfuncionariogob = 2 OR pparentescofunci = 2
                THEN                                    --malmanzar 24-07-2023
                    p_lista_p (pcod_persona       => v_persona,
                               pcargo             => pespeficiquefunci,
                               pparentescofunci   => pexpecifiqueparen);
                END IF;

                p_operaciones_realizar (
                    pcod_persona            => v_persona,
                    ptipo_producto          => 'PRESTAMOS',
                    pcod_moneda             => ptipomoneda,             --'1',
                    pproposito              => vfudrow.especifiquedestino,
                    pmonto_inicial          => pmontoinicial,
                    pinstrumento_bancario   =>
                        CASE
                            WHEN pformaoperacion = '1' THEN 'EFECTIVO'
                            WHEN pformaoperacion = '2' THEN 'CHEQUE'
                            WHEN pformaoperacion = '3' THEN 'TRANSFERENCIA'
                        END,
                    porigen_fondos          => porigenrecursos,
                    pno_credito             => TO_NUMBER (vfudrow.nocredito));
            END IF;

            ---01-04-2023 Begin referencias Comerciales y Bancarias



            p_refcom_portacredit (
                pcod_persona         => v_persona,
                ptelefono            => preferenciacomertel1,
                pnombre_referencia   => preferenciacomernom1);

            --            P_DEPURA (
            --                   'Linea: '
            --                || $$plsql_line
            --                || ' v_persona: '
            --                || v_persona
            --                || ' pREFERENCIACOMERTEL1 '
            --                || pREFERENCIACOMERTEL2
            --                || ' pREFERENCIACOMERNOM1: '
            --                || pREFERENCIACOMERNOM2);
            p_refcom_portacredit (
                pcod_persona         => v_persona,
                ptelefono            => preferenciacomertel2,
                pnombre_referencia   => preferenciacomernom2);

            ---Bancarias
            --1.

            --            P_DEPURA (
            --                   'Linea: '
            --                || $$plsql_line
            --                || ' v_persona: '
            --                || v_persona
            --                || ' pREFERENCIABANCANOM1 '
            --                || pREFERENCIABANCANOM1
            --                || ' pREFERENCIACOMERNOM1: '
            --                || pREFERENCIACOMERNOM1);
            p_refbanc_portacredit (
                pcod_persona         => v_persona,
                ptipo_cuenta         => preferenciabancatip1,
                pnum_cuenta          => preferenciabancanum1,
                pnombre_referencia   => preferenciabancanom1);
            --2.
            p_refbanc_portacredit (
                pcod_persona         => v_persona,
                ptipo_cuenta         => preferenciabancatip2,
                pnum_cuenta          => preferenciabancanum2,
                pnombre_referencia   => preferenciabancanom2);


            ---Nacionalidad US



            ---01-04-2023 End



            --Insertar Fud Extendida
            pr.pkg_solicitud_credito.p_insert_fudextendida (
                pid,
                pid_tempfud,
                REPLACE (pnomarchivo, 'FUD_'),
                --Otra Nacionalidad
                presidenteusa,
                pnropasaporteusa,
                pnroitin,
                pnrossn,
                pnroresidencia,
                pzona,
                pcondicionvivienda,
                pnegociodomicilio,
                ptiposervicio,
                pmontoinicial,
                porigenrecursos,
                pformaoperacion,
                pingresosmensual,
                pfuncionariogob,
                pespeficiquefunci,
                pparentescofunci,
                pexpecifiqueparen,
                --Referencias Comerciales
                preferenciacomernom1,
                preferenciacomertel1,
                preferenciacomernom2,
                preferenciacomertel2,
                --Referencias Bancarias
                preferenciabancanom1,
                preferenciabancatip1,
                preferenciabancanum1,
                preferenciabancanom2,
                preferenciabancatip2,
                preferenciabancanum2,
                --Referencias P
                preferenciaperapodo1,
                preferenciaperapodo2,
                --Referencias Familaires
                preferenciafamnom,
                preferenciafamape,
                preferenciafamapodo,
                preferenciafamtelefono,
                --pSEGUROCONTRATADO,
                --pSEGUROOTROESPEFICIQUE,
                pseguroincendiopyme,                   --pSEGUROINCENDIOLINEA,
                psegurodesempleodis,
                psegurootroespeficique,
                pfecha_carga,
                --malmanzar 23-01-2023 Begin
                ptipomoneda,
                pformasdeposito,
                pactivostotal,
                pvolumenventa,
                ppatrimonioneto,
                prangovolumenmensual,
                pcantidadtransacciones,
                ptieneebankingnumber,
                pposeedobleciudadania,
                pposeedobleciudadaniapais,
                --malmanzar 23-01-2023 end
                pmensaje,
                perrorcode,
                perrordescription);


            --malmanzar 23-01-2023 Begin

            --malmanzar 16-03-2023, Para mover código al procedimiento pcrearFud
            --If        nvl(pSEGUROINCENDIOLINEA,0) = 1 then
            IF NVL (pseguroincendiopyme, 0) = 1
            THEN
                DECLARE
                    vncodeudor       NUMBER := NULL;
                    cmensaje         VARCHAR2 (500);
                    vmonto_calculo   NUMBER;
                BEGIN
                    pkg_polizas.agrega_poliza (
                        pempresa        => 1,
                        pcredito        => vfudrow.nocredito, ---p_no_credito,
                        pfecha          => TRUNC (vfudrow.fecha_registro), ---p_credito.f_apertura,
                        --Sysdate,
                        pesvida         => 'N',
                        pesvehiculo     => 'N',
                        pesincendio     => 'N',
                        pesincendiopy   => 'S', ---REQ_59191_Seguro_Insendio_Pymes >> Nuevo Parámetro
                        pmensajeerror   => cmensaje,
                        pcodeudor       => vncodeudor,
                        paccion         => 'I', --C = Solo cálculo, I = Calcula e inserta
                        ptipopoliza     => NULL,
                        pmontocalculo   => vmonto_calculo);

                    IF NVL (vmonto_calculo, 0) > 0
                    THEN
                        UPDATE pr_creditos
                           SET esincendio_pyme = 'S'
                         WHERE     codigo_empresa = 1
                               AND no_credito = vfudrow.nocredito;
                    END IF;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        NULL;
                END;
            END IF;

            --1
            --OMARIOT 08/06/2018 REQ_84355 Seguro Desempleo
            BEGIN
                IF NVL (psegurodesempleodis, 0) = 1
                THEN
                    DECLARE
                        vparamlist             pkg_polizas.tlistaparam
                                                   := pkg_polizas.tlistaparam ();
                        nindex                 PLS_INTEGER := 0;
                        nedad                  NUMBER := 0;
                        nedadminima            NUMBER := 0;
                        nedadmaxima            NUMBER := 0;
                        form_trigger_failure   EXCEPTION;
                    BEGIN
                        BEGIN
                            --  Calcula la edad de la persona
                            SELECT TRUNC (
                                         (TRUNC (SYSDATE) - p.fec_nacimiento)
                                       / 365)
                              INTO nedad
                              FROM pa.personas_fisicas p
                             WHERE p.cod_per_fisica = v_persona; --:BKCREDIT.CODIGO_CLIENTE;
                        EXCEPTION
                            WHEN NO_DATA_FOUND
                            THEN
                                perrordescription :=
                                    'El cliente no está registrado como persona fisica.';
                                --Message(' ');
                                RAISE form_trigger_failure;
                        END;

                        nedadminima :=
                            TO_NUMBER (
                                param.parametro_x_empresa (
                                    1,
                                    'POL_DESEMPLEOEDADMIN',
                                    'PR'));
                        nedadmaxima :=
                            TO_NUMBER (
                                param.parametro_x_empresa (
                                    1,
                                    'POL_DESEMPLEOEDADMAX',
                                    'PR'));

                        --  Validación de la edad de la persona dentro del rango permitido
                        IF nedad BETWEEN (nedadminima) AND (nedadmaxima)
                        THEN
                            ---MARCA_INDICADOR_POLIZA;

                            vparamlist.delete;
                            nindex := nindex + 1;
                            vparamlist.EXTEND;
                            vparamlist (nindex) :=
                                pkg_polizas.agrega_parametro (
                                    pnombreparam   => 'ESDESEMPLEO',
                                    puso           => 'D',
                                    pindparam      => 'S');

                            pkg_polizas.agrega_poliza_list (
                                pempresa         => 1, ---:Variables.CodEmpresa,
                                pcredito         => vfudrow.nocredito, ---:BKCredit.No_Credito,
                                pfecha           => vfudrow.fecha_registro, --:Variables.Fecha,
                                pindtipopoliza   => vparamlist,
                                pmensajeerror    => perrordescription);

                            IF perrordescription IS NOT NULL
                            THEN
                                -- Message(cMensaje);
                                --Message(' ');
                                RAISE form_trigger_failure;
                            ELSE
                                agregar_indicador_marcarpoliza (
                                    1,
                                    vfudrow.nocredito,
                                    0,
                                    'D',
                                    'S',
                                    perrordescription);

                                IF perrordescription IS NOT NULL
                                THEN
                                    RAISE form_trigger_failure;
                                END IF;
                            END IF;
                        --END IF;

                        ELSE
                            perrordescription :=
                                   'La Persona debe tener la edad permitida ('
                                || nedadminima
                                || '-'
                                || nedadmaxima
                                || ') para este tipo de póliza.';
                            --Message(' ');
                            RAISE form_trigger_failure;
                        END IF;
                    EXCEPTION
                        WHEN form_trigger_failure
                        THEN
                            ROLLBACK;
                            RETURN;
                    END;
                --   Else
                --    PKG_POLIZAS.Borrar_Poliza(pEmpresa       => 1,
                --                                 pCredito       => vFudRow.nocredito,--:BKCredit.No_Credito,
                --                                 pTipoUso       => 'D',
                --                                 pTipoCredito   => vFudRow.CODIGOPROYECTO --:BKCredit.Tipo_Credito
                --);
                END IF;
            END;
        -- FIN OMARIOT 08/06/2018
        --2

        --malmanzar 23-01-2023 End

        ELSE
            pmensaje :=
                   'ID_TEMPFUD: '
                || pid_tempfud
                || ' pNOMARCHIVO: '
                || REPLACE (pnomarchivo, 'FUD_')
                || ' NO se encuentra en tabla TEMPFUD';

            perrordescription := pmensaje;
            ROLLBACK;
            RETURN;
        END IF;

        CLOSE c_fud;
    END;

    PROCEDURE p_insert_fudextendida (
        pid                             NUMBER,
        pid_tempfud                     NUMBER,
        pnomarchivo                     VARCHAR2,
        presidenteusa                   NUMBER,                   ---VARCHAR2,
        pnropasaporteusa                VARCHAR2,
        pnroitin                        VARCHAR2,
        pnrossn                         VARCHAR2,
        pnroresidencia                  VARCHAR2,
        pzona                           NUMBER,
        pcondicionvivienda              NUMBER,
        pnegociodomicilio               NUMBER,                    --VARCHAR2,
        ptiposervicio                   NUMBER,
        pmontoinicial                   NUMBER,
        porigenrecursos                 VARCHAR2,                   -- NUMBER,
        pformaoperacion                 NUMBER,
        pingresosmensual                NUMBER,
        pfuncionariogob                 NUMBER,                    --VARCHAR2,
        pespeficiquefunci               VARCHAR2,
        pparentescofunci                NUMBER,                    --VARCHAR2,
        pexpecifiqueparen               VARCHAR2,
        preferenciacomernom1            VARCHAR2,
        preferenciacomertel1            VARCHAR2,
        preferenciacomernom2            VARCHAR2,
        preferenciacomertel2            VARCHAR2,
        preferenciabancanom1            VARCHAR2,
        preferenciabancatip1            VARCHAR2,
        preferenciabancanum1            VARCHAR2,
        preferenciabancanom2            VARCHAR2,
        preferenciabancatip2            VARCHAR2,
        preferenciabancanum2            VARCHAR2,
        preferenciaperapodo1            VARCHAR2,
        preferenciaperapodo2            VARCHAR2,
        preferenciafamnom               VARCHAR2,
        preferenciafamape               VARCHAR2,
        preferenciafamapodo             VARCHAR2,
        preferenciafamtelefono          VARCHAR2,
        --pSEGUROCONTRATADO            NUMBER,
        -- pSEGUROOTROESPEFICIQUE       VARCHAR2,
        pseguroincendiopyme                           /*pSEGUROINCENDIOLINEA*/
                                        NUMBER,         --malmanzar 16-03-2023
        psegurodesempleodis             NUMBER,
        psegurootroespeficique          VARCHAR2,
        pfecha_carga                    DATE,
        --malmanzar 23-01-2023 Begin
        ptipomoneda                     NUMBER,
        pformasdeposito                 NUMBER,
        pactivostotal                   NUMBER,
        pvolumenventa                   NUMBER,
        ppatrimonioneto                 NUMBER,
        prangovolumenmensual            NUMBER,
        pcantidadtransacciones          NUMBER,
        ptieneebankingnumber            NUMBER,
        pposeedobleciudadania           VARCHAR2,
        pposeedobleciudadaniapais       VARCHAR2,
        --malmanzar 23-01-2023 end
        pmensaje                    OUT VARCHAR2,
        perrorcode                  OUT VARCHAR2,
        perrordescription           OUT VARCHAR2)
    IS
    BEGIN
        INSERT INTO pr.fudextendida (id,
                                     id_tempfud,
                                     nomarchivo,
                                     residenteusa,
                                     nropasaporteusa,
                                     nroitin,
                                     nrossn,
                                     nroresidencia,
                                     zona,
                                     condicionvivienda,
                                     negociodomicilio,
                                     tiposervicio,
                                     montoinicial,
                                     origenrecursos,
                                     formaoperacion,
                                     ingresosmensual,
                                     funcionariogob,
                                     espeficiquefunci,
                                     parentescofunci,
                                     expecifiqueparen,
                                     referenciacomernom1,
                                     referenciacomertel1,
                                     referenciacomernom2,
                                     referenciacomertel2,
                                     referenciabancanom1,
                                     referenciabancatip1,
                                     referenciabancanum1,
                                     referenciabancanom2,
                                     referenciabancatip2,
                                     referenciabancanum2,
                                     referenciaperapodo1,
                                     referenciaperapodo2,
                                     referenciafamnom,
                                     referenciafamape,
                                     referenciafamapodo,
                                     referenciafamtelefono,
                                     --SEGUROCONTRATADO,
                                     -- SEGUROOTROESPEFICIQUE,
                                     seguroincendiopyme, --malmanzar 16-03-2023 pendiente renombrar columna en tabla
                                     segurodesempleodis,
                                     segurootroespeficique,
                                     fecha_carga,
                                     tipomoneda,
                                     formasdeposito,
                                     activostotal,
                                     volumenventa,
                                     patrimonioneto,
                                     rangovolumenmensual,
                                     cantidadtransacciones,
                                     tieneebankingnumber,
                                     poseedobleciudadania,
                                     poseedobleciudadaniapais)
             VALUES (pid,
                     pid_tempfud,
                     pnomarchivo,
                     presidenteusa,
                     pnropasaporteusa,
                     pnroitin,
                     pnrossn,
                     pnroresidencia,
                     pzona,
                     pcondicionvivienda,
                     pnegociodomicilio,
                     ptiposervicio,
                     pmontoinicial,
                     porigenrecursos,
                     pformaoperacion,
                     pingresosmensual,
                     pfuncionariogob,
                     pespeficiquefunci,
                     pparentescofunci,
                     pexpecifiqueparen,
                     preferenciacomernom1,
                     preferenciacomertel1,
                     preferenciacomernom2,
                     preferenciacomertel2,
                     preferenciabancanom1,
                     preferenciabancatip1,
                     preferenciabancanum1,
                     preferenciabancanom2,
                     preferenciabancatip2,
                     preferenciabancanum2,
                     preferenciaperapodo1,
                     preferenciaperapodo2,
                     preferenciafamnom,
                     preferenciafamape,
                     preferenciafamapodo,
                     preferenciafamtelefono,
                     --pSEGUROCONTRATADO,
                     --pSEGUROOTROESPEFICIQUE,
                     pseguroincendiopyme,              --pSEGUROINCENDIOLINEA,
                     psegurodesempleodis,
                     psegurootroespeficique,
                     pfecha_carga,
                     ptipomoneda,
                     pformasdeposito,
                     pactivostotal,
                     pvolumenventa,
                     ppatrimonioneto,
                     prangovolumenmensual,
                     pcantidadtransacciones,
                     ptieneebankingnumber,
                     pposeedobleciudadania,
                     pposeedobleciudadaniapais);

        IF SQL%ROWCOUNT = 1
        THEN
            pmensaje :=
                'Id_FudExtendida ' || pid || ' fue insertada correctamente';
        END IF;
    EXCEPTION
        WHEN OTHERS
        THEN
            pmensaje := 'Error insertando FudExtendida';
            perrorcode := SQLCODE;
            perrordescription := 'sqlerrm ' || SQLERRM;
            RETURN;
    END;

    FUNCTION f_tipoid_pda_core (ptipo_id_pda VARCHAR2)
        RETURN VARCHAR2
    IS
        CURSOR c_tipo (tipo_idp VARCHAR2)
        IS
            SELECT cod_tipo_id
              FROM pa.tipos_id
             WHERE tipo_id_pda = tipo_idp;

        vtipo   pa.tipos_id.cod_tipo_id%TYPE;
    BEGIN
        OPEN c_tipo (ptipo_id_pda);      ---C = 1, R = 2, P = 4, X = 5, PE = 6

        FETCH c_tipo INTO vtipo;

        CLOSE c_tipo;

        RETURN vtipo;
    END;

    PROCEDURE p_direccion (pidpais             IN     VARCHAR2,
                           pidcanton           IN     VARCHAR2,
                           pidmunicipio        IN     VARCHAR2,
                           piddistrito         IN     VARCHAR2,
                           ---Out
                           pidpais_core           OUT VARCHAR2,
                           pidregion_core         OUT VARCHAR2, --Region, identificada en el core como provincia
                           pidcanton_core         OUT VARCHAR2, --Provincia, identificada en el core como Cantón
                           pidmunicipio_core      OUT VARCHAR2,
                           piddistrito_core       OUT VARCHAR2)
    IS
        v_pais   VARCHAR2 (5);
    --v_Region   VARCHAR2 (5);
    BEGIN
        BEGIN
            v_pais := NULL;

            SELECT cod_pais
              INTO v_pais
              FROM pais
             WHERE pais_sb = pidpais;
        EXCEPTION
            WHEN OTHERS
            THEN
                v_pais := '1';
        END;



        pidpais_core := v_pais;
        pidcanton_core := TO_NUMBER (SUBSTR (pidcanton, 1, 2));
        pidmunicipio_core := TO_NUMBER (SUBSTR (pidmunicipio, 4, 2));
        piddistrito_core := TO_NUMBER (SUBSTR (piddistrito, 5, 2));

        BEGIN
            SELECT cod_provincia
              INTO pidregion_core
              FROM pa.cantones
             WHERE     cod_pais = v_pais
                   AND cod_canton = pidcanton_core
                   AND ROWNUM = 1;
        EXCEPTION
            WHEN OTHERS
            THEN
                pidregion_core := '1';
        END;
    END;

    PROCEDURE agregar_indicador_marcarpoliza (incodempresa   IN     VARCHAR2,
                                              innocredito    IN     NUMBER,
                                              incodagencia   IN     VARCHAR2,
                                              intipopoliza   IN     VARCHAR2,
                                              inindicador    IN     VARCHAR2,
                                              mensaje           OUT VARCHAR2)
    IS
        nexiste   NUMBER := 0;
    BEGIN
        SELECT COUNT (1)
          INTO nexiste
          FROM pr.pr_creditos_indpoliza i
         WHERE     i.codigo_empresa = incodempresa
               AND i.no_credito = innocredito
               AND i.tipo_poliza = intipopoliza
               AND (i.codigo_agencia = incodagencia OR incodagencia IS NULL);

        IF (nexiste > 0)
        THEN
            BEGIN
                UPDATE pr.pr_creditos_indpoliza i
                   SET ind_poliza = inindicador,
                       modificado_por = USER,
                       fecha_modificacion = SYSDATE
                 WHERE     i.codigo_empresa = incodempresa
                       AND i.no_credito = innocredito
                       AND i.tipo_poliza = intipopoliza
                       AND (   i.codigo_agencia = incodagencia
                            OR incodagencia IS NULL);
            EXCEPTION
                WHEN OTHERS
                THEN
                    mensaje :=
                        'Error Actualizando Indicador de pólizas marcadas';
                    RETURN;
            END;
        ELSE
            BEGIN
                INSERT INTO pr.pr_creditos_indpoliza (codigo_empresa,
                                                      no_credito,
                                                      tipo_poliza,
                                                      codigo_agencia,
                                                      ind_poliza,
                                                      adicionado_por,
                                                      fecha_adicion,
                                                      modificado_por,
                                                      fecha_modificacion)
                     VALUES (incodempresa,
                             innocredito,
                             intipopoliza,
                             incodagencia,
                             inindicador,
                             USER,
                             SYSDATE,
                             NULL,
                             NULL);
            EXCEPTION
                WHEN OTHERS
                THEN
                    mensaje :=
                        'Error Insertando Indicador de pólizas marcadas';
                    RETURN;
            END;
        END IF;
    END;

    PROCEDURE p_refcom_portacredit (pcod_persona         VARCHAR2,
                                    ptelefono            VARCHAR2,
                                    pnombre_referencia   VARCHAR2)
    IS
        v_cod_ref_com   NUMBER;
        vcodente        NUMBER := 0;
        vnombre         VARCHAR2 (600);
    BEGIN
        v_cod_ref_com := s_cod_ref_com.NEXTVAL; ---s_cod_ref_portacredit.NEXTVAL;

        BEGIN
            SELECT e.cod_ente, p.nombre
              INTO vcodente, vnombre
              FROM pa.entes_externos e, personas p
             WHERE     p.nombre LIKE '%' || pnombre_referencia || '%'
                   AND p.cod_persona = e.cod_persona
                   AND ROWNUM = 1;
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                vcodente := 232;
                vnombre := pnombre_referencia;
        END;

        INSERT INTO ref_comerciales (cod_ref_com,                   --NOT NULL
                                     cod_tip_ref,
                                     cod_persona,
                                     cod_ente,
                                     num_cuenta,
                                     credito_otorgado,
                                     saldo_credito,
                                     cuota_mensual,
                                     cod_moneda,
                                     fec_apertura,
                                     fec_vencimiento,
                                     desc_garantia,
                                     observaciones,
                                     oficial,
                                     nombre_ente,
                                     num_telefono)
             VALUES (v_cod_ref_com,
                     '2',
                     pcod_persona,
                     vcodente,                                              --
                     NULL,                                      --pNUM_CUENTA,
                     NULL,                                 --CREDITO_OTORGADO,
                     NULL,                                    --SALDO_CREDITO,
                     NULL,                                   -- CUOTA_MENSUAL,
                     '1',                                        --COD_MONEDA,
                     NULL,                                     --FEC_APERTURA,
                     NULL,                                  --FEC_VENCIMIENTO,
                     NULL,                                    --DESC_GARANTIA,
                     NULL,                                    --OBSERVACIONES,
                     NULL,                                          --OFICIAL,
                     vnombre,                                    --NOMBRE_ENTE
                     ptelefono);
    EXCEPTION
        WHEN OTHERS
        THEN
            NULL;
    END;

    PROCEDURE p_refbanc_portacredit (pcod_persona         VARCHAR2,
                                     ptipo_cuenta         VARCHAR2,
                                     pnum_cuenta          VARCHAR2,
                                     pnombre_referencia   VARCHAR2)
    IS
        v_cod_ref_ban   NUMBER;
        vcodente        NUMBER := 0;
        vnombre         VARCHAR2 (600);
    BEGIN
        IF pnum_cuenta IS NOT NULL AND pnombre_referencia IS NOT NULL
        THEN
            v_cod_ref_ban := s_cod_ref_com.NEXTVAL; --s_cod_refbanc_portacredit.NEXTVAL;



            BEGIN
                SELECT e.cod_ente, p.nombre
                  INTO vcodente, vnombre
                  FROM pa.entes_externos e, personas p
                 WHERE     p.nombre LIKE '%' || pnombre_referencia || '%'
                       AND p.cod_persona = e.cod_persona
                       AND ROWNUM = 1;
            EXCEPTION
                WHEN NO_DATA_FOUND
                THEN
                    vcodente := 232;
                    vnombre := pnombre_referencia;
            END;

            INSERT INTO ref_comerciales (cod_ref_com,               --NOT NULL
                                         cod_tip_ref,
                                         cod_persona,
                                         cod_ente,
                                         num_cuenta,
                                         credito_otorgado,
                                         saldo_credito,
                                         cuota_mensual,
                                         cod_moneda,
                                         fec_apertura,
                                         fec_vencimiento,
                                         desc_garantia,
                                         observaciones,
                                         oficial,
                                         nombre_ente,
                                         tipo_cuenta)
                 VALUES (v_cod_ref_ban,
                         '1',
                         pcod_persona,
                         vcodente,                                          --
                         pnum_cuenta,
                         NULL,                             --CREDITO_OTORGADO,
                         NULL,                                --SALDO_CREDITO,
                         NULL,                               -- CUOTA_MENSUAL,
                         '1',                                    --COD_MONEDA,
                         NULL,                                 --FEC_APERTURA,
                         NULL,                              --FEC_VENCIMIENTO,
                         NULL,                                --DESC_GARANTIA,
                         NULL,                                --OBSERVACIONES,
                         NULL,                                      --OFICIAL,
                         vnombre,                                --NOMBRE_ENTE
                         ptipo_cuenta);
        --            INSERT INTO refbancaria_portacredit (COD_REF_BANC,
        --                                                 COD_PERSONA,
        --                                                 TIPO_CUENTA,
        --                                                 NUM_CUENTA,
        --                                                 NOMBRE_REFERENCIA)
        --                 VALUES (v_cod_ref_ban,
        --                         pCOD_PERSONA,
        --                         pTIPO_CUENTA,
        --                         pNUM_CUENTA,
        --                         pNOMBRE_REFERENCIA);
        END IF;
    EXCEPTION
        WHEN OTHERS
        THEN
            NULL;
    END;

    PROCEDURE p_ref_personales (pcod_persona        VARCHAR2,
                                pcod_empresa        VARCHAR2,
                                pcod_tipo_id        VARCHAR2,
                                pnombre_ref         VARCHAR2,
                                pnum_id             VARCHAR2,
                                pcod_area           VARCHAR2,
                                pnum_telefono       VARCHAR2,
                                ppuesto             VARCHAR2,
                                plugar_trabajo      VARCHAR2,
                                prelacion_persona   VARCHAR2,
                                pobservaciones      VARCHAR2,
                                pextension_tel      VARCHAR2)
    IS
        vcod_ref_per   NUMBER;
        vcount_ref     NUMBER := 0;
    BEGIN
        SELECT COUNT (*)
          INTO vcount_ref
          FROM ref_personales
         WHERE     cod_persona = pcod_persona
               AND cod_empresa = pcod_empresa
               AND cod_tipo_id = pcod_tipo_id
               AND nombre_ref = pnombre_ref
               AND num_id = pnum_id
               AND cod_area = pcod_area
               AND num_telefono = pnum_telefono;


        IF vcount_ref = 0
        THEN
            vcod_ref_per := s_cod_ref_per.NEXTVAL;

            INSERT INTO ref_personales (cod_ref_per,
                                        cod_persona,
                                        cod_empresa,
                                        cod_tipo_id,
                                        nombre_ref,
                                        num_id,
                                        cod_area,
                                        num_telefono,
                                        puesto,
                                        lugar_trabajo,
                                        relacion_persona,
                                        observaciones,
                                        extension_tel)
                 VALUES (vcod_ref_per,
                         pcod_persona,
                         pcod_empresa,
                         pcod_tipo_id,
                         pnombre_ref,
                         pnum_id,
                         pcod_area,
                         pnum_telefono,
                         ppuesto,
                         plugar_trabajo,
                         prelacion_persona,
                         pobservaciones,
                         pextension_tel);
        END IF;
    EXCEPTION
        WHEN OTHERS
        THEN
            NULL;
    END;

    PROCEDURE p_datos_reg_fatca (
        pn_cod_cliente        IN     datos_regulacion_fatca.cod_cliente%TYPE,
        pc_numero_pasaporte   IN     datos_regulacion_fatca.numero_pasaporte%TYPE,
        pc_cod_pais           IN     datos_regulacion_fatca.cod_pais%TYPE,
        pc_numero_ss          IN     datos_regulacion_fatca.numero_ss%TYPE,
        pc_numero_tin         IN     datos_regulacion_fatca.numero_tin%TYPE,
        pc_numero_greencard   IN     datos_regulacion_fatca.num_green_card%TYPE,
        pc_direccion          IN     datos_regulacion_fatca.direccion%TYPE,
        pc_ciudad             IN     datos_regulacion_fatca.ciudad%TYPE,
        pc_num_telefono       IN     datos_regulacion_fatca.num_telefono%TYPE,
        pc_num_telefono2      IN     datos_regulacion_fatca.num_telefono2%TYPE,
        pc_es_residente       IN     datos_regulacion_fatca.es_residente%TYPE,
        pc_form_impresion     IN     datos_regulacion_fatca.form_impresion%TYPE,
        pc_form_cambio        IN     BOOLEAN,
        pn_opcion             IN     NUMBER,
        pc_mensaje            IN OUT VARCHAR2)
    IS
        vcount   NUMBER := 0;
    BEGIN
        BEGIN
            SELECT COUNT (*)
              INTO vcount
              FROM datos_regulacion_fatca
             WHERE cod_cliente = pn_cod_cliente AND cod_pais = pc_cod_pais;
        END;

        IF vcount = 0
        THEN
            INSERT INTO datos_regulacion_fatca (numero_tin,
                                                direccion,
                                                numero_ss,
                                                num_green_card,
                                                num_telefono,
                                                es_residente,
                                                num_telefono2,
                                                cod_pais,
                                                numero_pasaporte,
                                                cod_cliente,
                                                ciudad,
                                                form_impresion,
                                                archivo_pdf)
                 VALUES (pc_numero_tin,
                         pc_direccion,
                         pc_numero_ss,
                         pc_numero_greencard,
                         pc_num_telefono,
                         pc_es_residente,
                         pc_num_telefono2,
                         pc_cod_pais,
                         pc_numero_pasaporte,
                         pn_cod_cliente,
                         pc_ciudad,
                         pc_form_impresion,
                         EMPTY_BLOB ());
        ELSE
            UPDATE datos_regulacion_fatca
               SET numero_pasaporte =
                       NVL (pc_numero_pasaporte, numero_pasaporte),
                   numero_ss = NVL (pc_numero_ss, numero_ss),
                   numero_tin = NVL (pc_numero_tin, numero_tin),
                   direccion = NVL (pc_direccion, direccion),
                   ciudad = NVL (pc_ciudad, ciudad),
                   num_telefono = NVL (num_telefono, pc_num_telefono),
                   num_telefono2 = NVL (num_telefono2, pc_num_telefono2),
                   es_residente = NVL (pc_es_residente, es_residente),
                   form_impresion = NVL (pc_form_impresion, form_impresion),
                   num_green_card = NVL (pc_numero_greencard, num_green_card)
             WHERE cod_cliente = pn_cod_cliente AND cod_pais = pc_cod_pais;
        END IF;


        UPDATE personas
           SET lleno_fatca = 'S', es_fatca = 'S'
         WHERE cod_persona = pn_cod_cliente;
    EXCEPTION
        WHEN OTHERS
        THEN
            p_depura ('Sqlerrm: ' || SQLERRM);
    END;

    PROCEDURE p_lista_p (pcod_persona       VARCHAR2,
                         pcargo             VARCHAR2,
                         pparentescofunci   VARCHAR2)
    IS
        v_consecutivo   NUMBER;
        v_codigo        NUMBER;
    BEGIN
        SELECT NVL (MAX (consecutivo) + 1, 1)
          INTO v_consecutivo
          FROM pa.lista_pep;

        BEGIN
            SELECT cod_parentesco
              INTO v_codigo
              FROM parentesco
             WHERE     UPPER (descripcion) LIKE
                           '%' || UPPER (pparentescofunci) || '%'
                   AND ROWNUM = 1;
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                v_codigo := 0;
        END;

        INSERT INTO pa.lista_pep (cod_persona,
                                  consecutivo,
                                  cargo,
                                  fec_ingreso,
                                  codigo_parentesco,
                                  -- FEC_VENCIMIENTO,
                                  --  APODO,
                                  adicionado_por,
                                  fecha_adicion)
             VALUES (pcod_persona,
                     v_consecutivo,
                     pcargo,
                     TRUNC (SYSDATE),
                     v_codigo,                --pPARENTESCOFUNCI,   04-04-2023
                     USER,
                     SYSDATE);
    EXCEPTION
        WHEN OTHERS
        THEN
            p_depura (
                   'Error insertando lista_pep sqlerrm: '
                || SQLERRM
                || ' Linea: '
                || $$plsql_line);
    END;

    PROCEDURE p_operaciones_realizar (pcod_persona            VARCHAR2,
                                      ptipo_producto          VARCHAR2,
                                      pcod_moneda             VARCHAR2,
                                      pproposito              VARCHAR2,
                                      pmonto_inicial          NUMBER,
                                      pinstrumento_bancario   VARCHAR2,
                                      porigen_fondos          VARCHAR2,
                                      pno_credito             NUMBER)
    IS
        vcount   NUMBER;
    BEGIN
        BEGIN
            SELECT COUNT (*)
              INTO vcount
              FROM pa.info_prod_sol
             WHERE     cod_persona = pcod_persona
                   AND tipo_producto = ptipo_producto
                   AND proposito = pproposito;
        --and no_credito =pno_credito;
        EXCEPTION
            WHEN OTHERS
            THEN
                vcount := 0;
        END;


        IF vcount = 0
        THEN
            INSERT INTO pa.info_prod_sol (cod_persona,
                                          tipo_producto,
                                          cod_moneda,
                                          proposito,
                                          monto_inicial,
                                          instrumento_bancario,
                                          origen_fondos,
                                          no_credito)
                 VALUES (pcod_persona,
                         ptipo_producto,
                         pcod_moneda,
                         pproposito,
                         pmonto_inicial,
                         pinstrumento_bancario,
                         porigen_fondos,
                         pno_credito);
        ELSE                                            --malmanzar 14-05-2024
            UPDATE pa.info_prod_sol
               SET origen_fondos = NVL (porigen_fondos, origen_fondos),
                   proposito = NVL (pproposito, proposito),
                   monto_inicial = NVL (pmonto_inicial, monto_inicial),
                   no_credito = pno_credito
             WHERE     cod_persona = pcod_persona
                   AND tipo_producto = ptipo_producto
                   AND proposito = pproposito;                   ---21-05-2024
        END IF;
    EXCEPTION
        WHEN OTHERS
        THEN
            p_depura (
                   'Error insertando INFO_PROD_SOL sqlerrm: '
                || SQLERRM
                || ' Linea: '
                || $$plsql_line);
            RETURN;
    END;

    PROCEDURE pcrearsolicitud_old (
        vsolicitud         IN     pr.solicitud_credito_obj,
        pn_nocredito          OUT NUMBER,
        pc_task               OUT pa.tarea_list,
        errorcode          IN OUT VARCHAR2,
        errordescription   IN OUT VARCHAR2)
    IS
        --pc_Task                PA.TAREA_LIST;  --temp
        reg1                        pr_credito.t_rec_pr_creditos;
        vcod_persona                VARCHAR2 (15);
        p_codempresa                NUMBER := 1;
        v_pr_pr_tipo_credito_list   pr_pkg_utl.t_pr_tipo_credito_list
            := pr_pkg_utl.t_pr_tipo_credito_list ();
        --
        vplazo_minimo               pr_tipo_credito.plazo_minimo%TYPE;
        vplazo_maximo               pr_tipo_credito.plazo_maximo%TYPE;
        vmonto_minimo               pr_tipo_credito.monto_minimo%TYPE;
        vmonto_maximo               pr_tipo_credito.monto_maximo%TYPE;
        vvariacion_base             pr_tipo_credito.variacion_base%TYPE;
        --
        vporcentaje                 valores_de_tasas_de_interes.porcentaje%TYPE;
        vvariacion_min              tipos_de_tasas_de_interes.variacion_min%TYPE;
        vvariacion_max              tipos_de_tasas_de_interes.variacion_max%TYPE;

        v_credito_anula             NUMBER (5);

        --        V_Pa_Empleados_List         pa_pkg_utl.t_Pa_Empleados_List
        --                                        := pa_pkg_utl.t_Pa_Empleados_List ();

        v_error                     VARCHAR2 (500);

        v_desc_plan_inversion       VARCHAR2 (500);
        v_desc_ejecutivo            VARCHAR2 (500);
        v_desc_actividad            VARCHAR2 (500);
        v_agencia_labora            VARCHAR2 (100);
        p_mensajeerror              VARCHAR2 (500);
        p_nrocredito                pr_creditos.no_credito%TYPE;
        vtasks                      pa.tarea_list := pa.tarea_list ();
        --Out
        vestadofec                  VARCHAR2 (30);            --- Out varchar2
        vmensajefec                 VARCHAR2 (3000);          -- OUT VARCHAR2,
        ---        vNoSolicitud                NUMBER (15);                 -- OUT NUMBER
        ----vTipo_Solicitante                   PERSONAS_FISICAS.TIPO_PERSONA%TYPE;

        verrores_solicitud          NUMBER;                          --- := 0;

        v_telefono_info_laboral     VARCHAR2 (20);
        v_email__info_laboral       VARCHAR2 (100);
        v_direccion_detalle         info_laboral.direccion%TYPE;
        vdescpais                   pais.pais%TYPE;
        vcodpais                    pais.cod_pais%TYPE;
        v_procesado                 VARCHAR2 (100);
        p_msgerr                    VARCHAR2 (500);
    BEGIN
        --       PR.PKG_PORTACREDIT2.LimpiarTarea;

        --Validar solicitud
        verrores_solicitud := 0;

        BEGIN
            pvalida_solicitud (psolicitud   => vsolicitud,
                               perrores     => verrores_solicitud);


            p_depura (
                   'vErrores_Solicitud = '
                || verrores_solicitud
                || ' Line: '
                || $$plsql_line);

            IF verrores_solicitud > 0
            THEN
                errordescription :=
                       'Errores en el proceso de validación('
                    || verrores_solicitud
                    || '), '
                    || 'Solicitud NO Procesada..';
                RETURN;
            END IF;
        END;


        reg1.codigo_empresa := 1;
        reg1.codigo_agencia := TO_NUMBER (vsolicitud.codigo_centro_costo /*CODIGO_BRANCH*/
                                                                        );
        reg1.tipo_credito := vsolicitud.info_prestamo.codigo_proyecto;
        reg1.f_apertura :=
            fecha_actual_calendario ('PR', reg1.codigo_empresa, 50 --Para evitar error con envio centro empleados
                                                                  --reg1.codigo_agencia
                                                                  );
        reg1.plazo_segun_unidad := vsolicitud.info_prestamo.termino_prestamo;
        p_depura (
               'plazo_segun_unidad = '
            || reg1.plazo_segun_unidad
            || ' Linea: '
            || $$plsql_line);


        p_depura (
               'Linea: '
            || $$plsql_line
            || ' '
            || 'f_apertura = '
            || reg1.f_apertura
            || '  reg1.codigo_agencia '
            || reg1.codigo_agencia
            || ' TO_NUMBER (vSolicitud.CODIGO_CENTRO_COSTO: '
            || TO_NUMBER (vsolicitud.codigo_centro_costo));
        p_depura ('==============CreditRequest==============');
        p_depura ('Id = ' || vsolicitud.id_solicitud_credito);

        --P_DEPURA ('Code = ' || vSolicitud.CODIGO_SOLICITUD);
        --P_DEPURA ('IsProcessed = ' || vSolicitud.ES_PROCESADO);
        ----cut Begin  18-01-2024
        ---Cut End   18-01-2024

        --        IF reg1.codigo_cliente  IS NOT NULL
        --           AND reg1.tipo_credito IS NOT NULL THEN
        --          IF NOT Valida_tipcredito_clienteNuevo(reg1.tipo_credito, reg1.codigo_cliente) THEN
        --             COMMIT;
        --                   ERRORDESCRIPTION :=
        --                   'Tipo de credito '
        --                || reg1.tipo_credito
        --                || ' solo es valido para clientes nuevos ';
        --            PR.PKG_PORTACREDIT2.AgregarTarea ('Tarea Validar Tipo Credito',
        --                                              'PR.PR_TIPO_CREDITO',
        --                                              'TIPO_CREDITO',
        --                                              '200',
        --                                              ERRORDESCRIPTION,
        --                                              'Procesar Credito');
        --
        --             RETURN;
        --          END IF;
        --        END IF;


        --        PR.PKG_PORTACREDIT2.AgregarTarea ('Tarea Procesar Persona Principal',
        --                                          'PA.PERSONAS',
        --                                          'vCod_Persona',
        --                                          '200',
        --                                          'Persona procesada exitosamente',
        --                                          'Procesar credito');

        ---
        BEGIN
            v_pr_pr_tipo_credito_list :=
                ia.pr_pkg_utl.pr_tipo_credito_select (
                    pcodigo_empresa                 => p_codempresa,
                    ptipo_credito                   =>
                        TO_NUMBER (vsolicitud.info_prestamo.codigo_proyecto),
                    pdescripcion                    => NULL,
                    pcodigo_sub_aplicacion          => NULL,
                    pes_linea_credito               => NULL,
                    pcodigo_moneda                  => NULL,
                    pcodigo_plazo                   => NULL,
                    pcodigo_origen                  => NULL,
                    pmodalidad_cobro                => NULL,
                    ptiene_vencimiento              => NULL,
                    ptipo_intereses                 => NULL,
                    ptipo_calendario                => NULL,
                    ptipo_linea                     => NULL,
                    pmanejo                         => NULL,
                    pplazo_minimo                   => NULL,
                    pplazo_maximo                   => NULL,
                    pmonto_minimo                   => NULL,
                    pmonto_maximo                   => NULL,
                    ptipo_tasa                      => NULL,
                    pcodigo_tipo_de_tasa            => NULL,
                    pvariacion_base                 => NULL,
                    ptasa_interes                   => NULL,
                    pcodigo_tasa_moratorios         => NULL,
                    pvariacion_mora                 => NULL,
                    ptasa_moratorios                => NULL,
                    pgracia_principal               => NULL,
                    pgracia_mora                    => NULL,
                    pdias_atraso_cobro_jud          => NULL,
                    pcontinua_cobro_intereses       => NULL,
                    pcomision_normal                => NULL,
                    pcomision_normal_minima         => NULL,
                    pcomision_normal_maxima         => NULL,
                    pperiodo_comision_normal        => NULL,
                    prevaloriza                     => NULL,
                    paprobacion_con_garantia        => NULL,
                    padicionado_por                 => NULL,
                    pfecha_adicion                  => NULL,
                    pmodificado_por                 => NULL,
                    pfecha_modificacion             => NULL,
                    ptipo_comision                  => NULL,
                    ptipo_mora                      => NULL,
                    pporcentaje_tasa_mora           => NULL,
                    pmax_dias_vencido_cobro         => NULL,
                    ppermite_sobregiro              => NULL,
                    pporcentaje_sobregiro           => NULL,
                    pcargo_comision                 => NULL,
                    pcargo_poliza                   => NULL,
                    pcodigo_corte                   => NULL,
                    pvariacion_minima               => NULL,
                    pvariacion_maxima               => NULL,
                    pperiodos_gracia_principal      => NULL,
                    pcargo_comision_atrasada        => NULL,
                    pmnemonico                      => NULL,
                    pcargo_cobro_administrativo     => NULL,
                    pcobra_comision_atrasada        => NULL,
                    pcobra_cobro_administrativo     => NULL,
                    pdias_atraso_cobro_admin        => NULL,
                    pbase_calculo_moratorios        => NULL,
                    pcomision_sobre_saldos          => NULL,
                    psaldos_teoricos                => NULL,
                    pcargo_iva                      => NULL,
                    pcobra_saldo_no_utilizado       => NULL,
                    pcargo_saldo_no_utilizado       => NULL,
                    pcomision_genera_iva            => NULL,
                    pcobra_intereses_dia_pago       => NULL,
                    pcargo_interes_prorrogado       => NULL,
                    pcargo_moratorio_prorrogado     => NULL,
                    pcargo_comision_prorrogada      => NULL,
                    ptipo_calculo_mora              => NULL,
                    pcargo_mora_flat                => NULL,
                    pdia_pago                       => NULL,
                    ptipo_cartera                   => NULL,
                    pdias_atraso_en_vigente         => NULL,
                    pes_pre_aprobado                => NULL,
                    pvigencia_solicitud             => NULL,
                    pcobro_aut_poliza               => NULL,
                    pes_cuota_multiple              => NULL,
                    ptipo_credito_hijos             => NULL,
                    pdescuentainteresesdesembolso   => NULL,
                    pcantidad_cuotas_descontar      => NULL,
                    pind_poliza_bco                 => NULL,
                    pind_pr_vehiculo                => NULL,
                    pmax_porc_extraordinario        => NULL,
                    pcon_garantia_certificado       => NULL,
                    pporcentaje_pignoracion_cd      => NULL,
                    poficial_autorizado             => NULL,
                    pgrupo_tipo_credito             => NULL,
                    ptipo_de_persona                => NULL,
                    pllamada_atraso                 => NULL,
                    pind_es_reserva                 => NULL,
                    pind_credito_universitario      => NULL,
                    pind_micro_credito              => NULL,
                    plimite_tolerable_ea            => NULL,
                    plimite_tolerable_lc            => NULL,
                    plimite_tolerable_gf            => NULL,
                    plimite_tolerable_cp            => NULL,
                    pfacilidad_creditic             => NULL,
                    pind_cobra_mora                 => NULL,
                    pestado                         => NULL,
                    ptipo_cuota                     => NULL,
                    pmultiples_desembolsos          => NULL,
                    pdesembolso_pactado             => NULL,
                    pgracia_mora_principal          => NULL,
                    errorcode                       => errorcode,
                    errordescription                => errordescription);
            p_depura (
                   'Linea '
                || $$plsql_line
                || ' Program Unit = '
                || $$plsql_unit);


            IF v_pr_pr_tipo_credito_list.COUNT = 0
            THEN
                errorcode := '45-' || errorcode;
                errordescription :=
                       errordescription
                    || '-Tipo de credito '
                    || vsolicitud.info_prestamo.codigo_proyecto
                    || ' no encontrado';
                ROLLBACK;
                RETURN;
            ELSE
                FOR i IN 1 .. v_pr_pr_tipo_credito_list.COUNT
                LOOP
                    reg1.codigo_moneda :=
                        v_pr_pr_tipo_credito_list (i).codigo_moneda;
                    reg1.tipo_credito :=
                        v_pr_pr_tipo_credito_list (i).tipo_credito;
                    reg1.es_linea_credito :=
                        v_pr_pr_tipo_credito_list (i).es_linea_credito;
                    reg1.tipo_linea :=
                        v_pr_pr_tipo_credito_list (i).tipo_linea;
                    reg1.manejo := v_pr_pr_tipo_credito_list (i).manejo;
                    reg1.modalidad_cobro :=
                        v_pr_pr_tipo_credito_list (i).modalidad_cobro;
                    reg1.tipo_intereses :=
                        v_pr_pr_tipo_credito_list (i).tipo_intereses;
                    reg1.tipo_calendario :=
                        v_pr_pr_tipo_credito_list (i).tipo_calendario;
                    reg1.periodo_comision_normal :=
                        v_pr_pr_tipo_credito_list (i).periodo_comision_normal;
                    reg1.comision_normal :=
                        v_pr_pr_tipo_credito_list (i).comision_normal;
                    reg1.tipo_tasa := v_pr_pr_tipo_credito_list (i).tipo_tasa;
                    reg1.codigo_tipo_de_tasa :=
                        v_pr_pr_tipo_credito_list (i).codigo_tipo_de_tasa;
                    reg1.variacion_base :=
                        v_pr_pr_tipo_credito_list (i).variacion_base;
                    reg1.tasa_interes :=
                        v_pr_pr_tipo_credito_list (i).tasa_interes;
                    reg1.codigo_tasa_moratorios :=
                        v_pr_pr_tipo_credito_list (i).codigo_tasa_moratorios;
                    reg1.variacion_mora :=
                        v_pr_pr_tipo_credito_list (i).variacion_mora;
                    reg1.tasa_moratorios :=
                        v_pr_pr_tipo_credito_list (i).tasa_moratorios;
                    reg1.gracia_principal :=
                        v_pr_pr_tipo_credito_list (i).gracia_principal;
                    reg1.gracia_mora :=
                        v_pr_pr_tipo_credito_list (i).gracia_mora;
                    reg1.codigo_origen :=
                        v_pr_pr_tipo_credito_list (i).codigo_origen;
                    reg1.continua_cobro_intereses :=
                        v_pr_pr_tipo_credito_list (i).continua_cobro_intereses;
                    reg1.dia_pago := v_pr_pr_tipo_credito_list (i).dia_pago;
                    reg1.revaloriza :=
                        v_pr_pr_tipo_credito_list (i).revaloriza;
                    reg1.codigo_sub_aplicacion :=
                        v_pr_pr_tipo_credito_list (i).codigo_sub_aplicacion;
                    reg1.tipo_comision :=
                        v_pr_pr_tipo_credito_list (i).tipo_comision;
                    reg1.tipo_mora := v_pr_pr_tipo_credito_list (i).tipo_mora;
                    reg1.porcentaje_tasa_mora :=
                        v_pr_pr_tipo_credito_list (i).porcentaje_tasa_mora;
                    -- reg1.codigo_plazo,
                    reg1.permite_sobregiro :=
                        v_pr_pr_tipo_credito_list (i).permite_sobregiro;
                    reg1.porcentaje_sobregiro :=
                        v_pr_pr_tipo_credito_list (i).porcentaje_sobregiro;
                    reg1.variacion_minima :=
                        v_pr_pr_tipo_credito_list (i).variacion_minima;
                    reg1.variacion_maxima :=
                        v_pr_pr_tipo_credito_list (i).variacion_maxima;
                    reg1.periodos_gracia_principal :=
                        v_pr_pr_tipo_credito_list (i).periodos_gracia_principal;
                    reg1.base_calculo_moratorios :=
                        v_pr_pr_tipo_credito_list (i).base_calculo_moratorios;
                    reg1.descuenta_intereses_desembolso :=
                        v_pr_pr_tipo_credito_list (i).descuenta_intereses_desembolso;
                    reg1.cantidad_cuotas_descontar :=
                        v_pr_pr_tipo_credito_list (i).cantidad_cuotas_descontar;
                    reg1.ind_pr_vehiculo :=
                        v_pr_pr_tipo_credito_list (i).ind_pr_vehiculo;
                    -- reg1.dias_periodo_cuota,
                    -- reg1.plazo,
                    reg1.tipo_desembolso := 'C'; ---V_Pr_Pr_Tipo_Credito_List(i).tipo_desembolso;
                    reg1.codigo_actividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_actividad;
                    reg1.codigo_subactividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_subactividad;
                    reg1.codigo_sub_clase := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_sub_clase;
                    reg1.codigo_plazo :=
                        v_pr_pr_tipo_credito_list (i).codigo_plazo;
                    vplazo_minimo :=
                        v_pr_pr_tipo_credito_list (i).plazo_minimo;
                    vplazo_maximo :=
                        v_pr_pr_tipo_credito_list (i).plazo_maximo;
                    vmonto_minimo :=
                        v_pr_pr_tipo_credito_list (i).monto_minimo;
                    vmonto_maximo :=
                        v_pr_pr_tipo_credito_list (i).monto_maximo;
                    vvariacion_base :=
                        v_pr_pr_tipo_credito_list (i).variacion_base;
                END LOOP;
            END IF;
        END;

        --Paste Begin 18-01-2024
        p_depura ('==============Persons==============');


        ---Cliente
        FOR i IN 1 .. vsolicitud.persona.COUNT
        LOOP
            vcod_persona := NULL;

            p_procesar_persona (
                ppersona           => vsolicitud.persona (i),
                psolicitud         => vsolicitud.id_solicitud_credito,
                --pCodigo_Moneda     => reg1.codigo_moneda,
                pcod_oficial       => TO_NUMBER (vsolicitud.codigo_empleado),
                pcodigo_agencia    =>
                    TO_NUMBER (vsolicitud.codigo_centro_costo /*CODIGO_BRANCH*/
                                                             ),
                psalario           =>
                      NVL (
                          vsolicitud.evaluaciones.ingresos_salariales.salario,
                          0)
                    + NVL (
                          vsolicitud.evaluaciones.ingresos_salariales.otros_ingresos,
                          0),                          ---malmanzar 05-02-2024
                pcod_persona       => vcod_persona,
                errorcode          => errorcode,
                errordescription   => errordescription);


            ---malmanzar 18-01-2023 Begin
            --            p_operaciones_realizar (
            --                pcod_persona            => vcod_persona,
            --                ptipo_producto          => 'PRESTAMOS',
            --                pcod_moneda             => reg1.codigo_moneda, --vMoneda_Credito,--pTIPOMONEDA,             --'1',
            --                pproposito              =>
            --                    vsolicitud.info_prestamo.destino_credito_especif, ---vFudRow.ESPECIFIQUEDESTINO,
            --                pmonto_inicial          => vsolicitud.info_prestamo.monto_credito, --- pMONTOINICIAL,
            --                pinstrumento_bancario   => 'EFECTIVO',
            --                /*CASE
            --                    WHEN pFORMAOPERACION = '1' THEN 'EFECTIVO'
            --                    WHEN pFORMAOPERACION = '2' THEN 'CHEQUE'
            --                    WHEN pFORMAOPERACION = '3' THEN 'TRANSFERENCIA'
            --                END,*/
            --                porigen_fondos          =>
            --                    vSolicitud.EVALUACIONES.ESTADO_RESULTADO.ORIGEN_RECURSOS -- 'SALARIO' -- pORIGENRECURSOS 14-05-2024
            --                                                                            );   --Mover despues de generar crédito



            --IF  ERRORDESCRIPTION IS NOT NULL THEN
            ---ERRORDESCRIPTION := 'Error';
            --                 PR.PKG_PORTACREDIT2.AgregarTarea (
            --                    'ERROR',
            --                    'PERSONA',
            --                    'COD_PERSONA',
            --                    '500',
            --                     'Error procesando persona',--ERRORDESCRIPTION,
            ----                    'Procesar Solicitud');
            --                    ROLLBACK;
            --                   RETURN;
            --                END IF;


            p_depura (
                   'Linea: '
                || $$plsql_line
                || ' vCod_Persona: '
                || vcod_persona
                || ' ERRORCODE: '
                || errorcode
                || ' ERRORDESCRIPTION: '
                || errordescription);
        --Identificaciones Persona

        END LOOP;


        reg1.codigo_cliente := (vcod_persona);

        ---End Cliente

        --Paste End   18-01-2024



        p_depura (
            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        reg1.estado := 'R';
        reg1.tipo_cuota := 'N';

        --malmanzar 17-02-2022 reactiva codigo comentado    2019
        BEGIN
            ---malmanzar 09-06-2022
            reg1.codigo_periodo_cuota :=
                f_periodicidad_pda_core (
                    TO_NUMBER (
                        SUBSTR (
                            vsolicitud.info_prestamo.codigo_frecuencia_pago,
                            1,
                            2)));
        END;

        reg1.plazo :=
              pr_proyeccion.my_add_month (
                  reg1.f_apertura,                               /*pplazocal*/
                  vsolicitud.info_prestamo.termino_prestamo)
            - reg1.f_apertura;
        p_depura (
               ' crear fud Linea '
            || $$plsql_line
            || ' vSolicitud.INFO_PRESTAMO.TERMINO_PRESTAMO: '
            || vsolicitud.info_prestamo.termino_prestamo);
        p_depura (
               ' crear fud Linea '
            || $$plsql_line
            || ' eg1.f_apertura: '
            || reg1.f_apertura
            || ' reg1.plazo: '
            || reg1.plazo);
        p_depura (
            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);

        BEGIN
            SELECT codigo_plazo
              INTO reg1.codigo_plazo
              FROM pr_tipos_plazos
             WHERE     codigo_plazo = reg1.codigo_plazo
                   AND reg1.plazo BETWEEN plazo_minimo AND plazo_maximo;
        --Between vPlazo_Minimo And vPlazo_Maximo;
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                v_error :=
                       'Revisar el campo Plazo: '
                    || reg1.plazo
                    || ' Codigo_Plazo '
                    || reg1.codigo_plazo
                    || ' '
                    || $$plsql_unit
                    || ' $$PLSQL_LINE = '
                    || $$plsql_line
                    || ' Sqlerrm '
                    || SQLERRM;


                errorcode := '46';
                errordescription := v_error;

                p_depura ('errorCode ' || errorcode || ': ' || v_error);
                ROLLBACK;
                RETURN;
        END;


        p_depura (
            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        reg1.f_vencimiento := reg1.f_apertura + reg1.plazo;
        --
        reg1.monto_credito := vsolicitud.info_prestamo.monto_credito; --pmontocal;
        p_depura (' crear fud Linea ' || $$plsql_line);

        IF reg1.monto_credito NOT BETWEEN vmonto_minimo AND vmonto_maximo
        THEN
            v_error := --'p_mensajeerror = Revisar el campo : Monto del Credito Solicitado, no se encuentra dentro de los rangos minimo y maximo del codigo de proyecto asignado ';
                   ' reg1.monto_credito '
                || TO_CHAR (reg1.monto_credito)
                || ' vmonto_minimo '
                || TO_CHAR (vmonto_minimo)
                || ' vmonto_maximo '
                || TO_CHAR (vmonto_maximo);
            errorcode := '47';
            errordescription := v_error;
            ROLLBACK;
            RETURN;
        END IF;

        BEGIN
            reg1.cuota := TO_NUMBER (                    /*pcuotaprestamocal*/
                                     vsolicitud.info_prestamo.cuota_fija);
        EXCEPTION
            WHEN OTHERS
            THEN
                v_error :=
                    'El valor del campo cuota no esta siendo enviado en el formato correcto.';
                errorcode := '48';
                errordescription := v_error;
                ROLLBACK;
                RETURN;
        END;

        p_depura (
            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        p_depura (
               ' crear fud Linea '
            || $$plsql_line
            || ' vSolicitud.CODIGO_EMPLEADO: '
            || vsolicitud.codigo_empleado);

        -- p_depura( 'valida :new.CUOTAPRESTAMOCAL ' || :New.cuotaprestamocal || ' ' || reg1.cuota );
        reg1.codigo_analista := vsolicitud.codigo_empleado;     -- pidoficial;
        p_depura (
            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);

        --10-07-2019 Begin
        BEGIN
            SELECT b.porcentaje, a.variacion_min, a.variacion_max
              INTO vporcentaje, vvariacion_min, vvariacion_max
              /* into :BKCredit.Desc_TASA_INTERES_BASE, :BKCredit.Desc_valor_tasa_corrientes,
              :BKCredit.variacion_min_interes, :BKCredit.variacion_max_interes*/
              FROM tipos_de_tasas_de_interes a, valores_de_tasas_de_interes b
             WHERE     a.codigo_tipo_de_tasa = b.codigo_tipo_de_tasa
                   AND b.codigo_empresa = p_codempresa
                   AND a.codigo_tipo_de_tasa =
                       TO_NUMBER (reg1.codigo_tipo_de_tasa)
                   --To_number( :New.tipocal )--LMVR
                   AND b.fecha_inicio =
                       (SELECT MAX (fecha_inicio)
                          FROM valores_de_tasas_de_interes
                         WHERE     codigo_empresa = p_codempresa
                               AND codigo_tipo_de_tasa =
                                   a.codigo_tipo_de_tasa
                               AND fecha_inicio <= TRUNC (SYSDATE) /*pfecha_registro*/
                                                                  );
        -- p_depura( 'ejecuto tasa de interes?:' || Sqlerrm );
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                p_depura (' crear fud Linea ' || $$plsql_line);
                v_error :=
                    'no encontro registros, revisar campos : Validaci¿n de Tasa de Interes';
                errorcode := '49';
                errordescription := v_error;
                ROLLBACK;
                RETURN;
            WHEN OTHERS
            THEN
                -- p_depura( 'others tasa de interes:' || Sqlerrm );
                v_error :=
                       'p_mensajeerror = revisar campos para consulta de tipos de tasas de interes '
                    || SQLERRM;
                p_depura (
                       'Linea '
                    || $$plsql_line
                    || ' Program Unit = '
                    || $$plsql_unit
                    || ' v_error: '
                    || v_error);
        END;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        reg1.variacion_base :=                                    /*ptasacal*/
                               vsolicitud.info_prestamo.tasa - (vporcentaje);
        ---- p_depura('salio de validaciones 2 '||sqlerrm);
        reg1.tasa_interes := vsolicitud.info_prestamo.tasa;        --ptasacal;
        ---p_depura ('Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit||' reg1.codigo_cliente: '||reg1.codigo_cliente);

        --    IF  reg1.codigo_cliente is not null THEN
        reg1.segregacion_rd := get_ciuu (reg1.codigo_cliente); --pidrama_ciiu;
        --   IF  reg1.segregacion_rd is not null THEN
        --     ROLLBACK;
        --       errorDescription := 'Error al procesar persona';
        -- RETURN;
        ---END IF;
        ---- errorDescription := 'Error al procesar persona';
        --  RETURN;
        ---END IF;
        ---p_depura ('Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);

        --a begin
        pr_credito.obtiene_planinversion (p_codempresa,
                                          'ESPA',
                                          reg1.plan_inversion,
                                          v_desc_plan_inversion);
        p_depura (
            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        pr_credito.busca_extras_cliente (p_codempresa,
                                         reg1.codigo_actividad,
                                         reg1.codigo_cliente, --:New.idaperturacliente,--LMVR
                                         v_desc_ejecutivo,
                                         v_desc_ejecutivo,
                                         v_desc_actividad,
                                         v_agencia_labora,
                                         --FAMH --- 22-04-2005 PROBLEMA CON LA AGENCIA
                                         reg1,
                                         'ESPA');

        p_depura (
            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);

        --
        -----------------------------------------------------------------------------
        -- JMoraM   02/08/2016
        -- Se valida si hay un cr¿dito en estado Registrado,
        -- Se anula los que est¿n para que cree el nuevo.
        -----------------------------------------------------------------------------



        IF                                                       /*v_persona*/
           reg1.codigo_cliente IS NOT NULL
        THEN
            BEGIN
                SELECT COUNT (no_credito)
                  INTO v_credito_anula
                  FROM pr.pr_creditos
                 WHERE     codigo_empresa = 1
                       AND estado = 'R'
                       AND codigo_cliente = reg1.codigo_cliente;  --v_persona;
            EXCEPTION
                WHEN OTHERS
                THEN
                    v_credito_anula := 0;
            END;

            IF v_credito_anula > 0
            THEN
                BEGIN
                    FOR a
                        IN (SELECT no_credito
                              FROM pr_creditos
                             WHERE     codigo_empresa = 1
                                   AND estado = 'R'
                                   AND codigo_cliente = reg1.codigo_cliente --v_persona
                                                                           )
                    LOOP
                        anula_credito_at (a.no_credito);
                    END LOOP;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        v_error := 'Error Anulacion AT ' || SQLERRM;
                        errorcode := '50';
                        errordescription := v_error;
                        ROLLBACK;
                        RETURN;
                END;

                --LMVR
                p_depura (' crear fud Linea ' || $$plsql_line);
            --
            END IF;

            p_depura (' crear fud Linea ' || $$plsql_line);
        END IF;

        --a end
        --p_depura (' crear fud Linea ' || $$plsql_line);

        --b Begin
        DECLARE
            v_existe_credito   VARCHAR2 (1) := 'N';
        BEGIN
            --            BEGIN
            --                SELECT DISTINCT esta
            --                  INTO v_existe_credito
            --                  FROM (SELECT 'S'     esta
            --                          FROM pr_creditos
            --                         WHERE     codigo_empresa = 1
            --                               AND estado IN ('D',
            --                                              'V',
            --                                              'M',
            --                                              'E',
            --                                              'J',
            --                                              'C')
            --                               AND codigo_cliente = reg1.codigo_cliente --v_persona
            --                        UNION ALL
            --                        SELECT 'S'     esta
            --                          FROM pr_creditos_hi
            --                         WHERE     codigo_empresa = 1
            --                               AND estado = 'C'
            --                               AND codigo_cliente = reg1.codigo_cliente --v_persona
            --                                                                       );
            --            EXCEPTION
            --                WHEN OTHERS
            --                THEN
            --                    p_depura (' crear fud Linea ' || $$plsql_line);
            --                    v_existe_credito := 'N';
            --            END;

            p_depura (' crear fud Linea ' || $$plsql_line);

            --            IF     v_existe_credito = 'S'
            --               AND INSTR (
            --                       param.parametro_x_empresa (1,
            --                                                  'TIPCRED_VAL_CLT_NEW',
            --                                                  'PR'),
            --                       /*pcodigoproyecto*/
            --                       TO_NUMBER (vSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO)) >
            --                   0
            --            THEN
            --                v_error :=
            --                       'El codigo de proyecto '
            --                    || TO_NUMBER (vSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO) --pcodigoproyecto
            --                    || ' solo aplica para clientes nuevos.';
            --                errorCode := '51';
            --                errorDescription := v_error;
            --                p_depura (' crear fud Linea ' || $$plsql_line);
            --                ROLLBACK;
            --                RETURN;
            --            ELSE
            --- p_depura (' crear fud Linea ' || $$plsql_line);

            p_depura (' crear fud Linea ' || $$plsql_line);

            BEGIN
                pr_credito.inserta_credito (p_codempresa,
                                            reg1.codigo_agencia, --p_codagencia
                                            p_nrocredito,
                                            reg1,
                                            p_mensajeerror);

                pn_nocredito := p_nrocredito;
            --                    PR.PKG_PORTACREDIT2.AgregarTarea (
            --                        'pr_credito.inserta_credito',
            --                        'PR.PR_CREDITOS',
            --                        'No_Credito',
            --                        '200',
            --                        'Credito procesado exitosamente',
            --                        TO_CHAR (p_nrocredito));
            --                        p_depura (' crear fud Linea ' || $$plsql_line||' p_nrocredito: '||p_nrocredito);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '51.5';
                    errordescription :=
                           'Error pr_credito.inserta_credito sqlerrm '
                        || SQLERRM
                        || ' Linea '
                        || $$plsql_line
                        || ' p_mensajeerror '
                        || p_mensajeerror;
                    p_depura (
                           ' crear fud Linea '
                        || $$plsql_line
                        || ' errorDescription: '
                        || errordescription);
                    -- p_depura (errorDescription);
                    RETURN;                             --malmanzar 04-08-2022
            END;



            p_depura ('Proceso Fec principal Linea: ' || $$plsql_line);

            BEGIN
                IF p_nrocredito IS NOT NULL
                THEN
                    --Begin 14-05-2024

                    p_operaciones_realizar (
                        pcod_persona            => vcod_persona,
                        ptipo_producto          => 'PRESTAMOS',
                        pcod_moneda             => reg1.codigo_moneda, --vMoneda_Credito,--pTIPOMONEDA,             --'1',
                        pproposito              =>
                            vsolicitud.info_prestamo.destino_credito_especif, ---vFudRow.ESPECIFIQUEDESTINO,
                        pmonto_inicial          =>
                            vsolicitud.info_prestamo.monto_credito, --- pMONTOINICIAL,
                        pinstrumento_bancario   => 'EFECTIVO',
                        /*CASE
                            WHEN pFORMAOPERACION = '1' THEN 'EFECTIVO'
                            WHEN pFORMAOPERACION = '2' THEN 'CHEQUE'
                            WHEN pFORMAOPERACION = '3' THEN 'TRANSFERENCIA'
                        END,*/
                        porigen_fondos          =>
                            vsolicitud.evaluaciones.estado_resultado.origen_recursos, -- 'SALARIO' -- pORIGENRECURSOS 14-05-2024
                        pno_credito             => p_nrocredito);
                    --End 14-05-2024



                    --New Fec Persona Begin
                    pcreafecpersona (
                        p_solicitud                      => reg1.no_credito,
                        p_codcliente                     => reg1.codigo_cliente,
                        p_codagencia                     => reg1.codigo_agencia, -- IN NUMBER,
                        ptipo_solicitante                => '01', --vTipo_Solicitante, ---Temp
                        --P_cuotasegurocal,
                        ----              monedacal,
                        p_destinocredito                 =>
                            vsolicitud.info_prestamo.destino_credito, -----Temp IN VARCHAR2 ,
                        p_especifiquedestino             =>
                            vsolicitud.info_prestamo.destino_credito_especif, --Temp--IN VARCHAR2,
                        pidtempfec                       => 0, --IN OUT NUMBER,
                        pnomarchivo                      => '0', --IN OUT VARCHAR2,
                        pidevaluacioncrediticia          => '0', --IN OUT VARCHAR2,
                        ptipodocumentoidentidad          => '0', --IN OUT VARCHAR2,
                        pdocumentoidentidad              => '0', --IN OUT VARCHAR2,
                        pnombrecliente                   => '0', --IN OUT VARCHAR2,
                        pnumerosolicitud                 => p_nrocredito, --IN OUT NUMBER,
                        pmontorecomendado                => reg1.monto_credito, --IN OUT NUMBER,
                        pfrecuencia                      =>
                            vsolicitud.info_prestamo.codigo_frecuencia_pago,
                        --vSolicitud.INFO_PRESTAMO.CODIGO_FRECUENCIA_PAGO, --IN OUT VARCHAR2, --malmanzar 14-07-222
                        pplazo                           => reg1.plazo, --IN OUT NUMBER,
                        ppro1ventasmensuales             => 0, --IN OUT NUMBER,
                        ppro2ventasmensuales             => 0, --IN OUT NUMBER,
                        ppro3ventasmensuales             => 0, --IN OUT NUMBER,
                        pprootroventasmensuales          => 0, --IN OUT NUMBER,
                        pventasmensuales1                => 0, --IN OUT NUMBER,
                        pventasmensuales2                => 0, --IN OUT NUMBER,
                        pventasmensuales3                => 0, --IN OUT NUMBER,
                        pventasmensuales4                => 0, --IN OUT NUMBER,
                        pventasmensuales5                => 0, --IN OUT NUMBER,
                        pventasmensuales6                => 0, --IN OUT NUMBER,
                        pventasmensuales7                => 0, --IN OUT NUMBER,
                        pventasmensuales8                => 0, --IN OUT NUMBER,
                        pventasmensualesot               => 0, --IN OUT NUMBER,
                        pventas_ingresos                 =>
                            NVL (
                                vsolicitud.evaluaciones.ingresos_salariales.salario,
                                vsolicitud.evaluaciones.estado_resultado.ingresos_por_ventas), --  30-01-2024   TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                        ---vSolicitud.EVALUACIONES.ESTADO_RESULTADO.INGRESOS_POR_VENTAS
                        ppro1costosventasmensuales       => 0, --IN OUT NUMBER,
                        ppro2costosventasmensuales       => 0, --IN OUT NUMBER,
                        ppro3costosventasmensuales       => 0, --IN OUT NUMBER,
                        pprootrocostosventasmensuales    => 0, --IN OUT NUMBER,
                        pcostoventas1                    => 0, --IN OUT NUMBER,
                        pcostoventas2                    => 0, --IN OUT NUMBER,
                        pcostoventas3                    => 0, --IN OUT NUMBER,
                        pcostoventas4                    => 0, --IN OUT NUMBER,
                        pcostoventas5                    => 0, --IN OUT NUMBER,
                        pcostoventas6                    => 0, --IN OUT NUMBER,
                        pcostoventas7                    => 0, --IN OUT NUMBER,
                        pcostoventas8                    => 0, --IN OUT NUMBER,
                        pcostoventasot                   => 0, --IN OUT NUMBER,
                        pcostoventas                     =>
                            vsolicitud.evaluaciones.estado_resultado.costo_ventas,
                        ---vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.TOTAL_COSTOS_OPERACIONAL, --    TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                        psueldo                          =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_salarial, --IN OUT NUMBER,
                        pservicio                        =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_servicios, --IN OUT NUMBER,
                        palquiler                        =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.pagos_renta, --IN OUT NUMBER, 22-01-2024 --Pendiente
                        ptransporte_combs                =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_combustible, --IN OUT NUMBER,
                        ppagointereses                   =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_interes_pagos, --IN OUT NUMBER,
                        potrosingresos_operacionales     =>
                            vsolicitud.evaluaciones.estado_resultado.otros_ingresos, --IN OUT NUMBER, 22-01-2024 --Pendiente
                        --Evaluacián Familiar
                        palimentacion                    =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_alimentacion, ---COSTOS_FAMILIARES.GASTOS_ALIMENTACION, --IN OUT NUMBER,
                        pvivienda                        =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_vivienda, --IN OUT NUMBER,
                        pvestido                         =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_ropa, --IN OUT NUMBER,
                        ptransporte                      =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_transportacion, --IN OUT NUMBER,
                        pservicios                       =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_servicios, --IN OUT NUMBER,
                        pmedicinas                       =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_medicos, --IN OUT NUMBER,
                        peducacion                       =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_educacion, --IN OUT NUMBER,
                        pdeudasfamiliares                =>
                            vsolicitud.evaluaciones.gastos_del_hogar.debitos, --IN OUT NUMBER,
                        potros_gastos                    =>
                            vsolicitud.evaluaciones.gastos_del_hogar.otros_gastos, --IN OUT NUMBER,
                        ptotalgastos_familiares          =>
                            vsolicitud.evaluaciones.gastos_del_hogar.total_gastos, --IN OUT NUMBER, --pendiente
                        pexcedentefamiliar               =>
                            vsolicitud.evaluaciones.gastos_del_hogar.excedente_familiar, --IN OUT NUMBER, --pendiente
                        potros                           =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.otros_gastos, -- 23-01-2024 ---malmanzar 27-09-2023 pendiente   vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.OTROS_INGRESOS, --IN OUT NUMBER,
                        ---Evaluación Comercial
                        pmaquinaria_mueblesequipos       =>
                            vsolicitud.evaluaciones.balance_comercial.maquinaria_mobiliario_eq, --IN OUT NUMBER,
                        pefectivo_cajabanco              =>
                            vsolicitud.evaluaciones.balance_comercial.efectivo_caja_chica, --IN OUT NUMBER,
                        pcuentaxcobrar                   =>
                            vsolicitud.evaluaciones.balance_comercial.cuentas_por_cobrar, --IN OUT NUMBER,
                        pinventario_prod_tem             =>
                            vsolicitud.evaluaciones.balance_comercial.inventario_producto_finalizado, --IN OUT NUMBER,
                        pinventario_prod_proc            =>
                            vsolicitud.evaluaciones.balance_comercial.inventario_producto_produccion, --IN OUT NUMBER,
                        pinventario_materiaprima         =>
                            vsolicitud.evaluaciones.balance_comercial.inventario_materia_prima, --IN OUT NUMBER,
                        pmercancia                       =>
                            vsolicitud.evaluaciones.balance_comercial.cantidad_mercancia, --IN OUT NUMBER,
                        panticipo_proveedores            =>
                            vsolicitud.evaluaciones.balance_comercial.cantidad_proveedor_anticipado, --IN OUT NUMBER,
                        plocalnegocio                    =>
                            vsolicitud.evaluaciones.balance_comercial.valor_local_comercial, --IN OUT NUMBER,
                        pobligacionesfinancieras         =>
                            vsolicitud.evaluaciones.balance_comercial.balance_oblicacion_financiera, --IN OUT NUMBER,
                        ptotal_pasivo_lp                 =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_largo_plazo, --IN OUT NUMBER,
                        pmueble_vehiculo                 =>
                            vsolicitud.evaluaciones.balance_familiar.valor_muebles_vehiculo, --IN OUT NUMBER,
                        pdeudacomercial                  =>
                            vsolicitud.evaluaciones.balance_familiar.deuda_comercial, --IN OUT NUMBER,
                        ptasa                            => reg1.tasa_interes, --IN OUT NUMBER,  --pendiente
                        pcuota                           => reg1.cuota, --IN OUT NUMBER,  --pendiente
                        pcuentapagarprovedor             =>
                            vsolicitud.evaluaciones.balance_comercial.cuenta_por_pagar_proveedor, --IN OUT NUMBER,
                        pcuentapagarvarias               =>
                            vsolicitud.evaluaciones.balance_comercial.cuenta_por_pagar_varios, --IN OUT NUMBER,
                        pinmuebles                       =>
                            vsolicitud.evaluaciones.balance_familiar.valor_propiedades, --IN OUT NUMBER,
                        ptotal_activofamiliar            =>
                            vsolicitud.evaluaciones.balance_familiar.total_activos_familiares, --IN OUT NUMBER,
                        pdeudabancaria                   =>
                            vsolicitud.evaluaciones.balance_familiar.deuda_bancaria, --IN OUT NUMBER,
                        ptotal_pasivofamiliar            =>
                            vsolicitud.evaluaciones.balance_familiar.tota_pasivos_familiar, --IN OUT NUMBER,
                        ppatrio_fam_balgen               =>
                            vsolicitud.evaluaciones.balance_familiar.total_patrimonio_familiar, --IN OUT NUMBER,   ---
                        ptotal_activocorriente           =>
                            vsolicitud.evaluaciones.balance_comercial.total_activos_corrientes, --IN OUT NUMBER,
                        ptotal_activofijo                =>
                            vsolicitud.evaluaciones.balance_comercial.total_activos_fijos, --IN OUT NUMBER,
                        ptotal_activos1                  =>
                            vsolicitud.evaluaciones.balance_comercial.total_activos, --IN OUT NUMBER,
                        ptotal_pasivocorrientes          =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_corriente, --IN OUT NUMBER,
                        ptotal_pasivo                    =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo, --IN OUT NUMBER,
                        ptotal_pasivopatrimonio          =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                        ppasivo_patrimonio               =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                        ppatrimonio                      =>
                            vsolicitud.evaluaciones.balance_comercial.patrimonio, --IN OUT NUMBER,
                        pactivocorte_pascte              => 0, --IN OUT NUMBER,
                        potrosingresos_excedente         => 0, --IN OUT NUMBER,
                        pcuotarecomendada_excedfam       => 0, --IN OUT NUMBER,
                        ptotalpasivo_patrimonio          =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                        putilidadneta_patrimonio         => 0, --IN OUT NUMBER,
                        putilidadneta_totalactivos1      => 0, --IN OUT NUMBER,
                        putilidadneta_ventas             => 0, --IN OUT NUMBER,
                        pcuentasxcobrar_ventas           => 0, --IN OUT NUMBER,
                        pcostoventa_inventario           => 0, --IN OUT NUMBER,
                        pgastoslegales                   => 0, --IN OUT NUMBER,    --
                        pmoneda                          => reg1.codigo_moneda, --IN OUT VARCHAR2,
                        pcapital_trabajo                 =>
                            vsolicitud.evaluaciones.balance_comercial.capital_de_trabajo, --IN OUT NUMBER,
                        pfechabalancegeneral             =>
                            vsolicitud.evaluaciones.balance_comercial.fecha_balance, --IN OUT VARCHAR2,
                        pdesde                           =>
                            vsolicitud.evaluaciones.estado_resultado.fecha_inicio_eval, --IN OUT VARCHAR2,
                        phasta                           =>
                            vsolicitud.evaluaciones.estado_resultado.fecha_fin_eval, ---FECHA_FIN_EVALUACION, --IN OUT VARCHAR2,
                        ptotalcostooperacional           =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.total_costos_operacional, --IN OUT NUMBER,
                        putilidadneta                    =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.ganacia_neta, --IN OUT NUMBER,
                        pventasdiarias_promedio          =>
                            vsolicitud.evaluaciones.evaluacion_financiera.ventas_diarias_promedio, --IN OUT NUMBER,
                        pdiastrabajados                  =>
                            vsolicitud.evaluaciones.evaluacion_financiera.dias_trabajados_por_mes, --IN OUT NUMBER,
                        pcomprassemanalesdeclaradas      =>
                            vsolicitud.evaluaciones.evaluacion_financiera.compras_semanales_promedio, --IN OUT NUMBER,
                        pventasmensualesdeclaradas       =>
                            vsolicitud.evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --IN OUT NUMBER,
                        pmargendeclarado                 =>
                            vsolicitud.evaluaciones.evaluacion_financiera.margen_beneficio_declarado, --IN OUT NUMBER,
                        pmontomesalto                    =>
                            vsolicitud.evaluaciones.evaluacion_financiera.mayor_beneficio_mes, --MONTE_MES_MAS_GANANCIAS, --IN OUT NUMBER,
                        pmontomesmedio                   =>
                            vsolicitud.evaluaciones.evaluacion_financiera.beneficio_prom_mensual, --IN OUT NUMBER,
                        pcomprasmensualesdeclaradas      =>
                            vsolicitud.evaluaciones.evaluacion_financiera.compras_mensuales_declaradas, --IN OUT NUMBER,
                        pmontomesbajo                    =>
                            vsolicitud.evaluaciones.evaluacion_financiera.menor_beneficio_mes, --MONTO_MES_MENOS_GANANCIAS, --IN OUT NUMBER,
                        pventasmensuales                 =>
                            vsolicitud.evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                        pcostoventamensual               =>
                            vsolicitud.evaluaciones.estado_resultado.costo_ventas, --Pendiente 27-09-2023 vSolicitud.EVALUACIONES.TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                        putilidadbruta                   =>
                            vsolicitud.evaluaciones.estado_resultado.beneficio_ventas, --IN OUT NUMBER,
                        pmargenganancia                  =>
                            vsolicitud.evaluaciones.evaluacion_financiera.margen_beneficio_declarado, --MARGEN_GANANCIA, --IN OUT NUMBER,
                        pprimera_ref_vecinos             => '0', --IN OUT VARCHAR2,
                        psegunda_ref_vecinos             => '0', --IN OUT VARCHAR2,
                        pambientefamiliar                => '0', --IN OUT VARCHAR2,
                        pdependientes                    => 0, --IN OUT NUMBER,
                        pedad                            => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                        pestadosaludfamilia              => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                        pingresos                        =>
                            vsolicitud.evaluaciones.estado_resultado.ingresos_por_ventas, --IN OUT VARCHAR2, --Number  27-07-2022
                        potrosingresos                   =>
                            vsolicitud.evaluaciones.estado_resultado.otros_ingresos, --IN OUT VARCHAR2, --Number  27-07-2022
                        pexperiencia_neg                 =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.anio_experiencia_negocio, --IN OUT NUMBER, --malmanzar 27-07-2022
                        phoras_neg                       =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.horas_trabajo_por_semana, --IN OUT NUMBER,
                        plocalpropio                     =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.local_no_alquilado, --IN OUT VARCHAR2, --malmanzar 14-07-2022
                        ptiempoempleo                    =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.tiempo_lugar_negocio, --IN OUT NUMBER,
                        pubicacionnegocio                =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.codigo_ubicacion_negocio, --IN OUT VARCHAR2,
                        pllevaregistro                   => '0', --IN OUT VARCHAR2,
                        pmejorasnegocio                  => '0', --IN OUT VARCHAR2,
                        pclientesfrecuentes              => 0, --IN OUT NUMBER,
                        pnivelcompetencia                => '0', --IN OUT VARCHAR2, --malmanzar 14-07-2022
                        pfecha_balancegeneral_al         =>
                            vsolicitud.evaluaciones.balance_familiar.fecha_balance, --IN OUT VARCHAR2,
                        --                             IN=> 0, -- OUT
                        pdestinocredito                  =>
                            vsolicitud.info_prestamo.destino_credito, --IN OUT VARCHAR2,
                        pespecifiquedestino              =>
                            vsolicitud.info_prestamo.destino_credito_especif, --IN OUT VARCHAR2,
                        pestadosolicitud                 => 0, --IN OUT NUMBER,
                        pactividadeconomica              => '0', --IN OUT VARCHAR2,
                        pactividadeconomicadinrap        => '0', --IN OUT VARCHAR2,
                        pmargenbrutoestandar             => 0, --IN OUT NUMBER,
                        pgastosoperacionalesestandar     => 0, --IN OUT NUMBER,
                        palto_indicadores                => 0, --IN OUT NUMBER,
                        pbajo_indicadores                => 0, --IN OUT NUMBER,
                        plunes                           => '0', --IN OUT VARCHAR2,
                        pmartes                          => '0', --IN OUT VARCHAR2,
                        pmiercoles                       => '0', --IN OUT VARCHAR2,
                        pjueves                          => '0', --IN OUT VARCHAR2,
                        pviernes                         => '0', --IN OUT VARCHAR2,
                        psabado                          => '0', --IN OUT VARCHAR2,
                        pdomingo                         => '0', --IN OUT VARCHAR2,
                        ptotal_ventasaltas               => 0, --IN OUT NUMBER,
                        ptotal_ventasbajas               => 0, --IN OUT NUMBER,
                        ptotal_ventassemanales           => 0, --IN OUT NUMBER,
                        ptotal_ventasmensuales           => 0, --IN OUT NUMBER,
                        pmargenbrutodeclarado            => 0, --IN OUT NUMBER,
                        palimentacion_gastos             => 0, --IN OUT NUMBER,
                        pvivienda_gastos                 => 0, --IN OUT NUMBER,
                        peducacion_gastos                => 0, --IN OUT NUMBER,
                        psalud_gastos                    => 0, --IN OUT NUMBER,
                        ptransporte_gastos               => 0, --IN OUT NUMBER,
                        pvestido_gastos                  => 0, --IN OUT NUMBER,
                        ppagodeudas_gastos               => 0, --IN OUT NUMBER,
                        potros_gastos_familiares         => 0, --IN OUT NUMBER,
                        ptotal_gastos                    => 0, --IN OUT NUMBER,
                        pventas_gastos                   => 0, --IN OUT NUMBER,
                        pcostosventas_gastos             => 0, --IN OUT NUMBER,
                        pgastosoperativos                => 0, --IN OUT NUMBER,
                        potros_ingresos_gastos           => 0, --IN OUT NUMBER,
                        ptotal_gastos_familiares         => 0, --IN OUT NUMBER,
                        pexcedentefamiliar_gastos        => 0, --IN OUT NUMBER,
                        pcuotasolicitada                 => 0, --IN OUT NUMBER,
                        prelcuotasolicitada_excfam       => 0, --IN OUT NUMBER,
                        ---Datos Recom Soli
                        pmonto_recomendacion             => reg1.monto_credito, --IN OUT NUMBER,
                        pmoneda_recomendacion            => reg1.codigo_moneda, --IN OUT VARCHAR2,
                        pplazo_recomendacion             =>
                            reg1.plazo_segun_unidad,          --IN OUT NUMBER,
                        ptasa_recomendacion              => reg1.tasa_interes, --IN OUT NUMBER,
                        pfrecuencia_recomendacion        =>
                            vsolicitud.info_prestamo.codigo_frecuencia_pago, --reg1.codigo_periodo_cuota, --IN OUT VARCHAR2,
                        pcuota_recomendacion             => reg1.cuota, --IN OUT NUMBER,
                        pestadosolicitud_recomendacion   => 0, --IN OUT NUMBER,
                        pcuotarecomendada_excfamiliar    => 0, --IN OUT NUMBER,
                        pventasevalanterior              => 0, --IN OUT NUMBER,
                        pactual_ventas                   => 0, --IN OUT NUMBER,
                        pvariacionventas                 => 0, --IN OUT NUMBER,
                        pcomentario1                     => '0', --IN OUT VARCHAR2,
                        pcomentario2                     => '0', --IN OUT VARCHAR2,
                        ppro1nombre                      => '0', --IN OUT VARCHAR2,
                        ppro1materiaprima1               => 0, --IN OUT NUMBER,
                        ppro1materiaprima2               => 0, --IN OUT NUMBER,
                        ppro1materiaprima3               => 0, --IN OUT NUMBER,
                        ppro1totalmp                     => 0, --IN OUT NUMBER,
                        ppro1sueldo1                     => 0, --IN OUT NUMBER,
                        ppro1sueldo2                     => 0, --IN OUT NUMBER,
                        ppro1totalsueldo                 => 0, --IN OUT NUMBER,
                        ppro1otroscostos                 => 0, --IN OUT NUMBER,
                        ppro1totalcostos                 => 0, --IN OUT NUMBER,
                        ppro1costounitario               => 0, --IN OUT NUMBER,
                        ppro1preciounitario              => 0, --IN OUT NUMBER,
                        ppro1unidadesvendidas            => 0, --IN OUT NUMBER,
                        ppro1margenganancia              => 0, --IN OUT NUMBER,
                        ppro2nombre                      => '0', --IN OUT VARCHAR2,
                        ppro2materiaprima1               => 0, --IN OUT NUMBER,
                        ppro2materiaprima2               => 0, --IN OUT NUMBER,
                        ppro2materiaprima3               => 0, --IN OUT NUMBER,
                        ppro2totalmp                     => 0, --IN OUT NUMBER,
                        ppro2sueldo1                     => 0, --IN OUT NUMBER,
                        ppro2sueldo2                     => 0, --IN OUT NUMBER,
                        ppro2totalsueldo                 => 0, --IN OUT NUMBER,
                        ppro2otroscostos                 => 0, --IN OUT NUMBER,
                        ppro2totalcostos                 => 0, --IN OUT NUMBER,
                        ppro2costounitario               => 0, --IN OUT NUMBER,
                        ppro2preciounitario              => 0, --IN OUT NUMBER,
                        ppro2unidadesvendidas            => 0, --IN OUT NUMBER,
                        ppro2margenganancia              => 0, --IN OUT NUMBER,
                        ppro3nombre                      => '0', --IN OUT VARCHAR2,
                        ppro3materiaprima1               => 0, --IN OUT NUMBER,
                        ppro3materiaprima2               => 0, --IN OUT NUMBER,
                        ppro3materiaprima3               => 0, --IN OUT NUMBER,
                        ppro3totalmp                     => 0, --IN OUT NUMBER,
                        ppro3sueldo1                     => 0, --IN OUT NUMBER,
                        ppro3sueldo2                     => 0, --IN OUT NUMBER,
                        ppro3totalsueldo                 => 0, --IN OUT NUMBER,
                        ppro3otroscostos                 => 0, --IN OUT NUMBER,
                        ppro3totalcostos                 => 0, --IN OUT NUMBER,
                        ppro3costounitario               => 0, --IN OUT NUMBER,
                        ppro3preciounitario              => 0, --IN OUT NUMBER,
                        ppro3unidadesvendidas            => 0, --IN OUT NUMBER,
                        ppro3margenganancia              => 0, --IN OUT NUMBER,
                        pprootromateriaprima1            => 0, --IN OUT NUMBER,
                        pprootromateriaprima2            => 0, --IN OUT NUMBER,
                        pprootromateriaprima3            => 0, --IN OUT NUMBER,
                        pprootrototalmp                  => 0, --IN OUT NUMBER,
                        pprootrosueldo1                  => 0, --IN OUT NUMBER,
                        pprootrosueldo2                  => 0, --IN OUT NUMBER,
                        pprootrototalsueldo              => 0, --IN OUT NUMBER,
                        pprootrootroscostos              => 0, --IN OUT NUMBER,
                        pprootrototalcostos              => 0, --IN OUT NUMBER,
                        pprootrocostounitario            => 0, --IN OUT NUMBER,
                        pprootropreciounitario           => 0, --IN OUT NUMBER,
                        pprootrounidadesvendidas         => 0, --IN OUT NUMBER,
                        pprootromargenganancia           => 0, --IN OUT NUMBER,
                        plinea1                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario1                 => 0, --IN OUT NUMBER,
                        pcostounitario1                  => 0, --IN OUT NUMBER,
                        pmargendeganancia1               => 0, --IN OUT NUMBER,
                        punidadesvendidas1               => 0, --IN OUT NUMBER,
                        plinea2                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario2                 => 0, --IN OUT NUMBER,
                        pcostounitario2                  => 0, --IN OUT NUMBER,
                        pmargendeganancia2               => 0, --IN OUT NUMBER,
                        punidadesvendidas2               => 0, --IN OUT NUMBER,
                        plinea3                          => 0, --IN OUT VARCHAR2,
                        ppreciounitario3                 => 0, --IN OUT NUMBER,
                        pcostounitario3                  => 0, --IN OUT NUMBER,
                        pmargendeganancia3               => 0, --IN OUT NUMBER,
                        punidadesvendidas3               => 0, --IN OUT NUMBER,
                        plineaot                         => 0, --IN OUT VARCHAR2,
                        ppreciounitarioot                => 0, --IN OUT NUMBER,
                        pcostounitarioot                 => 0, --IN OUT NUMBER,
                        pmargendegananciaot              => 0, --IN OUT NUMBER,
                        punidadesvendidasot              => 0, --IN OUT NUMBER,
                        ptipocredito                     => '0', --IN OUT VARCHAR2,
                        pgarantias                       => '0', --IN OUT VARCHAR2,
                        pvalorgarantia                   => '0', --IN OUT VARCHAR2,
                        pdescripciongarantia             => '0', --IN OUT VARCHAR2,
                        pprestamodescontar               => '0', --IN OUT VARCHAR2,
                        plinea4                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario4                 => 0, --IN OUT NUMBER,
                        pcostounitario4                  => 0, --IN OUT NUMBER,
                        pmargendeganancia4               => 0, --IN OUT NUMBER,
                        punidadesvendidas4               => 0, --IN OUT NUMBER,
                        plinea5                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario5                 => 0, --IN OUT NUMBER,
                        pcostounitario5                  => 0, --IN OUT NUMBER,
                        pmargendeganancia5               => 0, --IN OUT NUMBER,
                        punidadesvendidas5               => 0, --IN OUT NUMBER,
                        plinea6                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario6                 => 0, --IN OUT NUMBER,
                        pcostounitario6                  => 0, --IN OUT NUMBER,
                        pmargendeganancia6               => 0, --IN OUT NUMBER,
                        punidadesvendidas6               => 0, --IN OUT NUMBER,
                        plinea7                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario7                 => 0, --IN OUT NUMBER,
                        pcostounitario7                  => 0, --IN OUT NUMBER,
                        pmargendeganancia7               => 0, --IN OUT NUMBER,
                        punidadesvendidas7               => 0, --IN OUT NUMBER,
                        plinea8                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario8                 => 0, --IN OUT NUMBER,
                        pcostounitario8                  => 0, --IN OUT NUMBER,
                        pmargendeganancia8               => 0, --IN OUT NUMBER,
                        punidadesvendidas8               => 0, --IN OUT NUMBER,
                        pcomentario                      => '0', --IN OUT VARCHAR2,
                        pidoficial                       => '0', --IN OUT VARCHAR2,
                        pfecharegistro                   => SYSDATE, --IN OUT DATE,
                        pfechafija                       => '0', --IN OUT VARCHAR2,
                        pidestado                        => '0', --IN OUT VARCHAR2,
                        pmensaje                         => '0', --IN OUT VARCHAR2,
                        pnosubida                        => '0', --IN OUT VARCHAR2,
                        pidgrupo                         => '0', --IN OUT VARCHAR2,
                        pimpreso                         => '0', --IN OUT VARCHAR2,
                        /*Valores a retornar para elimina=> 0, --r uso Funci¿n fnupdatefud que ejecuta via WS
                           proceso debe implementarse en => 0, --el llamado de SQL/Server
                          */
                        pestadofec                       => vestadofec, --IN OUT VARCHAR2,
                        pmensajefec                      => vmensajefec --, --IN OUT VARCHAR2,
                                                                       --pNoSolicitud                     => vNoSolicitud --IN OUT NUMBER
                                                                       );
                    --New Fec Persona End



                    p_depura (
                           'Proceso Fec principal Linea: '
                        || $$plsql_line
                        || ' NoCredito p_nrocredito: '
                        || p_nrocredito);
                END IF;
            EXCEPTION
                WHEN OTHERS
                THEN
                    --p_depura ('error ' || sqlerrm);
                    NULL;
            END;
        --  END IF;
        END;



        --b End

        --C Begin.
        p_depura (
               '==============FinanciallyLinked============== Linea: '
            || $$plsql_line);

        FOR fl IN 1 .. vsolicitud.vinculacion_finaciera.COUNT
        LOOP                               ---vSolicitud.VINCULACION_FINACIERA
            p_depura (
                   'FinanciallyLinked.FinanciallyLinkedCode = '
                || vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan
                || ' Linea: '
                || $$plsql_line);

            p_depura (
                   '==============FinanciallyLinked.Persons==============Linea: '
                || $$plsql_line);

            FOR i
                IN 1 .. vsolicitud.vinculacion_finaciera (fl).personas.COUNT
            LOOP --Personas        ---vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS
                p_depura (
                       'FinanciallyLinked.FinanciallyLinkedCode = Linea: '
                    || $$plsql_line);

                --Procesar Persona Begin
                BEGIN
                    ---vTipo_Solicitante := NULL;
                    p_depura (
                           'vSolicitud.VINCULACION_FINACIERA (fl).CODIGO_VINCULACION_FINAN: '
                        || vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan);

                    vcod_persona := NULL;

                    p_procesar_persona (
                        ppersona           =>
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i),
                        psolicitud         => vsolicitud.id_solicitud_credito,
                        ---pCodigo_Moneda     => vMoneda_Credito,
                        pcod_oficial       =>
                            TO_NUMBER (vsolicitud.codigo_empleado),
                        pcodigo_agencia    =>
                            TO_NUMBER (vsolicitud.codigo_centro_costo /*vSolicitud.CODIGO_BRANCH*/
                                                                     ),
                        psalario           =>
                              NVL (
                                  vsolicitud.vinculacion_finaciera (fl).personas (
                                      i).evaluaciones.ingresos_salariales.salario,
                                  0)
                            + NVL (
                                  vsolicitud.vinculacion_finaciera (fl).personas (
                                      i).evaluaciones.ingresos_salariales.otros_ingresos,
                                  0),
                        --pTipo_Solicitante      => vTipo_solicitante,
                        pcod_persona       => vcod_persona,
                        errorcode          => errorcode,
                        errordescription   => errordescription);

                    p_depura (
                           'Despues p_procesar_persona: vCod_Persona'
                        || vcod_persona
                        || ' Linea: '
                        || $$plsql_line
                        || ' ERRORDESCRIPTION: '
                        || errordescription);


                    ---malmanzar 18-01-2023 Begin

                    p_depura (
                           '2-ORIGEN_RECURSOS:'
                        || vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.origen_recursos);


                    p_operaciones_realizar (
                        pcod_persona            => vcod_persona,
                        ptipo_producto          => 'PRESTAMOS',
                        pcod_moneda             => reg1.codigo_moneda, --vMoneda_Credito,--pTIPOMONEDA,             --'1',
                        pproposito              =>
                            vsolicitud.info_prestamo.destino_credito_especif, ---vFudRow.ESPECIFIQUEDESTINO,
                        pmonto_inicial          =>
                            vsolicitud.info_prestamo.monto_credito, --- pMONTOINICIAL,
                        pinstrumento_bancario   => 'EFECTIVO',
                        /*CASE
                            WHEN pFORMAOPERACION = '1' THEN 'EFECTIVO'
                            WHEN pFORMAOPERACION = '2' THEN 'CHEQUE'
                            WHEN pFORMAOPERACION = '3' THEN 'TRANSFERENCIA'
                        END,*/
                        porigen_fondos          =>
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i).evaluaciones.estado_resultado.origen_recursos, -- 'SALARIO' -- pORIGENRECURSOS  14-05-2024
                        pno_credito             => reg1.no_credito);


                    ---p_depura('vSolicitud.VINCULACION_FINACIERA (fl).CODIGO_VINCULACION_FINAN: ' || vsolicitud.vinculacion_finaciera(fl).codigo_vinculacion_finan);
                    ---DBMS_OUTPUT.PUT_LINE(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).EVALUACIONES.ESTADO_RESULTADO.ORIGEN_RECURSOS    );


                    IF errordescription IS NOT NULL
                    THEN
                        p_depura (
                               'Linea: '
                            || $$plsql_line
                            || ' vCod_Persona: '
                            || vcod_persona
                            || ' ERRORCODE: '
                            || errorcode
                            || ' ERRORDESCRIPTION: '
                            || errordescription);
                        ROLLBACK;
                        p_nrocredito := NULL;          ---malmanzar 09-10-2023
                        raise_application_error (num   => -20000,
                                                 msg   => errordescription);
                    ---raise;
                    END IF;
                --                    DBMS_OUTPUT.PUT_LINE (
                --                           'Person('
                --                        || i
                --                        || ').id = '
                --                        || vSolicitud.PERSONA (i).ID_PERSONA_CREDITO
                --                        || ' vCod_Persona: '
                --                        || vCod_Persona);
                --  DBMS_OUTPUT.PUT_LINE (
                ---  '==============IdentificationDocuments==============');
                END;


                --fl info_laboral Begin 26-01-2024
                FOR n
                    IN 1 ..
                       vsolicitud.vinculacion_finaciera (fl).personas (i).negocios.COUNT
                LOOP                                                --Negocios
                    p_depura (
                        vsolicitud.vinculacion_finaciera (fl).personas (i).negocios.COUNT);

                    FOR l
                        IN 1 ..
                           vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).localizadores.COUNT
                    LOOP                                       --Localizadores
                        --p_depura( vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (i).NEGOCIOS (n).LOCALIZADORES (l).TIPO_LOCALIZADOR);
                        p_depura (
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i).negocios (n).localizadores.COUNT);

                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                             'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Locators('
                        --                            || l
                        --                            || ').locatorTypeCode   = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).LOCALIZADORES (l).TIPO_LOCALIZADOR);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Locators('
                        --                            || l
                        --                            || ').value             = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).LOCALIZADORES (l).VALOR);
                        --
                        IF vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).localizadores (l).tipo_localizador =
                           '01'
                        THEN
                            --                            --Teléfono
                            v_telefono_info_laboral :=
                                vsolicitud.vinculacion_finaciera (fl).personas (
                                    i).negocios (n).localizadores (l).valor;
                        --                        --Email
                        ELSIF vsolicitud.vinculacion_finaciera (fl).personas (
                                  i).negocios (n).localizadores (l).tipo_localizador =
                              '02'
                        THEN
                            v_email__info_laboral :=
                                vsolicitud.vinculacion_finaciera (fl).personas (
                                    i).negocios (n).localizadores (l).valor;
                        END IF;
                    END LOOP;


                    --
                    FOR d
                        IN 1 ..
                           vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).direcciones.COUNT
                    LOOP
                        --                 DBMS_OUTPUT.PUT_LINE (
                        --                        'FinanciallyLinked.Person('
                        --                     || i
                        --                     || ').Businesses('
                        ----                            || n
                        ----                            || ').Addresses('
                        ----                            || d
                        ----                            || ').addressTypeCode          = '
                        ----                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        ----                                   i).NEGOCIOS (n).Direcciones (d).TIPO_DIRECCION);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').countryCode              = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_PAIS);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').sectionCode              = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_PROVINCIA);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').provinceCode             = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_CANTON);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').municipalityCode         = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_DISTRITO);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').districtMunicipalityCode = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_PUEBLO);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').neighborhoodCode         = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).BARRIO);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').street                   = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).CALLE);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').housingTypeCode          = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).TIPO_CASA);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').addressReference         = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).REFERENCIA);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').ResideSince              = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).RESIDE_DESDE);
                        --
                        /* BEGIN
                             SELECT PAIS, COD_PAIS
                               INTO vDescPais, vCodPais
                               FROM PAIS
                              WHERE COD_PAIS_ISO =
                                    vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                                        i).NEGOCIOS (n).Direcciones (d).COD_PAIS;
                         EXCEPTION
                             WHEN OTHERS
                             THEN
                                 vCodPais := 1;
                         END;


                         v_direccion_detalle :=
                             LTRIM (
                                    pa.obt_desc_canton (
                                        vcodpais,
                                        vsolicitud.vinculacion_finaciera (fl).personas (
                                            i).negocios (n).direcciones (d).cod_provincia,
                                        vsolicitud.vinculacion_finaciera (fl).personas (
                                            i).negocios (n).direcciones (d).cod_canton)
                                 || ', '
                                 || pa.obt_desc_distrito (
                                        vcodpais,
                                        vsolicitud.vinculacion_finaciera (fl).personas (
                                            i).negocios (n).direcciones (d).cod_provincia,
                                        vsolicitud.vinculacion_finaciera (fl).personas (
                                            i).negocios (n).direcciones (d).cod_canton,
                                        vsolicitud.vinculacion_finaciera (fl).personas (
                                            i).negocios (n).direcciones (d).cod_distrito)
                                 || ', '
                                 || vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).calle);*/

                        v_direccion_detalle :=
                            f_direccion_completa (
                                pcod_pais_iso          =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_pais, --VARCHAR2,
                                pcod_canton            =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_canton, --VARCHAR2,
                                pcod_provincia         =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_provincia, --VARCHAR2,
                                pcod_distrito          =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_distrito, --VARCHAR2,
                                pcalle                 =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).calle,
                                pincluyedespais        => 'N',
                                pincluyedesprovincia   => 'N');    --VARCHAR2)
                    END LOOP;

                    --


                    ---p_depura(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).NEGOCIOS(n).CODIGO);

                    p_depura (
                           'infolaboral Linea: '
                        || $$plsql_line
                        || ' vcod_persona: '
                        || vcod_persona);
                    p_depura (
                           'infolaboral Linea: '
                        || $$plsql_line
                        || ' vcod_persona: '
                        || vcod_persona
                        || ' : NVL(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).EVALUACIONES.INGRESOS_SALARIALES.SALARIO,0)  NVL(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).EVALUACIONES.INGRESOS_SALARIALES.OTROS_INGRESOS ,0): '
                        || TO_CHAR (
                               vsolicitud.vinculacion_finaciera (fl).personas (
                                   i).evaluaciones.ingresos_salariales.salario)
                        || ' - '
                        || TO_CHAR (
                               vsolicitud.vinculacion_finaciera (fl).personas (
                                   i).evaluaciones.ingresos_salariales.otros_ingresos));

                    IF     vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).nombre
                               IS NOT NULL
                       AND vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).fecha_inicio_operacion
                               IS NOT NULL --- malmanzar 07-06-2024   ---AND pPersona.INFORMACION_TRABAJO.FECHA_INGRESO IS NOT NULL
                    THEN
                        BEGIN
                            p_info_laboral (
                                p_persona     => vcod_persona, ---In  Varchar2,
                                p_fec_ing     =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).fecha_inicio_operacion, --                                      pPersona.INFORMACION_TRABAJO.FECHA_INGRESO,
                                p_lugar_lab   =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).nombre,
                                p_sueldo      =>
                                      NVL (
                                          vsolicitud.vinculacion_finaciera (
                                              fl).personas (i).evaluaciones.ingresos_salariales.salario,
                                          0)
                                    + NVL (
                                          vsolicitud.vinculacion_finaciera (
                                              fl).personas (i).evaluaciones.ingresos_salariales.otros_ingresos,
                                          0), --                                                    pPersona.INFORMACION_TRABAJO.SALARIO_MENSUAL, ---In  Number,
                                p_puesto      =>
                                    vsolicitud.persona (i).informacion_trabajo.cargo, --malmanzar 05-02-2024 -- pPersona.INFORMACION_TRABAJO.CARGO, ---In  Varchar2,
                                p_direccion   => v_direccion_detalle, --pPERSONA.INFORMACION_TRABAJO.DIRECCION.DETALLE, ---pPersona.INFORMACION_TRABAJO.,---In  Varchar2,  --Pendiene
                                p_telefono    => v_telefono_info_laboral, --                                                    pPersona.INFORMACION_TRABAJO.NUMERO_TELEFONO, ---In  Varchar2,
                                p_extension   => NULL, --                                                    pPersona.INFORMACION_TRABAJO.EXTENSION_TELEFONICA, ---In  Varchar2,
                                p_procesado   => v_procesado, ---Out Varchar2,
                                p_msgerr      => p_msgerr      ---Out Varchar2
                                                         );
                        EXCEPTION
                            WHEN OTHERS
                            THEN
                                p_depura ('sqlerrm: ' || SQLERRM);
                                raise_application_error (
                                    -20400,
                                    'Error procesando info laboral');
                        END;
                    END IF;
                END LOOP;

                --fl info_laboral Begin 26-01-2024

                --Conyuge  02-10-2023 Begin
                --if  vSolicitud.VINCULACION_FINACIERA(fl).CODIGO_VINCULACION_FINAN
                --Conyuge 02-10-2023 End

                --Cuenta relacion Begin
                IF vcod_persona IS NOT NULL
                THEN
                    IF vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan =
                       '04'
                    THEN
                        BEGIN
                            UPDATE personas_fisicas
                               SET conyugue = vcod_persona
                             WHERE cod_per_fisica = reg1.codigo_cliente; --v_persona;
                        EXCEPTION
                            WHEN OTHERS
                            THEN
                                NULL;
                        END;
                    ELSIF vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan IN
                              ('02', '03')         -- =  '02' --IN('02', '03')
                    THEN
                        --
                        -- Tipos de Solicitantes
                        --
                        --01 Cliente
                        --02 Fiador
                        --03 Codeudor
                        --04 Conyuge

                        DECLARE
                            vnumero_linea   NUMBER;
                        BEGIN
                            SELECT NVL (MAX (numero_linea), 0) + 1
                              INTO vnumero_linea
                              FROM cuenta_cliente_relacion
                             WHERE num_cuenta = TO_CHAR (reg1.no_credito);


                            p_depura (
                                   'vCod_Persona: '
                                || vcod_persona
                                || 'vSolicitud.VINCULACION_FINACIERA(fl).CODIGO_VINCULACION_FINAN : '
                                || vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan
                                || ' Linea: '
                                || $$plsql_line);

                            --Inserta en tabla cuenta cliente relación
                            INSERT INTO cuenta_cliente_relacion (
                                            num_cuenta,
                                            codigo_cliente,
                                            tipo_relacion,
                                            principal,
                                            cod_sistema,
                                            estado,
                                            numero_linea)
                                     VALUES (
                                                reg1.no_credito,
                                                vcod_persona,
                                                CASE
                                                    WHEN vsolicitud.vinculacion_finaciera (
                                                             fl).codigo_vinculacion_finan =
                                                         '02'
                                                    THEN
                                                        'F'           --Fiador
                                                    ELSE
                                                        'O'         --Codeudor
                                                END,
                                                'N',
                                                'PR',
                                                NULL,
                                                vnumero_linea              --2
                                                             );
                        EXCEPTION
                            WHEN DUP_VAL_ON_INDEX
                            THEN
                                NULL;
                        END;
                    END IF;
                END IF;

                --Cuenta_relacion End



                --Fec Vinculados Begin
                pcreafecpersona (
                    p_solicitud                      => reg1.no_credito,
                    p_codcliente                     => vcod_persona, ---reg1.codigo_cliente,
                    p_codagencia                     => reg1.codigo_agencia, -- IN NUMBER,
                    ptipo_solicitante                =>
                        vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan, --vTipo_Solicitante,     ---Temp
                    --P_cuotasegurocal,
                    ----              monedacal,
                    p_destinocredito                 =>
                        vsolicitud.info_prestamo.destino_credito, -----Temp IN VARCHAR2 ,
                    p_especifiquedestino             =>
                        vsolicitud.info_prestamo.destino_credito_especif, --Temp--IN VARCHAR2,
                    pidtempfec                       => 0,    --IN OUT NUMBER,
                    pnomarchivo                      => '0', --IN OUT VARCHAR2,
                    pidevaluacioncrediticia          => '0', --IN OUT VARCHAR2,
                    ptipodocumentoidentidad          => '0', --IN OUT VARCHAR2,
                    pdocumentoidentidad              => '0', --IN OUT VARCHAR2,
                    pnombrecliente                   => '0', --IN OUT VARCHAR2,
                    pnumerosolicitud                 => p_nrocredito, --IN OUT NUMBER,
                    pmontorecomendado                => reg1.monto_credito, --IN OUT NUMBER,
                    pfrecuencia                      =>
                        vsolicitud.info_prestamo.codigo_frecuencia_pago, --IN OUT VARCHAR2, --malmanzar 14-07-222
                    pplazo                           => reg1.plazo, --IN OUT NUMBER,
                    ppro1ventasmensuales             => 0,    --IN OUT NUMBER,
                    ppro2ventasmensuales             => 0,    --IN OUT NUMBER,
                    ppro3ventasmensuales             => 0,    --IN OUT NUMBER,
                    pprootroventasmensuales          => 0,    --IN OUT NUMBER,
                    pventasmensuales1                => 0,    --IN OUT NUMBER,
                    pventasmensuales2                => 0,    --IN OUT NUMBER,
                    pventasmensuales3                => 0,    --IN OUT NUMBER,
                    pventasmensuales4                => 0,    --IN OUT NUMBER,
                    pventasmensuales5                => 0,    --IN OUT NUMBER,
                    pventasmensuales6                => 0,    --IN OUT NUMBER,
                    pventasmensuales7                => 0,    --IN OUT NUMBER,
                    pventasmensuales8                => 0,    --IN OUT NUMBER,
                    pventasmensualesot               => 0,    --IN OUT NUMBER,
                    pventas_ingresos                 =>
                        NVL (
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i).evaluaciones.ingresos_salariales.salario,
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i).evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas), --30-01-2024 --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_MENSUALES_DECLARADAS, --/**/ -- vSolicitud.EVALUACIONES.TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                    ppro1costosventasmensuales       => 0,    --IN OUT NUMBER,
                    ppro2costosventasmensuales       => 0,    --IN OUT NUMBER,
                    ppro3costosventasmensuales       => 0,    --IN OUT NUMBER,
                    pprootrocostosventasmensuales    => 0,    --IN OUT NUMBER,
                    pcostoventas1                    => 0,    --IN OUT NUMBER,
                    pcostoventas2                    => 0,    --IN OUT NUMBER,
                    pcostoventas3                    => 0,    --IN OUT NUMBER,
                    pcostoventas4                    => 0,    --IN OUT NUMBER,
                    pcostoventas5                    => 0,    --IN OUT NUMBER,
                    pcostoventas6                    => 0,    --IN OUT NUMBER,
                    pcostoventas7                    => 0,    --IN OUT NUMBER,
                    pcostoventas8                    => 0,    --IN OUT NUMBER,
                    pcostoventasot                   => 0,    --IN OUT NUMBER,
                    pcostoventas                     =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.costo_ventas,
                    ---vSolicitud.EVALUACIONES.ESTADO_RESULTADO.COSTO_VENTAS, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.MATRIX_COSTO_INGRESOS.COSTO_MENSUAL_VENTAS, -- vSolicitud.EVALUACIONES.TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                    psueldo                          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_salarial, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_SALARIAL, --IN OUT NUMBER,
                    pservicio                        =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_servicios, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_SERVICIOS, --IN OUT NUMBER,
                    palquiler                        =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.pagos_renta, --IN OUT NUMBER,  --Pendiente
                    ptransporte_combs                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_combustible, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_COMBUSTIBLE, --IN OUT NUMBER,
                    ppagointereses                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_interes_pagos, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_INTERES_PAGOS, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_INTERES_PAGOS, --IN OUT NUMBER,
                    potrosingresos_operacionales     =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.otros_ingresos, --IN OUT NUMBER, --Pendiente
                    palimentacion                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_alimentacion, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_ALIMENTACION, --IN OUT NUMBER,
                    pvivienda                        =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_vivienda, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_VIVIENDA, --IN OUT NUMBER,
                    pvestido                         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_ropa, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_ROPA, --IN OUT NUMBER,
                    ptransporte                      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_transportacion, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_TRANSPORTACION, --IN OUT NUMBER,
                    pservicios                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_servicios, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_SERVICIOS, --IN OUT NUMBER,
                    pmedicinas                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_medicos, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_MEDICOS, --IN OUT NUMBER,
                    peducacion                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_educacion, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_EDUCACION, --IN OUT NUMBER,
                    pdeudasfamiliares                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.debitos, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.DEBITOS, --IN OUT NUMBER,
                    potros_gastos                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.otros_gastos, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.OTROS_GASTOS, --IN OUT NUMBER,
                    ptotalgastos_familiares          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.total_gastos, --IN OUT NUMBER, --pendiente
                    pexcedentefamiliar               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.excedente_familiar, --IN OUT NUMBER, --pendiente
                    potros                           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.otros_gastos, ---otros ingresos--vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.OTROS_INGRESOS, --IN OUT NUMBER,
                    --/  Balance Comercial/
                    pmaquinaria_mueblesequipos       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.maquinaria_mobiliario_eq, ---                vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.MAQUINARIA_MOBILIARIO_EQ, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.MAQUINARIA_MOBILIARIO_EQ, --IN OUT NUMBER,
                    pefectivo_cajabanco              =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.efectivo_caja_chica, --       vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.EFECTIVO_CAJA_CHICA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.EFECTIVO_CAJA_CHICA, --IN OUT NUMBER,
                    pcuentaxcobrar                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuentas_por_cobrar, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CUENTAS_POR_COBRAR, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CUENTAS_POR_COBRAR, --IN OUT NUMBER,
                    pinventario_prod_tem             =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_producto_finalizado, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_FINALIZADO, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_FINALIZADO, --IN OUT NUMBER,
                    pinventario_prod_proc            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_producto_produccion, ---                   vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_PRODUCCION, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_PRODUCCION, --IN OUT NUMBER,
                    pinventario_materiaprima         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_materia_prima, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_MATERIA_PRIMA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_MATERIA_PRIMA, --IN OUT NUMBER,
                    pmercancia                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cantidad_mercancia, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CANTIDAD_MERCANCIA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CANTIDAD_MERCANCIA, --IN OUT NUMBER,
                    panticipo_proveedores            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cantidad_proveedor_anticipado, ---Pendiente  --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CANTIDAD_PROVEEDOR_ANTICIPADO, --IN OUT NUMBER,
                    plocalnegocio                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.valor_local_comercial, --                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.VALOR_LOCAL_COMERCIAL, --vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.LOCAL_ALQUILADO,--vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.VALOR_LOCAL_COMERCIAL, --IN OUT NUMBER,
                    pobligacionesfinancieras         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.balance_oblicacion_financiera, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.BALANCE_OBLICACION_FINANCIERA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.BALANCE_OBLICACION_FINANCIERA, --IN OUT NUMBER,
                    ptotal_pasivo_lp                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_largo_plazo, --            vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_LARGO_PLAZO, ---vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_LARGO_PLAZO, --IN OUT NUMBER,
                    pmueble_vehiculo                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.valor_muebles_vehiculo, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.VALOR_MUEBLES_VEHICULO, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.VALOR_MUEBLES_VEHICULO, --IN OUT NUMBER,
                    pdeudacomercial                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.deuda_comercial, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.DEUDA_COMERCIAL, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.DEUDA_COMERCIAL, --IN OUT NUMBER,
                    ptasa                            => reg1.tasa_interes, --IN OUT NUMBER,  --pendiente
                    pcuota                           => reg1.cuota, --IN OUT NUMBER,  --pendiente
                    pcuentapagarprovedor             =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuenta_por_pagar_proveedor, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_PROVEEDOR, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_PROVEEDOR, --IN OUT NUMBER,
                    pcuentapagarvarias               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuenta_por_pagar_varios, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_VARIOS, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_VARIOS, --IN OUT NUMBER,
                    pinmuebles                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.valor_propiedades, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.VALOR_PROPIEDADES, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.VALOR_PROPIEDADES, --IN OUT NUMBER,
                    ptotal_activofamiliar            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.total_activos_familiares, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.TOTAL_ACTIVOS_FAMILIARES, --IN OUT NUMBER,
                    pdeudabancaria                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.deuda_bancaria, ---                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.DEUDA_BANCARIA, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.DEUDA_BANCARIA, --IN OUT NUMBER,
                    ptotal_pasivofamiliar            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.tota_pasivos_familiar, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.TOTA_PASIVOS_FAMILIAR, --IN OUT NUMBER,
                    ppatrio_fam_balgen               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.total_patrimonio_familiar, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.TOTAL_PATRIMONIO_FAMILIAR, --IN OUT NUMBER,   ---
                    ptotal_activocorriente           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos_corrientes, --              vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_ACTIVOS_CORRIENTES, --IN OUT NUMBER,
                    ptotal_activofijo                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos_fijos, --                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_ACTIVOS_FIJOS, --IN OUT NUMBER,
                    ptotal_activos1                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_ACTIVOS, --IN OUT NUMBER,
                    ptotal_pasivocorrientes          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_corriente, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_CORRIENTE, --IN OUT NUMBER,
                    ptotal_pasivo                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO, --IN OUT NUMBER,
                    ptotal_pasivopatrimonio          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_patrimonio, --                vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_PATRIMONIO, --IN OUT NUMBER,
                    ppasivo_patrimonio               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                    ppatrimonio                      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.patrimonio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.PATRIMONIO, --IN OUT NUMBER,
                    pactivocorte_pascte              => 0,    --IN OUT NUMBER,
                    potrosingresos_excedente         => 0,    --IN OUT NUMBER,
                    pcuotarecomendada_excedfam       => 0,    --IN OUT NUMBER,
                    ptotalpasivo_patrimonio          => 0,    --IN OUT NUMBER,
                    putilidadneta_patrimonio         => 0,    --IN OUT NUMBER,
                    putilidadneta_totalactivos1      => 0,    --IN OUT NUMBER,
                    putilidadneta_ventas             => 0,    --IN OUT NUMBER,
                    pcuentasxcobrar_ventas           => 0,    --IN OUT NUMBER,
                    pcostoventa_inventario           => 0,    --IN OUT NUMBER,
                    pgastoslegales                   =>
                        vsolicitud.info_prestamo.monto_gastos_legales, --IN OUT NUMBER,    --
                    pmoneda                          => '0', --IN OUT VARCHAR2,
                    pcapital_trabajo                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.capital_de_trabajo, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CAPITAL_DE_TRABAJO, ---vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CAPITAL_DE_TRABAJO, --IN OUT NUMBER,
                    pfechabalancegeneral             =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.fecha_balance, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.FECHA_BALANCE, ---vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.FECHA_BALANCE, --IN OUT VARCHAR2,
                    pdesde                           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.fecha_inicio_eval, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.FECHA_INICIO_EVALUACION, --vSolicitud.EVALUACIONES.FECHA_INICIO_EVALUACION, --IN OUT VARCHAR2,
                    phasta                           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.fecha_fin_eval, --                vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.FECHA_FIN_EVALUACION, --vSolicitud.EVALUACIONES.FECHA_FIN_EVALUACION, --IN OUT VARCHAR2,
                    ptotalcostooperacional           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.total_costos_operacional, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.TOTAL_COSTOS_OPERACIONAL, --IN OUT NUMBER,
                    putilidadneta                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.ganacia_neta, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GANACIA_NETA, --IN OUT NUMBER,
                    pventasdiarias_promedio          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_diarias_promedio, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_DIARIAS_PROMEDIO, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_DIARIAS_PROMEDIO, --IN OUT NUMBER,
                    pdiastrabajados                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.dias_trabajados_por_mes, --         vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.DIAS_TRABAJADOS_POR_MES, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.DIAS_TRABAJADOS_POR_MES, --IN OUT NUMBER,
                    pcomprassemanalesdeclaradas      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.compras_semanales_promedio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_SEMANALES_PROMEDIO, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_SEMANALES_PROMEDIO, --IN OUT NUMBER,
                    pventasmensualesdeclaradas       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_MENSUALES_DECLARADAS, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_MENSUALES_DECLARADAS, --IN OUT NUMBER,
                    pmargendeclarado                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.margen_beneficio_declarado, --IN OUT NUMBER,
                    pmontomesalto                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.mayor_beneficio_mes, ----                   vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MONTE_MES_MAS_GANANCIAS, -- vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.MONTE_MES_MAS_GANANCIAS, --IN OUT NUMBER,
                    pmontomesmedio                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.beneficio_prom_mensual, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MONTE_MES, --IN OUT NUMBER,
                    pcomprasmensualesdeclaradas      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.compras_mensuales_declaradas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_MENSUALES_DECLARADAS, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_MENSUALES_DECLARADAS, --IN OUT NUMBER,
                    pmontomesbajo                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.menor_beneficio_mes, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MONTO_MES_MENOS_GANANCIAS, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.MONTO_MES_MENOS_GANANCIAS, --IN OUT NUMBER,
                    pventasmensuales                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.MATRIX_COSTO_INGRESOS.VENTAS_MENSUALES, --vSolicitud.EVALUACIONES.TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                    pcostoventamensual               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.costo_ventas, --                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.MATRIX_COSTO_INGRESOS.COSTO_MENSUAL_VENTAS, --vSolicitud.EVALUACIONES.TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                    putilidadbruta                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.beneficio_ventas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BENEFICIO_BRUTO, --IN OUT NUMBER,
                    pmargenganancia                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.margen_beneficio_declarado, ---                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MARGEN_BENEFICIO_DECLARADO, -- vSolicitud.EVALUACIONES.MATRIX_COSTO_INGRESOS.MARGEN_GANANCIA, --IN OUT NUMBER,
                    pprimera_ref_vecinos             => '0', --IN OUT VARCHAR2,
                    psegunda_ref_vecinos             => '0', --IN OUT VARCHAR2,
                    pambientefamiliar                => '0', --IN OUT VARCHAR2,
                    pdependientes                    => 0,    --IN OUT NUMBER,
                    pedad                            => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                    pestadosaludfamilia              => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                    pingresos                        => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                    potrosingresos                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.otros_ingresos, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.OTROS_INGRESOS, --IN OUT VARCHAR2, --Number  27-07-2022
                    pexperiencia_neg                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.anio_experiencia_negocio, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.ANIO_EXPERIENCIA_NEGOCIO, --IN OUT NUMBER, --malmanzar 27-07-2022
                    phoras_neg                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.horas_trabajo_por_semana, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.HORAS_TRABAJO_POR_SEMANA, --IN OUT NUMBER,
                    plocalpropio                     =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.local_no_alquilado, --0, --IN OUT VARCHAR2, --malmanzar 14-07-2022
                    ptiempoempleo                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.tiempo_lugar_negocio, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.TIEMPO_LUGAR_NEGOCIO, --IN OUT NUMBER,
                    pubicacionnegocio                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.codigo_ubicacion_negocio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.LOCALIZACION_NEGOCIO, --IN OUT VARCHAR2,
                    pllevaregistro                   => '0', --IN OUT VARCHAR2,
                    pmejorasnegocio                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.es_mejoras_comerciales, --               vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.ES_MEJORAS_COMERCIALES, --IN OUT VARCHAR2,
                    pclientesfrecuentes              =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.numero_frecuencia_clientes, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.NUMERO_FRECUENCIA_CLIENTES, --IN OUT NUMBER,
                    pnivelcompetencia                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.nivel_competencia_negocio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.NIVEL_COMPETICION_NEGOCIO, --IN OUT VARCHAR2, --malmanzar 14-07-2022
                    pfecha_balancegeneral_al         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.fecha_balance, --'0',    --IN OUT VARCHAR2,
                    --                             IN=> 0, -- OUT
                    pdestinocredito                  =>
                        vsolicitud.info_prestamo.destino_credito, -- '0',    --IN OUT VARCHAR2,
                    pespecifiquedestino              =>
                        vsolicitud.info_prestamo.destino_credito_especif, --'0',    --IN OUT VARCHAR2,
                    pestadosolicitud                 => 0,    --IN OUT NUMBER,
                    pactividadeconomica              => '0', --IN OUT VARCHAR2,
                    pactividadeconomicadinrap        => '0', --IN OUT VARCHAR2,
                    pmargenbrutoestandar             => 0,    --IN OUT NUMBER,
                    pgastosoperacionalesestandar     => 0,    --IN OUT NUMBER,
                    palto_indicadores                => 0,    --IN OUT NUMBER,
                    pbajo_indicadores                => 0,    --IN OUT NUMBER,
                    plunes                           => '0', --IN OUT VARCHAR2,
                    pmartes                          => '0', --IN OUT VARCHAR2,
                    pmiercoles                       => '0', --IN OUT VARCHAR2,
                    pjueves                          => '0', --IN OUT VARCHAR2,
                    pviernes                         => '0', --IN OUT VARCHAR2,
                    psabado                          => '0', --IN OUT VARCHAR2,
                    pdomingo                         => '0', --IN OUT VARCHAR2,
                    ptotal_ventasaltas               => 0,    --IN OUT NUMBER,
                    ptotal_ventasbajas               => 0,    --IN OUT NUMBER,
                    ptotal_ventassemanales           => 0,    --IN OUT NUMBER,
                    ptotal_ventasmensuales           => 0,    --IN OUT NUMBER,
                    pmargenbrutodeclarado            => 0,    --IN OUT NUMBER,
                    palimentacion_gastos             => 0,    --IN OUT NUMBER,
                    pvivienda_gastos                 => 0,    --IN OUT NUMBER,
                    peducacion_gastos                => 0,    --IN OUT NUMBER,
                    psalud_gastos                    => 0,    --IN OUT NUMBER,
                    ptransporte_gastos               => 0,    --IN OUT NUMBER,
                    pvestido_gastos                  => 0,    --IN OUT NUMBER,
                    ppagodeudas_gastos               => 0,    --IN OUT NUMBER,
                    potros_gastos_familiares         => 0,    --IN OUT NUMBER,
                    ptotal_gastos                    => 0,    --IN OUT NUMBER,
                    pventas_gastos                   => 0,    --IN OUT NUMBER,
                    pcostosventas_gastos             => 0,    --IN OUT NUMBER,
                    pgastosoperativos                => 0,    --IN OUT NUMBER,
                    potros_ingresos_gastos           => 0,    --IN OUT NUMBER,
                    ptotal_gastos_familiares         => 0,    --IN OUT NUMBER,
                    pexcedentefamiliar_gastos        => 0,    --IN OUT NUMBER,
                    pcuotasolicitada                 => 0,    --IN OUT NUMBER,
                    prelcuotasolicitada_excfam       => 0,    --IN OUT NUMBER,
                    ---Datos Recom Soli
                    pmonto_recomendacion             => reg1.monto_credito, --reg1.monto_credito,--0,        --IN OUT NUMBER,
                    pmoneda_recomendacion            => reg1.codigo_moneda, --'0',    --IN OUT VARCHAR2,
                    pplazo_recomendacion             => reg1.plazo_segun_unidad, --0,        --IN OUT NUMBER,
                    ptasa_recomendacion              => reg1.tasa_interes, --0,        --IN OUT NUMBER,
                    pfrecuencia_recomendacion        =>
                        vsolicitud.info_prestamo.codigo_frecuencia_pago, --'0',    --IN OUT VARCHAR2,
                    pcuota_recomendacion             => reg1.cuota, -- 0,        --IN OUT NUMBER,
                    pestadosolicitud_recomendacion   => 0,    --IN OUT NUMBER,
                    pcuotarecomendada_excfamiliar    => 0,    --IN OUT NUMBER,
                    pventasevalanterior              => 0,    --IN OUT NUMBER,
                    pactual_ventas                   => 0,    --IN OUT NUMBER,
                    pvariacionventas                 => 0,    --IN OUT NUMBER,
                    pcomentario1                     => '0', --IN OUT VARCHAR2,
                    pcomentario2                     => '0', --IN OUT VARCHAR2,
                    ppro1nombre                      => '0', --IN OUT VARCHAR2,
                    ppro1materiaprima1               => 0,    --IN OUT NUMBER,
                    ppro1materiaprima2               => 0,    --IN OUT NUMBER,
                    ppro1materiaprima3               => 0,    --IN OUT NUMBER,
                    ppro1totalmp                     => 0,    --IN OUT NUMBER,
                    ppro1sueldo1                     => 0,    --IN OUT NUMBER,
                    ppro1sueldo2                     => 0,    --IN OUT NUMBER,
                    ppro1totalsueldo                 => 0,    --IN OUT NUMBER,
                    ppro1otroscostos                 => 0,    --IN OUT NUMBER,
                    ppro1totalcostos                 => 0,    --IN OUT NUMBER,
                    ppro1costounitario               => 0,    --IN OUT NUMBER,
                    ppro1preciounitario              => 0,    --IN OUT NUMBER,
                    ppro1unidadesvendidas            => 0,    --IN OUT NUMBER,
                    ppro1margenganancia              => 0,    --IN OUT NUMBER,
                    ppro2nombre                      => '0', --IN OUT VARCHAR2,
                    ppro2materiaprima1               => 0,    --IN OUT NUMBER,
                    ppro2materiaprima2               => 0,    --IN OUT NUMBER,
                    ppro2materiaprima3               => 0,    --IN OUT NUMBER,
                    ppro2totalmp                     => 0,    --IN OUT NUMBER,
                    ppro2sueldo1                     => 0,    --IN OUT NUMBER,
                    ppro2sueldo2                     => 0,    --IN OUT NUMBER,
                    ppro2totalsueldo                 => 0,    --IN OUT NUMBER,
                    ppro2otroscostos                 => 0,    --IN OUT NUMBER,
                    ppro2totalcostos                 => 0,    --IN OUT NUMBER,
                    ppro2costounitario               => 0,    --IN OUT NUMBER,
                    ppro2preciounitario              => 0,    --IN OUT NUMBER,
                    ppro2unidadesvendidas            => 0,    --IN OUT NUMBER,
                    ppro2margenganancia              => 0,    --IN OUT NUMBER,
                    ppro3nombre                      => '0', --IN OUT VARCHAR2,
                    ppro3materiaprima1               => 0,    --IN OUT NUMBER,
                    ppro3materiaprima2               => 0,    --IN OUT NUMBER,
                    ppro3materiaprima3               => 0,    --IN OUT NUMBER,
                    ppro3totalmp                     => 0,    --IN OUT NUMBER,
                    ppro3sueldo1                     => 0,    --IN OUT NUMBER,
                    ppro3sueldo2                     => 0,    --IN OUT NUMBER,
                    ppro3totalsueldo                 => 0,    --IN OUT NUMBER,
                    ppro3otroscostos                 => 0,    --IN OUT NUMBER,
                    ppro3totalcostos                 => 0,    --IN OUT NUMBER,
                    ppro3costounitario               => 0,    --IN OUT NUMBER,
                    ppro3preciounitario              => 0,    --IN OUT NUMBER,
                    ppro3unidadesvendidas            => 0,    --IN OUT NUMBER,
                    ppro3margenganancia              => 0,    --IN OUT NUMBER,
                    pprootromateriaprima1            => 0,    --IN OUT NUMBER,
                    pprootromateriaprima2            => 0,    --IN OUT NUMBER,
                    pprootromateriaprima3            => 0,    --IN OUT NUMBER,
                    pprootrototalmp                  => 0,    --IN OUT NUMBER,
                    pprootrosueldo1                  => 0,    --IN OUT NUMBER,
                    pprootrosueldo2                  => 0,    --IN OUT NUMBER,
                    pprootrototalsueldo              => 0,    --IN OUT NUMBER,
                    pprootrootroscostos              => 0,    --IN OUT NUMBER,
                    pprootrototalcostos              => 0,    --IN OUT NUMBER,
                    pprootrocostounitario            => 0,    --IN OUT NUMBER,
                    pprootropreciounitario           => 0,    --IN OUT NUMBER,
                    pprootrounidadesvendidas         => 0,    --IN OUT NUMBER,
                    pprootromargenganancia           => 0,    --IN OUT NUMBER,
                    plinea1                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario1                 => 0,    --IN OUT NUMBER,
                    pcostounitario1                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia1               => 0,    --IN OUT NUMBER,
                    punidadesvendidas1               => 0,    --IN OUT NUMBER,
                    plinea2                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario2                 => 0,    --IN OUT NUMBER,
                    pcostounitario2                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia2               => 0,    --IN OUT NUMBER,
                    punidadesvendidas2               => 0,    --IN OUT NUMBER,
                    plinea3                          => 0,  --IN OUT VARCHAR2,
                    ppreciounitario3                 => 0,    --IN OUT NUMBER,
                    pcostounitario3                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia3               => 0,    --IN OUT NUMBER,
                    punidadesvendidas3               => 0,    --IN OUT NUMBER,
                    plineaot                         => 0,  --IN OUT VARCHAR2,
                    ppreciounitarioot                => 0,    --IN OUT NUMBER,
                    pcostounitarioot                 => 0,    --IN OUT NUMBER,
                    pmargendegananciaot              => 0,    --IN OUT NUMBER,
                    punidadesvendidasot              => 0,    --IN OUT NUMBER,
                    ptipocredito                     => '0', --IN OUT VARCHAR2,
                    pgarantias                       => '0', --IN OUT VARCHAR2,
                    pvalorgarantia                   => '0', --IN OUT VARCHAR2,
                    pdescripciongarantia             => '0', --IN OUT VARCHAR2,
                    pprestamodescontar               => '0', --IN OUT VARCHAR2,
                    plinea4                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario4                 => 0,    --IN OUT NUMBER,
                    pcostounitario4                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia4               => 0,    --IN OUT NUMBER,
                    punidadesvendidas4               => 0,    --IN OUT NUMBER,
                    plinea5                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario5                 => 0,    --IN OUT NUMBER,
                    pcostounitario5                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia5               => 0,    --IN OUT NUMBER,
                    punidadesvendidas5               => 0,    --IN OUT NUMBER,
                    plinea6                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario6                 => 0,    --IN OUT NUMBER,
                    pcostounitario6                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia6               => 0,    --IN OUT NUMBER,
                    punidadesvendidas6               => 0,    --IN OUT NUMBER,
                    plinea7                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario7                 => 0,    --IN OUT NUMBER,
                    pcostounitario7                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia7               => 0,    --IN OUT NUMBER,
                    punidadesvendidas7               => 0,    --IN OUT NUMBER,
                    plinea8                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario8                 => 0,    --IN OUT NUMBER,
                    pcostounitario8                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia8               => 0,    --IN OUT NUMBER,
                    punidadesvendidas8               => 0,    --IN OUT NUMBER,
                    pcomentario                      => '0', --IN OUT VARCHAR2,
                    pidoficial                       => '0', --IN OUT VARCHAR2,
                    pfecharegistro                   => SYSDATE, --IN OUT DATE,
                    pfechafija                       => '0', --IN OUT VARCHAR2,
                    pidestado                        => '0', --IN OUT VARCHAR2,
                    pmensaje                         => '0', --IN OUT VARCHAR2,
                    pnosubida                        => '0', --IN OUT VARCHAR2,
                    pidgrupo                         => '0', --IN OUT VARCHAR2,
                    pimpreso                         => '0', --IN OUT VARCHAR2,
                    /*Valores a retornar para elimina=> 0, --r uso Funci¿n fnupdatefud que ejecuta via WS
                       proceso debe implementarse en => 0, --el llamado de SQL/Server
                      */
                    pestadofec                       => vestadofec, --IN OUT VARCHAR2,
                    pmensajefec                      => vmensajefec --, --IN OUT VARCHAR2,
                                                                   --pNoSolicitud                     => vNoSolicitud --IN OUT NUMBER
                                                                   );
            END LOOP;      -----vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS
        END LOOP;                        ---- vSolicitud.VINCULACION_FINACIERA



        p_depura ('Linea: ' || $$plsql_line);

        FOR s IN 1 .. vsolicitud.info_prestamo.seguros.COUNT
        LOOP
            p_depura ('Linea: ' || $$plsql_line);
            DBMS_OUTPUT.put_line (
                   'LoanInfo.insurances('
                || s
                || ').insuranceTypeCode = '
                || vsolicitud.info_prestamo.seguros (s).tipo_seguro);
            DBMS_OUTPUT.put_line (
                   'LoanInfo.insurances('
                || s
                || ').amount = '
                || vsolicitud.info_prestamo.seguros (s).monto);

            --Seguros Begin

            --Recalcular seguro de vida 28-03-2023 para incluir codeudor en el c¿lculo
            --                    IF NVL (vEsVida, 'N') = 'S'
            --                    THEN
            DECLARE
                cmensaje         VARCHAR2 (500);
                vmonto_calculo   NUMBER;
                --Out
                vesvida          VARCHAR2 (1);
                vesvehiculo      VARCHAR2 (1);
                vesincendio      VARCHAR2 (1);
                vesincendiopy    VARCHAR2 (1);
                vesdesempleo     VARCHAR2 (1);
                vcodeudor        VARCHAR2 (30);
            BEGIN
                --                            DELETE pr_polizas_x_credito
                --                             WHERE     codigo_empresa = 1
                --                                   AND no_credito = p_nrocredito
                --                                   AND tipo_poliza IN
                --                                           (SELECT tipo_poliza
                --                                              FROM pr_tipos_polizas
                --                                             WHERE uso = 'V');
                p_depura (
                       'Linea: '
                    || $$plsql_line
                    || ' VSolicitud.INFO_PRESTAMO.SEGUROS(s).TIPO_SEGURO: '
                    || vsolicitud.info_prestamo.seguros (s).tipo_seguro);

                /*    pkg_polizas.determina_poliza (
                        pEmpresa        => p_codempresa,             -- In Number,
                        pCredito        => reg1.no_credito,          -- In Number,
                        pTipoPoliza     =>
                            VSolicitud.INFO_PRESTAMO.SEGUROS (s).TIPO_SEGURO, --vTipoPoliza  ,-- In Number,
                        pEsVida         => vEsVida,               -- Out Varchar2,
                        pEsVehiculo     => vEsVehiculo,           -- Out Varchar2,
                        pEsIncendio     => vEsIncendio,           -- Out Varchar2,
                        pEsIncendioPy   => vEsIncendioPy,         -- Out Varchar2,
                        pEsDesempleo    => vEsDesempleo,          -- Out Varchar2,
                        pCodeudor       => vCodeudor                -- Out Number)
                                                    );                          --
      */
                --30-01-2024
                IF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'V'
                THEN
                    vesvida := 'S';                              --Seguro Vida
                    vesvehiculo := 'N';
                    vesincendio := 'N';
                    vesincendiopy := 'N';
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'H'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'N';
                    vesincendio := 'S';                          --Hipotecario
                    vesincendiopy := 'N';
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'I'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'N';
                    vesincendio := 'N';
                    vesincendiopy := 'S';                      --Incendio Pyme
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'A'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'S';                             --Vehiculo
                    vesincendio := 'N';
                    vesincendiopy := 'N';
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'D'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'N';
                    vesincendio := 'N';
                    vesincendiopy := 'N';
                    vesdesempleo := 'S';                           --Desempleo
                END IF;



                IF vesdesempleo = 'N'
                THEN
                    pkg_polizas.agrega_poliza (
                        pempresa        => 1,
                        pcredito        => p_nrocredito,      ---p_no_credito,
                        pfecha          => TRUNC (SYSDATE), ---p_credito.f_apertura,
                        --Sysdate,
                        pesvida         => vesvida,                     --'S',
                        pesvehiculo     => vesvehiculo,                 --'N',
                        pesincendio     => vesincendio,                -- 'N',
                        pesincendiopy   => vesincendiopy,               --'N',
                        pmensajeerror   => cmensaje,
                        pcodeudor       => vcodeudor, --v_persona,    --vncodeudor,
                        paccion         => 'I', --C = Solo c¿lculo, I = Calcula e inserta
                        ptipopoliza     => NULL, --  VSolicitud.INFO_PRESTAMO.SEGUROS (s).TIPO_SEGURO, -- NULL,  --30-01-2024
                        pmontocalculo   => vmonto_calculo);

                    p_depura ('vesincendio = ' || vesincendio);
                    p_depura ('vesincendiopy = ' || vesincendiopy);

                    IF vesincendiopy = 'S'
                    THEN                                --malmanzar 16-09-2024
                        UPDATE pr_creditos
                           SET esincendio_pyme = 'S'
                         WHERE     codigo_empresa = 1
                               AND no_credito = p_nrocredito;
                    END IF;
                ELSE
                    --OMARIOT 08/06/2018 REQ_84355 Seguro Desempleo
                    BEGIN
                        --IF NVL (pSEGURODESEMPLEODIS, 0) = 1
                        ---THEN
                        DECLARE
                            vparamlist             pkg_polizas.tlistaparam
                                                       := pkg_polizas.tlistaparam ();
                            nindex                 PLS_INTEGER := 0;
                            nedad                  NUMBER := 0;
                            nedadminima            NUMBER := 0;
                            nedadmaxima            NUMBER := 0;

                            perrordescription      VARCHAR2 (500);

                            form_trigger_failure   EXCEPTION;
                        BEGIN
                            BEGIN
                                --  Calcula la edad de la persona
                                SELECT TRUNC (
                                             (  TRUNC (SYSDATE)
                                              - p.fec_nacimiento)
                                           / 365)
                                  INTO nedad
                                  FROM pa.personas_fisicas p
                                 WHERE p.cod_per_fisica = reg1.codigo_cliente; ---v_persona; --:BKCREDIT.CODIGO_CLIENTE;
                            EXCEPTION
                                WHEN NO_DATA_FOUND
                                THEN
                                    perrordescription :=
                                        'El cliente no está registrado como persona fisica.';
                                    --Message(' ');
                                    RAISE form_trigger_failure;
                            END;

                            nedadminima :=
                                TO_NUMBER (
                                    param.parametro_x_empresa (
                                        1,
                                        'POL_DESEMPLEOEDADMIN',
                                        'PR'));
                            nedadmaxima :=
                                TO_NUMBER (
                                    param.parametro_x_empresa (
                                        1,
                                        'POL_DESEMPLEOEDADMAX',
                                        'PR'));

                            --  Validación de la edad de la persona dentro del rango permitido
                            IF nedad BETWEEN (nedadminima) AND (nedadmaxima)
                            THEN
                                ---MARCA_INDICADOR_POLIZA;

                                vparamlist.delete;
                                nindex := nindex + 1;
                                vparamlist.EXTEND;
                                vparamlist (nindex) :=
                                    pkg_polizas.agrega_parametro (
                                        pnombreparam   => 'ESDESEMPLEO',
                                        puso           => 'D',
                                        pindparam      => 'S');

                                pkg_polizas.agrega_poliza_list (
                                    pempresa         => 1, ---:Variables.CodEmpresa,
                                    pcredito         => reg1.no_credito, --vFudRow.nocredito, ---:BKCredit.No_Credito,
                                    pfecha           => SYSDATE, ---vFudRow.fecha_registro, --:Variables.Fecha,
                                    pindtipopoliza   => vparamlist,
                                    pmensajeerror    => perrordescription);

                                IF perrordescription IS NOT NULL
                                THEN
                                    -- Message(cMensaje);
                                    --Message(' ');
                                    RAISE form_trigger_failure;
                                ELSE
                                    agregar_indicador_marcarpoliza (
                                        1,
                                        reg1.no_credito, ---vFudRow.nocredito,
                                        0,
                                        'D',
                                        'S',
                                        perrordescription);

                                    IF perrordescription IS NOT NULL
                                    THEN
                                        RAISE form_trigger_failure;
                                    END IF;
                                END IF;
                            --END IF;

                            ELSE
                                perrordescription :=
                                       'La Persona debe tener la edad permitida ('
                                    || nedadminima
                                    || '-'
                                    || nedadmaxima
                                    || ') para este tipo de póliza.';
                                --Message(' ');
                                RAISE form_trigger_failure;
                            END IF;
                        EXCEPTION
                            WHEN form_trigger_failure
                            THEN
                                ROLLBACK;
                                RETURN;
                        END;
                    --   Else
                    --    PKG_POLIZAS.Borrar_Poliza(pEmpresa       => 1,
                    --                                 pCredito       => vFudRow.nocredito,--:BKCredit.No_Credito,
                    --                                 pTipoUso       => 'D',
                    --                                 pTipoCredito   => vFudRow.CODIGOPROYECTO --:BKCredit.Tipo_Credito
                    --);
                    --- END IF;
                    END;
                -- FIN OMARIOT 08/06/2018
                END IF;



                p_depura (
                       'VSolicitud.INFO_PRESTAMO.SEGUROS(s).TIPO_SEGURO: '
                    || vsolicitud.info_prestamo.seguros (s).tipo_seguro
                    || '  cmensaje: '
                    || cmensaje);

                COMMIT;

                --                IF cmensaje IS NOT NULL
                --                THEN
                --                    PR.PKG_PORTACREDIT2.AgregarTarea (
                --                           'Tarea agregando seguro: '
                --                        || VSolicitud.INFO_PRESTAMO.SEGUROS (s).TIPO_SEGURO,
                --                        'pr_poliza_x_credito',
                --                        'tipo_poliza',
                --                        '404',
                --                        cmensaje,
                --                        TO_CHAR (p_nrocredito));
                --                ELSE
                --                    PR.PKG_PORTACREDIT2.AgregarTarea (
                --                           'Tarea agregando seguro: '
                --                        || VSolicitud.INFO_PRESTAMO.SEGUROS (s).TIPO_SEGURO,
                --                        'pr_poliza_x_credito',
                --                        'tipo_poliza',
                --                        '200',
                --                        'Poliza agrada correctamente.',
                --                        TO_CHAR (p_nrocredito));
                --                -- ROLLBACK;
                --                ---  RETURN;
                --                END IF;

                vtasks := pr.pkg_portacredit2.obtenertareas;
                pc_task := vtasks;

                p_depura (
                       'cmensaje: '
                    || cmensaje
                    || ' vmonto_calculo: '
                    || vmonto_calculo);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea: ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    NULL;
            END;
        --- END IF;                                           --ESVIDA
        --Seguros End

        END LOOP;

        --End


        ---vTasks := PR.PKG_PORTACREDIT2.ObtenerTareas;
        pc_task := vtasks;
    END pcrearsolicitud_old;


    PROCEDURE p_busca_id_persona (pcod_tipo_id       VARCHAR2,
                                  pnum_id            VARCHAR2,
                                  pcod_persona   OUT VARCHAR2)
    IS
    BEGIN
        SELECT cod_persona
          INTO pcod_persona
          FROM id_personas
         WHERE cod_tipo_id = pcod_tipo_id AND num_id = pnum_id;
    EXCEPTION
        WHEN NO_DATA_FOUND
        THEN
            pcod_persona := NULL;
    END;


    PROCEDURE p_procesar_persona (ppersona           IN     pr.persona_cr_obj,
                                  psolicitud         IN     VARCHAR2,
                                  --pCodigo_Moneda     IN     NUMBER,
                                  pcod_oficial       IN     NUMBER,
                                  pcodigo_agencia    IN     NUMBER,
                                  --pTipo_Solicitante     OUT VARCHAR2,
                                  psalario           IN     NUMBER,
                                  pcod_persona          OUT VARCHAR2,
                                  errorcode             OUT VARCHAR2,
                                  errordescription      OUT VARCHAR2)
    IS
        vcod_persona              VARCHAR2 (15);
        ---vCod_PersonaEncontrada varchar2(15);

        vtipodocumentoidentidad   VARCHAR2 (5);
        vnumidformat              VARCHAR2 (30);
        --
        --vactividadc                 personas_fisicas.actividad%TYPE;
        vactividadp               personas_fisicas.actividad%TYPE;
        --vcodsubactividadc           sub_actividades_economicas.codigo_subactividad%TYPE;
        vcodsubactividadp         sub_actividades_economicas.codigo_subactividad%TYPE;

        ---    vTipoPersona              PERSONAS_FISICAS.TIPO_PERSONA%TYPE;
        vtipo_cliente             personas_fisicas.tipo_cliente%TYPE;
        vsector_economico         personas_fisicas.cod_sector%TYPE;
        vactividad_ciiu           personas_fisicas.cod_actividad%TYPE;

        v_codpais                 VARCHAR2 (5);
        ---
        vcod_direccion            dir_personas.cod_direccion%TYPE;
        vdireccion                dir_personas.detalle%TYPE;
        v_pa_distritos_list       pa_pkg_utl.t_pa_distritos_list
                                      := pa_pkg_utl.t_pa_distritos_list ();
        vidprovincia              provincias.cod_provincia%TYPE;
        ---
        ves_default               VARCHAR2 (1);
        vtip_telefono             VARCHAR2 (1);
        ---
        nacionalidadpe            id_personas.nacionalidad%TYPE;

        p_codempresa              NUMBER (5);
        vcodoficial               cliente.cod_oficial%TYPE;

        v_pa_empleados_list       pa_pkg_utl.t_pa_empleados_list
                                      := pa_pkg_utl.t_pa_empleados_list ();
        v_pr_pr_analistas_list    pr_pkg_utl.t_pr_analistas_list
                                      := pr_pkg_utl.t_pr_analistas_list ();

        v_cod_cat_clte            cat_clientes.cod_cat_clte%TYPE
            := param.parametro_x_empresa (p_codempresa   => '1',
                                          p_abrev        => 'P_COD_CAT_CLTE',
                                          p_codsistema   => 'PA');

        vmoneda_credito           NUMBER;

        vsqlerrm_char             VARCHAR2 (4000);
        p_msgerr                  VARCHAR2 (4000);

        v_procesado               VARCHAR2 (1);

        vmail                     VARCHAR2 (100);

        v_direccion               VARCHAR2 (300);
        v_telefono                VARCHAR2 (20);



        vcrear                    BOOLEAN;
    BEGIN
        p_codempresa := 1;

        FOR x IN 1 .. ppersona.identificaciones.COUNT
        LOOP
            vtipodocumentoidentidad := NULL;                      --04-08-2022

            vtipodocumentoidentidad :=
                f_tipoid_pda_core (
                    ptipo_id_pda   =>
                        ppersona.identificaciones (x).cod_tipo_id --ptipodocumentoidentidad
                                                                 ); --malmanzar 09-06-2022

            ---vnumidformat :=

            SELECT pa.formatear_identificacion (
                       REPLACE (ppersona.identificaciones (x).num_id, '-'),
                       (SELECT mascara
                          FROM tipos_id
                         WHERE cod_tipo_id = vtipodocumentoidentidad),
                       'ESPA')
              --CASE WHEN vSolicitud.PERSONA(i).IDENTIFICACIONES(x).COD_TIPO_ID = 'C' THEN '1' ELSE '6' END
              INTO vnumidformat
              FROM DUAL;

            /*pa.formatear_identifi (ppersona.identificaciones (x).num_id, --(pnumdocumentoidentidad,
                                   vtipodocumentoidentidad);   06-06-2024*/
            -- ptipodocumentoidentidad  03-03-2023

            p_busca_id_persona (pcod_tipo_id   => vtipodocumentoidentidad, --ppersona.identificaciones (x).cod_tipo_id,
                                pnum_id        => vnumidformat, --ppersona.identificaciones (x).num_id,
                                pcod_persona   => vcod_persona);

            IF vcod_persona IS NOT NULL
            THEN
                pcod_persona := vcod_persona;
                vcrear := FALSE;
                EXIT;
            END IF;
        END LOOP;                                   --Identificaciones Persona

        IF pcod_persona IS NULL
        THEN
            SELECT s_cod_persona.NEXTVAL INTO vcod_persona FROM DUAL;

            vcrear := TRUE;
        ELSE
            vcrear := FALSE;
        END IF;

        --Insertar Persona Fisica

        --vTipoPersona := pPERSONA.TIPO_SOLICITUD_CREDITO; ---'P5'; --Pendiente 23-08-2023
        vtipo_cliente := ppersona.tipo_codigo_cliente; -- 511;  ----CustomerTypeCode   03-10-2023
        vsector_economico := ppersona.sector_economico; ---'16';  --09-10-2023

        vactividad_ciiu := NULL;
        vactividad_ciiu := ppersona.cod_actividad; --31-05-2024  '950004'; -- pPERSONA.CODIGO_ACTIVIDAD_ECONOMICA;-- '950004';   09-10-2023

        v_codpais := '1';

        BEGIN
            SELECT concepto, grupo     --<<I.SSANMIGUEL|SYSDECL-508|13042016>>
              INTO vactividadp, vcodsubactividadp
              FROM pa.actividades_economicas_bc_ciiu
             WHERE segregacion_rd = vactividad_ciiu --pPersona.CIIU_ACTIVIDAD-- pIDRAMA_CIIU
                                                    AND estado = 'S';
        EXCEPTION
            WHEN OTHERS
            THEN
                errorcode := '5-' || errorcode;
                errordescription :=
                       errordescription
                    || '-Agregando Personas Fisicas 2 '
                    || 'pIDRAMA_CIIU '
                    || vactividad_ciiu                          --pIDRAMA_CIIU
                    || SQLERRM
                    || ' vcod_persona: '
                    || vcod_persona
                    || ' Line: '
                    || $$plsql_line;
                p_depura (errordescription);
                ROLLBACK;
                raise_application_error (num   => -20000,
                                         msg   => errordescription);
        --   RETURN;
        END;


        DBMS_OUTPUT.put_line ('==============Locators==============');

        FOR l IN 1 .. ppersona.localizadores.COUNT
        LOOP
            --            p_depura (
            --                   'Person(ocators('
            --                || l
            --                || ').locatorTypeCode = '
            --                || ppersona.localizadores (l).tipo_localizador);
            --            p_depura (
            --                   'Person(.Locators('
            --                || l
            --                || ').value = '
            --                || ppersona.localizadores (l).valor);

            IF ppersona.localizadores (l).tipo_localizador = '02'
            THEN
                vmail := ppersona.localizadores (l).valor;
                EXIT;
            ELSE
                vmail := NULL;
            END IF;
        END LOOP;



        IF vcrear     ---Pendiente la parte de actualización cliente existente
        THEN
            BEGIN
                pa_pkg_utl.pa_personas_fisicas_insert (
                    pcod_per_fisica         => vcod_persona, -- v_persona,    1
                    pest_civil              => ppersona.estado_civil, --pPersona.CODIGO_ESTADO_CIVIL, --pIDESTADOCIVIL, 2
                    psexo                   => ppersona.genero, ---pPersona.CODIGO_GENERO, --pPersona. pSEXO, 3
                    pfec_nacimiento         => ppersona.fecha_nacimiento, --  TO_DATE (pPersona.FECHA_NACIMIENTO, 'dd-mm-yyyy'),  --4
                    pprimer_apellido        => UPPER (ppersona.primer_apellido), --pPRIMERAPELLIDO, --pPrimer_Apellido , 5
                    psegundo_apellido       => UPPER (ppersona.segundo_apellido), ---pSEGUNDOAPELLIDO, --pSegundo_Apellido , ----Verificar con Fermín y Carlos Baez 22-08-2023 6
                    pprimer_nombre          => UPPER (ppersona.primer_nombre), --pPRIMERNOMBRE,   --pPrimer_Nombre,   7
                    psegundo_nombre         => UPPER (ppersona.segundo_nombre), --pSEGUNDONOMBRE, ---pSegundo_Nombre, ----Verificar con Fermín y Carlos Baez  22-08-2023 8
                    pprofesion              => NULL,                       --9
                    pidioma_correo          => 'ESPA',                    --10
                    pes_mal_deudor          => NULL,                      --11
                    pconyugue               => NULL,                      --12
                    pnacionalidad           => 'Dominicana', --v_nompais,   Verificar con Fermín y Carlos Baez  22-08-2023, Inoa: se enviara pais  13
                    pcod_sector             => vsector_economico, ---TO_NUMBER (pPersona.CODIGO_ACTIVIDAD_ECONOMICA/*pSECTORECONOMICO*/), 14
                    pestatal                => NULL,                     -- 15
                    pemail_usuario          => vmail, --'Pendiente@mail.com',    --pEMAIL, 16
                    pemail_servidor         => NULL,                     -- 17
                    pnivel_estudios         => NULL,                      --18
                    ptipo_vivienda          => NULL,                      --19
                    pnum_hijos              => ppersona.cantidad_hijos, --pNOHIJOS, --20
                    pnum_dependientes       => ppersona.cantidad_dependientes, --pDEPENDIENTES,   --21
                    pes_residente           => NULL,                      --22
                    ptiempo_vivien_act      => NULL,                      --23
                    peval_ref_bancaria      => 'V',                       --24
                    peval_ref_tarjetas      => 'V',                       --25
                    peval_ref_laboral       => 'C',                       --26
                    ptotal_ingresos         => 0,                         --27
                    pcod_pais               => v_codpais, --malmanzar 10-03-2022  -28
                    pincluido_por           => USER,                      --29
                    pfec_inclusion          => SYSDATE,                   --30
                    pmodificado_por         => NULL,                      --31
                    pfec_modificacion       => NULL,                      --32
                    pscoring                => NULL,                      --33
                    pactividad              => vactividadp,               --34
                    prango_ingresos         => 1,                         --35
                    pcasada_apellido        => NULL,                      --36
                    pes_funcionario         => NULL,                      --37
                    pes_peps                =>
                        CASE
                            WHEN UPPER (ppersona.es_pep) = 'TRUE' THEN 'S'
                            ELSE 'N'
                        END,                                      --NULL,   38
                    pcod_actividad          => vactividad_ciiu, --pPersona.CIIU_ACTIVIDAD,--pidrama_ciiu,                ---39 --Pendiente 23-08-2023 --39
                    pcod_subactividad       => vcodsubactividadp,         --40
                    ptipo_persona           => ppersona.codigo_tipo_persona, --vTipoPersona, ----ptipopersona2,    ---pTIPOPERSONA, ---Pendiente 23-08-2023 --41
                    ptipo_cliente           => vtipo_cliente, ---pTIPOCLIENTE,   --42
                    pcod_pais_padre         => v_codpais,                 --43
                    pcod_pais_madre         => v_codpais,                 --44
                    pcod_pais_conyugue      => v_codpais,                 --45
                    pmas_180_dias_eeuu      => NULL,
                    pcod_finalidad          => NULL,
                    ppeso                   => NULL,
                    pestatura               => NULL,
                    pactividad_polizah      => NULL,
                    pdeporte_polizah        => NULL,
                    ppeso_polizah           => NULL,
                    pestatura_polizah       => NULL,
                    papellido_casada        => NULL,
                    ptercer_nombre          => NULL,
                    ptipo_soc_conyugal      => NULL,
                    pind_fallecimiento      => NULL,
                    pfec_fallecimiento      => NULL,
                    pgpo_riesgo             => NULL,
                    pnum_empleados          => NULL,
                    pventas_ingresos        => NULL,
                    pcp_total_activo        => NULL,
                    pind_clte_vip           => NULL,
                    pocupacion_clasif_nac   => ppersona.ocupacion_clasif_nac, --IN    VARCHAR2, --15-10-2024
                    ptipo_gen_divisas       => ppersona.tipo_gen_divisas, --IN     VARCHAR2, --15-10-2024
                    errorcode               => errorcode,
                    errordescription        => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '6-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Creando persona fisica >>  Program Unit = '
                        || $$plsql_unit
                        || ' $$PLSQL_LINE = '
                        || $$plsql_line
                        || ' Sqlerrm '
                        || SQLERRM;


                    --                    p_depura (
                    --                           'errorCode '
                    --                        || errorcode
                    --                        || ' errorDescription '
                    --                        || errordescription
                    --                        || ' pPersona.CODIGO_TIPO_PERSONA: '
                    --                        || ppersona.codigo_tipo_persona);
                    raise_application_error (num   => -20000,
                                             msg   => errordescription);
            --RETURN;
            END;

            --



            -- Insertar Persona
            BEGIN
                pa_pkg_utl.pa_personas_insert (
                    pcod_persona          => vcod_persona,        --v_persona,
                    pcod_per_fisica       => vcod_persona,        --v_persona,
                    pcod_per_juridica     => NULL,
                    pes_fisica            => 'S',
                    pnombre               => ppersona.nombre_completo,
                    --                           pPRIMERNOMBRE
                    --                        || ' '
                    --                        || pSEGUNDONOMBRE
                    --                        || ' '
                    --                        || PPRIMERAPELLIDO
                    --                        || ' '
                    --                        || PSEGUNDOAPELLIDO,
                    pind_clte_i2000       => 'N',
                    ppaga_imp_ley288      => 'S',
                    pbenef_pag_ley288     => 'S',
                    pcod_vinculacion      => ppersona.tipo_relacion_empleado, --TIPO_ENLACE_EMPLEADO, --pIDTIPOVINCULADO,
                    pcod_sec_contable     => '030202', --pSECTORECONOMICO, --11-04-2023
                    padicionado_por       => USER,
                    pfecha_adicion        => SYSDATE,
                    pmodificado_por       => NULL,
                    pfecha_modificacion   => NULL,
                    pcodigo_sustituto     => NULL,
                    pestado_persona       => 'A',
                    pcobr_nodgii_132011   => 'N',
                    plleno_fatca          => 'N',
                    pimprimio_fatca       => 'N',
                    pes_fatca             => 'N',
                    pfec_actualizacion    => NULL,
                    ptel_verificado       => 'N',
                    errorcode             => errorcode,
                    errordescription      => errordescription);
            --                PR.PKG_PORTACREDIT2.AgregarTarea (
            --                    'Tarea Insertar persona fisica',
            --                    'PA.PERSONAS_FISICAS',
            --                    vcod_persona,
            --                    '200',
            --                    'Persona creada exitosamente',
            --                    vcod_persona);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '7-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Creando persona  >>Sqlerrm '
                        || SQLERRM;
                    RETURN;
            END;
        --

        ELSE --04-10-2023 malmanzar , pendiente codigo cuando está bloqueado el registro.
            --Actualiza persona

            BEGIN
                pa_pkg_utl.pa_personas_fisicas_update (
                    pcod_per_fisica         => vcod_persona,
                    pest_civil              => NULL,
                    psexo                   => NULL,
                    pfec_nacimiento         => NULL,
                    pprimer_apellido        => NULL,
                    psegundo_apellido       => NULL,
                    pprimer_nombre          => NULL,
                    psegundo_nombre         => NULL,
                    pprofesion              => NULL,
                    pidioma_correo          => NULL,
                    pes_mal_deudor          => NULL,
                    pconyugue               => NULL,
                    pnacionalidad           => NULL,
                    pcod_sector             => NULL,
                    pestatal                => NULL,
                    pemail_usuario          => vmail, ---NULL,   malmanzar 22-01-2024
                    pemail_servidor         => NULL,
                    pnivel_estudios         => NULL,
                    ptipo_vivienda          => NULL,
                    pnum_hijos              => NULL,
                    pnum_dependientes       => NULL,
                    pes_residente           => NULL,
                    ptiempo_vivien_act      => NULL,
                    peval_ref_bancaria      => NULL,
                    peval_ref_tarjetas      => NULL,
                    peval_ref_laboral       => NULL,
                    ptotal_ingresos         => NULL,
                    pcod_pais               => NULL,
                    pincluido_por           => NULL,
                    pfec_inclusion          => NULL,
                    pmodificado_por         => NULL,
                    pfec_modificacion       => NULL,
                    pscoring                => NULL,
                    pactividad              => NULL,
                    prango_ingresos         => NULL,
                    pcasada_apellido        => NULL,
                    pes_funcionario         => ppersona.tiene_relacion_pep, --MALMANZAR 22-01-2023
                    --                        CASE
                    --                            WHEN                           /*pFUNCIONARIOGOB*/
                    --                                 pPersona.TIENE_RELACION_PEP = 'true'
                    --                            THEN
                    --                                'S'
                    --                            ELSE
                    --                                'N'
                    --                        END,    --malmanzar 02-12-2022 por cambio tipo de dato
                    pes_peps                => ppersona.es_pep, --MALMANZAR 22-01-2023
                    --                        CASE
                    --                            WHEN                          /*pPARENTESCOFUNCI*/
                    --                                 pPersona.ES_PEP = 'true' THEN 'S'
                    --                            ELSE 'N'
                    --                        END,    --malmanzar 02-12-2022 por cambio tipo de dato
                    pcod_actividad          => vactividad_ciiu, --NULL, malmanzar 31-05-2024
                    pcod_subactividad       => NULL,
                    ptipo_persona           => NULL,
                    ptipo_cliente           => NULL,
                    pcod_pais_padre         => NULL,
                    pcod_pais_madre         => NULL,
                    pcod_pais_conyugue      => NULL,
                    pmas_180_dias_eeuu      => NULL,
                    pcod_finalidad          => NULL,
                    ppeso                   => NULL,
                    pestatura               => NULL,
                    pactividad_polizah      => NULL,
                    pdeporte_polizah        => NULL,
                    ppeso_polizah           => NULL,
                    pestatura_polizah       => NULL,
                    papellido_casada        => NULL,
                    ptercer_nombre          => NULL,
                    ptipo_soc_conyugal      => NULL,
                    pind_fallecimiento      => NULL,
                    pfec_fallecimiento      => NULL,
                    pgpo_riesgo             => NULL,
                    pnum_empleados          => NULL,
                    pventas_ingresos        => NULL, --pVOLUMENVENTA, 04-10-2023 --NULL,malmanzar 23-01-2023
                    pcp_total_activo        => NULL, --pACTIVOSTOTAL,  04-10-2023 --NULL,  malmanzar 23-01-2023
                    pind_clte_vip           => NULL,
                    pocupacion_clasif_nac   => ppersona.ocupacion_clasif_nac,
                    ptipo_gen_divisas       => ppersona.tipo_gen_divisas,
                    errorcode               => errorcode,
                    errordescription        => errordescription);

                IF errordescription IS NOT NULL
                THEN                          --malmanzar 24-07-2023 Req. 9272
                    ROLLBACK;
                    RETURN;
                END IF;
            EXCEPTION
                WHEN OTHERS
                THEN
                    errordescription := 'SQLERRM: ' || SQLERRM;
                    RETURN;
            END;                              --malmanzar 24-07-2023 Req. 9272
        END IF;                                                        --Crear

        ---IF pFUNCIONARIOGOB = 2 OR pPARENTESCOFUNCI = 2
        IF    UPPER (ppersona.tiene_relacion_pep) IN ('TRUE', 'S')
           OR UPPER (ppersona.es_pep) IN ('TRUE', 'S')
        THEN                                            --malmanzar 24-07-2023
            p_lista_p (pcod_persona       => vcod_persona,
                       pcargo             => ppersona.parentesco_pep /*pESPEFICIQUEFUNCI*/
                                                                    ,
                       pparentescofunci   => ppersona.parentesco_pep /*pEXPECIFIQUEPAREN*/
                                                                    );
        END IF;



        --Dir_Persona, crear dirección independientemente de que sea nueva o existente.
        --Get Provincia
        -- Dirección Begin
        --Get Provincia
        FOR d IN 1 .. ppersona.direcciones.COUNT
        LOOP
            BEGIN
                v_pa_distritos_list :=
                    pa_pkg_utl.pa_distritos_select (
                        pcod_pais          => NULL,
                        pcod_provincia     => NULL,
                        pcod_canton        =>
                            TO_NUMBER (
                                SUBSTR (ppersona.direcciones (d).cod_pueblo,
                                        1,
                                        2)),
                        pcod_distrito      =>
                            TO_NUMBER (
                                SUBSTR (ppersona.direcciones (d).cod_pueblo,
                                        3,
                                        2)),
                        pdescripcion       => NULL,
                        pabreviatura       => NULL,
                        ptipo              => NULL,
                        pcod_serie         => NULL,
                        plocalidad_sb      => NULL,
                        pid_ciudad_fc      => NULL,
                        pid_ciudad_ls      => NULL,
                        errorcode          => errorcode,
                        errordescription   => errorcode);

                FOR i IN 1 .. v_pa_distritos_list.COUNT
                LOOP
                    vidprovincia := v_pa_distritos_list (i).cod_provincia;
                END LOOP;
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '8-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Consultando distrito  >>Sqlerrm '
                        || SQLERRM;
                    RETURN;
            END;


            BEGIN
                SELECT NVL (MAX (TO_NUMBER (cod_direccion)), 0) + 1 --malmanzar 05-10-2023
                  INTO vcod_direccion
                  FROM dir_personas
                 WHERE cod_persona = vcod_persona;
            END;


            vdireccion :=
                   ppersona.direcciones (d).calle
                || ' '
                || ppersona.direcciones (d).barrio;

            /*|| ' ' || ppersona.direcciones(d).cod_canton || ' ' || ppersona.direcciones(d).cod_provincia; */
                                        --HAGUTIERREZ | REQ_43866 | 15/09/2025

            BEGIN
                pa_pkg_utl.pa_dir_personas_insert (
                    pcod_persona          => vcod_persona,        --v_persona,
                    pcod_direccion        => vcod_direccion,              --1,
                    ptip_direccion        =>
                        TO_NUMBER (ppersona.direcciones (d).tipo_direccion), --1,
                    papartado_postal      => NULL,
                    pcod_postal           => NULL,
                    pdetalle              => SUBSTR (vdireccion, 1, 160), --pDIRECCION,
                    pcod_pais             => '1', --pPersona.Direcciones (d).COD_PAIS,--v_codpais,
                    pcod_provincia        =>
                        get_regionprovincia (
                            pcod_pais   => '1',
                            pcod_canton   =>
                                TO_NUMBER (
                                    ppersona.direcciones (d).cod_canton)),
                    -- TO_NUMBER (pPersona.Direcciones (d).COD_PROVINCIA), --vidprovincia,
                    pcod_canton           =>
                        TO_NUMBER (ppersona.direcciones (d).cod_canton),
                    ---TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 1, 2)),
                    pcod_distrito         =>
                        TO_NUMBER (ppersona.direcciones (d).cod_distrito),
                    --TO_NUMBER (SUBSTR (pdireccion_idmunicipio, 3, 2)),
                    pcod_pueblo           =>
                        TO_NUMBER (ppersona.direcciones (d).cod_pueblo), --'1', --NULL,  malmanzar 11-03-2023
                    pes_default           => 'S',
                    pcolonia              => NULL,
                    pzona                 => NULL,
                    pind_estado           => 'S',
                    pincluido_por         => USER,
                    pfec_inclusion        => SYSDATE,
                    pmodificado_por       => NULL,
                    pfecha_modificacion   => NULL,
                    errorcode             => errorcode,
                    errordescription      => errordescription);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '9-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error Insertando direccion Pa_Dir_Personas_Insert >>Sqlerrm '
                        || SQLERRM;

                    RETURN;
            END;
        /*
             BEGIN
                 pa_pkg_utl.Pa_Dir_Envio_X_Pers_Insert (
                     pCod_Persona       => vcod_persona,           --v_persona,
                     pTipo_Envio        => 'D',
                     pApdo_Postal       => 1,
                     pCodigo_Postal     => NULL,
                     pCod_Direccion     => '1',    --NULL, malmanzar 14-03-2023
                     pCod_Area          => NULL,
                     pNum_Telefono      => NULL,
                     pNum_Casilla       => NULL,
                     pCod_Empresa       => NULL,
                     pCod_Agencia       => NULL,
                     pEmail_Usuario     => NULL,
                     pEmail_Servidor    => NULL,
                     errorCode          => errorCode,
                     errorDescription   => errorDescription);
             EXCEPTION
                 WHEN DUP_VAL_ON_INDEX THEN  --malmanzar 01-09-2023
                   NULL;
                 WHEN OTHERS
                 THEN
                     errorCode := '11-' || errorCode;
                     errorDescription :=
                            errorDescription
                         || '-Error Insertando direcci¿n trabajo Pa_Dir_Personas_Insert >>Sqlerrm '
                         || SQLERRM;
                     P_DEPURA (
                            'pdireccion_id_municipio '
                         || TO_NUMBER (
                                SUBSTR (pPersona.Direcciones (d).COD_DISTRITO,
                                        1,
                                        2))
                         || ' Linea '
                         || $$plsql_line);
                     RETURN;
             END;
             */
        END LOOP;                                 --pPersona.DIRECCIONES.COUNT

        --
        --        PR.PKG_PORTACREDIT2.AgregarTarea (
        --            'Tarea Insertar direcciones persona ',
        --            'PA.DIR_PERSONA',
        --            'vcod_persona',
        --            '200',
        --            'Persona creada exitosamente',
        --            vcod_persona);

        --Dirección End

        ---Telefonos Begin
        -----------------------------------------------------------------------

        -----------------------------------------------------------------------


        --Insertar Telefono
        FOR l IN 1 .. ppersona.localizadores.COUNT
        LOOP
            --Se valida que tenga al menos un telefono
            -----------------------------------------------------------------------
            IF ppersona.localizadores (l).tipo_localizador = '01'
            THEN
                BEGIN
                    IF TO_NUMBER (
                           REPLACE (
                               TRIM (
                                   REPLACE (
                                       SUBSTR (
                                           ppersona.localizadores (l).valor,
                                           4),
                                       '-',
                                       NULL)),
                               '-')) =
                       0
                    THEN
                        errorcode := '12';
                        errordescription :=
                            'El cliente debe tener minimo un telefono de casa o celular.';
                        RETURN;
                    END IF;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '13';
                        errordescription :=
                               'Validando telefonos Deudor: '
                            || REPLACE (
                                   TRIM (
                                       REPLACE (
                                           SUBSTR (
                                               ppersona.localizadores (l).valor,
                                               4),
                                           '-',
                                           NULL)),
                                   '-')
                            || ' sqlerrm: '
                            || SQLERRM;
                        RETURN;
                END;


                vtip_telefono := 'C';
                ves_default := 'S';

                IF TO_NUMBER (
                       REPLACE (
                           TRIM (
                               TO_NUMBER (
                                   REPLACE (
                                       TRIM (
                                           REPLACE (
                                               SUBSTR (
                                                   ppersona.localizadores (l).valor,
                                                   4),
                                               '-',
                                               NULL)),
                                       '-'))),
                           '-')) !=
                   0
                THEN
                    BEGIN
                        pa_pkg_utl.pa_tel_personas_insert (
                            pcod_persona          => vcod_persona, --v_persona,
                            pcod_area             =>
                                SUBSTR (ppersona.localizadores (l).valor,
                                        1,
                                        3),  ---SUBSTR (ptelefono_casa, 1, 3),
                            pnum_telefono         =>
                                REPLACE (
                                    SUBSTR (ppersona.localizadores (l).valor,
                                            4),
                                    '-',
                                    NULL),
                            ptip_telefono         => vtip_telefono,     --'R',
                            ptel_ubicacion        => 'O',
                            pextension            => NULL,
                            pnota                 => 'PortaCredit',
                            pes_default           => ves_default, --'S',--'N', --'S',  ---malmanzar 22-03-2023
                            pposicion             => NULL,
                            pcod_direccion        => 1,
                            pcod_pais             => v_codpais,
                            pmodificado_por       => NULL,
                            pfecha_modificacion   => NULL,
                            pincluido_por         => USER,
                            pfec_inclusion        => SYSDATE,
                            errorcode             => errorcode,
                            errordescription      => errordescription);
                    EXCEPTION
                        WHEN OTHERS
                        THEN
                            errorcode := '14-' || errorcode;
                            errordescription :=
                                   errordescription
                                || '-Validando telefonos Deudor'
                                || SQLERRM;
                            RETURN;
                    END;
                END IF;
            END IF;                                               ---Teléfonos
        END LOOP;

        --        PR.PKG_PORTACREDIT2.AgregarTarea (
        --            'Tarea Insertar teléfonos persona ',
        --            'PA.TEL_PERSONA',
        --            'vcod_persona',
        --            '200',
        --            'Persona creada exitosamente',
        --            vcod_persona);

        ---Teléfonos End

        --Insertar id_personas

        FOR x IN 1 .. ppersona.identificaciones.COUNT
        LOOP
            nacionalidadpe := 'Dominicana';            ---Pendiente 23-08-2023


            vtipodocumentoidentidad := NULL;                      --04-08-2022

            vtipodocumentoidentidad :=
                f_tipoid_pda_core (
                    ptipo_id_pda   =>
                        ppersona.identificaciones (x).cod_tipo_id --ptipodocumentoidentidad
                                                                 ); --malmanzar 09-06-2022

            vnumidformat :=
                pa.formatear_identifi (ppersona.identificaciones (x).num_id, --(pnumdocumentoidentidad,
                                       vtipodocumentoidentidad); -- ptipodocumentoidentidad  03-03-2023

            IF NOT id_existe (vtipodocumentoidentidad, vnumidformat)
            THEN
                BEGIN
                    pa_pkg_utl.pa_id_personas_insert (
                        pcod_persona       => vcod_persona,       --v_persona,
                        pcod_tipo_id       => vtipodocumentoidentidad, --pTIPODOCUMENTOIDENTIDAD,  --03-03-2023 ptipodocumentoidentidad,
                        pnum_id            => vnumidformat, --pnumdocumentoidentidad, --03-03-2023
                        pfec_vencimiento   =>
                            TO_DATE ('31/12/2050', 'dd/mm/yyyy'),
                        pcod_pais          => v_codpais,
                        pnacionalidadpe    => nacionalidadpe, --malmanzar 09-06-2022
                        errorcode          => errorcode,
                        errordescription   => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '17-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-insertando Pa_Id_Personas_Insert'
                            || SQLERRM;
                        RETURN;
                END;



                BEGIN
                    pa_pkg_utl.pa_infofisicanacion_insert (
                        pcod_persona                    => vcod_persona, --v_persona,
                        ppind_cedula                    => 'S',
                        ppind_licencia_conducir         => 'N',
                        ppind_residencia                => 'N',
                        ppind_id_otro                   => 'N',
                        pid_otro_desc                   => NULL,
                        ppind_certificado_nacimiento    => 'N',
                        ppind_pensionado_jubilado       => 'N',
                        ppind_lab_tiempo                => 'N',
                        ppind_lab_ingreso_anual         => 'N',
                        ppind_lab_puesto_desempena      => 'N',
                        ppind_trabaja_independiente     => 'N',
                        ppind_independiente_actividad   => 'N',
                        ppindindependientejustificaa    => 'N',
                        pcomentarios_adicionales        =>
                            'Registrado por PDA',
                        errorcode                       => errorcode,
                        errordescription                => errordescription);
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        errorcode := '18-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-insertando Pa_Id_Personas_Insert'
                            || SQLERRM;
                        RETURN;
                END;
            END IF;
        END LOOP;                                  --IDENTIFICACIONES pPERSONA

        --        PR.PKG_PORTACREDIT2.AgregarTarea ('Tarea Insertar id persona ',
        --                                          'ID_PERSONAS',
        --                                          'vNumIdFormat',
        --                                          '200',
        --                                          'Persona creada exitosamente',
        --                                          vNumIdFormat);


        --Oficial Begin
        BEGIN
            BEGIN
                v_pr_pr_analistas_list :=
                    ia.pr_pkg_utl.pr_analistas_select (
                        pcodigo_empresa       => p_codempresa,
                        pcodigo_analista      => pcod_oficial,   --pIDOFICIAL,
                        pnombre_analista      => NULL,
                        pcodigo_persona       => NULL,
                        pes_analista          => NULL,
                        pes_aprobador         => NULL,
                        padicionado_por       => NULL,
                        pfecha_adicion        => NULL,
                        pmodificado_por       => NULL,
                        pfecha_modificacion   => NULL,
                        errorcode             => errorcode,
                        errordescription      => errordescription);


                FOR i IN 1 .. v_pr_pr_analistas_list.COUNT
                LOOP
                    vcodoficial := v_pr_pr_analistas_list (i).codigo_persona;
                END LOOP;

                IF vcodoficial IS NOT NULL
                THEN
                    v_pa_empleados_list :=
                        ia.pa_pkg_utl.pa_empleados_select (
                            pcod_empresa           => p_codempresa,
                            pid_empleado           => vcodoficial, --pCod_Oficial,-- vcodoficial,
                            pcod_per_fisica        => NULL,
                            pcod_puesto            => NULL,
                            pcod_agencia           => NULL,
                            pcod_agencia_labora    => NULL,
                            pesta_activo           => NULL,
                            pfec_ingreso           => NULL,
                            pextension             => NULL,
                            patiende_quejas        => NULL,
                            patiende_publico       => NULL,
                            pcrosselling           => NULL,
                            prentabilidad          => NULL,
                            pes_oficial            => NULL,
                            pes_promotor           => NULL,
                            pes_externo            => NULL,
                            pcod_canal             => NULL,
                            pemail1                => NULL,
                            pemail2                => NULL,
                            psupervisor            => NULL,
                            pfirma_autorizada      => NULL,
                            ptipo_firma            => NULL,
                            pimp_corte_cta         => NULL,
                            pcod_motivo            => NULL,
                            pes_oficial_cta        => NULL,
                            pind_autosegesp        => NULL,
                            pnivel_aprobacion      => NULL,
                            pver_todos_referidos   => NULL,
                            pid_jefe               => NULL,
                            pcateg_empleados       => NULL,
                            parea_trabaja          => NULL,
                            presponsab_emple       => NULL,
                            errorcode              => errorcode,
                            errordescription       => errordescription);

                    IF v_pa_empleados_list.COUNT = 0
                    THEN
                        errorcode := '19-' || errorcode;
                        errordescription :=
                               errordescription
                            || '-No existe oficial como empleado '
                            || SQLERRM;
                        RETURN;
                    END IF;
                END IF;
            EXCEPTION
                WHEN NO_DATA_FOUND
                THEN
                    errorcode := '20';
                    errordescription := 'No existe oficial ' || SQLERRM;
                    RETURN;
            END;
        END;

        --Oficial End


        IF vcrear = TRUE
        THEN
            --Inserta cliente
            BEGIN
                ia.pa_pkg_utl.pa_cliente_insert (
                    pcod_empresa              => p_codempresa,
                    pcod_cliente              => vcod_persona,    --v_persona,
                    pnum_cliente              => vcod_persona,    --v_persona,
                    pcod_agencia              => pcodigo_agencia, ---TO_NUMBER (p_codagencia),
                    pcod_cat_clte             => v_cod_cat_clte,
                    pcod_grupo                => NULL,
                    pesta_activo              => 'S',
                    ppaga_impto_renta         => 'S',
                    pfec_ingreso              => SYSDATE,
                    pcat_riesgo               => 'A',
                    pcod_oficial              => vcodoficial,
                    pcod_promotor             => vcodoficial,
                    pcod_zona                 => NULL,
                    pcliente_especial         => 'N',
                    ptipo_deudor              => 1,
                    pcross_estimado           => 30,
                    pcross_calculado          => 0,
                    prentabilidad             => 0,
                    pmon_ingreso_bco          => 0,
                    pmon_egreso_bco           => 0,
                    pcod_sub_agencia          => NULL,
                    pestado_cliente           => 'A',
                    pcod_nicho                => '99',
                    pfec_actualiza_ingresos   => NULL,
                    pcomentario_act_ingreso   => 'INGRESO POR PDA',
                    pnum_carpeta              => NULL,
                    pcod_linea_credito        => NULL,
                    pincluido_por             => USER,
                    pfec_inclusion            => SYSDATE,
                    pmodificado_por           => NULL,
                    pfec_modificacion         => NULL,
                    errorcode                 => errorcode,
                    errordescription          => errordescription);
            EXCEPTION
                WHEN NO_DATA_FOUND
                THEN
                    errorcode := '21-' || errorcode;
                    errordescription :=
                           errordescription
                        || '-Error ia.pa_pkg_utl.Pa_Cliente_Inser  '
                        || SQLERRM;
                    RETURN;
            END;
        --            PR.PKG_PORTACREDIT2.AgregarTarea ('Tarea insertar cliente  ',
        --                                              'CLIENTE',
        --                                              'vcod_persona',
        --                                              '200',
        --                                              'Cliente creado exitosamente',
        --                                              vcod_persona);
        END IF;                                               ---Crear cliente


        --Referencias Personales Begin

        ---DBMS_OUTPUT.put_line ('==============References==============');

        FOR r IN 1 .. ppersona.referencias.COUNT
        --vSolicitud.PERSONA(i).REFERENCIAS.COUNT
        LOOP
            FOR rp IN 1 .. ppersona.referencias (r).personas_referencia.COUNT
            --pPERSONA(i).REFERENCIAS(r).PERSONAS_REFERENCIA.count
            LOOP
                v_telefono := NULL;

                FOR l
                    IN 1 ..
                       ppersona.referencias (r).personas_referencia (rp).localizadores.COUNT
                LOOP
                    IF ppersona.referencias (r).personas_referencia (rp).localizadores (
                           l).tipo_localizador =
                       '01'
                    THEN
                        v_telefono :=
                            ppersona.referencias (r).personas_referencia (rp).localizadores (
                                l).valor;    ---'01' = telefono, 02 = 'email';
                    END IF;
                END LOOP;

                IF ppersona.referencias (r).tipo_referencia IN ('01', '02')
                THEN                                  --Referencias personales
                    p_depura (
                           ' pPERSONA.REFERENCIAS(r).TIPO_REFERENCIA: '
                        || ppersona.referencias (r).tipo_referencia
                        || 'Linea: '
                        || $$plsql_line);
                    p_ref_personales (
                        pcod_persona        => vcod_persona,      --v_persona,
                        pcod_empresa        => '1',
                        pcod_tipo_id        => '1',               -- VARCHAR2,
                        pnombre_ref         =>
                               ppersona.referencias (r).personas_referencia (
                                   rp).nombres
                            || ' '
                            || ppersona.referencias (r).personas_referencia (
                                   rp).apellidos,
                        --- pPERSONA(i).REFERENCIAS(r).PERSONAS_REFERENCIA(rp).NOMBRES
                        --pREFPERSONALES_NOMBRES || ' ' || pREFPERSONALES_APELLIDOS,
                        pnum_id             => '000-0000000-1',
                        pcod_area           => SUBSTR (v_telefono, 1, 3),
                        pnum_telefono       => SUBSTR (v_telefono, 4, 7),
                        ppuesto             => NULL,
                        plugar_trabajo      => NULL,
                        prelacion_persona   =>
                            CASE
                                WHEN ppersona.referencias (r).tipo_referencia =
                                     '01'
                                THEN
                                    'FAMILIAR'
                                ELSE
                                    'AMIGO'
                            END,
                        pobservaciones      => NULL,
                        pextension_tel      => NULL);
                ELSIF ppersona.referencias (r).tipo_referencia = '03'
                THEN                                 --Referencias Comerciales
                    ---- p_depura(' pPERSONA.REFERENCIAS(r).TIPO_REFERENCIA: '|| pPERSONA.REFERENCIAS(r).TIPO_REFERENCIA||'Linea: '||$$plsql_line);

                    p_refcom_portacredit (
                        pcod_persona   => vcod_persona,
                        ptelefono      => v_telefono, --pPERSONA.REFERENCIAS (r).PERSONAS_REFERENCIA ( rp).LOCALIZADORES (l).VALOR,
                        pnombre_referencia   =>
                               ppersona.referencias (r).personas_referencia (
                                   rp).nombres
                            || ' '
                            || ppersona.referencias (r).personas_referencia (
                                   rp).apellidos);
                ELSIF ppersona.referencias (r).tipo_referencia = '04'
                THEN                                   --Rererencias Bancarias
                    ---p_depura(' pPERSONA.REFERENCIAS(r).TIPO_REFERENCIA: '|| pPERSONA.REFERENCIAS(r).TIPO_REFERENCIA||'Linea: '||$$plsql_line);

                    p_refbanc_portacredit (
                        pcod_persona   => vcod_persona,
                        ptipo_cuenta   => 'A',
                        pnum_cuenta    => '99999999',
                        pnombre_referencia   =>
                               ppersona.referencias (r).personas_referencia (
                                   rp).nombres
                            || ' '
                            || ppersona.referencias (r).personas_referencia (
                                   rp).apellidos);
                ELSE
                    NULL;
                END IF;
            END LOOP;
        END LOOP;                               ---End Referencias Personasles

        --Begin Referencias Comerciales   30-01-2024
        ---End Referencias Comerciales

        --Begin Referencias Bancarias
        --end Referencias Bancarias    30-01-2024

        --Información laboral Begin 18-01-2024
        --        DBMS_OUTPUT.put_line (
        --               'NombreEmpresa: '
        --            || ppersona.informacion_trabajo.nombre_empresa
        --            || ' Linea: '
        --            || $$plsql_line);
        --        DBMS_OUTPUT.put_line (
        --               'FECHA_INGRESO: '
        --            || ppersona.informacion_trabajo.fecha_ingreso
        --            || ' Linea: '
        --            || $$plsql_line);
        --        DBMS_OUTPUT.put_line (
        --               'SALARIO_MENSUAL: '
        --            || ppersona.informacion_trabajo.salario_mensual
        --            || ' Linea: '
        --            || $$plsql_line);
        --        DBMS_OUTPUT.put_line (
        --               'NUMERO_TELEFONO: '
        --            || ppersona.informacion_trabajo.numero_telefono
        --            || ' Linea: '
        --            || $$plsql_line);
        --        DBMS_OUTPUT.put_line (
        --               'CARGO: '
        --            || ppersona.informacion_trabajo.cargo
        --            || ' Linea: '
        --            || $$plsql_line);
        --        DBMS_OUTPUT.put_line (
        --               'EXTENSION_TELEFONICA: '
        --            || ppersona.informacion_trabajo.extension_telefonica
        --            || ' Linea: '
        --            || $$plsql_line);
        --        DBMS_OUTPUT.put_line (
        --               'CORREO_ELECTRONICO: '
        --            || ppersona.informacion_trabajo.correo_electronico
        --            || ' Linea: '
        --            || $$plsql_line);



        --        DBMS_OUTPUT.put_line (
        --               'TIPO_DIRECCION: '
        --            || ppersona.informacion_trabajo.direccion.tipo_direccion
        --            || ' Linea: '
        --            || $$plsql_line);
        -- DBMS_OUTPUT.put_line ('BARRIO: '|| pPersona.INFORMACION_TRABAJO.DIRECCION.BARRIO || ' Linea: '      || $$PLSQL_LINE);
        --DBMS_OUTPUT.put_line ('CALLE: '|| pPersona.INFORMACION_TRABAJO.DIRECCION.TIPO_CASA || ' Linea: '      || $$PLSQL_LINE);
        --DBMS_OUTPUT.put_line ('TIPO_CASA: '|| pPersona.INFORMACION_TRABAJO.DIRECCION.TIPO_CASA || ' Linea: '      || $$PLSQL_LINE);
        --DBMS_OUTPUT.put_line ('REFERENCIA: '|| pPersona.INFORMACION_TRABAJO.DIRECCION.REFERENCIA || ' Linea: '      || $$PLSQL_LINE);
        ---DBMS_OUTPUT.put_line ('RESIDE_DESDE: '|| pPersona.INFORMACION_TRABAJO.DIRECCION.RESIDE_DESDE || ' Linea: '      || $$PLSQL_LINE);

        --        DBMS_OUTPUT.put_line ('cod_pais: '||pPERSONA.INFORMACION_TRABAJO.DIRECCION.COD_PAIS    || ' Linea: '      || $$PLSQL_LINE);
        --        DBMS_OUTPUT.PUT_LINE ( 'Person.JobInformation.Address.SectionCode               = ' ||pPERSONA.INFORMACION_TRABAJO.DIRECCION.COD_PROVINCIA || ' Linea: '      || $$PLSQL_LINE );
        --        DBMS_OUTPUT.PUT_LINE ( 'Person.JobInformation.Address.ProvinceCode               = ' || pPERSONA.INFORMACION_TRABAJO.DIRECCION.COD_CANTON   || ' Linea: '      || $$PLSQL_LINE );
        --        DBMS_OUTPUT.PUT_LINE ( 'Person.JobInformation.Address.MunicipalityCode           = ' || pPERSONA.INFORMACION_TRABAJO.DIRECCION.COD_DISTRITO || ' Linea: '      || $$PLSQL_LINE );
        --        DBMS_OUTPUT.PUT_LINE ( 'Person.JobInformation.Address.DistrictMunicipalityCode   = ' || pPERSONA.INFORMACION_TRABAJO.DIRECCION.COD_PUEBLO   || ' Linea: '      || $$PLSQL_LINE );
        --        DBMS_OUTPUT.PUT_LINE ( 'Person.JobInformation.Address.Street                     = ' || pPERSONA.INFORMACION_TRABAJO.DIRECCION.CALLE        || ' Linea: '      || $$PLSQL_LINE );



        --DBMS_OUTPUT.PUT_LINE ( 'pPERSONA.INFORMACION_TRABAJO.DIRECCION.DETALLE = ' || pPERSONA.INFORMACION_TRABAJO.DIRECCION.DETALLE||' Linea:'      || $$PLSQL_LINE );
        --
        --        p_depura (
        --               'vcod_persona: '
        --            || vcod_persona
        --            || ' pPersona.INFORMACION_TRABAJO.NOMBRE_EMPRESA: '
        --            || ppersona.informacion_trabajo.nombre_empresa
        --            || ' pPersona.INFORMACION_TRABAJO.FECHA_INGRESO: '
        --            || ppersona.informacion_trabajo.fecha_ingreso);
        --
        --
        --
        --        --p_depura('infolaboral Linea: '||$$plsql_line);
        --        p_depura (
        --               'infolaboral Linea: '
        --            || $$plsql_line
        --            || ' vcod_persona: '
        --            || vcod_persona
        --            || ' pPersona.INFORMACION_TRABAJO.SALARIO_MENSUAL: '
        --            || ppersona.informacion_trabajo.salario_mensual);


        IF     ppersona.informacion_trabajo.nombre_empresa IS NOT NULL
           AND ppersona.informacion_trabajo.fecha_ingreso IS NOT NULL
        THEN
            BEGIN
                p_info_laboral (
                    p_persona     => vcod_persona,            ---In  Varchar2,
                    p_fec_ing     =>                              ---TO_DATE (
                                     ppersona.informacion_trabajo.fecha_ingreso,
                    ---      'DD/MM/YYYY'),                   ---In  Date,
                    p_lugar_lab   =>
                        ppersona.informacion_trabajo.nombre_empresa, ---In  Varchar2,
                    p_sueldo      => psalario, -- pPersona.INFORMACION_TRABAJO.SALARIO_MENSUAL, ---In  Number,
                    p_puesto      => ppersona.informacion_trabajo.cargo, ---In  Varchar2,
                    p_direccion   =>
                        ppersona.informacion_trabajo.direccion.detalle, ---pPersona.INFORMACION_TRABAJO.,---In  Varchar2,  --Pendiene
                    p_telefono    =>
                        ppersona.informacion_trabajo.numero_telefono, ---In  Varchar2,
                    p_extension   =>
                        ppersona.informacion_trabajo.extension_telefonica, ---In  Varchar2,
                    p_procesado   => v_procesado,             ---Out Varchar2,
                    p_msgerr      => p_msgerr                  ---Out Varchar2
                                             );

                p_depura (
                       'Linea '
                    || $$plsql_line
                    || ' Program Unit = '
                    || $$plsql_unit);

                IF p_msgerr IS NOT NULL
                THEN
                    p_msgerr :=
                           'FUD Error procesando información laboral'
                        || ' '
                        || p_msgerr;
                    errorcode := '25';
                    errordescription := p_msgerr || SQLERRM;
                    RETURN;
                END IF;
            EXCEPTION
                WHEN OTHERS
                THEN
                    vsqlerrm_char := LTRIM (RTRIM (SQLERRM));
                    p_msgerr :=
                           'Error procesando información laboral para Cod Persona  '
                        || vcod_persona
                        || ' Error : '
                        || vsqlerrm_char;
                    v_procesado := 'N';
            END;
        END IF;

        ---Bussisnes  Begin  29-01-2024 Pc2
        FOR n IN 1 .. ppersona.negocios.COUNT
        LOOP
            IF     ppersona.negocios (n).nombre IS NOT NULL
               AND ppersona.informacion_trabajo.fecha_ingreso IS NOT NULL --12-08-2024
            THEN
                FOR l IN 1 .. ppersona.negocios (n).localizadores.COUNT
                LOOP
                    --DBMS_OUTPUT.PUT_LINE ( 'Person('||i||').Businesses('||n||').Locators('||l||').locatorTypeCode   = ' || vSolicitud.PERSONA(i).NEGOCIOS(n).LOCALIZADORES(l).TIPO_LOCALIZADOR);
                    --DBMS_OUTPUT.PUT_LINE ( 'Person('||i||').Businesses('||n||').Locators('||l||').value             = ' || vSolicitud.PERSONA(i).NEGOCIOS(n).LOCALIZADORES(l).VALOR);
                    IF ppersona.negocios (n).localizadores (l).tipo_localizador =
                       '01'
                    THEN
                        v_telefono :=
                            ppersona.negocios (n).localizadores (l).valor;
                    END IF;
                END LOOP;

                FOR d IN 1 .. ppersona.negocios (n).direcciones.COUNT
                LOOP
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').addressTypeCode          = '
                    --                        || ppersona.negocios (n).direcciones (d).tipo_direccion);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').countryCode              = '
                    --                        || ppersona.negocios (n).direcciones (d).cod_pais);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').sectionCode              = '
                    --                        || ppersona.negocios (n).direcciones (d).cod_provincia);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').provinceCode             = '
                    --                        || ppersona.negocios (n).direcciones (d).cod_canton);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').municipalityCode         = '
                    --                        || ppersona.negocios (n).direcciones (d).cod_distrito);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').districtMunicipalityCode = '
                    --                        || ppersona.negocios (n).direcciones (d).cod_pueblo);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').neighborhoodCode         = '
                    --                        || ppersona.negocios (n).direcciones (d).barrio);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').street                   = '
                    --                        || ppersona.negocios (n).direcciones (d).calle);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').housingTypeCode          = '
                    --                        || ppersona.negocios (n).direcciones (d).tipo_casa);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').addressReference         = '
                    --                        || ppersona.negocios (n).direcciones (d).referencia);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'Person(.Businesses('
                    --                        || n
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').ResideSince              = '
                    --                        || ppersona.negocios (n).direcciones (d).reside_desde);

                    v_direccion :=
                        f_direccion_completa (
                            pcod_pais_iso          =>
                                ppersona.negocios (n).direcciones (d).cod_pais, --vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (i).NEGOCIOS (n).Direcciones (d).COD_PAIS,--VARCHAR2,
                            pcod_canton            =>
                                ppersona.negocios (n).direcciones (d).cod_canton, --vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (n).direcciones (d).cod_canton ,--VARCHAR2,
                            pcod_provincia         =>
                                ppersona.negocios (n).direcciones (d).cod_provincia, --vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (n).direcciones (d).cod_provincia,--VARCHAR2,
                            pcod_distrito          =>
                                ppersona.negocios (n).direcciones (d).cod_distrito, --vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (n).direcciones (d).cod_distrito,--VARCHAR2,
                            pcalle                 =>
                                ppersona.negocios (n).direcciones (d).calle, --vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (n).direcciones (d).calle --VARCHAR2)
                            pincluyedespais        => 'S',
                            pincluyedesprovincia   => 'S');
                END LOOP;


                --- vSolicitud.EVALUACIONES.INGRESOS_SALARIALES.SALARIO

                ---p_depura('infolaboral Linea: '||$$plsql_line);

                ---- p_depura('infolaboral Linea: '||$$plsql_line||' vcod_persona: '||vcod_persona||' : ppersona.evaluaciones.INGRESOS_SALARIALES.SALARIO: '||ppersona.evaluaciones.INGRESOS_SALARIALES.SALARIO);


                BEGIN
                    p_info_laboral (
                        p_persona     => vcod_persona,        ---In  Varchar2,
                        p_fec_ing     =>
                            ppersona.negocios (n).fecha_inicio_operacion, --NULL,--- pPersona.INFORMACION_TRABAJO.FECHA_INGRESO,           ---      'DD/MM/YYYY'),                   ---In  Date,
                        p_lugar_lab   => ppersona.negocios (n).nombre, ---In  Varchar2,
                        p_sueldo      => psalario, --NVL(ppersona.evaluaciones.INGRESOS_SALARIALES.SALARIO,0) + NVL(ppersona.evaluaciones.INGRESOS_SALARIALES.SALARIO,0), --05-02-2024 -- pPersona.INFORMACION_TRABAJO.SALARIO_MENSUAL, ---In  Number,
                        p_puesto      => ppersona.informacion_trabajo.cargo, --'NO ENCONTRADO EN EL JSON', ---NULL,--pPersona.INFORMACION_TRABAJO.CARGO, ---In  Varchar2,
                        p_direccion   => v_direccion, -- pPERSONA.INFORMACION_TRABAJO.DIRECCION.DETALLE, ---pPersona.INFORMACION_TRABAJO.,---In  Varchar2,  --Pendiene
                        p_telefono    => v_telefono, -- pPersona.INFORMACION_TRABAJO.NUMERO_TELEFONO, ---In  Varchar2,
                        p_extension   => NULL, --pPersona.INFORMACION_TRABAJO.EXTENSION_TELEFONICA, ---In  Varchar2,
                        p_procesado   => v_procesado,         ---Out Varchar2,
                        p_msgerr      => p_msgerr              ---Out Varchar2
                                                 );

                    p_depura (
                           'Linea '
                        || $$plsql_line
                        || ' Program Unit = '
                        || $$plsql_unit);

                    IF p_msgerr IS NOT NULL
                    THEN
                        p_msgerr :=
                               'FUD Error procesando información laboral'
                            || ' '
                            || p_msgerr;
                        errorcode := '25';
                        errordescription := p_msgerr || SQLERRM;
                        raise_application_error (num   => -20000,
                                                 msg   => errordescription);
                    ---RETURN;
                    END IF;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        vsqlerrm_char := LTRIM (RTRIM (SQLERRM));
                        p_msgerr :=
                               'Error procesando información laboral para Cod Persona  '
                            || vcod_persona
                            || ' Error : '
                            || vsqlerrm_char;
                        v_procesado := 'N';
                        raise_application_error (num   => -20000,
                                                 msg   => errordescription);
                ---RETURN;
                END;
            END IF;
        --END IF;
        END LOOP;                                                    --negocio

        ---Bussisnes  End  29-01-2024   Pc2



        --                PA.Pa_Mant_Datos_Personas.P_Inserta_Info_Laboral (
        --                                                                vcod_persona,
        --                                                                TO_DATE (/*pFechaingreso*/pPersona.INFORMACION_TRABAJO.FECHA_INGRESO, 'DD/MM/YYYY'),
        --                                                                pPersona.INFORMACION_TRABAJO.NOMBRE_EMPRESA,--pLugartrabajo,
        --                                                                0,                     -- Sueldo (Campo no existe en tabla
        --                                                                NVL (pPersona.INFORMACION_TRABAJO.CARGO, 'NO ESPECIFICADO'),
        --                                                                pTrabajo_Direccion,
        --                                                                REPLACE (pPersona.INFORMACION_TRABAJO.NUMERO_TELEFONO, '-'),
        --                                                                Null,---TO_CHAR (TO_NUMBER (pExtension)),
        --                                                                --Excello:malmanzar: 2022-02-15:REQ_99362:Begin >>
        --                                                                pNOMARCHIVO,                --P_Archivo_FUD  In  Varchar2,
        --                                                                pNUMDOCUMENTOIDENTIDAD,     --P_TIdper_FUD   In  Varchar2,
        --                                                                vNumIdFormat,               --P_NumIdoer_FUD In  Varchar2,
        --                                                                --Excello:malmanzar: 2022-02-15:REQ_99362:End >>
        --                                                                V_Procesado,
        --                                                                V_MsgErr);
        --



        --Información laboral Begin 18-01-2023


        pcod_persona := vcod_persona;                            ---04-10-2023
    --        PR.PKG_PORTACREDIT2.AgregarTarea (
    --            'Tarea Referencias Personales  ',
    --            'ref_personales',
    --            'vcod_persona',
    --            '200',
    --            'Referencias procesadas exitosamente',
    --            vcod_persona);
    --Referencias Personales End
    END p_procesar_persona;

    FUNCTION get_regionprovincia (pcod_pais     IN VARCHAR2,
                                  pcod_canton   IN VARCHAR2)
        RETURN NUMBER
    IS
        vregion   areas_mercado.cod_zona%TYPE;
    BEGIN
        SELECT cod_provincia
          INTO vregion
          FROM cantones
         WHERE cod_pais = pcod_pais AND cod_canton = pcod_canton;

        RETURN vregion;
    EXCEPTION
        WHEN OTHERS
        THEN
            vregion := NULL;
    END;

    FUNCTION get_ciuu (pcod_persona VARCHAR2)
        RETURN VARCHAR2
    IS
        vcod_actividad   personas_fisicas.cod_actividad%TYPE;
    BEGIN
        SELECT cod_actividad
          INTO vcod_actividad
          FROM personas_fisicas
         WHERE cod_per_fisica = pcod_persona;

        RETURN vcod_actividad;
    EXCEPTION
        WHEN OTHERS
        THEN
            RETURN NULL;
    END;

    FUNCTION id_existe (ptipo_id VARCHAR2, pnum_id VARCHAR2)
        RETURN BOOLEAN
    IS
        vcount     NUMBER;

        v_return   BOOLEAN;
    BEGIN
        SELECT COUNT (*)
          INTO vcount
          FROM id_personas
         WHERE cod_tipo_id = ptipo_id AND num_id = pnum_id;

        IF vcount > 0
        THEN
            v_return := TRUE;
        ELSE
            v_return := FALSE;
        END IF;

        RETURN v_return;
    END;

    ---Nueva Fec Persona Begin
    PROCEDURE pcreafecpersona (
        p_solicitud                      IN     NUMBER,
        p_codcliente                     IN     VARCHAR2,
        p_codagencia                     IN     NUMBER,
        ptipo_solicitante                IN     VARCHAR2,
        --P_cuotasegurocal,
        ----              monedacal,
        p_destinocredito                 IN     VARCHAR2,
        p_especifiquedestino             IN     VARCHAR2,
        pidtempfec                       IN     NUMBER,
        pnomarchivo                      IN     VARCHAR2,
        pidevaluacioncrediticia          IN     VARCHAR2,
        ptipodocumentoidentidad          IN     VARCHAR2,
        pdocumentoidentidad              IN     VARCHAR2,
        pnombrecliente                   IN     VARCHAR2,
        pnumerosolicitud                 IN     NUMBER,
        pmontorecomendado                IN     NUMBER,
        pfrecuencia                      IN     VARCHAR2, --malmanzar 14-07-222
        pplazo                           IN     NUMBER,
        ppro1ventasmensuales             IN     NUMBER,
        ppro2ventasmensuales             IN     NUMBER,
        ppro3ventasmensuales             IN     NUMBER,
        pprootroventasmensuales          IN     NUMBER,
        pventasmensuales1                IN     NUMBER,
        pventasmensuales2                IN     NUMBER,
        pventasmensuales3                IN     NUMBER,
        pventasmensuales4                IN     NUMBER,
        pventasmensuales5                IN     NUMBER,
        pventasmensuales6                IN     NUMBER,
        pventasmensuales7                IN     NUMBER,
        pventasmensuales8                IN     NUMBER,
        pventasmensualesot               IN     NUMBER,
        pventas_ingresos                 IN     NUMBER,
        ppro1costosventasmensuales       IN     NUMBER,
        ppro2costosventasmensuales       IN     NUMBER,
        ppro3costosventasmensuales       IN     NUMBER,
        pprootrocostosventasmensuales    IN     NUMBER,
        pcostoventas1                    IN     NUMBER,
        pcostoventas2                    IN     NUMBER,
        pcostoventas3                    IN     NUMBER,
        pcostoventas4                    IN     NUMBER,
        pcostoventas5                    IN     NUMBER,
        pcostoventas6                    IN     NUMBER,
        pcostoventas7                    IN     NUMBER,
        pcostoventas8                    IN     NUMBER,
        pcostoventasot                   IN     NUMBER,
        pcostoventas                     IN     NUMBER,
        psueldo                          IN     NUMBER,
        pservicio                        IN     NUMBER,
        palquiler                        IN     NUMBER,
        ptransporte_combs                IN     NUMBER,
        ppagointereses                   IN     NUMBER,
        potrosingresos_operacionales     IN     NUMBER,
        palimentacion                    IN     NUMBER,
        pvivienda                        IN     NUMBER,
        pvestido                         IN     NUMBER,
        ptransporte                      IN     NUMBER,
        pservicios                       IN     NUMBER,
        pmedicinas                       IN     NUMBER,
        peducacion                       IN     NUMBER,
        pdeudasfamiliares                IN     NUMBER,
        potros_gastos                    IN     NUMBER,
        ptotalgastos_familiares          IN     NUMBER,
        pexcedentefamiliar               IN     NUMBER,
        potros                           IN     NUMBER,
        pmaquinaria_mueblesequipos       IN     NUMBER,
        pefectivo_cajabanco              IN     NUMBER,
        pcuentaxcobrar                   IN     NUMBER,
        pinventario_prod_tem             IN     NUMBER,
        pinventario_prod_proc            IN     NUMBER,
        pinventario_materiaprima         IN     NUMBER,
        pmercancia                       IN     NUMBER,
        panticipo_proveedores            IN     NUMBER,
        plocalnegocio                    IN     NUMBER,
        pobligacionesfinancieras         IN     NUMBER,
        ptotal_pasivo_lp                 IN     NUMBER,
        pmueble_vehiculo                 IN     NUMBER,
        pdeudacomercial                  IN     NUMBER,
        ptasa                            IN     NUMBER,
        pcuota                           IN     NUMBER,
        pcuentapagarprovedor             IN     NUMBER,
        pcuentapagarvarias               IN     NUMBER,
        pinmuebles                       IN     NUMBER,
        ptotal_activofamiliar            IN     NUMBER,
        pdeudabancaria                   IN     NUMBER,
        ptotal_pasivofamiliar            IN     NUMBER,
        ppatrio_fam_balgen               IN     NUMBER,                    ---
        ptotal_activocorriente           IN     NUMBER,
        ptotal_activofijo                IN     NUMBER,
        ptotal_activos1                  IN     NUMBER,
        ptotal_pasivocorrientes          IN     NUMBER,
        ptotal_pasivo                    IN     NUMBER,
        ptotal_pasivopatrimonio          IN     NUMBER,
        ppasivo_patrimonio               IN     NUMBER,
        ppatrimonio                      IN     NUMBER,
        pactivocorte_pascte              IN     NUMBER,
        potrosingresos_excedente         IN     NUMBER,
        pcuotarecomendada_excedfam       IN     NUMBER,
        ptotalpasivo_patrimonio          IN     NUMBER,
        putilidadneta_patrimonio         IN     NUMBER,
        putilidadneta_totalactivos1      IN     NUMBER,
        putilidadneta_ventas             IN     NUMBER,
        pcuentasxcobrar_ventas           IN     NUMBER,
        pcostoventa_inventario           IN     NUMBER,
        pgastoslegales                   IN     NUMBER,                     --
        pmoneda                          IN     VARCHAR2,
        pcapital_trabajo                 IN     NUMBER,
        pfechabalancegeneral             IN     VARCHAR2,
        pdesde                           IN     VARCHAR2,
        phasta                           IN     VARCHAR2,
        ptotalcostooperacional           IN     NUMBER,
        putilidadneta                    IN     NUMBER,
        pventasdiarias_promedio          IN     NUMBER,
        pdiastrabajados                  IN     NUMBER,
        pcomprassemanalesdeclaradas      IN     NUMBER,
        pventasmensualesdeclaradas       IN     NUMBER,
        pmargendeclarado                 IN     NUMBER,
        pmontomesalto                    IN     NUMBER,
        pmontomesmedio                   IN     NUMBER,
        pcomprasmensualesdeclaradas      IN     NUMBER,
        pmontomesbajo                    IN     NUMBER,
        pventasmensuales                 IN     NUMBER,
        pcostoventamensual               IN     NUMBER,
        putilidadbruta                   IN     NUMBER,
        pmargenganancia                  IN     NUMBER,
        pprimera_ref_vecinos             IN     VARCHAR2,
        psegunda_ref_vecinos             IN     VARCHAR2,
        pambientefamiliar                IN     VARCHAR2,
        pdependientes                    IN     NUMBER,
        pedad                            IN     VARCHAR2, --Number  27-07-2022
        pestadosaludfamilia              IN     VARCHAR2, --Number  27-07-2022
        pingresos                        IN     VARCHAR2, --Number  27-07-2022
        potrosingresos                   IN     VARCHAR2, --Number  27-07-2022
        pexperiencia_neg                 IN     NUMBER, --malmanzar 27-07-2022
        phoras_neg                       IN     NUMBER,
        plocalpropio                     IN     VARCHAR2, --malmanzar 14-07-2022
        ptiempoempleo                    IN     NUMBER,
        pubicacionnegocio                IN     VARCHAR2,
        pllevaregistro                   IN     VARCHAR2,
        pmejorasnegocio                  IN     VARCHAR2,
        pclientesfrecuentes              IN     NUMBER,
        pnivelcompetencia                IN     VARCHAR2, --malmanzar 14-07-2022
        pfecha_balancegeneral_al         IN     VARCHAR2,
        --                             IN OU
        pdestinocredito                  IN     VARCHAR2,
        pespecifiquedestino              IN     VARCHAR2,
        pestadosolicitud                 IN     NUMBER,
        pactividadeconomica              IN     VARCHAR2,
        pactividadeconomicadinrap        IN     VARCHAR2,
        pmargenbrutoestandar             IN     NUMBER,
        pgastosoperacionalesestandar     IN     NUMBER,
        palto_indicadores                IN     NUMBER,
        pbajo_indicadores                IN     NUMBER,
        plunes                           IN     VARCHAR2,
        pmartes                          IN     VARCHAR2,
        pmiercoles                       IN     VARCHAR2,
        pjueves                          IN     VARCHAR2,
        pviernes                         IN     VARCHAR2,
        psabado                          IN     VARCHAR2,
        pdomingo                         IN     VARCHAR2,
        ptotal_ventasaltas               IN     NUMBER,
        ptotal_ventasbajas               IN     NUMBER,
        ptotal_ventassemanales           IN     NUMBER,
        ptotal_ventasmensuales           IN     NUMBER,
        pmargenbrutodeclarado            IN     NUMBER,
        palimentacion_gastos             IN     NUMBER,
        pvivienda_gastos                 IN     NUMBER,
        peducacion_gastos                IN     NUMBER,
        psalud_gastos                    IN     NUMBER,
        ptransporte_gastos               IN     NUMBER,
        pvestido_gastos                  IN     NUMBER,
        ppagodeudas_gastos               IN     NUMBER,
        potros_gastos_familiares         IN     NUMBER,
        ptotal_gastos                    IN     NUMBER,
        pventas_gastos                   IN     NUMBER,
        pcostosventas_gastos             IN     NUMBER,
        pgastosoperativos                IN     NUMBER,
        potros_ingresos_gastos           IN     NUMBER,
        ptotal_gastos_familiares         IN     NUMBER,
        pexcedentefamiliar_gastos        IN     NUMBER,
        pcuotasolicitada                 IN     NUMBER,
        prelcuotasolicitada_excfam       IN     NUMBER,
        pmonto_recomendacion             IN     NUMBER,
        pmoneda_recomendacion            IN     VARCHAR2,
        pplazo_recomendacion             IN     NUMBER,
        ptasa_recomendacion              IN     NUMBER,
        pfrecuencia_recomendacion        IN     VARCHAR2,
        pcuota_recomendacion             IN     NUMBER,
        pestadosolicitud_recomendacion   IN     NUMBER,
        pcuotarecomendada_excfamiliar    IN     NUMBER,
        pventasevalanterior              IN     NUMBER,
        pactual_ventas                   IN     NUMBER,
        pvariacionventas                 IN     NUMBER,
        pcomentario1                     IN     VARCHAR2,
        pcomentario2                     IN     VARCHAR2,
        ppro1nombre                      IN     VARCHAR2,
        ppro1materiaprima1               IN     NUMBER,
        ppro1materiaprima2               IN     NUMBER,
        ppro1materiaprima3               IN     NUMBER,
        ppro1totalmp                     IN     NUMBER,
        ppro1sueldo1                     IN     NUMBER,
        ppro1sueldo2                     IN     NUMBER,
        ppro1totalsueldo                 IN     NUMBER,
        ppro1otroscostos                 IN     NUMBER,
        ppro1totalcostos                 IN     NUMBER,
        ppro1costounitario               IN     NUMBER,
        ppro1preciounitario              IN     NUMBER,
        ppro1unidadesvendidas            IN     NUMBER,
        ppro1margenganancia              IN     NUMBER,
        ppro2nombre                      IN     VARCHAR2,
        ppro2materiaprima1               IN     NUMBER,
        ppro2materiaprima2               IN     NUMBER,
        ppro2materiaprima3               IN     NUMBER,
        ppro2totalmp                     IN     NUMBER,
        ppro2sueldo1                     IN     NUMBER,
        ppro2sueldo2                     IN     NUMBER,
        ppro2totalsueldo                 IN     NUMBER,
        ppro2otroscostos                 IN     NUMBER,
        ppro2totalcostos                 IN     NUMBER,
        ppro2costounitario               IN     NUMBER,
        ppro2preciounitario              IN     NUMBER,
        ppro2unidadesvendidas            IN     NUMBER,
        ppro2margenganancia              IN     NUMBER,
        ppro3nombre                      IN     VARCHAR2,
        ppro3materiaprima1               IN     NUMBER,
        ppro3materiaprima2               IN     NUMBER,
        ppro3materiaprima3               IN     NUMBER,
        ppro3totalmp                     IN     NUMBER,
        ppro3sueldo1                     IN     NUMBER,
        ppro3sueldo2                     IN     NUMBER,
        ppro3totalsueldo                 IN     NUMBER,
        ppro3otroscostos                 IN     NUMBER,
        ppro3totalcostos                 IN     NUMBER,
        ppro3costounitario               IN     NUMBER,
        ppro3preciounitario              IN     NUMBER,
        ppro3unidadesvendidas            IN     NUMBER,
        ppro3margenganancia              IN     NUMBER,
        pprootromateriaprima1            IN     NUMBER,
        pprootromateriaprima2            IN     NUMBER,
        pprootromateriaprima3            IN     NUMBER,
        pprootrototalmp                  IN     NUMBER,
        pprootrosueldo1                  IN     NUMBER,
        pprootrosueldo2                  IN     NUMBER,
        pprootrototalsueldo              IN     NUMBER,
        pprootrootroscostos              IN     NUMBER,
        pprootrototalcostos              IN     NUMBER,
        pprootrocostounitario            IN     NUMBER,
        pprootropreciounitario           IN     NUMBER,
        pprootrounidadesvendidas         IN     NUMBER,
        pprootromargenganancia           IN     NUMBER,
        plinea1                          IN     VARCHAR2,
        ppreciounitario1                 IN     NUMBER,
        pcostounitario1                  IN     NUMBER,
        pmargendeganancia1               IN     NUMBER,
        punidadesvendidas1               IN     NUMBER,
        plinea2                          IN     VARCHAR2,
        ppreciounitario2                 IN     NUMBER,
        pcostounitario2                  IN     NUMBER,
        pmargendeganancia2               IN     NUMBER,
        punidadesvendidas2               IN     NUMBER,
        plinea3                          IN     VARCHAR2,
        ppreciounitario3                 IN     NUMBER,
        pcostounitario3                  IN     NUMBER,
        pmargendeganancia3               IN     NUMBER,
        punidadesvendidas3               IN     NUMBER,
        plineaot                         IN     VARCHAR2,
        ppreciounitarioot                IN     NUMBER,
        pcostounitarioot                 IN     NUMBER,
        pmargendegananciaot              IN     NUMBER,
        punidadesvendidasot              IN     NUMBER,
        ptipocredito                     IN     VARCHAR2,
        pgarantias                       IN     VARCHAR2,
        pvalorgarantia                   IN     VARCHAR2,
        pdescripciongarantia             IN     VARCHAR2,
        pprestamodescontar               IN     VARCHAR2,
        plinea4                          IN     VARCHAR2,
        ppreciounitario4                 IN     NUMBER,
        pcostounitario4                  IN     NUMBER,
        pmargendeganancia4               IN     NUMBER,
        punidadesvendidas4               IN     NUMBER,
        plinea5                          IN     VARCHAR2,
        ppreciounitario5                 IN     NUMBER,
        pcostounitario5                  IN     NUMBER,
        pmargendeganancia5               IN     NUMBER,
        punidadesvendidas5               IN     NUMBER,
        plinea6                          IN     VARCHAR2,
        ppreciounitario6                 IN     NUMBER,
        pcostounitario6                  IN     NUMBER,
        pmargendeganancia6               IN     NUMBER,
        punidadesvendidas6               IN     NUMBER,
        plinea7                          IN     VARCHAR2,
        ppreciounitario7                 IN     NUMBER,
        pcostounitario7                  IN     NUMBER,
        pmargendeganancia7               IN     NUMBER,
        punidadesvendidas7               IN     NUMBER,
        plinea8                          IN     VARCHAR2,
        ppreciounitario8                 IN     NUMBER,
        pcostounitario8                  IN     NUMBER,
        pmargendeganancia8               IN     NUMBER,
        punidadesvendidas8               IN     NUMBER,
        pcomentario                      IN     VARCHAR2,
        pidoficial                       IN     VARCHAR2,
        pfecharegistro                   IN     DATE,
        pfechafija                       IN     VARCHAR2,
        pidestado                        IN     VARCHAR2,
        pmensaje                         IN     VARCHAR2,
        pnosubida                        IN     VARCHAR2,
        pidgrupo                         IN     VARCHAR2,
        pimpreso                         IN     VARCHAR2,
        /*Valores a retornar para eliminar uso Funci¿n fnupdatefud que ejecuta via WS
           proceso debe implementarse en el llamado de SQL/Server
          */
        pestadofec                          OUT VARCHAR2,
        pmensajefec                         OUT VARCHAR2 --pNoSolicitud                        OUT NUMBER
                                                        )                   --
    IS
        --- tmpvar                      NUMBER;
        vresult                     BOOLEAN;
        pmensajeerror               VARCHAR2 (4000);
        --p_solicitud                 NUMBER (7);
        --p_codcliente                VARCHAR2 (15);



        p_codempresa                NUMBER (5) := 1;
        --p_codagencia                NUMBER (5);
        --
        reg1                        pr_carga_analisis_solic.t_rec_analisis_solic;
        --
        v_reg_credito               pr_credito.t_rec_pr_creditos;
        v_error                     VARCHAR2 (1000);
        v_mensaje_error             VARCHAR2 (600);
        v_no_credito                pr_creditos.no_credito%TYPE;
        v_frecuencia                VARCHAR2 (10);
        v_plazo                     pr_creditos.plazo%TYPE;
        --v_tipopersona               tempfud.tipopersona%TYPE;
        --
        v_totalventasmensuales      NUMBER;
        v_totalcostoventas          NUMBER;
        v_utilidadbruta             NUMBER;
        v_tcon                      NUMBER;
        v_utilidad_neta             NUMBER;
        v_total_gastos_familiares   NUMBER;
        v_excedentefamiliar         NUMBER;
        v_total_activo_fijo         NUMBER;
        v_total_activo_corriente    NUMBER;
        v_total_activos             NUMBER;
        v_total_pasivo_corriente    NUMBER;
        v_total_pasivo              NUMBER;
        v_patrimonio                NUMBER;
        v_total_pasivo_patrimonio   NUMBER;
        v_activos_familiares        NUMBER;
        v_total_pasivo_familiar     NUMBER;
        v_patrimonio_familiar       NUMBER;
        v_utilidadneta_ventas       NUMBER;
        v_cxc_patrimonio            NUMBER;
        v_exd_familiar              NUMBER;
        v_excedente_familiar        NUMBER;
        --
        vcuotasegurocal             tempfud.cuotasegurocal%TYPE;
        vclientepertenece           tempfud.clientepertenece%TYPE;
        v_cuota_excedentefamiliar   NUMBER;
        --
        vmonedacal                  tempfud.monedacal%TYPE;
        vdestinocredito             tempfud.destinocredito%TYPE;
        vespecifiquedestino         tempfud.especifiquedestino%TYPE;
        vcuotasegurocallv           NUMBER (16, 2);                     --LMVR
        vestadocre                  VARCHAR2 (1);
        v_credito_anula             NUMBER (7);
        v_procesado                 VARCHAR2 (1) := NULL; --Excello:JPH:2020-03-27:REQ_ 108967
        -- PRAGMA AUTONOMOUS_TRANSACTION;

        vtipodocumentoidentidad     id_personas.cod_tipo_id%TYPE;
        vnumidformat                id_personas.num_id%TYPE;
    --vId_tempfec                 NUMBER;
    BEGIN
        p_depura ('Inicio pCrearFec ' || $$plsql_line);           --04-08-2022



        --Depura tmp ini
         /*
p_depura(  'p_codcliente                   '||         p_codcliente                     );
p_depura(  'p_codagencia                   '||         p_codagencia                     );
p_depura(  'pTipo_Solicitante              '||         pTipo_Solicitante                );
p_depura(  'p_destinocredito               '||         p_destinocredito                 );
p_depura(  'p_especifiquedestino           '||         p_especifiquedestino             );
p_depura(  'pIdTempFec                     '||         pIdTempFec                       );
p_depura(  'pNomarchivo                    '||         pNomarchivo                      );
p_depura(  'pIdevaluacioncrediticia        '||         pIdevaluacioncrediticia          );
p_depura(  'pTipodocumentoidentidad        '||         pTipodocumentoidentidad          );
p_depura(  'pDocumentoidentidad            '||         pDocumentoidentidad              );
p_depura(  'pNombrecliente                 '||         pNombrecliente                   );
p_depura(  'pNumerosolicitud               '||         pNumerosolicitud                 );
p_depura(  'pMontorecomendado              '||         pMontorecomendado                );
p_depura(  'pFrecuencia                    '||         pFrecuencia                      );
p_depura(  'pPlazo                         '||         pPlazo                           );
p_depura(  'Ppro1ventasmensuales           '||         Ppro1ventasmensuales             );
p_depura(  'ppro2ventasmensuales           '||         ppro2ventasmensuales             );
p_depura(  'ppro3ventasmensuales           '||         ppro3ventasmensuales             );
p_depura(  'pprootroventasmensuales        '||         pprootroventasmensuales          );
p_depura(  'pventasmensuales1              '||         pventasmensuales1                );
p_depura(  'pventasmensuales2              '||         pventasmensuales2                );
p_depura(  'pventasmensuales3              '||         pventasmensuales3                );
p_depura(  'pventasmensuales4              '||         pventasmensuales4                );
p_depura(  'pventasmensuales5              '||         pventasmensuales5                );
p_depura(  'pventasmensuales6              '||         pventasmensuales6                );
p_depura(  'pventasmensuales7              '||         pventasmensuales7                );
p_depura(  'pventasmensuales8              '||         pventasmensuales8                );
p_depura(  'pventasmensualesot             '||         pventasmensualesot               );
p_depura(  'pVENTAS_INGRESOS               '||         pVENTAS_INGRESOS                 );
p_depura(  'ppro1costosventasmensuales     '||         ppro1costosventasmensuales       );
p_depura(  'ppro2costosventasmensuales     '||         ppro2costosventasmensuales       );
p_depura(  'ppro3costosventasmensuales     '||         ppro3costosventasmensuales       );
p_depura(  'pprootrocostosventasmensuales  '||         pprootrocostosventasmensuales    );
p_depura(  'pcostoventas1                  '||         pcostoventas1                    );
p_depura(  'pcostoventas2                  '||         pcostoventas2                    );
p_depura(  'pcostoventas3                  '||         pcostoventas3                    );
p_depura(  'pcostoventas4                  '||         pcostoventas4                    );
p_depura(  'pcostoventas5                  '||         pcostoventas5                    );
p_depura(  'pcostoventas6                  '||         pcostoventas6                    );
p_depura(  'pcostoventas7                  '||         pcostoventas7                    );
p_depura(  'pcostoventas8                  '||         pcostoventas8                    );
p_depura(  'pcostoventasot                 '||         pcostoventasot                   );
p_depura(  'pCOSTOVENTAS                   '||         pCOSTOVENTAS                     );
p_depura(  'psueldo                        '||         psueldo                          );
p_depura(  'pservicio                      '||         pservicio                        );
p_depura(  'palquiler                      '||         palquiler                        );
p_depura(  'ptransporte_combs              '||         ptransporte_combs                );
p_depura(  'ppagointereses                 '||         ppagointereses                   );
p_depura(  'potrosingresos_operacionales   '||         potrosingresos_operacionales     );
p_depura(  'palimentacion                  '||         palimentacion                    );
p_depura(  'pvivienda                      '||         pvivienda                        );
p_depura(  'pvestido                       '||         pvestido                         );
p_depura(  'ptransporte                    '||         ptransporte                      );
p_depura(  'pservicios                     '||         pservicios                       );
p_depura(  'pmedicinas                     '||         pmedicinas                       );
p_depura(  'peducacion                     '||         peducacion                       );
p_depura(  'pdeudasfamiliares              '||         pdeudasfamiliares                );
p_depura(  'potros_gastos                  '||         potros_gastos                    );
p_depura(  'pTotalgastos_familiares        '||         pTotalgastos_familiares          );
p_depura(  'pExcedentefamiliar             '||         pExcedentefamiliar               );
p_depura(  'potros                         '||         potros                           );
p_depura(  'pmaquinaria_mueblesequipos     '||         pmaquinaria_mueblesequipos       );
p_depura(  'pefectivo_cajabanco            '||         pefectivo_cajabanco              );
p_depura(  'pcuentaxcobrar                 '||         pcuentaxcobrar                   );
p_depura(  'pinventario_prod_tem           '||         pinventario_prod_tem             );
p_depura(  'pinventario_prod_proc          '||         pinventario_prod_proc            );
p_depura(  'pinventario_materiaprima       '||         pinventario_materiaprima         );
p_depura(  'pmercancia                     '||         pmercancia                       );
p_depura(  'panticipo_proveedores          '||         panticipo_proveedores            );
p_depura(  'plocalnegocio                  '||         plocalnegocio                    );
p_depura(  'pobligacionesfinancieras       '||         pobligacionesfinancieras         );
p_depura(  'ptotal_pasivo_lp               '||         ptotal_pasivo_lp                 );
p_depura(  'pmueble_vehiculo               '||         pmueble_vehiculo                 );
p_depura(  'pdeudacomercial                '||         pdeudacomercial                  );
p_depura(  'ptasa                          '||         ptasa                            );
p_depura(  'pcuota                         '||         pcuota                           );
p_depura(  'pcuentapagarprovedor           '||         pcuentapagarprovedor             );
p_depura(  'pcuentapagarvarias             '||         pcuentapagarvarias               );
p_depura(  'pinmuebles                     '||         pinmuebles                       );
p_depura(  'pTotal_activofamiliar          '||         pTotal_activofamiliar            );
p_depura(  'pdeudabancaria                 '||         pdeudabancaria                   );
p_depura(  'pTotal_pasivofamiliar          '||         pTotal_pasivofamiliar            );
p_depura(  'pPATRIO_FAM_BALGEN             '||         pPATRIO_FAM_BALGEN               );                  ---
p_depura(  'pTOTAL_ACTIVOCORRIENTE         '||         pTOTAL_ACTIVOCORRIENTE           );
p_depura(  'pTOTAL_ACTIVOFIJO              '||         pTOTAL_ACTIVOFIJO                );
p_depura(  'pTOTAL_ACTIVOS1                '||         pTOTAL_ACTIVOS1                  );
p_depura(  'pTOTAL_PASIVOCORRIENTES        '||         pTOTAL_PASIVOCORRIENTES          );
p_depura(  'pTOTAL_PASIVO                  '||         pTOTAL_PASIVO                    );
p_depura(  'pTOTAL_PASIVOPATRIMONIO        '||         pTOTAL_PASIVOPATRIMONIO          );
p_depura(  'pPASIVO_PATRIMONIO             '||         pPASIVO_PATRIMONIO               );
p_depura(  'pPATRIMONIO                    '||         pPATRIMONIO                      );
p_depura(  'pACTIVOCORTE_PASCTE            '||         pACTIVOCORTE_PASCTE              );
p_depura(  'pOTROSINGRESOS_EXCEDENTE       '||         pOTROSINGRESOS_EXCEDENTE         );
p_depura(  'pCUOTARECOMENDADA_EXCEDFAM     '||         pCUOTARECOMENDADA_EXCEDFAM       );
p_depura(  'pTOTALPASIVO_PATRIMONIO        '||         pTOTALPASIVO_PATRIMONIO          );
p_depura(  'pUTILIDADNETA_PATRIMONIO       '||         pUTILIDADNETA_PATRIMONIO         );
p_depura(  'pUTILIDADNETA_TOTALACTIVOS1    '||         pUTILIDADNETA_TOTALACTIVOS1      );
p_depura(  'pUTILIDADNETA_VENTAS           '||         pUTILIDADNETA_VENTAS             );
p_depura(  'pCUENTASXCOBRAR_VENTAS         '||         pCUENTASXCOBRAR_VENTAS           );
p_depura(  'pCOSTOVENTA_INVENTARIO         '||         pCOSTOVENTA_INVENTARIO           );
p_depura(  'pGASTOSLEGALES                 '||         pGASTOSLEGALES                   );                   --
p_depura(  'pMONEDA                        '||         pMONEDA                          );
p_depura(  'pcapital_trabajo               '||         pcapital_trabajo                 );
p_depura(  'pfechabalancegeneral           '||         pfechabalancegeneral             );
p_depura(  'pdesde                         '||         pdesde                           );
p_depura(  'phasta                         '||         phasta                           );
p_depura(  'ptotalcostooperacional         '||         ptotalcostooperacional           );
p_depura(  'putilidadneta                  '||         putilidadneta                    );
p_depura(  'pventasdiarias_promedio        '||         pventasdiarias_promedio          );
p_depura(  'pdiastrabajados                '||         pdiastrabajados                  );
p_depura(  'pcomprassemanalesdeclaradas    '||         pcomprassemanalesdeclaradas      );
p_depura(  'pventasmensualesdeclaradas     '||         pventasmensualesdeclaradas       );
p_depura(  'pmargendeclarado               '||         pmargendeclarado                 );
p_depura(  'pmontomesalto                  '||         pmontomesalto                    );
p_depura(  'pmontomesmedio                 '||         pmontomesmedio                   );
p_depura(  'pcomprasmensualesdeclaradas    '||         pcomprasmensualesdeclaradas      );
p_depura(  'pmontomesbajo                  '||         pmontomesbajo                    );
p_depura(  'pventasmensuales               '||         pventasmensuales                 );
p_depura(  'pcostoventamensual             '||         pcostoventamensual               );
p_depura(  'pUtilidadbruta                 '||         pUtilidadbruta                   );
p_depura(  'pmargenganancia                '||         pmargenganancia                  );
p_depura(  'pprimera_ref_vecinos           '||         pprimera_ref_vecinos             );
p_depura(  'psegunda_ref_vecinos           '||         psegunda_ref_vecinos             );
p_depura(  'pambientefamiliar              '||         pambientefamiliar                );
p_depura(  'pdependientes                  '||         pdependientes                    );
p_depura(  'pedad                          '||         pedad                            );
p_depura(  'pestadosaludfamilia            '||         pestadosaludfamilia              );
p_depura(  'pingresos                      '||         pingresos                        );
p_depura(  'potrosingresos                 '||         potrosingresos                   );
p_depura(  'pexperiencia_neg               '||         pexperiencia_neg                 );
p_depura(  'phoras_neg                     '||         phoras_neg                       );
p_depura(  'plocalpropio                   '||         plocalpropio                     );
p_depura(  'ptiempoempleo                  '||         ptiempoempleo                    );
p_depura(  'pubicacionnegocio              '||         pubicacionnegocio                );
p_depura(  'pllevaregistro                 '||         pllevaregistro                   );
p_depura(  'pmejorasnegocio                '||         pmejorasnegocio                  );
p_depura(  'pclientesfrecuentes            '||         pclientesfrecuentes              );
p_depura(  'pnivelcompetencia              '||         pnivelcompetencia                );
p_depura(  'pfecha_balancegeneral_al       '||         pfecha_balancegeneral_al         );
p_depura(  'pDESTINOCREDITO                '||         pDESTINOCREDITO                  );
p_depura(  'pESPECIFIQUEDESTINO            '||         pESPECIFIQUEDESTINO              );
p_depura(  'pESTADOSOLICITUD               '||         pESTADOSOLICITUD                 );
p_depura(  'pACTIVIDADECONOMICA            '||         pACTIVIDADECONOMICA              );
p_depura(  'pACTIVIDADECONOMICADINRAP      '||         pACTIVIDADECONOMICADINRAP        );
p_depura(  'pMARGENBRUTOESTANDAR           '||         pMARGENBRUTOESTANDAR             );
p_depura(  'pGASTOSOPERACIONALESESTANDAR   '||         pGASTOSOPERACIONALESESTANDAR     );
p_depura(  'pALTO_INDICADORES              '||         pALTO_INDICADORES                );
p_depura(  'pBAJO_INDICADORES              '||         pBAJO_INDICADORES                );
p_depura(  'pLUNES                         '||         pLUNES                           );
p_depura(  'pMARTES                        '||         pMARTES                          );
p_depura(  'pMIERCOLES                     '||         pMIERCOLES                       );
p_depura(  'pJUEVES                        '||         pJUEVES                          );
p_depura(  'pVIERNES                       '||         pVIERNES                         );
p_depura(  'pSABADO                        '||         pSABADO                          );
p_depura(  'pDOMINGO                       '||         pDOMINGO                         );
p_depura(  'pTOTAL_VENTASALTAS             '||         pTOTAL_VENTASALTAS               );
p_depura(  'pTOTAL_VENTASBAJAS             '||         pTOTAL_VENTASBAJAS               );
p_depura(  'pTOTAL_VENTASSEMANALES         '||         pTOTAL_VENTASSEMANALES           );
p_depura(  'pTOTAL_VENTASMENSUALES         '||         pTOTAL_VENTASMENSUALES           );
p_depura(  'pMARGENBRUTODECLARADO          '||         pMARGENBRUTODECLARADO            );
p_depura(  'pALIMENTACION_GASTOS           '||         pALIMENTACION_GASTOS             );
p_depura(  'pVIVIENDA_GASTOS               '||         pVIVIENDA_GASTOS                 );
p_depura(  'pEDUCACION_GASTOS              '||         pEDUCACION_GASTOS                );
p_depura(  'pSALUD_GASTOS                  '||         pSALUD_GASTOS                    );
p_depura(  'pTRANSPORTE_GASTOS             '||         pTRANSPORTE_GASTOS               );
p_depura(  'pVESTIDO_GASTOS                '||         pVESTIDO_GASTOS                  );
p_depura(  'pPAGODEUDAS_GASTOS             '||         pPAGODEUDAS_GASTOS               );
p_depura(  'pOTROS_GASTOS_FAMILIARES       '||         pOTROS_GASTOS_FAMILIARES         );
p_depura(  'pTOTAL_GASTOS                  '||         pTOTAL_GASTOS                    );
p_depura(  'pVENTAS_GASTOS                 '||         pVENTAS_GASTOS                   );
p_depura(  'pCOSTOSVENTAS_GASTOS           '||         pCOSTOSVENTAS_GASTOS             );
p_depura(  'pGASTOSOPERATIVOS              '||         pGASTOSOPERATIVOS                );
p_depura(  'pOTROS_INGRESOS_GASTOS         '||         pOTROS_INGRESOS_GASTOS           );
p_depura(  'pTOTAL_GASTOS_FAMILIARES       '||         pTOTAL_GASTOS_FAMILIARES         );
p_depura(  'pEXCEDENTEFAMILIAR_GASTOS      '||         pEXCEDENTEFAMILIAR_GASTOS        );
p_depura(  'pCUOTASOLICITADA               '||         pCUOTASOLICITADA                 );
p_depura(  'pRELCUOTASOLICITADA_EXCFAM     '||         pRELCUOTASOLICITADA_EXCFAM       );
p_depura(  'pMONTO_RECOMENDACION           '||         pMONTO_RECOMENDACION             );
p_depura(  'pMONEDA_RECOMENDACION          '||         pMONEDA_RECOMENDACION            );
p_depura(  'pPLAZO_RECOMENDACION           '||         pPLAZO_RECOMENDACION             );
p_depura(  'pTASA_RECOMENDACION            '||         pTASA_RECOMENDACION              );
p_depura(  'pFRECUENCIA_RECOMENDACION      '||         pFRECUENCIA_RECOMENDACION        );
p_depura(  'pCUOTA_RECOMENDACION           '||         pCUOTA_RECOMENDACION             );
p_depura(  'pESTADOSOLICITUD_RECOMENDACION '||         pESTADOSOLICITUD_RECOMENDACION   );
p_depura(  'pCUOTARECOMENDADA_EXCFAMILIAR  '||         pCUOTARECOMENDADA_EXCFAMILIAR    );
p_depura(  'pVENTASEVALANTERIOR            '||         pVENTASEVALANTERIOR              );
p_depura(  'pACTUAL_VENTAS                 '||         pACTUAL_VENTAS                   );
p_depura(  'pVARIACIONVENTAS               '||         pVARIACIONVENTAS                 );
p_depura(  'pCOMENTARIO1                   '||         pCOMENTARIO1                     );
p_depura(  'pCOMENTARIO2                   '||         pCOMENTARIO2                     );
p_depura(  'pPRO1NOMBRE                    '||         pPRO1NOMBRE                      );
p_depura(  'pPRO1MATERIAPRIMA1             '||         pPRO1MATERIAPRIMA1               );
p_depura(  'pPRO1MATERIAPRIMA2             '||         pPRO1MATERIAPRIMA2               );
p_depura(  'pPRO1MATERIAPRIMA3             '||         pPRO1MATERIAPRIMA3               );
p_depura(  'pPRO1TOTALMP                   '||         pPRO1TOTALMP                     );
p_depura(  'pPRO1SUELDO1                   '||         pPRO1SUELDO1                     );
p_depura(  'pPRO1SUELDO2                   '||         pPRO1SUELDO2                     );
p_depura(  'pPRO1TOTALSUELDO               '||         pPRO1TOTALSUELDO                 );
p_depura(  'pPRO1OTROSCOSTOS               '||         pPRO1OTROSCOSTOS                 );
p_depura(  'pPRO1TOTALCOSTOS               '||         pPRO1TOTALCOSTOS                 );
p_depura(  'pPRO1COSTOUNITARIO             '||         pPRO1COSTOUNITARIO               );
p_depura(  'pPRO1PRECIOUNITARIO            '||         pPRO1PRECIOUNITARIO              );
p_depura(  'pPRO1UNIDADESVENDIDAS          '||         pPRO1UNIDADESVENDIDAS            );
p_depura(  'pPRO1MARGENGANANCIA            '||         pPRO1MARGENGANANCIA              );
p_depura(  'pPRO2NOMBRE                    '||         pPRO2NOMBRE                      );
p_depura(  'pPRO2MATERIAPRIMA1             '||         pPRO2MATERIAPRIMA1               );
p_depura(  'pPRO2MATERIAPRIMA2             '||         pPRO2MATERIAPRIMA2               );
p_depura(  'pPRO2MATERIAPRIMA3             '||         pPRO2MATERIAPRIMA3               );
p_depura(  'pPRO2TOTALMP                   '||         pPRO2TOTALMP                     );
p_depura(  'pPRO2SUELDO1                   '||         pPRO2SUELDO1                     );
p_depura(  'pPRO2SUELDO2                   '||         pPRO2SUELDO2                     );
p_depura(  'pPRO2TOTALSUELDO               '||         pPRO2TOTALSUELDO                 );
p_depura(  'pPRO2OTROSCOSTOS               '||         pPRO2OTROSCOSTOS                 );
p_depura(  'pPRO2TOTALCOSTOS               '||         pPRO2TOTALCOSTOS                 );
p_depura(  'pPRO2COSTOUNITARIO             '||         pPRO2COSTOUNITARIO               );
p_depura(  'pPRO2PRECIOUNITARIO            '||         pPRO2PRECIOUNITARIO              );
p_depura(  'pPRO2UNIDADESVENDIDAS          '||         pPRO2UNIDADESVENDIDAS            );
p_depura(  'pPRO2MARGENGANANCIA            '||         pPRO2MARGENGANANCIA              );
p_depura(  'pPRO3NOMBRE                    '||         pPRO3NOMBRE                      );
p_depura(  'pPRO3MATERIAPRIMA1             '||         pPRO3MATERIAPRIMA1               );
p_depura(  'pPRO3MATERIAPRIMA2             '||         pPRO3MATERIAPRIMA2               );
p_depura(  'pPRO3MATERIAPRIMA3             '||         pPRO3MATERIAPRIMA3               );
p_depura(  'pPRO3TOTALMP                   '||         pPRO3TOTALMP                     );
p_depura(  'pPRO3SUELDO1                   '||         pPRO3SUELDO1                     );
p_depura(  'pPRO3SUELDO2                   '||         pPRO3SUELDO2                     );
p_depura(  'pPRO3TOTALSUELDO               '||         pPRO3TOTALSUELDO                 );
p_depura(  'pPRO3OTROSCOSTOS               '||         pPRO3OTROSCOSTOS                 );
p_depura(  'pPRO3TOTALCOSTOS               '||         pPRO3TOTALCOSTOS                 );
p_depura(  'pPRO3COSTOUNITARIO             '||         pPRO3COSTOUNITARIO               );
p_depura(  'pPRO3PRECIOUNITARIO            '||         pPRO3PRECIOUNITARIO              );
p_depura(  'pPRO3UNIDADESVENDIDAS          '||         pPRO3UNIDADESVENDIDAS            );
p_depura(  'pPRO3MARGENGANANCIA            '||         pPRO3MARGENGANANCIA              );
p_depura(  'pPROOTROMATERIAPRIMA1          '||         pPROOTROMATERIAPRIMA1            );
p_depura(  'pPROOTROMATERIAPRIMA2          '||         pPROOTROMATERIAPRIMA2            );
p_depura(  'pPROOTROMATERIAPRIMA3          '||         pPROOTROMATERIAPRIMA3            );
p_depura(  'pPROOTROTOTALMP                '||         pPROOTROTOTALMP                  );
p_depura(  'pPROOTROSUELDO1                '||         pPROOTROSUELDO1                  );
p_depura(  'pPROOTROSUELDO2                '||         pPROOTROSUELDO2                  );
p_depura(  'pPROOTROTOTALSUELDO            '||         pPROOTROTOTALSUELDO              );
p_depura(  'pPROOTROOTROSCOSTOS            '||         pPROOTROOTROSCOSTOS              );
p_depura(  'pPROOTROTOTALCOSTOS            '||         pPROOTROTOTALCOSTOS              );
p_depura(  'pPROOTROCOSTOUNITARIO          '||         pPROOTROCOSTOUNITARIO            );
p_depura(  'pPROOTROPRECIOUNITARIO         '||         pPROOTROPRECIOUNITARIO           );
p_depura(  'pPROOTROUNIDADESVENDIDAS       '||         pPROOTROUNIDADESVENDIDAS         );
p_depura(  'pPROOTROMARGENGANANCIA         '||         pPROOTROMARGENGANANCIA           );
p_depura(  'pLINEA1                        '||         pLINEA1                          );
p_depura(  'pPRECIOUNITARIO1               '||         pPRECIOUNITARIO1                 );
p_depura(  'pCOSTOUNITARIO1                '||         pCOSTOUNITARIO1                  );
p_depura(  'pMARGENDEGANANCIA1             '||         pMARGENDEGANANCIA1               );
p_depura(  'pUNIDADESVENDIDAS1             '||         pUNIDADESVENDIDAS1               );
p_depura(  'pLINEA2                        '||         pLINEA2                          );
p_depura(  'pPRECIOUNITARIO2               '||         pPRECIOUNITARIO2                 );
p_depura(  'pCOSTOUNITARIO2                '||         pCOSTOUNITARIO2                  );
p_depura(  'pMARGENDEGANANCIA2             '||         pMARGENDEGANANCIA2               );
p_depura(  'pUNIDADESVENDIDAS2             '||         pUNIDADESVENDIDAS2               );
p_depura(  'pLINEA3                        '||         pLINEA3                          );
p_depura(  'pPRECIOUNITARIO3               '||         pPRECIOUNITARIO3                 );
p_depura(  'pCOSTOUNITARIO3                '||         pCOSTOUNITARIO3                  );
p_depura(  'pMARGENDEGANANCIA3             '||         pMARGENDEGANANCIA3               );
p_depura(  'pUNIDADESVENDIDAS3             '||         pUNIDADESVENDIDAS3               );
p_depura(  'pLINEAOT                       '||         pLINEAOT                         );
p_depura(  'pPRECIOUNITARIOOT              '||         pPRECIOUNITARIOOT                );
p_depura(  'pCOSTOUNITARIOOT               '||         pCOSTOUNITARIOOT                 );
p_depura(  'pMARGENDEGANANCIAOT            '||         pMARGENDEGANANCIAOT              );
p_depura(  'pUNIDADESVENDIDASOT            '||         pUNIDADESVENDIDASOT              );
p_depura(  'pTIPOCREDITO                   '||         pTIPOCREDITO                     );
p_depura(  'pGARANTIAS                     '||         pGARANTIAS                       );
p_depura(  'pVALORGARANTIA                 '||         pVALORGARANTIA                   );
p_depura(  'pDESCRIPCIONGARANTIA           '||         pDESCRIPCIONGARANTIA             );
p_depura(  'pPRESTAMODESCONTAR             '||         pPRESTAMODESCONTAR               );
p_depura(  'pLINEA4                        '||         pLINEA4                          );
p_depura(  'pPRECIOUNITARIO4               '||         pPRECIOUNITARIO4                 );
p_depura(  'pCOSTOUNITARIO4                '||         pCOSTOUNITARIO4                  );
p_depura(  'pMARGENDEGANANCIA4             '||         pMARGENDEGANANCIA4               );
p_depura(  'pUNIDADESVENDIDAS4             '||         pUNIDADESVENDIDAS4               );
p_depura(  'pLINEA5                        '||         pLINEA5                          );
p_depura(  'pPRECIOUNITARIO5               '||         pPRECIOUNITARIO5                 );
p_depura(  'pCOSTOUNITARIO5                '||         pCOSTOUNITARIO5                  );
p_depura(  'pMARGENDEGANANCIA5             '||         pMARGENDEGANANCIA5               );
p_depura(  'pUNIDADESVENDIDAS5             '||         pUNIDADESVENDIDAS5               );
p_depura(  'pLINEA6                        '||         pLINEA6                          );
p_depura(  'pPRECIOUNITARIO6               '||         pPRECIOUNITARIO6                 );
p_depura(  'pCOSTOUNITARIO6                '||         pCOSTOUNITARIO6                  );
p_depura(  'pMARGENDEGANANCIA6             '||         pMARGENDEGANANCIA6               );
p_depura(  'pUNIDADESVENDIDAS6             '||         pUNIDADESVENDIDAS6               );
p_depura(  'pLINEA7                        '||         pLINEA7                          );
p_depura(  'pPRECIOUNITARIO7               '||         pPRECIOUNITARIO7                 );
p_depura(  'pCOSTOUNITARIO7                '||         pCOSTOUNITARIO7                  );
p_depura(  'pMARGENDEGANANCIA7             '||         pMARGENDEGANANCIA7               );
p_depura(  'pUNIDADESVENDIDAS7             '||         pUNIDADESVENDIDAS7               );
p_depura(  'pLINEA8                        '||         pLINEA8                          );
p_depura(  'pPRECIOUNITARIO8               '||         pPRECIOUNITARIO8                 );
p_depura(  'pCOSTOUNITARIO8                '||         pCOSTOUNITARIO8                  );
p_depura(  'pMARGENDEGANANCIA8             '||         pMARGENDEGANANCIA8               );
p_depura(  'pUNIDADESVENDIDAS8             '||         pUNIDADESVENDIDAS8               );
p_depura(  'pCOMENTARIO                    '||         pCOMENTARIO                      );
p_depura(  'pIDOFICIAL                     '||         pIDOFICIAL                       );
p_depura(  'pFECHAREGISTRO                 '||         pFECHAREGISTRO                   );
p_depura(  'pFECHAFIJA                     '||         pFECHAFIJA                       );
p_depura(  'pIDESTADO                      '||         pIDESTADO                        );
p_depura(  'pMENSAJE                       '||         pMENSAJE                         );
p_depura(  'pNOSUBIDA                      '||         pNOSUBIDA                        );
p_depura(  'pIDGRUPO                       '||         pIDGRUPO                         );
p_depura(  'pIMPRESO                       '||         pIMPRESO                         );
*/

        --Depura tmp fin
        ---Return;

        --pNOMARCHIVO := REPLACE (pNOMARCHIVO, 'FEC_');

        --pIDESTADO := NULL;            --malmanzar 18-07-2022 para evitar error

        ---antes limpieza



        ---malmanzar 04-05-2023
        --
        --        vtipodocumentoidentidad := NULL;                          --04-08-2022
        --
        --        vtipodocumentoidentidad :=
        --            F_TIPOID_PDA_CORE (pTipo_Id_PDA => ptipodocumentoidentidad); --malmanzar 09-06-2022
        --
        --        vNumIdFormat :=
        --            pa.formatear_identifi (pDocumentoidentidad,
        --                                   vtipodocumentoidentidad -- ptipodocumentoidentidad  03-03-2023
        --                                                          );
        --
        --        BEGIN                                                       --Bloque 1
        --            SELECT cod_persona
        --              INTO p_codcliente
        --              FROM id_personas b
        --             WHERE     b.num_id = vNumIdFormat
        --                   AND b.cod_tipo_id = vtipodocumentoidentidad;
        --        --                       pa.formatear_identifi (
        --        --                           pDocumentoidentidad,
        --        --                           DECODE (pTipodocumentoidentidad,
        --        --                                   'C', '1',
        --        --                                   'R', '2',
        --        --                                   'P', '4'))
        --        --                   AND b.cod_tipo_id =
        --        --                       DECODE (pTipodocumentoidentidad,
        --        --                               'C', '1',
        --        --                               'R', '2',
        --        --                               'P', '4');
        --        -- EXCEPTION
        --        --            WHEN OTHERS
        --        --            THEN
        --        --                BEGIN
        --        --                    SELECT cod_persona
        --        --                      INTO p_codcliente
        --        --                      FROM id_personas b
        --        --                     WHERE     b.num_id =
        --        --                               pa.formatear_identifi (
        --        --                                   pDocumentoidentidad,
        --        --                                   DECODE (pTipodocumentoidentidad,
        --        --                                           'C', '1',
        --        --                                           'R', '2',
        --        --                                           'P', '6'))
        --        --                           AND b.cod_tipo_id =
        --        --                               DECODE (pTipodocumentoidentidad,
        --        --                                       'C', '1',
        --        --                                       'R', '2',
        --        --                                       'P', '6');
        --        EXCEPTION
        --            WHEN OTHERS
        --            THEN
        --                ROLLBACK;
        --                pmensajeerror :=
        --                       'Revisar campos tipodocumentoidentidad y documentoidentidad: '
        --                    || pTipodocumentoidentidad
        --                    || ' pDocumentoidentidad: '
        --                    || pDocumentoidentidad
        --                    || '...';
        --
        --                /*malmanzar 04-03-2022
        --                En caso de error en vez de realizar de actualizar  via WebService
        --                se realiza rollback se devuelve mensaje de error.
        --                */
        --                --pIdtempFud                   := 0;
        --                pEstadoFec := 'R';
        --                pMensajeFec := pmensajeerror;
        --                pNoSolicitud := 0;
        --                RETURN;
        --        --:new.idestado := 'R';
        --        ---vId_tempfec := 999;
        --        --:new.mensaje := 'Rechazado';
        --        /*IF ia.api_portacredit.fnupdatefud (0,   --malmanzar 04-03-2022
        --                                           pIdTempFec,
        --                                           'R',
        --                                           pmensajeerror,
        --                                           0)
        --        THEN
        --            raise_application_error (num   => -20000,
        --                                     msg   => pmensajeerror);
        --        END IF;*/
        --        --   END;
        --        END;                                                    --End Bloque 1

        --Begin Bloque 2

        --- X
        --                   p_codagencia,
        --                   v_no_credito,
        --                   v_tipopersona,
        --                   --vcuotasegurocal,
        --                   vmonedacal,
        --                   vdestinocredito,
        --                   vespecifiquedestino,
        ---X
        --
        --        BEGIN
        --            SELECT TO_NUMBER (idagencia),
        --                   b.nocredito,                      --to_number(b.nocredito),
        --                   UPPER (b.tipopersona),
        --                   --cuotasegurocal,--to_number(replace(cuotasegurocal,'.',',')),
        --                   monedacal,
        --                   destinocredito,
        --                   especifiquedestino,
        --                   clientepertenece
        --              INTO p_codagencia,
        --                   v_no_credito,
        --                   v_tipopersona,
        --                   --vcuotasegurocal,
        --                   vmonedacal,
        --                   vdestinocredito,
        --                   vespecifiquedestino,
        --                   vclientepertenece
        --              FROM tempfud b
        --             WHERE nomarchivo = pNomarchivo;
        --        --- 31-10-2022-WHERE nomarchivo = SUBSTR(pNomarchivo,5,LENGTH(pNomarchivo)); --malmanzar 15-07-2022
        --        EXCEPTION
        --            WHEN OTHERS
        --            THEN
        --                ROLLBACK;
        --                pmensajeerror :=
        --                       'Revisar campo nomarchivo '
        --                    || pNomarchivo
        --                    || ', se esta realizando la busqueda del registro en Tempfud sqlerrm '
        --                    || SQLERRM;
        --                p_depura (
        --                       'pmensajeerror '
        --                    || pmensajeerror
        --                    || ' Linea '
        --                    || $$plsql_line);
        --
        --                /*malmanzar 04-03-2022
        --                En caso de error en vez de realizar de actualizar  via WebService
        --                se realiza rollback se devuelve mensaje de error.
        --                */
        --                --pIdtempFud                   := 0;
        --                pEstadoFec := 'R';
        --                pMensajeFec := pmensajeerror;
        --                pNoSolicitud := 0;
        --                RETURN;
        --        --:new.idestado := 'R';
        --
        --        --:new.mensaje := 'Rechazado';
        --        --                IF ia.api_portacredit.fnupdatefud (0,
        --        --                                                   pIdTempFec,
        --        --                                                   'R',
        --        --                                                   pmensajeerror,
        --        --                                                   0)
        --        --                THEN
        --        --                    raise_application_error (num   => -20000,
        --        --                                             msg   => pmensajeerror);
        --        --                END IF;
        --        END;

        --End Bloque 2



        --Begin Bloque 3
        --        IF v_no_credito IS NULL
        --        THEN
        --            IF vclientepertenece IS NOT NULL
        --            THEN
        --                SELECT MAX (TO_NUMBER (b.nocredito))
        --                  INTO v_no_credito
        --                  FROM tempfud b
        --                 WHERE numdocumentoidentidad = vclientepertenece;
        --            --AND idestado = 'A';
        --            --                       AND idestado = 'E';              --MALMANZAR 12-08-2022 , malmanzar 28-03-2023
        --            END IF;
        --
        --            IF v_no_credito IS NULL AND vclientepertenece IS NOT NULL
        --            THEN
        --                ROLLBACK;
        --                pmensajeerror :=
        --                       'Revisar campo cliente pertenece, para validar el no_credito creado asociado a este fiador, cliente pertenece: '
        --                    || vclientepertenece;
        --
        --                /*malmanzar 04-03-2022
        --                     En caso de error en vez de realizar de actualizar  via WebService
        --                     se realiza rollback se devuelve mensaje de error.
        --                     */
        --                --pIdtempFud                   := 0;
        --                pEstadoFec := 'R';
        --                pMensajeFec := pmensajeerror;
        --                pNoSolicitud := 0;
        --                RETURN;
        --                --:new.idestado := 'R';
        --                p_depura ('Linea ' || $$plsql_line);
        --            --:new.mensaje := 'Rechazado';
        --            --                IF ia.api_portacredit.fnupdatefud (0,
        --            --                                                   pIdTempFec,
        --            --                                                   'R',
        --            --                                                   pmensajeerror,
        --            --                                                   0)
        --            --                THEN
        --            --                    raise_application_error (num   => -20000,
        --            --                                             msg   => pmensajeerror);
        --            --                END IF;
        --            ELSIF v_no_credito IS NULL AND vclientepertenece IS NULL
        --            THEN
        --                ROLLBACK;
        --
        --                p_depura ('Linea ' || $$plsql_line);
        --                pmensajeerror := 'Revisar el error presentado en FUD.';
        --
        --                /*malmanzar 04-03-2022
        --                        En caso de error en vez de realizar de actualizar  via WebService
        --                        se realiza rollback se devuelve mensaje de error.
        --                        */
        --                -- pIdtempFud                   := 0;
        --                pEstadoFec := 'R';
        --                pMensajeFec := pmensajeerror;
        --                pNoSolicitud := 0;
        --                RETURN;
        --            --:new.idestado := 'R';
        --
        --            --                --:new.mensaje := 'Rechazado';
        --            --                IF ia.api_portacredit.fnupdatefud (0,
        --            --                                                   pIdTempFec,
        --            --                                                   'R',
        --            --                                                   pmensajeerror,
        --            --                                                   0)
        --            --                THEN
        --            --                    raise_application_error (num   => -20000,
        --            --                                             msg   => pmensajeerror);
        --            --                END IF;
        --            END IF;
        --        END IF;
        --
        --        p_depura ('Linea ' || $$plsql_line);
        --
        --        --

        BEGIN
            SELECT cuota
              INTO vcuotasegurocallv
              FROM pr_creditos
             WHERE no_credito = p_solicitud;   --v_no_credito;   ---30-09-2025
        EXCEPTION
            WHEN OTHERS
            THEN
                vcuotasegurocallv := 0;
        END;


        --p_depura ('tempfec p_codcliente ' || v_no_credito || ' ' || :new.nomarchivo || ' ' || :new.frecuencia);
        v_reg_credito.codigo_cliente := p_codcliente;
        v_reg_credito.monto_credito := pmontorecomendado;


        --
        --p_depura ('tempfec v_tipopersona ' || v_tipopersona);
        --        IF v_tipopersona = 'CLIENTE'
        --        THEN
        --            SELECT DECODE (pFrecuencia,
        --                           1, 'SM',                                --  Semanal
        --                           2, 'BS',                              --  Bisemanal
        --                           3, 'TS',                             --  Trisemanal
        --                           4, 'VO',                          --  CuatriSemanal
        --                           5, 'ME',                                --  Mensual
        --                           6, 'BI',                              --  Bimestral
        --                           7, 'TR',                             --  Trimestral
        --                           8, 'CU',                          --  Cuatrimestral
        --                           9, 'SE',                              --  Semestral
        --                           10, 'AN')
        --              INTO v_frecuencia
        --              FROM DUAL;

        ---p_depura ('Linea ' || $$plsql_line);                            --

        --p_depura ('tempfec v_frecuencia ' || v_frecuencia);
        --
        --p_depura('pmensajeerror '||pmensajeerror||' linea '||$$plsql_line);
        --            BEGIN
        --                SELECT dias_periodo * pplazo
        --                  INTO v_plazo
        --                  FROM pr_periodicidad pp
        --                 WHERE pp.codigo_periodo =
        --                       DECODE (pFrecuencia,
        --                               1, 'SM',                            --  Semanal
        --                               2, 'BS',                          --  Bisemanal
        --                               3, 'TS',                         --  Trisemanal
        --                               4, 'VO',                      --  CuatriSemanal
        --                               5, 'ME',                            --  Mensual
        --                               6, 'BI',                          --  Bimestral
        --                               7, 'TR',                         --  Trimestral
        --                               8, 'CU',                      --  Cuatrimestral
        --                               9, 'SE',                          --  Semestral
        --                               10, 'AN');
        --            EXCEPTION
        --                WHEN OTHERS
        --                THEN
        --                    ROLLBACK;
        --                    v_plazo := 0;
        --                    pmensajeerror :=
        --                           'Revisar el campo Frecuenciacal >>>'
        --                        || pFrecuencia
        --                        || '<<< Linea '
        --                        || $$plsql_line
        --                        || ' sqlerr '
        --                        || SQLERRM;
        --
        --                    /*malmanzar 04-03-2022
        --                        En caso de error en vez de realizar de actualizar  via WebService
        --                        se realiza rollback se devuelve mensaje de error.
        --                        */
        --                    -- pIdtempFud                   := 0;
        --                    pEstadoFec := 'R';
        --                    pMensajeFec := pmensajeerror;
        --                    pNoSolicitud := 0;
        --                    p_depura (
        --                           'Linea '
        --                        || $$plsql_line
        --                        || ' Antes Return '
        --                        || pmensajeerror);
        --                    RETURN;
        --:new.idestado := 'R';

        --:new.mensaje := 'Rechazado';
        --                    IF ia.api_portacredit.fnupdatefud (0,
        --                                                       pIdTempFec,
        --                                                       'R',
        --                                                       'Frecuenciacal',
        --                                                       0)
        --                    THEN
        --                        DBMS_OUTPUT.put_line (
        --                            'p_mensajeerror= Frecuenciacal');
        --                        raise_application_error (num   => -20000,
        --                                                 msg   => pmensajeerror);
        --                    END IF;
        --  END;
        --

        ---END IF;

        --p_depura ('tempfec v_plazo ' || v_plazo);
        --p_depura ('tempfec registra valores');
        BEGIN
            --Calculos de Totales
            v_totalventasmensuales := 0;

            v_totalventasmensuales := pventas_ingresos;
            /*    NVL (Ppro1ventasmensuales, 0)
              + NVL (ppro2ventasmensuales, 0)
              + NVL (ppro3ventasmensuales, 0)
              + NVL (pprootroventasmensuales, 0)
              + NVL (pventasmensuales1, 0)
              + NVL (pventasmensuales2, 0)
              + NVL (pventasmensuales3, 0)
              + NVL (pventasmensuales4, 0)
              + NVL (pventasmensuales5, 0)
              + NVL (pventasmensuales6, 0)
              + NVL (pventasmensuales7, 0)
              + NVL (pventasmensuales8, 0)
              + NVL (pventasmensualesot, 0)
              + (CASE
                     WHEN vclientepertenece IS NULL THEN 0
                     ELSE NVL (pVENTAS_INGRESOS, 0)
                 END);*/
            --22-01-2024

            v_totalcostoventas := 0;
            v_totalcostoventas := pcostoventas;
            /*    NVL (ppro1costosventasmensuales, 0)
              + NVL (ppro2costosventasmensuales, 0)
              + NVL (ppro3costosventasmensuales, 0)
              + NVL (pprootrocostosventasmensuales, 0)
              + NVL (pcostoventas1, 0)
              + NVL (pcostoventas2, 0)
              + NVL (pcostoventas3, 0)
              + NVL (pcostoventas4, 0)
              + NVL (pcostoventas5, 0)
              + NVL (pcostoventas6, 0)
              + NVL (pcostoventas7, 0)
              + NVL (pcostoventas8, 0)
              + NVL (pcostoventasot, 0)
              + (CASE
                     WHEN vclientepertenece IS NULL THEN 0
                     ELSE NVL (pCOSTOVENTAS, 0)
                 END);*/
            --malmanzar 22-01-2024
            v_utilidadbruta := v_totalventasmensuales - v_totalcostoventas;
            v_tcon :=
                  NVL (psueldo, 0)
                + NVL (pservicio, 0)
                + NVL (palquiler, 0)
                + NVL (ptransporte_combs, 0)
                + NVL (ppagointereses, 0)
                + NVL (potrosingresos_operacionales, 0);
            v_utilidad_neta := v_utilidadbruta - v_tcon;
            v_total_gastos_familiares :=
                  NVL (palimentacion, 0)                                    --
                + NVL (pvivienda, 0)                                        --
                + NVL (pvestido, 0)                                         --
                + NVL (ptransporte, 0)                                      --
                + NVL (pservicios, 0)                                       --
                + NVL (pmedicinas, 0)
                + NVL (peducacion, 0)                                       --
                + NVL (pdeudasfamiliares, 0)                                --
                + NVL (potros_gastos, 0);                                   --
            v_exd_familiar :=
                  (v_utilidad_neta + NVL (potros, 0))
                - v_total_gastos_familiares;
            v_excedentefamiliar := v_exd_familiar;
            -- Calculos Balance General
            v_total_activo_fijo :=
                NVL (pmaquinaria_mueblesequipos, 0) + NVL (plocalnegocio, 0);
            v_total_activo_corriente :=
                  NVL (pefectivo_cajabanco, 0)
                + NVL (pcuentaxcobrar, 0)
                + NVL (pinventario_prod_tem, 0)
                + NVL (pinventario_prod_proc, 0)
                + NVL (pinventario_materiaprima, 0)
                + NVL (pmercancia, 0)
                + NVL (panticipo_proveedores, 0);
            v_total_activos := v_total_activo_corriente + v_total_activo_fijo;
            v_total_pasivo_corriente :=
                  NVL (pobligacionesfinancieras, 0)
                + NVL (pcuentapagarprovedor, 0)
                + NVL (pcuentapagarvarias, 0);
            v_total_pasivo :=
                v_total_pasivo_corriente + NVL (ptotal_pasivo_lp, 0);
            v_patrimonio := v_total_activos - v_total_pasivo;
            v_total_pasivo_patrimonio := v_patrimonio + v_total_pasivo;
            v_activos_familiares :=
                NVL (pmueble_vehiculo, 0) + NVL (pinmuebles, 0);
            v_total_pasivo_familiar :=
                NVL (pdeudacomercial, 0) + NVL (pdeudabancaria, 0);
            v_patrimonio_familiar :=
                v_activos_familiares - v_total_pasivo_familiar;

            ----p_depura('cuota tempfec:'||vcuotasegurocal);

            ----p_depura('excedente familiar tempfec:'||v_excedentefamiliar);

            p_depura ('excedente familiar tempfec:' || v_excedentefamiliar);
            p_depura (
                ' round(nvl(vcuotasegurocallv, 0): ' || vcuotasegurocallv);

            -- Calculo de indicadores
            IF v_excedentefamiliar <> 0
            THEN
                v_cuota_excedentefamiliar :=
                    ROUND (NVL (vcuotasegurocallv, 0) / v_excedentefamiliar,
                           2);
            ELSE
                v_cuota_excedentefamiliar := 0;
            END IF;



            --to_number(replace(vcuotasegurocal,'.',','))
            /*v_total_pasivo_corriente :=
             nvl(:New.obligacionesfinancieras, 0)

                                        + nvl(:New.cuentapagarprovedor, 0)

                                        + nvl(:New.cuentapagarvarias, 0);

            v_total_pasivo :=
             v_total_pasivo_corriente +
                              nvl(:New.total_pasivo_lp, 0);

            v_patrimonio := v_total_activos - v_total_pasivo;

            v_total_pasivo_patrimonio := v_patrimonio + v_total_pasivo;*/
            IF NVL (pventas_ingresos, 0) <> 0
            THEN
                v_utilidadneta_ventas :=
                    v_utilidad_neta / NVL (pventas_ingresos, 0);
                v_cxc_patrimonio :=
                    NVL (pcuentaxcobrar, 0) / NVL (pventas_ingresos, 0);
            ELSE
                v_utilidadneta_ventas := 0;
                v_cxc_patrimonio := 0;
            END IF;
        EXCEPTION
            WHEN OTHERS
            THEN
                --p_depura ('error ' || sqlerrm);
                NULL;
        END;

        --

        --:New.total_activofijo := v_Total_Activo_Fijo;

        --:New.total_activocorriente := v_Total_Activo_Corriente;

        --:New.patrimonio  := v_Patrimonio;

        --:New.total_activofamiliar :=  v_Activos_Familiares;

        --:New.total_pasivofamiliar := v_Total_Pasivo_Familiar;

        --:new.totalgastos_familiares:= v_Total_Gastos_Familiares;

        --:new.excedentefamiliar := v_ExcedenteFamiliar;

        --:New.patrio_fam_balgen := v_Patrimonio_Familiar;

        --:new.total_activos1 := v_Total_Activos;

        --:New.cuotarecomendada_excedfamiliar := vcuotasegurocal / v_ExcedenteFamiliar;

        --:New.totalpasivo_patrimonio := to_number(:new.obligacionesfinancieras) + to_number(:new.cuentapagarprovedor)+to_number(:new.cuentapagarvarias);

        --
        BEGIN
            --*****************************************

            --Insercion package carga_maestro_credito

            --*****************************************    vmonedacal,vDESTINOCREDITO,vESPECIFIQUEDESTINO

            BEGIN
                --25-01-2024 Begin
                reg1.monto_rec := pmonto_recomendacion;   --pmontorecomendado;
                reg1.plazo_rec := pplazo_recomendacion;              --pplazo;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'SQLERRM: ' || SQLERRM || ' linea: ' || $$plsql_line);
            END;

            BEGIN
                reg1.tasa_rec := ptasa_recomendacion;                 --ptasa;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'SQLERRM: ' || SQLERRM || ' linea: ' || $$plsql_line);
            END;

            BEGIN
                reg1.frecuencia_rec := '05'; --pFRECUENCIA_RECOMENDACION;--pfrecuencia;
                reg1.cuota_cr := pcuota_recomendacion;               --pcuota;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'SQLERRM: '
                        || SQLERRM
                        || ' linea: '
                        || $$plsql_line
                        || ' pFRECUENCIA_RECOMENDACION: '
                        || pfrecuencia_recomendacion
                        || ' pCUOTA_RECOMENDACION: '
                        || pcuota_recomendacion);
            END;

            reg1.destino_credito_rec := pdestinocredito;    --vdestinocredito;

            BEGIN
                reg1.detalle_destino_rec := pespecifiquedestino; --vespecifiquedestino;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'SQLERRM: ' || SQLERRM || ' linea: ' || $$plsql_line);
            END;

            BEGIN
                reg1.moneda_rec := pmoneda_recomendacion;        --vmonedacal;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'SQLERRM: ' || SQLERRM || ' linea: ' || $$plsql_line);
            END;

            BEGIN
                reg1.cod_estado_solici_rec := 'R'; --:new.estadosolicitud;  --25-01-2024 End
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'SQLERRM: ' || SQLERRM || ' linea: ' || $$plsql_line);
            END;

            --

            p_depura ('Linea ' || $$plsql_line);
            --****************************************

            --Insercion package carga_balance_general

            --****************************************
            reg1.maquinaria_computacion_bge := pmaquinaria_mueblesequipos;
            reg1.puesto_propio_bge := plocalnegocio;
            reg1.prestamos_pagar_bge := pobligacionesfinancieras;
            reg1.cuentas_pagar_bge := 0;
            reg1.tarjetas_credito_bge := pcuentapagarprovedor;
            --:New.cuentapagarvarias;
            reg1.otros_pas_bge := pcuentapagarvarias;
            reg1.activo_corriente_bge := v_total_activo_corriente;
            reg1.activo_no_corriente_bge := v_total_activo_fijo;
            reg1.pasivo_corriente_bge := v_total_pasivo_corriente;
            --:New.total_pasivocorrientes;
            reg1.pasivo_no_corriente_bge := ptotal_pasivo_lp;
            reg1.suma_pasivo_bge := v_total_pasivo_patrimonio;
            --v_patrimonio + nvl(:New.total_pasivo, 0);
            reg1.suma_patrimonio_bge := v_patrimonio;
            reg1.suma_activo_bge :=
                  NVL (pobligacionesfinancieras, 0)
                + NVL (pcuentapagarprovedor, 0)
                + NVL (pcuentapagarvarias, 0);  --:New.total_pasivopatrimonio;
            reg1.capital_bge := pcapital_trabajo;
            reg1.fecha_bge := TO_DATE (pfechabalancegeneral, 'DD/MM/YYYY');
            --reg1.fecha_bge             := To_date( :New.fechabalancegeneral, 'DD/MM/YYYY' );
            reg1.efectivo_bge := pefectivo_cajabanco;
            reg1.cuentas_cobrar_bge := pcuentaxcobrar;
            reg1.inventario_prod_term_bge := pinventario_prod_tem;
            reg1.inventario_prod_proc_bge := pinventario_prod_proc;
            reg1.inventario_mercaderias_bge := pinventario_materiaprima;
            reg1.herramientas_bge := pmercancia;
            reg1.anticipo_proveedores_bge := panticipo_proveedores;
            reg1.suma_total_activo_bge := v_total_activos; --:new.total_activos1;
            reg1.vehiculos_bge := pmueble_vehiculo;
            reg1.cuentas_bancarias_bge := pdeudabancaria;
            --****************************************

            --Insercion package carga_estado_resultados

            --****************************************
            reg1.fecha_desde_neg := pdesde;  --TO_DATE (pdesde, 'DD/MM/YYYY');
            reg1.fecha_hasta_neg := phasta;  --TO_DATE (phasta, 'DD/MM/YYYY');
            reg1.ventas_mensuales_neg := v_totalventasmensuales;
            --:New.ventas_ingresos;
            reg1.costo_ventas_neg := v_totalcostoventas;   --:New.costoventas;
            reg1.utilidad_bruta_ventas_neg := v_utilidadbruta; --:New.utilidadbruta;
            reg1.salarios_neg := psueldo;
            reg1.servicios_varios_neg := pservicio;
            reg1.alquiler_local_neg := palquiler;
            reg1.transporte_neg := ptransporte_combs;
            reg1.intereses_neg := ppagointereses;
            ---reg1.otros_neg := potrosingresos_operacionales;  ---11-04-2023
            reg1.otros_neg := potros;                  ---malmanzar 11-04-2023
            reg1.gastos_operacion_neg :=
                  NVL (psueldo, 0)
                + NVL (pservicio, 0)
                + NVL (palquiler, 0)
                + NVL (ptransporte_combs, 0)
                + NVL (ppagointereses, 0)
                + NVL (potros, 0);                      --malmanzar 11-04-2023

            p_depura ('Linea ' || $$plsql_line);
            ---ptotalcostooperacional;
            /****+ (CASE
                   WHEN vclientepertenece IS NULL THEN 0
                   ELSE NVL (v_tcon, 0)
               END);****/
            reg1.excedente_neg := v_utilidadbruta - reg1.gastos_operacion_neg; ---malmanzar 11-04-2023
            /****   putilidadneta
             + (CASE
                    WHEN vclientepertenece IS NULL THEN 0
                    ELSE v_utilidadbruta - reg1.gastos_operacion_neg
                END);*****/
            --reg1.otros_ingresos_fam := potros;    ----malmanzar 11-04-2023
            reg1.otros_ingresos_fam := potrosingresos_operacionales; ----malmanzar 11-04-2023
            reg1.alimentacion_fam := palimentacion;
            reg1.alquiler_fam := pvivienda;
            reg1.vestido_fam := pvestido;
            reg1.transporte_fam := ptransporte;
            reg1.servicios_varios_fam := pservicios;
            reg1.medicinas_fam := pmedicinas;
            reg1.educacion_fam := peducacion;
            reg1.gastos_imprevistos_fam := pdeudasfamiliares;
            reg1.otros_gastos_fam := potros_gastos;
            reg1.gastos_fam := v_total_gastos_familiares;
            --:New.totalgastos_familiares;
            --reg1.excedente_mensual_fam := v_excedentefamiliar; --------------*******----------  11-04-2023    reg1.excedente_mensual_fam := nvl(reg1.excedente_neg,0) + nvl(reg1.otros_ingresos_fam,0)   - nvl(reg1.gastos_fam,0)
            reg1.excedente_mensual_fam :=
                  NVL (reg1.excedente_neg, 0)
                + NVL (reg1.otros_ingresos_fam, 0)
                - NVL (reg1.gastos_fam, 0);                       --11-04-2023
            --:new.excedentefamiliar;
            --****************************************
            p_depura ('Linea ' || $$plsql_line);
            --Insercion package carga_evaluacion_financiera

            --****************************************
            reg1.ventas_diarias_evf := pventasdiarias_promedio;
            reg1.dias_trabmes_evf := pdiastrabajados;
            reg1.ventas_mensual_evf := pventasmensualesdeclaradas;
            reg1.compras_semprom_evf := pcomprassemanalesdeclaradas;
            reg1.compras_mendecl_evf := pcomprasmensualesdeclaradas;
            reg1.margen_decl_evf := pmargendeclarado;
            reg1.monto_mesalto_evf := pmontomesalto;
            reg1.monto_mesmedio_evf := pmontomesmedio;
            reg1.monto_mesbajo_evf := pmontomesbajo;
            reg1.venta_mes_evf := pventasmensuales;
            reg1.costo_ventames_evf := pcostoventamensual;
            reg1.margen_ganancia_evf := pmargenganancia;
            --****************************************
            p_depura ('Linea ' || $$plsql_line);

            --Insercion package carga_evaluacion_nofinanciera

            BEGIN
                --****************************************
                reg1.pri_ref_enf := pprimera_ref_vecinos;
                reg1.seg_ref_enf := psegunda_ref_vecinos;
                reg1.ambiente_fam_enf := pambientefamiliar;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            BEGIN
                reg1.dependientes_enf := pdependientes;
                reg1.edad_enf :=
                    TO_NUMBER (
                        SUBSTR (NVL (pedad, 0),
                                1,
                                INSTR (NVL (pedad, 0), ' , ')));
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            BEGIN
                reg1.est_salud_enf := pestadosaludfamilia;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            BEGIN
                ---reg1.estabilidad_enf := pingresos;   ---24-01-2024
                reg1.estabilidad_enf := NULL;   --- pingresos;   ---24-01-2024
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            BEGIN
                --            reg1.otros_ing_enf := potrosingresos;  ---24-01-2024
                reg1.otros_ing_enf := NULL;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            BEGIN
                reg1.experiencia_enf := pexperiencia_neg;
                reg1.horas_enf := phoras_neg;
                reg1.local_propio_enf := plocalpropio;
                reg1.tiempo_local_enf := ptiempoempleo;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            BEGIN
                reg1.ubic_negocio_enf := pubicacionnegocio;
                reg1.lleva_registros_enf := pllevaregistro;
                reg1.mejoras_negocio_enf := pmejorasnegocio;
                reg1.frecuencia_clte_enf := pclientesfrecuentes;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            BEGIN
                reg1.nivel_compe_enf := pnivelcompetencia;
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    ROLLBACK;
                    RETURN;
            END;

            --****************************************
            p_depura ('Linea ' || $$plsql_line);

            --Insercion package carga_indicadores

            --****************************************
            IF v_patrimonio <> 0
            THEN
                reg1.pasivo_patrimonio_ind :=
                    ROUND (v_total_pasivo / v_patrimonio, 2);
            ELSE
                reg1.pasivo_patrimonio_ind := 0;
            END IF;

            IF v_total_pasivo_corriente <> 0
            THEN
                reg1.activo_pasivo_ind :=
                    ROUND (
                        v_total_activo_corriente / v_total_pasivo_corriente,
                        2);
            --:New.activocorte_pascte;
            ELSE
                reg1.activo_pasivo_ind := 0;
            END IF;

            IF v_excedentefamiliar <> 0
            THEN
                reg1.otrosingresos_excedentefam :=
                    ROUND (
                          NVL (potrosingresos_operacionales, 0)
                        / v_excedentefamiliar,
                        2);
                --:= :New.otrosingresos_excedente;
                reg1.cuota_excedentefam :=
                    ROUND (NVL (vcuotasegurocallv, 0) / v_excedentefamiliar,
                           2);
            ELSE
                reg1.otrosingresos_excedentefam := 0;
                reg1.cuota_excedentefam := 0;
            END IF;

            --:New.cuotarecomendada_excedfamiliar;
            IF (v_patrimonio + v_patrimonio_familiar) <> 0
            THEN
                reg1.tot_pasivo_patrimonio :=
                    ROUND (
                          (v_total_pasivo + v_total_pasivo_familiar)
                        / (v_patrimonio + v_patrimonio_familiar),
                        2);
            ELSE
                reg1.tot_pasivo_patrimonio := 0;
            END IF;

            IF v_patrimonio <> 0
            THEN
                reg1.utilidadneta_patrimonio :=
                    ROUND (v_utilidad_neta / v_patrimonio, 2);
            ELSE
                reg1.utilidadneta_patrimonio := 0;
            END IF;

            --:New.utilidadneta_patrimonio;
            IF v_total_activos <> 0
            THEN
                reg1.utilidadneta_activostotal :=
                    ROUND (v_utilidad_neta / v_total_activos, 2);
            ELSE
                reg1.utilidadneta_activostotal := 0;
            END IF;

            --:New.utilidadneta_totalactivos1;
            reg1.utilidadneta_ingresos := v_utilidadneta_ventas;

            IF pventas_ingresos <> 0
            THEN
                reg1.ctasxcobrar_ingresos :=
                    pcuentaxcobrar / NVL (pventas_ingresos, 0);
            ELSE
                reg1.ctasxcobrar_ingresos := 0;
            END IF;

            IF (  NVL (pinventario_prod_tem, 0)
                + NVL (pinventario_prod_proc, 0)
                + NVL (pinventario_materiaprima, 0)
                + NVL (pmercancia, 0)) <>
               0
            THEN
                reg1.costoventas_inventario :=
                    ROUND (
                          pcostoventas
                        / (  NVL (pinventario_prod_tem, 0)
                           + NVL (pinventario_prod_proc, 0)
                           + NVL (pinventario_materiaprima, 0)
                           + NVL (pmercancia, 0)),
                        2);
            ELSE
                reg1.costoventas_inventario := 0;
            END IF;                              --:New.costoventa_inventario;

            --****************************************
            p_depura ('Linea ' || $$plsql_line);
            --Insercion package carga_balance_fam

            --****************************************
            p_depura (
                   'Linea: '
                || $$plsql_line
                || ' pmueble_vehiculo: '
                || pmueble_vehiculo);

            reg1.fecha_bgf := pfecha_balancegeneral_al;
            ---TO_DATE (pfecha_balancegeneral_al, 'DD/MM/YYYY'); malmanzar  24-01-2024
            reg1.muebles_vehiculos_bgf := pmueble_vehiculo;
            --to_number(nvl(:New.mueble_vehiculo,0));
            --p_depura ('Balance General:' || reg1.muebles_vehiculos_bgf || ' ' || :new.mueble_vehiculo);
            reg1.inmuebles_bgf := pinmuebles;
            --to_number(nvl(:New.inmuebles,0));
            --p_depura ('Balance General:' || reg1.inmuebles_bgf || ' ' || :new.inmuebles);
            reg1.tot_activos_bgf := v_activos_familiares;
            --:New.total_activofamiliar;
            --p_depura ('Balance General:' || reg1.tot_activos_bgf || ' ' || v_activos_familiares);
            reg1.deuda_comercial_bgf := pdeudacomercial;
            --to_number(nvl(:New.deudacomercial,0));
            --p_depura ('Balance General:' || reg1.deuda_comercial_bgf || ' ' || :new.deudacomercial);
            reg1.deuda_bancaria_bgf := pdeudabancaria;
            --to_number(nvl(:New.deudabancaria,0));
            --p_depura ('Balance General:' || reg1.deuda_bancaria_bgf || ' ' || :new.deudabancaria);
            reg1.tot_pasivo_bgf := v_total_pasivo_familiar;
            --:New.total_pasivofamiliar;
            --p_depura ('Balance General:' || reg1.inmuebles_bgf || ' ' || v_total_pasivo_familiar);
            reg1.patrimonio_bgf := v_patrimonio_familiar;
            --:New.total_pasivopatrimonio;
            --p_depura ('Balance General:' || reg1.patrimonio_bgf || ' ' || v_patrimonio_familiar);
            p_depura ('Linea ' || $$plsql_line);
        EXCEPTION
            WHEN OTHERS
            THEN
                p_depura ('Linea ' || $$plsql_line);
                --p_depura ('tempfec ' || sqlerrm);
                NULL;
        END;

        ----p_depura('Balance General:'||reg1.muebles_vehiculos_bgf||' '||reg1.inmuebles_bgf||' '||v_activos_familiares||' '||reg1.deuda_comercial_bgf||' '||reg1.deuda_bancaria_bgf||' '||v_total_pasivo_familiar||' '||v_patrimonio_familiar);
        --p_solicitud := v_no_credito;

        IF ptipo_solicitante != '04'
        THEN                              ---Conyuge   ---malmanzar 23-01-2024
            p_depura ('Linea: ' || $$plsql_line || ' Carga_Maestro_Credito');

            BEGIN
                pr_carga_analisis_solic.carga_maestro_credito (p_codempresa,
                                                               p_solicitud,
                                                               p_codcliente,
                                                               reg1,
                                                               pmensajeerror);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'sqlerrm: '
                        || SQLERRM
                        || ' Carga_Maestro_Credito Line: '
                        || $$plsql_line
                        || ' pmensajeerror: '
                        || pmensajeerror);
            END;

            --p_depura ('Carga_Maestro_Credito fec' || nvl (pmensajeerror, 'A'));
            p_depura ('Linea: ' || $$plsql_line || 'Carga_Indicadores');

            BEGIN
                pr_carga_analisis_solic.carga_indicadores (p_codempresa,
                                                           p_solicitud,
                                                           p_codcliente,
                                                           reg1,
                                                           pmensajeerror);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'sqlerrm: '
                        || SQLERRM
                        || ' Carga_Maestro_Credito Line: '
                        || $$plsql_line
                        || ' pmensajeerror: '
                        || pmensajeerror);
            END;

            --p_depura ('Carga_Indicadores fec' || nvl (pmensajeerror, 'A'));
            p_depura (
                'Linea: ' || $$plsql_line || 'Carga_Evaluacion_Nofinanc');

            BEGIN
                pr_carga_analisis_solic.carga_evaluacion_nofinanc (
                    p_codempresa,
                    p_solicitud,
                    p_codcliente,
                    reg1,
                    pmensajeerror);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'sqlerrm: '
                        || SQLERRM
                        || ' Carga_Evaluacion_Nofinanc Line: '
                        || $$plsql_line
                        || ' pmensajeerror: '
                        || pmensajeerror);
            END;

            p_depura ('Linea ' || $$plsql_line);
            --p_depura ('Carga_Evaluacion_Nofinanc fec' || nvl (pmensajeerror, 'A'));
            p_depura ('Linea: ' || $$plsql_line || 'Carga_Evaluacion_Financ');

            BEGIN
                pr_carga_analisis_solic.carga_evaluacion_financ (
                    p_codempresa,
                    p_solicitud,
                    p_codcliente,
                    reg1,
                    pmensajeerror);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'sqlerrm: '
                        || SQLERRM
                        || ' Carga_Evaluacion_Financ Line: '
                        || $$plsql_line
                        || ' pmensajeerror: '
                        || pmensajeerror);
            END;

            --p_depura ('Carga_Evaluacion_Financ fec' || nvl (pmensajeerror, 'A'));
            p_depura ('Linea: ' || $$plsql_line || 'Carga_Estado_Resultados');

            BEGIN
                pr_carga_analisis_solic.carga_estado_resultados (
                    p_codempresa,
                    p_solicitud,
                    p_codcliente,
                    reg1,
                    pmensajeerror);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'sqlerrm: '
                        || SQLERRM
                        || ' Carga_Evaluacion_Financ Line: '
                        || $$plsql_line
                        || ' pmensajeerror: '
                        || pmensajeerror);
            END;

            p_depura ('Linea ' || $$plsql_line);
            --p_depura ('Carga_Estado_Resultados fec' || nvl (pmensajeerror, 'A'));
            p_depura ('Linea: ' || $$plsql_line || 'Carga_Balance_General');

            BEGIN
                pr_carga_analisis_solic.carga_balance_general (p_codempresa,
                                                               p_solicitud,
                                                               p_codcliente,
                                                               reg1,
                                                               pmensajeerror);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'sqlerrm: '
                        || SQLERRM
                        || ' Carga_Balance_General Line: '
                        || $$plsql_line
                        || ' pmensajeerror: '
                        || pmensajeerror);
            END;


            --p_depura ('Carga_Balance_General fec' || nvl (pmensajeerror, 'A'));
            p_depura ('Linea: ' || $$plsql_line || 'Carga_Balance_Fam');

            BEGIN
                pr_carga_analisis_solic.carga_balance_fam (p_codempresa,
                                                           p_solicitud,
                                                           p_codcliente,
                                                           reg1,
                                                           pmensajeerror);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                           'sqlerrm: '
                        || SQLERRM
                        || ' Carga_Balance_Fam Line: '
                        || $$plsql_line
                        || ' pmensajeerror: '
                        || pmensajeerror);
            END;
        END IF;                         --  pTipo_Solicitante   != '04'   ---)

        p_depura (
               'Linea '
            || $$plsql_line
            || ' pTipo_Solicitante: '
            || ptipo_solicitante);

        --p_depura ('Carga_Balance_Fam fec' || nvl (pmensajeerror, 'A'));

        --
        IF                               /*vclientepertenece IS NOT NULL AND*/
                                                                    ---UPPER (
           ptipo_solicitante = '02' ---)                    /*(v_tipopersona)*/
        THEN
            --            BEGIN
            --                SELECT estado
            --                  INTO vestadocre
            --                  FROM pr_creditos
            --                 WHERE no_credito = p_solicitud;
            --
            --                IF vestadocre = 'R'
            --                THEN
            BEGIN
                -- Se agrega excepcion de llave ¿nica para que omita el error si se reprocesa y ya existe el aval.
                INSERT INTO pr_aval_repre_x_credito (codigo_empresa,
                                                     no_credito,
                                                     tipo_aval_repre,
                                                     codigo_aval_repre)
                     VALUES (p_codempresa,
                             p_solicitud,
                             'A',
                             p_codcliente);
            EXCEPTION
                WHEN DUP_VAL_ON_INDEX
                THEN
                    NULL;
                WHEN OTHERS
                THEN
                    p_depura (
                        'Line: ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
            END;
        --                ELSE
        --                    ROLLBACK;
        --                    pmensajeerror :=
        --                           'El estado ('
        --                        || vestadocre
        --                        || ') del cr¿dito ('
        --                        || p_solicitud
        --                        || ') no permite agregar aval ('
        --                        || p_codcliente
        --                        || ')';
        --                    p_depura ('Linea ' || $$plsql_line);
        --                    /*malmanzar 04-03-2022
        --                    En caso de error en vez de realizar de actualizar  via WebService
        --                    se realiza rollback se devuelve mensaje de error.
        --                    */
        --                    --  pIdtempFud                   := 0;
        --                    pEstadoFec := 'R';
        --                    pMensajeFec := pmensajeerror;
        --                    pNoSolicitud := 0;
        --                    RETURN;
        --                --PA.P_DEPURA_MAAP (pmensajeerror);
        --                --
        --                --                    IF ia.api_portacredit.fnupdatefud (0,
        --                --                                                       pIdTempFec,
        --                --                                                       'R',
        --                --                                                       pmensajeerror,
        --                --                                                       0)
        --                --                    THEN
        --                --                        ----p_depura( pmensajeerror );   --Null;
        --                --                        raise_application_error (num   => -20000,
        --                --                                                 msg   => pmensajeerror);
        --                --                    END IF;
        --                END IF;
        --            EXCEPTION
        --                WHEN OTHERS
        --                THEN
        --                    ROLLBACK;
        --                    pmensajeerror :=
        --                           'Error al intentar agregar el aval al cr¿dito. '
        --                        || SQLERRM
        --                        || ' '
        --                        || DBMS_UTILITY.FORMAT_ERROR_BACKTRACE;
        --                    PA.P_DEPURA_MAAP (
        --                           'Solicitud: '
        --                        || p_solicitud
        --                        || ' Aval: '
        --                        || p_codcliente
        --                        || ' - Error al intentar agregar el aval al cr¿dito. '
        --                        || SQLERRM
        --                        || ' '
        --                        || DBMS_UTILITY.FORMAT_ERROR_BACKTRACE);
        --                    p_depura ('Linea ' || $$plsql_line);
        --
        --                    /*malmanzar 04-03-2022
        --                      En caso de error en vez de realizar de actualizar  via WebService
        --                      se realiza rollback se devuelve mensaje de error.
        --                      */
        --                    --pIdtempFud                   := 0;
        --                    pEstadoFec := 'R';
        --                    pMensajeFec := pmensajeerror;
        --                    pNoSolicitud := 0;
        --                    RETURN;
        --                    IF ia.api_portacredit.fnupdatefud (0,
        --                                                       pIdTempFec,
        --                                                       'R',
        --                                                       pmensajeerror,
        --                                                       0)
        --                    THEN
        --                        ----p_depura( pmensajeerror );   --Null;
        --                        raise_application_error (num   => -20001,
        --                                                 msg   => pmensajeerror);
        --                    END IF;
        -- END;
        END IF;

        p_depura ('Linea ' || $$plsql_line);
        --

        --Excello:JPH:2020-03-27:REQ_ 108967:Begin >>
        --==================================================================- --
        --  Insetta Informaci¿n Laboral del Cliente                           --
        --==================================================================- --

        --        PA.Pa_Mant_Datos_Personas.P_Inserta_Info_Laboral_FEC (
        --            P_Codcliente,
        --            NVL (pVentas_Ingresos, 0),
        --            pNomarchivo,
        --            pTipodocumentoidentidad,
        --            pdocumentoidentidad,
        --            V_Procesado,
        --            v_mensaje_error);
        --        p_depura (
        --               'Linea '
        --            || $$plsql_line
        --            || ' v_mensaje_error '
        --            || v_mensaje_error);

        --p_depura('v_mensaje_error '||v_mensaje_error);
        --        IF v_mensaje_error IS NOT NULL
        --        THEN                                            --malmanzar 21-04-2021
        --            V_Error :=
        --                   'FEX Error procesando informacion laboral'
        --                || ' '
        --                || v_mensaje_error;
        --            pmensajeerror := V_Error; ----:New.Mensaje := Substr(V_Error,1,200);
        --        END IF;

        --Excello:JPH:2020-03-27:REQ_ 108967:End <<

        -- Exitoso
        --p_depura ('exitoso fec' || nvl (pmensajeerror, 'A'));
        --        IF TRIM (pmensajeerror) IS NULL
        --        THEN
        --            pEstadoFec := 'A';
        --            pMensajeFec := 'Procesado Correctamente';
        --pNoSolicitud := v_no_credito;
        --- RETURN;
        --malmanzar 04-03-2022 se retorna valores para que se ejecute en el llamado
        --            IF ia.api_portacredit.fnupdatefud (0,
        --                                               pIdTempFec,
        --                                               'A',
        --                                               'Procesado Correctamente',
        --                                               v_no_credito)
        --            THEN
        --                DBMS_OUTPUT.put_line ('Carga Exitosa');
        --            END IF;
        --        ELSE
        --            --p_depura ('con errores');
        --            --:new.idestado := 'R';
        --
        --            --:new.mensaje := 'Rechazado';
        --            ROLLBACK;
        --            pEstadoFec := 'E';
        --            pMensajeFec := 'Rechazado';
        --            ---pNoSolicitud := 0;
        --            p_depura (
        --                   ' pmensajeerror '
        --                || pmensajeerror
        --                || ' Linea '
        --                || $$plsql_line);
        --            RETURN;
        --        --            IF ia.api_portacredit.fnupdatefud (0,
        --        --                                               pIdTempFec,
        --        --                                               'R',
        --        --                                               pmensajeerror,
        --        --                                               0)
        --        --            THEN
        --        --                --p_depura (pmensajeerror);                                                                                   --Null;
        --        --                raise_application_error (num => -20000, msg => pmensajeerror);
        --        --            END IF;
        --        END IF;

        --Inserta Fec
        --        BEGIN
        --            p_depura ('Linea ' || $$plsql_line);
        --            vResult :=
        --                fninsertfec (
        --                    pID_TEMPFEC                     => pIdTempFec,    --Number
        --                    pNOMARCHIVO                     => pNOMARCHIVO,
        --                    pPROCESADO                      => V_Procesado,
        --                    pIDEVALUACIONCREDITICIA         => pIDEVALUACIONCREDITICIA,
        --                    pTIPODOCUMENTOIDENTIDAD         => pTIPODOCUMENTOIDENTIDAD,
        --                    pDOCUMENTOIDENTIDAD             => pDOCUMENTOIDENTIDAD,
        --                    pNOMBRECLIENTE                  => pNOMBRECLIENTE,
        --                    pNUMEROSOLICITUD                => pNUMEROSOLICITUD, --Number
        --                    pPRIMERA_REF_VECINOS            => pPRIMERA_REF_VECINOS,
        --                    pSEGUNDA_REF_VECINOS            => pSEGUNDA_REF_VECINOS,
        --                    pAMBIENTEFAMILIAR               => pAMBIENTEFAMILIAR,
        --                    pDEPENDIENTES                   => pDEPENDIENTES, -- Number
        --                    pEDAD                           => pEDAD,      -- Varchar2
        --                    pESTADOSALUDFAMILIA             => pESTADOSALUDFAMILIA,
        --                    pINGRESOS                       => pINGRESOS,
        --                    pOTROSINGRESOS                  => pOTROSINGRESOS,
        --                    pEXPERIENCIA_NEG                => pEXPERIENCIA_NEG,
        --                    pHORAS_NEG                      => pHORAS_NEG,
        --                    pLOCALPROPIO                    => pLOCALPROPIO,
        --                    pTIEMPOEMPLEO                   => pTIEMPOEMPLEO,
        --                    pUBICACIONNEGOCIO               => pUBICACIONNEGOCIO,
        --                    pLLEVAREGISTRO                  => pLLEVAREGISTRO,
        --                    pMEJORASNEGOCIO                 => pMEJORASNEGOCIO,
        --                    pCLIENTESFRECUENTES             => pCLIENTESFRECUENTES,
        --                    pNIVELCOMPETENCIA               => pNIVELCOMPETENCIA,
        --                    pVENTASDIARIAS_PROMEDIO         => pVENTASDIARIAS_PROMEDIO,
        --                    pDIASTRABAJADOS                 => pDIASTRABAJADOS,
        --                    pVENTASMENSUALESDECLARADAS      => pVENTASMENSUALESDECLARADAS,
        --                    pCOMPRASSEMANALESDECLARADAS     =>
        --                        pCOMPRASSEMANALESDECLARADAS,
        --                    pCOMPRASMENSUALESDECLARADAS     =>
        --                        pCOMPRASMENSUALESDECLARADAS,
        --                    pMARGENDECLARADO                => pMARGENDECLARADO,
        --                    pMONTOMESALTO                   => pMONTOMESALTO,
        --                    pMONTOMESMEDIO                  => pMONTOMESMEDIO,
        --                    pMONTOMESBAJO                   => pMONTOMESBAJO,
        --                    pVENTASMENSUALES                => pVENTASMENSUALES,
        --                    pCOSTOVENTAMENSUAL              => pCOSTOVENTAMENSUAL,
        --                    pMARGENGANANCIA                 => pMARGENGANANCIA,
        --                    pDESDE                          => pDESDE,
        --                    pHASTA                          => pHASTA,
        --                    pVENTAS_INGRESOS                => pVENTAS_INGRESOS,
        --                    pCOSTOVENTAS                    => pCOSTOVENTAS,
        --                    pUTILIDADBRUTA                  => pUTILIDADBRUTA,
        --                    pSUELDO                         => pSUELDO,
        --                    pSERVICIO                       => pSERVICIO,
        --                    pALQUILER                       => pALQUILER,
        --                    pTRANSPORTE_COMBS               => pTRANSPORTE_COMBS,
        --                    pPAGOINTERESES                  => pPAGOINTERESES,
        --                    pOTROS                          => pOTROS,
        --                    pTOTALCOSTOOPERACIONAL          => pTOTALCOSTOOPERACIONAL,
        --                    pUTILIDADNETA                   => pUTILIDADNETA,
        --                    pOTROSINGRESOS_OPERACIONALES    =>
        --                        pOTROSINGRESOS_OPERACIONALES,
        --                    pALIMENTACION                   => pALIMENTACION,
        --                    pVIVIENDA                       => pVIVIENDA,
        --                    pVESTIDO                        => pVESTIDO,
        --                    pTRANSPORTE                     => pTRANSPORTE,
        --                    pSERVICIOS                      => pSERVICIOS,
        --                    pMEDICINAS                      => pMEDICINAS,
        --                    pEDUCACION                      => pEDUCACION,
        --                    pDEUDASFAMILIARES               => pDEUDASFAMILIARES,
        --                    pOTROS_GASTOS                   => pOTROS_GASTOS,
        --                    pTOTALGASTOS_FAMILIARES         => pTOTALGASTOS_FAMILIARES,
        --                    pEXCEDENTEFAMILIAR              => pEXCEDENTEFAMILIAR,
        --                    pFECHABALANCEGENERAL            => pFECHABALANCEGENERAL,
        --                    pEFECTIVO_CAJABANCO             => pEFECTIVO_CAJABANCO,
        --                    pCUENTAXCOBRAR                  => pCUENTAXCOBRAR,
        --                    pINVENTARIO_PROD_TEM            => pINVENTARIO_PROD_TEM,
        --                    pINVENTARIO_PROD_PROC           => pINVENTARIO_PROD_PROC,
        --                    pINVENTARIO_MATERIAPRIMA        => pINVENTARIO_MATERIAPRIMA,
        --                    pMERCANCIA                      => pMERCANCIA,
        --                    pANTICIPO_PROVEEDORES           => pANTICIPO_PROVEEDORES,
        --                    pFECHA_BALANCEGENERAL_AL        => pFECHA_BALANCEGENERAL_AL,
        --                    pMUEBLE_VEHICULO                => pMUEBLE_VEHICULO,
        --                    pINMUEBLES                      => pINMUEBLES,
        --                    pTOTAL_ACTIVOFAMILIAR           => pTOTAL_ACTIVOFAMILIAR,
        --                    pDEUDACOMERCIAL                 => pDEUDACOMERCIAL,
        --                    pDEUDABANCARIA                  => pDEUDABANCARIA,
        --                    pTOTAL_PASIVOFAMILIAR           => pTOTAL_PASIVOFAMILIAR,
        --                    pPATRIO_FAM_BALGEN              => pPATRIO_FAM_BALGEN,
        --                    pMAQUINARIA_MUEBLESEQUIPOS      => pMAQUINARIA_MUEBLESEQUIPOS,
        --                    pLOCALNEGOCIO                   => pLOCALNEGOCIO,
        --                    pOBLIGACIONESFINANCIERAS        => pOBLIGACIONESFINANCIERAS,
        --                    pCUENTAPAGARPROVEDOR            => pCUENTAPAGARPROVEDOR,
        --                    pCUENTAPAGARVARIAS              => pCUENTAPAGARVARIAS,
        --                    pTOTAL_ACTIVOCORRIENTE          => pTOTAL_ACTIVOCORRIENTE,
        --                    pTOTAL_ACTIVOFIJO               => pTOTAL_ACTIVOFIJO,
        --                    pTOTAL_ACTIVOS1                 => pTOTAL_ACTIVOS1,
        --                    pTOTAL_PASIVOCORRIENTES         => pTOTAL_PASIVOCORRIENTES,
        --                    pTOTAL_PASIVO_LP                => pTOTAL_PASIVO_LP,
        --                    pTOTAL_PASIVO                   => pTOTAL_PASIVO,
        --                    pPATRIMONIO                     => pPATRIMONIO,
        --                    pTOTAL_PASIVOPATRIMONIO         => pTOTAL_PASIVOPATRIMONIO,
        --                    pCAPITAL_TRABAJO                => pCAPITAL_TRABAJO,
        --                    pPASIVO_PATRIMONIO              => pPASIVO_PATRIMONIO,
        --                    pACTIVOCORTE_PASCTE             => pACTIVOCORTE_PASCTE,
        --                    pOTROSINGRESOS_EXCEDENTE        => pOTROSINGRESOS_EXCEDENTE,
        --                    pCUOTARECOMENDADA_EXCEDFAM      => pCUOTARECOMENDADA_EXCEDFAM,
        --                    pTOTALPASIVO_PATRIMONIO         => pTOTALPASIVO_PATRIMONIO,
        --                    pUTILIDADNETA_PATRIMONIO        => pUTILIDADNETA_PATRIMONIO,
        --                    pUTILIDADNETA_TOTALACTIVOS1     =>
        --                        pUTILIDADNETA_TOTALACTIVOS1,
        --                    pUTILIDADNETA_VENTAS            => pUTILIDADNETA_VENTAS,
        --                    pCUENTASXCOBRAR_VENTAS          => pCUENTASXCOBRAR_VENTAS,
        --                    pCOSTOVENTA_INVENTARIO          => pCOSTOVENTA_INVENTARIO,
        --                    pMONTORECOMENDADO               => pMONTORECOMENDADO,
        --                    pGASTOSLEGALES                  => pGASTOSLEGALES,
        --                    pMONEDA                         => pMONEDA,
        --                    pPLAZO                          => pPLAZO,
        --                    pTASA                           => pTASA,
        --                    pFRECUENCIA                     => pFRECUENCIA,
        --                    pCUOTA                          => pCUOTA,
        --                    pDESTINOCREDITO                 => pDESTINOCREDITO,
        --                    pESPECIFIQUEDESTINO             => pESPECIFIQUEDESTINO,
        --                    pESTADOSOLICITUD                => pESTADOSOLICITUD,
        --                    pACTIVIDADECONOMICA             => pACTIVIDADECONOMICA,
        --                    pACTIVIDADECONOMICADINRAP       => pACTIVIDADECONOMICADINRAP,
        --                    pMARGENBRUTOESTANDAR            => pMARGENBRUTOESTANDAR,
        --                    pGASTOSOPERACIONALESESTANDAR    =>
        --                        pGASTOSOPERACIONALESESTANDAR,
        --                    pALTO_INDICADORES               => pALTO_INDICADORES,
        --                    pBAJO_INDICADORES               => pBAJO_INDICADORES,
        --                    pLUNES                          => pLUNES,
        --                    pMARTES                         => pMARTES,
        --                    pMIERCOLES                      => pMIERCOLES,
        --                    pJUEVES                         => pJUEVES,
        --                    pVIERNES                        => pVIERNES,
        --                    pSABADO                         => pSABADO,
        --                    pDOMINGO                        => pDOMINGO,
        --                    pTOTAL_VENTASALTAS              => pTOTAL_VENTASALTAS,
        --                    pTOTAL_VENTASBAJAS              => pTOTAL_VENTASBAJAS,
        --                    pTOTAL_VENTASSEMANALES          => pTOTAL_VENTASSEMANALES,
        --                    pTOTAL_VENTASMENSUALES          => pTOTAL_VENTASMENSUALES,
        --                    pMARGENBRUTODECLARADO           => pMARGENBRUTODECLARADO,
        --                    pALIMENTACION_GASTOS            => pALIMENTACION_GASTOS,
        --                    pVIVIENDA_GASTOS                => pVIVIENDA_GASTOS,
        --                    pEDUCACION_GASTOS               => pEDUCACION_GASTOS,
        --                    pSALUD_GASTOS                   => pSALUD_GASTOS,
        --                    pTRANSPORTE_GASTOS              => pTRANSPORTE_GASTOS,
        --                    pVESTIDO_GASTOS                 => pVESTIDO_GASTOS,
        --                    pPAGODEUDAS_GASTOS              => pPAGODEUDAS_GASTOS,
        --                    pOTROS_GASTOS_FAMILIARES        => pOTROS_GASTOS_FAMILIARES,
        --                    pTOTAL_GASTOS                   => pTOTAL_GASTOS,
        --                    pVENTAS_GASTOS                  => pVENTAS_GASTOS,
        --                    pCOSTOSVENTAS_GASTOS            => pCOSTOSVENTAS_GASTOS,
        --                    pGASTOSOPERATIVOS               => pGASTOSOPERATIVOS,
        --                    pOTROS_INGRESOS_GASTOS          => pOTROS_INGRESOS_GASTOS,
        --                    pTOTAL_GASTOS_FAMILIARES        => pTOTAL_GASTOS_FAMILIARES,
        --                    pEXCEDENTEFAMILIAR_GASTOS       => pEXCEDENTEFAMILIAR_GASTOS,
        --                    pCUOTASOLICITADA                => pCUOTASOLICITADA,
        --                    pRELCUOTASOLICITADA_EXCFAM      => pRELCUOTASOLICITADA_EXCFAM,
        --                    pMONTO_RECOMENDACION            => pMONTO_RECOMENDACION,
        --                    pMONEDA_RECOMENDACION           => pMONEDA_RECOMENDACION,
        --                    pPLAZO_RECOMENDACION            => pPLAZO_RECOMENDACION,
        --                    pTASA_RECOMENDACION             => pTASA_RECOMENDACION,
        --                    pFRECUENCIA_RECOMENDACION       => pFRECUENCIA_RECOMENDACION,
        --                    pCUOTA_RECOMENDACION            => pCUOTA_RECOMENDACION,
        --                    pESTADOSOLICITUD_RECOMENDACION   =>
        --                        pESTADOSOLICITUD_RECOMENDACION,
        --                    pCUOTARECOMENDADA_EXCFAMILIAR   =>
        --                        pCUOTARECOMENDADA_EXCFAMILIAR,
        --                    pVENTASEVALANTERIOR             => pVENTASEVALANTERIOR,
        --                    pACTUAL_VENTAS                  => pACTUAL_VENTAS,
        --                    pVARIACIONVENTAS                => pVARIACIONVENTAS,
        --                    pCOMENTARIO1                    => pCOMENTARIO1,
        --                    pCOMENTARIO2                    => pCOMENTARIO2,
        --                    pPRO1NOMBRE                     => pPRO1NOMBRE,
        --                    pPRO1MATERIAPRIMA1              => pPRO1MATERIAPRIMA1,
        --                    pPRO1MATERIAPRIMA2              => pPRO1MATERIAPRIMA2,
        --                    pPRO1MATERIAPRIMA3              => pPRO1MATERIAPRIMA3,
        --                    pPRO1TOTALMP                    => pPRO1TOTALMP,
        --                    pPRO1SUELDO1                    => pPRO1SUELDO1,
        --                    pPRO1SUELDO2                    => pPRO1SUELDO2,
        --                    pPRO1TOTALSUELDO                => pPRO1TOTALSUELDO,
        --                    pPRO1OTROSCOSTOS                => pPRO1OTROSCOSTOS,
        --                    pPRO1TOTALCOSTOS                => pPRO1TOTALCOSTOS,
        --                    pPRO1COSTOUNITARIO              => pPRO1COSTOUNITARIO,
        --                    pPRO1PRECIOUNITARIO             => pPRO1PRECIOUNITARIO,
        --                    pPRO1UNIDADESVENDIDAS           => pPRO1UNIDADESVENDIDAS,
        --                    pPRO1VENTASMENSUALES            => pPRO1VENTASMENSUALES,
        --                    pPRO1COSTOSVENTASMENSUALES      => pPRO1COSTOSVENTASMENSUALES,
        --                    pPRO1MARGENGANANCIA             => pPRO1MARGENGANANCIA,
        --                    pPRO2NOMBRE                     => pPRO2NOMBRE,
        --                    pPRO2MATERIAPRIMA1              => pPRO2MATERIAPRIMA1,
        --                    pPRO2MATERIAPRIMA2              => pPRO2MATERIAPRIMA2,
        --                    pPRO2MATERIAPRIMA3              => pPRO2MATERIAPRIMA3,
        --                    pPRO2TOTALMP                    => pPRO2TOTALMP,
        --                    pPRO2SUELDO1                    => pPRO2SUELDO1,
        --                    pPRO2SUELDO2                    => pPRO2SUELDO1,
        --                    pPRO2TOTALSUELDO                => pPRO2TOTALSUELDO,
        --                    pPRO2OTROSCOSTOS                => pPRO2OTROSCOSTOS,
        --                    pPRO2TOTALCOSTOS                => pPRO2TOTALCOSTOS,
        --                    pPRO2COSTOUNITARIO              => pPRO2COSTOUNITARIO,
        --                    pPRO2PRECIOUNITARIO             => pPRO2PRECIOUNITARIO,
        --                    pPRO2UNIDADESVENDIDAS           => pPRO2UNIDADESVENDIDAS,
        --                    pPRO2VENTASMENSUALES            => pPRO2VENTASMENSUALES,
        --                    pPRO2COSTOSVENTASMENSUALES      => pPRO2COSTOSVENTASMENSUALES,
        --                    pPRO2MARGENGANANCIA             => pPRO2MARGENGANANCIA,
        --                    pPRO3NOMBRE                     => pPRO3NOMBRE,
        --                    pPRO3MATERIAPRIMA1              => pPRO3MATERIAPRIMA1,
        --                    pPRO3MATERIAPRIMA2              => pPRO3MATERIAPRIMA2,
        --                    pPRO3MATERIAPRIMA3              => pPRO3MATERIAPRIMA3,
        --                    pPRO3TOTALMP                    => pPRO3TOTALMP,
        --                    pPRO3SUELDO1                    => pPRO3SUELDO1,
        --                    pPRO3SUELDO2                    => pPRO3SUELDO2,
        --                    pPRO3TOTALSUELDO                => pPRO3TOTALSUELDO,
        --                    pPRO3OTROSCOSTOS                => pPRO3OTROSCOSTOS,
        --                    pPRO3TOTALCOSTOS                => pPRO3TOTALCOSTOS,
        --                    pPRO3COSTOUNITARIO              => pPRO3COSTOUNITARIO,
        --                    pPRO3PRECIOUNITARIO             => pPRO3PRECIOUNITARIO,
        --                    pPRO3UNIDADESVENDIDAS           => pPRO3UNIDADESVENDIDAS,
        --                    pPRO3VENTASMENSUALES            => pPRO3VENTASMENSUALES,
        --                    pPRO3COSTOSVENTASMENSUALES      => pPRO3COSTOSVENTASMENSUALES,
        --                    pPRO3MARGENGANANCIA             => pPRO3MARGENGANANCIA,
        --                    pPROOTROMATERIAPRIMA1           => pPROOTROMATERIAPRIMA1,
        --                    pPROOTROMATERIAPRIMA2           => pPROOTROMATERIAPRIMA2,
        --                    pPROOTROMATERIAPRIMA3           => pPROOTROMATERIAPRIMA3,
        --                    pPROOTROTOTALMP                 => pPROOTROTOTALMP,
        --                    pPROOTROSUELDO1                 => pPROOTROSUELDO1,
        --                    pPROOTROSUELDO2                 => pPROOTROSUELDO2,
        --                    pPROOTROTOTALSUELDO             => pPROOTROTOTALSUELDO,
        --                    pPROOTROOTROSCOSTOS             => pPROOTROOTROSCOSTOS,
        --                    pPROOTROTOTALCOSTOS             => pPROOTROTOTALCOSTOS,
        --                    pPROOTROCOSTOUNITARIO           => pPROOTROCOSTOUNITARIO,
        --                    pPROOTROPRECIOUNITARIO          => pPROOTROPRECIOUNITARIO,
        --                    pPROOTROUNIDADESVENDIDAS        => pPROOTROUNIDADESVENDIDAS,
        --                    pPROOTROVENTASMENSUALES         => pPROOTROVENTASMENSUALES,
        --                    pPROOTROCOSTOSVENTASMENSUALES   =>
        --                        pPROOTROCOSTOSVENTASMENSUALES,
        --                    pPROOTROMARGENGANANCIA          => pPROOTROMARGENGANANCIA,
        --                    pLINEA1                         => pLINEA1,
        --                    pPRECIOUNITARIO1                => pPRECIOUNITARIO1,
        --                    pCOSTOUNITARIO1                 => pCOSTOUNITARIO1,
        --                    pMARGENDEGANANCIA1              => pMARGENDEGANANCIA1,
        --                    pUNIDADESVENDIDAS1              => pUNIDADESVENDIDAS1,
        --                    pVENTASMENSUALES1               => pVENTASMENSUALES1,
        --                    pCOSTOVENTAS1                   => pCOSTOVENTAS1,
        --                    pLINEA2                         => pLINEA2,
        --                    pPRECIOUNITARIO2                => pPRECIOUNITARIO2,
        --                    pCOSTOUNITARIO2                 => pCOSTOUNITARIO2,
        --                    pMARGENDEGANANCIA2              => pMARGENDEGANANCIA2,
        --                    pUNIDADESVENDIDAS2              => pUNIDADESVENDIDAS2,
        --                    pVENTASMENSUALES2               => pVENTASMENSUALES2,
        --                    pCOSTOVENTAS2                   => pCOSTOVENTAS2,
        --                    pLINEA3                         => pLINEA3,
        --                    pPRECIOUNITARIO3                => pPRECIOUNITARIO3,
        --                    pCOSTOUNITARIO3                 => pCOSTOUNITARIO3,
        --                    pMARGENDEGANANCIA3              => pMARGENDEGANANCIA3,
        --                    pUNIDADESVENDIDAS3              => pUNIDADESVENDIDAS3,
        --                    pVENTASMENSUALES3               => pVENTASMENSUALES3,
        --                    pCOSTOVENTAS3                   => pCOSTOVENTAS3,
        --                    pLINEAOT                        => pLINEAOT,
        --                    pPRECIOUNITARIOOT               => pPRECIOUNITARIOOT,
        --                    pCOSTOUNITARIOOT                => pCOSTOUNITARIOOT,
        --                    pMARGENDEGANANCIAOT             => pMARGENDEGANANCIAOT,
        --                    pUNIDADESVENDIDASOT             => pUNIDADESVENDIDASOT,
        --                    pVENTASMENSUALESOT              => pVENTASMENSUALESOT,
        --                    pCOSTOVENTASOT                  => pCOSTOVENTASOT,
        --                    pTIPOCREDITO                    => pTIPOCREDITO,
        --                    pGARANTIAS                      => pGARANTIAS,
        --                    pVALORGARANTIA                  => pVALORGARANTIA,
        --                    pDESCRIPCIONGARANTIA            => pDESCRIPCIONGARANTIA,
        --                    pPRESTAMODESCONTAR              => pPRESTAMODESCONTAR,
        --                    pLINEA4                         => pLINEA4,
        --                    pPRECIOUNITARIO4                => pPRECIOUNITARIO4,
        --                    pCOSTOUNITARIO4                 => pCOSTOUNITARIO4,
        --                    pMARGENDEGANANCIA4              => pMARGENDEGANANCIA4,
        --                    pUNIDADESVENDIDAS4              => pUNIDADESVENDIDAS4,
        --                    pVENTASMENSUALES4               => pVENTASMENSUALES4,
        --                    pCOSTOVENTAS4                   => pCOSTOVENTAS4,
        --                    pLINEA5                         => pLINEA5,
        --                    pPRECIOUNITARIO5                => pPRECIOUNITARIO5,
        --                    pCOSTOUNITARIO5                 => pCOSTOUNITARIO5,
        --                    pMARGENDEGANANCIA5              => pMARGENDEGANANCIA5,
        --                    pUNIDADESVENDIDAS5              => pUNIDADESVENDIDAS5,
        --                    pVENTASMENSUALES5               => pVENTASMENSUALES5,
        --                    pCOSTOVENTAS5                   => pCOSTOVENTAS5,
        --                    pLINEA6                         => pLINEA6,
        --                    pPRECIOUNITARIO6                => pPRECIOUNITARIO6,
        --                    pCOSTOUNITARIO6                 => pCOSTOUNITARIO6,
        --                    pMARGENDEGANANCIA6              => pMARGENDEGANANCIA6,
        --                    pUNIDADESVENDIDAS6              => pUNIDADESVENDIDAS6,
        --                    pVENTASMENSUALES6               => pVENTASMENSUALES6,
        --                    pCOSTOVENTAS6                   => pCOSTOVENTAS6,
        --                    pLINEA7                         => pLINEA7,
        --                    pPRECIOUNITARIO7                => pPRECIOUNITARIO7,
        --                    pCOSTOUNITARIO7                 => pCOSTOUNITARIO7,
        --                    pMARGENDEGANANCIA7              => pMARGENDEGANANCIA7,
        --                    pUNIDADESVENDIDAS7              => pUNIDADESVENDIDAS7,
        --                    pVENTASMENSUALES7               => pVENTASMENSUALES7,
        --                    pCOSTOVENTAS7                   => pCOSTOVENTAS7,
        --                    pLINEA8                         => pLINEA8,
        --                    pPRECIOUNITARIO8                => pPRECIOUNITARIO8,
        --                    pCOSTOUNITARIO8                 => pCOSTOUNITARIO8,
        --                    pMARGENDEGANANCIA8              => pMARGENDEGANANCIA8,
        --                    pUNIDADESVENDIDAS8              => pUNIDADESVENDIDAS8,
        --                    pVENTASMENSUALES8               => pVENTASMENSUALES8,
        --                    pCOSTOVENTAS8                   => pCOSTOVENTAS8,
        --                    pCOMENTARIO                     => pCOMENTARIO,
        --                    pIDOFICIAL                      => pIDOFICIAL,
        --                    pFECHAREGISTRO                  => pFECHAREGISTRO,
        --                    pFECHAFIJA                      => pFECHAFIJA,
        --                    pIDESTADO                       => pIDESTADO,
        --                    pMENSAJE                        => pMENSAJE,
        --                    pNOSUBIDA                       => pNOSUBIDA,
        --                    pIDGRUPO                        => pIDGRUPO,
        --                    pIMPRESO                        => pIMPRESO);
        --        END;
        --
        --        p_depura (
        --               'Linea '
        --            || $$plsql_line
        --            || CASE WHEN vresult THEN ' Si crearfec ' ELSE 'No crearFEc' END
        --            || ' pMENSAJE '
        --            || pMENSAJE);
        COMMIT;
    --
    EXCEPTION
        WHEN OTHERS
        THEN
            -- Consider Logging The Error And Then Re-Raise

            --:new.idestado := 'R';

            --:new.mensaje := 'Rechazado';
            p_depura ('Linea ' || $$plsql_line);

            ROLLBACK;
            pestadofec := 'E';
            pmensajefec := 'Rechazado ' || SQLERRM;
            ---pNoSolicitud := 0;
            RETURN;
    --            IF ia.api_portacredit.fnupdatefud (0,
    --                                               pIdTempFec,
    --                                               'R',
    --                                               pmensajeerror,
    --                                               0)
    --            THEN
    --                --p_depura (pmensajeerror);
    --                NULL;
    --                RAISE;
    --            END IF;
    --End Bloque 3
    END;

    ---Nueva Fec Persona End

    FUNCTION valida_tipo_persona (ptipo_persona VARCHAR2)
        RETURN BOOLEAN
    IS
        vcount    NUMBER;
        vreturn   BOOLEAN;
    BEGIN
        SELECT COUNT (1)
          INTO vcount
          FROM tipo_persona
         WHERE codigo = ptipo_persona;

        IF vcount = 0
        THEN
            vreturn := FALSE;
        ELSE
            vreturn := TRUE;
        END IF;

        RETURN vreturn;
    END;

    FUNCTION valida_tipo_cliente (ptipo_cliente      NUMBER,
                                  ptipo_persona   IN VARCHAR2)
        RETURN BOOLEAN
    IS
        vcount    NUMBER;
        vreturn   BOOLEAN;
    BEGIN
        SELECT COUNT (1)
          INTO vcount
          FROM tipo_cliente
         WHERE codigo = ptipo_cliente AND tipo_persona = ptipo_persona; --'F' física, 'J' 'Jurídica'

        IF vcount = 0
        THEN
            vreturn := FALSE;
        ELSE
            vreturn := TRUE;
        END IF;

        RETURN vreturn;
    END;



    FUNCTION f_valida_persona (ppersona   IN     pr.persona_cr_obj,
                               perrores      OUT NUMBER)
        RETURN BOOLEAN
    IS
        vreturn                   BOOLEAN;                        --- := TRUE;

        vtipodocumentoidentidad   VARCHAR2 (5);
        vnumidformat              VARCHAR2 (30);

        verrores                  NUMBER := 0;

        v_tipoid_core             id_personas.cod_tipo_id%TYPE;

        vactividadp               personas_fisicas.actividad%TYPE;

        vcodsubactividadp         sub_actividades_economicas.codigo_subactividad%TYPE;
    BEGIN
        --Id Persona

        DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);
        verrores := 0;

        FOR x IN 1 .. ppersona.identificaciones.COUNT
        LOOP
            vtipodocumentoidentidad := NULL;                      --04-08-2022

            vtipodocumentoidentidad :=
                f_tipoid_pda_core (
                    ptipo_id_pda   =>
                        ppersona.identificaciones (x).cod_tipo_id --ptipodocumentoidentidad
                                                                 ); --malmanzar 09-06-2022

            DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);

            IF vtipodocumentoidentidad IS NULL
            THEN
                verrores := verrores + 1;
            END IF;

            vnumidformat :=
                pa.formatear_identifi (ppersona.identificaciones (x).num_id, --(pnumdocumentoidentidad,
                                       vtipodocumentoidentidad); -- ptipodocumentoidentidad  03-03-2023

            ---Begin malmanzar 31-05-2024 Se incluye validación tipo id para evitar que se envíe uno direrente al creado en el Core.
            BEGIN
                DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);

                SELECT cod_tipo_id
                  INTO v_tipoid_core
                  FROM id_personas
                 WHERE REPLACE (num_id, '-') = REPLACE (vnumidformat, '-');
            EXCEPTION
                WHEN NO_DATA_FOUND
                THEN
                    v_tipoid_core := NULL;
                WHEN DUP_VAL_ON_INDEX
                THEN
                    v_tipoid_core := NULL;
                    verrores := verrores + 1;
                    pr.pkg_portacredit2.agregartarea (
                        'ERROR',
                        'COD_TIPO_ID',
                        'COD_TIPO_ID',
                        '500',
                           'Error validando, COD_TIPO_ID: '
                        || vtipodocumentoidentidad
                        || ' NumId: '
                        || vnumidformat
                        || ' Duplicado en el Core', ---Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                        'Validar Solicitud');

                    DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);
                WHEN OTHERS
                THEN
                    v_tipoid_core := NULL;
                    verrores := verrores + 1;
                    pr.pkg_portacredit2.agregartarea (
                        'ERROR',
                        'COD_TIPO_ID',
                        'COD_TIPO_ID',
                        '500',
                           'Error validando, COD_TIPO_ID: '
                        || vtipodocumentoidentidad
                        || ' NumId: '
                        || vnumidformat
                        || ' Error procesando en el Core', ---Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                        'Validar Solicitud');

                    DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);
            END;

            IF v_tipoid_core IS NOT NULL
            THEN
                IF v_tipoid_core != vtipodocumentoidentidad
                THEN
                    DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);

                    verrores := verrores + 1;
                    pr.pkg_portacredit2.agregartarea (
                        'ERROR',
                        'COD_TIPO_ID',
                        'COD_TIPO_ID',
                        '500',
                           'Error validando, COD_TIPO_ID: '
                        || vtipodocumentoidentidad
                        || ' NumId: '
                        || vnumidformat
                        || ' Creado con tipoid: '
                        || v_tipoid_core, ---Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                        'Validar Solicitud');
                END IF;
            END IF;
        ---End Begin malmanzar 31-05-2024 Se incluye validación tipo id para evitar que se envíe uno direrente al creado en el Core.

        END LOOP;

        ---        DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);


        --        p_depura (
        --            'pPERSONA.TIPO_CODIGO_CLIENTE: ' || ppersona.tipo_codigo_cliente);

        --
        IF NOT valida_tipo_cliente (
                   ppersona.tipo_codigo_cliente,
                   CASE
                       WHEN vtipodocumentoidentidad = 2 THEN 'J'
                       ELSE 'F'
                   END)
        THEN
            verrores := verrores + 1;
            pr.pkg_portacredit2.agregartarea (
                'ERROR',
                'TIPO_CLIENTE',
                'TIPO_CLIENTE',
                '500',
                   'Error validando, TIPO CLIENTE: '
                || ppersona.tipo_codigo_cliente, ---Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                'Validar Solicitud');
        END IF;

        DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);

        --V_COUNT := 0;

        IF NOT valida_tipo_persona (ppersona.codigo_tipo_persona)
        THEN
            DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);
            verrores := verrores + 1;
            pr.pkg_portacredit2.agregartarea (
                'ERROR',
                'TIPO_PERSONA',
                'tipo_persona',
                '500',
                   'Error validando, CODIGO_TIPO_PERSONA: '
                || ppersona.codigo_tipo_persona, ---Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                'Validar Solicitud');
        END IF;



        IF ppersona.cod_actividad IS NULL
        THEN
            DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);
            verrores := verrores + 1;
            pr.pkg_portacredit2.agregartarea (
                'ERROR',
                'PERSONA',
                'segregacion_rd',
                '500',
                   'Error validando: : cod_actividad ciiu NO puede estar vacia'
                || ppersona.codigo_tipo_persona, ---Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                'Validar Solicitud');
        END IF;

        ---DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);

        --
        /*
        IF NOT valida_sector_economico (pPERSONA.TIPO_CODIGO_CLIENTE)
        THEN
            vErrores := vErrores + 1;
        END IF;

        --
        IF NOT valida_actividad_ciiu (pPERSONA.TIPO_CODIGO_CLIENTE)
        THEN
            vErrores := vErrores + 1;
        END IF;
        */

        --Validar dir persona

        FOR d IN 1 .. ppersona.direcciones.COUNT
        LOOP
            NULL;
        END LOOP;


        --Validar localizadores: Teléfonos, Email
        FOR l IN 1 .. ppersona.localizadores.COUNT
        LOOP
            NULL;
        END LOOP;



        IF NVL (verrores, 0) > 0
        THEN
            vreturn := FALSE;
        ELSE
            vreturn := TRUE;
        END IF;

        perrores := verrores;
        DBMS_OUTPUT.put_line (
            ' pErrores: ' || perrores || ' Line: ' || $$plsql_line);

        DBMS_OUTPUT.put_line ('Linea: ' || $$plsql_line);
        RETURN vreturn;
    END;

    FUNCTION f_valida_vinculacion_financ (
        pfinanciallinklist   financieramente_vinculada_list)
        RETURN BOOLEAN
    IS
        vreturn   BOOLEAN;
    BEGIN
        --
        --         FOR fl IN 1 .. FINANCIERAMENTE_VINCULADA_LIST.COUNT LOOP
        --              DBMS_OUTPUT.PUT_LINE('FINANCIERAMENTE_VINCULADA_LIST.COUNT: '||FINANCIERAMENTE_VINCULADA_LIST.COUNT);
        --          END LOOP;

        RETURN TRUE;
    END;

    FUNCTION f_valida_info_prestamo (pinfo_prestamo info_prestamo_obj)
        RETURN BOOLEAN
    IS
        p_codempresa                NUMBER := 1;
        vreturn                     BOOLEAN;

        reg1                        pr_credito.t_rec_pr_creditos;

        v_pr_pr_tipo_credito_list   pr_pkg_utl.t_pr_tipo_credito_list
            := pr_pkg_utl.t_pr_tipo_credito_list ();


        vplazo_minimo               pr_tipo_credito.plazo_minimo%TYPE;
        vplazo_maximo               pr_tipo_credito.plazo_maximo%TYPE;
        vmonto_minimo               pr_tipo_credito.monto_minimo%TYPE;
        vmonto_maximo               pr_tipo_credito.monto_maximo%TYPE;
        vvariacion_base             pr_tipo_credito.variacion_base%TYPE;
        --
        vporcentaje                 valores_de_tasas_de_interes.porcentaje%TYPE;
        vvariacion_min              tipos_de_tasas_de_interes.variacion_min%TYPE;
        vvariacion_max              tipos_de_tasas_de_interes.variacion_max%TYPE;


        errorcode                   VARCHAR2 (300);
        errordescription            VARCHAR2 (4000);

        verrores_info               NUMBER := 0;
    BEGIN
        reg1.codigo_empresa := 1;
        --         reg1.codigo_agencia := TO_NUMBER (vSolicitud.CODIGO_CENTRO_COSTO /*CODIGO_BRANCH*/
        --                                                                        );
        reg1.f_apertura :=
            fecha_actual_calendario ('PR', reg1.codigo_empresa, 50 --Para evitar error con envio centro empleados
                                                                  --reg1.codigo_agencia
                                                                  );

        v_pr_pr_tipo_credito_list :=
            ia.pr_pkg_utl.pr_tipo_credito_select (
                pcodigo_empresa                 => p_codempresa,
                ptipo_credito                   =>
                    TO_NUMBER (pinfo_prestamo.codigo_proyecto),
                pdescripcion                    => NULL,
                pcodigo_sub_aplicacion          => NULL,
                pes_linea_credito               => NULL,
                pcodigo_moneda                  => NULL,
                pcodigo_plazo                   => NULL,
                pcodigo_origen                  => NULL,
                pmodalidad_cobro                => NULL,
                ptiene_vencimiento              => NULL,
                ptipo_intereses                 => NULL,
                ptipo_calendario                => NULL,
                ptipo_linea                     => NULL,
                pmanejo                         => NULL,
                pplazo_minimo                   => NULL,
                pplazo_maximo                   => NULL,
                pmonto_minimo                   => NULL,
                pmonto_maximo                   => NULL,
                ptipo_tasa                      => NULL,
                pcodigo_tipo_de_tasa            => NULL,
                pvariacion_base                 => NULL,
                ptasa_interes                   => NULL,
                pcodigo_tasa_moratorios         => NULL,
                pvariacion_mora                 => NULL,
                ptasa_moratorios                => NULL,
                pgracia_principal               => NULL,
                pgracia_mora                    => NULL,
                pdias_atraso_cobro_jud          => NULL,
                pcontinua_cobro_intereses       => NULL,
                pcomision_normal                => NULL,
                pcomision_normal_minima         => NULL,
                pcomision_normal_maxima         => NULL,
                pperiodo_comision_normal        => NULL,
                prevaloriza                     => NULL,
                paprobacion_con_garantia        => NULL,
                padicionado_por                 => NULL,
                pfecha_adicion                  => NULL,
                pmodificado_por                 => NULL,
                pfecha_modificacion             => NULL,
                ptipo_comision                  => NULL,
                ptipo_mora                      => NULL,
                pporcentaje_tasa_mora           => NULL,
                pmax_dias_vencido_cobro         => NULL,
                ppermite_sobregiro              => NULL,
                pporcentaje_sobregiro           => NULL,
                pcargo_comision                 => NULL,
                pcargo_poliza                   => NULL,
                pcodigo_corte                   => NULL,
                pvariacion_minima               => NULL,
                pvariacion_maxima               => NULL,
                pperiodos_gracia_principal      => NULL,
                pcargo_comision_atrasada        => NULL,
                pmnemonico                      => NULL,
                pcargo_cobro_administrativo     => NULL,
                pcobra_comision_atrasada        => NULL,
                pcobra_cobro_administrativo     => NULL,
                pdias_atraso_cobro_admin        => NULL,
                pbase_calculo_moratorios        => NULL,
                pcomision_sobre_saldos          => NULL,
                psaldos_teoricos                => NULL,
                pcargo_iva                      => NULL,
                pcobra_saldo_no_utilizado       => NULL,
                pcargo_saldo_no_utilizado       => NULL,
                pcomision_genera_iva            => NULL,
                pcobra_intereses_dia_pago       => NULL,
                pcargo_interes_prorrogado       => NULL,
                pcargo_moratorio_prorrogado     => NULL,
                pcargo_comision_prorrogada      => NULL,
                ptipo_calculo_mora              => NULL,
                pcargo_mora_flat                => NULL,
                pdia_pago                       => NULL,
                ptipo_cartera                   => NULL,
                pdias_atraso_en_vigente         => NULL,
                pes_pre_aprobado                => NULL,
                pvigencia_solicitud             => NULL,
                pcobro_aut_poliza               => NULL,
                pes_cuota_multiple              => NULL,
                ptipo_credito_hijos             => NULL,
                pdescuentainteresesdesembolso   => NULL,
                pcantidad_cuotas_descontar      => NULL,
                pind_poliza_bco                 => NULL,
                pind_pr_vehiculo                => NULL,
                pmax_porc_extraordinario        => NULL,
                pcon_garantia_certificado       => NULL,
                pporcentaje_pignoracion_cd      => NULL,
                poficial_autorizado             => NULL,
                pgrupo_tipo_credito             => NULL,
                ptipo_de_persona                => NULL,
                pllamada_atraso                 => NULL,
                pind_es_reserva                 => NULL,
                pind_credito_universitario      => NULL,
                pind_micro_credito              => NULL,
                plimite_tolerable_ea            => NULL,
                plimite_tolerable_lc            => NULL,
                plimite_tolerable_gf            => NULL,
                plimite_tolerable_cp            => NULL,
                pfacilidad_creditic             => NULL,
                pind_cobra_mora                 => NULL,
                pestado                         => NULL,
                ptipo_cuota                     => NULL,
                pmultiples_desembolsos          => NULL,
                pdesembolso_pactado             => NULL,
                pgracia_mora_principal          => NULL,
                errorcode                       => errorcode,
                errordescription                => errordescription);

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);


        IF v_pr_pr_tipo_credito_list.COUNT = 0
        THEN
            errorcode := '45-' || errorcode;
            errordescription :=
                   errordescription
                || '-Tipo de credito '
                || pinfo_prestamo.codigo_proyecto
                || ' no encontrado';
            --ROLLBACK;
            --RETURN FALSE;

            verrores_info := verrores_info + 1;
            pr.pkg_portacredit2.agregartarea (
                'ERROR',
                'TIPO_CREDITO',
                'Tipo credito',
                '500',
                   'Tipo credito '
                || pinfo_prestamo.codigo_proyecto
                || ' NO se ha Encontrado',
                'Validar Solicitud');
        ELSE
            FOR i IN 1 .. v_pr_pr_tipo_credito_list.COUNT
            LOOP
                reg1.codigo_moneda :=
                    v_pr_pr_tipo_credito_list (i).codigo_moneda;
                reg1.tipo_credito :=
                    v_pr_pr_tipo_credito_list (i).tipo_credito;
                reg1.es_linea_credito :=
                    v_pr_pr_tipo_credito_list (i).es_linea_credito;
                reg1.tipo_linea := v_pr_pr_tipo_credito_list (i).tipo_linea;
                reg1.manejo := v_pr_pr_tipo_credito_list (i).manejo;
                reg1.modalidad_cobro :=
                    v_pr_pr_tipo_credito_list (i).modalidad_cobro;
                reg1.tipo_intereses :=
                    v_pr_pr_tipo_credito_list (i).tipo_intereses;
                reg1.tipo_calendario :=
                    v_pr_pr_tipo_credito_list (i).tipo_calendario;
                reg1.periodo_comision_normal :=
                    v_pr_pr_tipo_credito_list (i).periodo_comision_normal;
                reg1.comision_normal :=
                    v_pr_pr_tipo_credito_list (i).comision_normal;
                reg1.tipo_tasa := v_pr_pr_tipo_credito_list (i).tipo_tasa;
                reg1.codigo_tipo_de_tasa :=
                    v_pr_pr_tipo_credito_list (i).codigo_tipo_de_tasa;
                reg1.variacion_base :=
                    v_pr_pr_tipo_credito_list (i).variacion_base;
                reg1.tasa_interes :=
                    v_pr_pr_tipo_credito_list (i).tasa_interes;
                reg1.codigo_tasa_moratorios :=
                    v_pr_pr_tipo_credito_list (i).codigo_tasa_moratorios;
                reg1.variacion_mora :=
                    v_pr_pr_tipo_credito_list (i).variacion_mora;
                reg1.tasa_moratorios :=
                    v_pr_pr_tipo_credito_list (i).tasa_moratorios;
                reg1.gracia_principal :=
                    v_pr_pr_tipo_credito_list (i).gracia_principal;
                reg1.gracia_mora := v_pr_pr_tipo_credito_list (i).gracia_mora;
                reg1.codigo_origen :=
                    v_pr_pr_tipo_credito_list (i).codigo_origen;
                reg1.continua_cobro_intereses :=
                    v_pr_pr_tipo_credito_list (i).continua_cobro_intereses;
                reg1.dia_pago := v_pr_pr_tipo_credito_list (i).dia_pago;
                reg1.revaloriza := v_pr_pr_tipo_credito_list (i).revaloriza;
                reg1.codigo_sub_aplicacion :=
                    v_pr_pr_tipo_credito_list (i).codigo_sub_aplicacion;
                reg1.tipo_comision :=
                    v_pr_pr_tipo_credito_list (i).tipo_comision;
                reg1.tipo_mora := v_pr_pr_tipo_credito_list (i).tipo_mora;
                reg1.porcentaje_tasa_mora :=
                    v_pr_pr_tipo_credito_list (i).porcentaje_tasa_mora;
                -- reg1.codigo_plazo,
                reg1.permite_sobregiro :=
                    v_pr_pr_tipo_credito_list (i).permite_sobregiro;
                reg1.porcentaje_sobregiro :=
                    v_pr_pr_tipo_credito_list (i).porcentaje_sobregiro;
                reg1.variacion_minima :=
                    v_pr_pr_tipo_credito_list (i).variacion_minima;
                reg1.variacion_maxima :=
                    v_pr_pr_tipo_credito_list (i).variacion_maxima;
                reg1.periodos_gracia_principal :=
                    v_pr_pr_tipo_credito_list (i).periodos_gracia_principal;
                reg1.base_calculo_moratorios :=
                    v_pr_pr_tipo_credito_list (i).base_calculo_moratorios;
                reg1.descuenta_intereses_desembolso :=
                    v_pr_pr_tipo_credito_list (i).descuenta_intereses_desembolso;
                reg1.cantidad_cuotas_descontar :=
                    v_pr_pr_tipo_credito_list (i).cantidad_cuotas_descontar;
                reg1.ind_pr_vehiculo :=
                    v_pr_pr_tipo_credito_list (i).ind_pr_vehiculo;
                -- reg1.dias_periodo_cuota,
                -- reg1.plazo,
                reg1.tipo_desembolso := 'C'; ---V_Pr_Pr_Tipo_Credito_List(i).tipo_desembolso;
                reg1.codigo_actividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_actividad;
                reg1.codigo_subactividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_subactividad;
                reg1.codigo_sub_clase := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_sub_clase;
                reg1.codigo_plazo :=
                    v_pr_pr_tipo_credito_list (i).codigo_plazo;
                vplazo_minimo := v_pr_pr_tipo_credito_list (i).plazo_minimo;
                vplazo_maximo := v_pr_pr_tipo_credito_list (i).plazo_maximo;
                vmonto_minimo := v_pr_pr_tipo_credito_list (i).monto_minimo;
                vmonto_maximo := v_pr_pr_tipo_credito_list (i).monto_maximo;
                vvariacion_base :=
                    v_pr_pr_tipo_credito_list (i).variacion_base;
            END LOOP;
        END IF;

        BEGIN
            ---malmanzar 09-06-2022
            reg1.codigo_periodo_cuota :=
                f_periodicidad_pda_core (
                    TO_NUMBER (
                        SUBSTR (pinfo_prestamo.codigo_frecuencia_pago, 1, 2)));
        END;

        reg1.plazo :=
              pr_proyeccion.my_add_month (reg1.f_apertura,       /*pplazocal*/
                                          pinfo_prestamo.termino_prestamo)
            - reg1.f_apertura;

        BEGIN
            SELECT codigo_plazo
              INTO reg1.codigo_plazo
              FROM pr_tipos_plazos
             WHERE     codigo_plazo = reg1.codigo_plazo
                   AND reg1.plazo BETWEEN plazo_minimo AND plazo_maximo;
        --Between vPlazo_Minimo And vPlazo_Maximo;
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                errordescription :=
                       'Revisar el campo Plazo: '
                    || reg1.plazo
                    || ' Codigo_Plazo '
                    || reg1.codigo_plazo
                    || ' '
                    || $$plsql_unit
                    || ' $$PLSQL_LINE = '
                    || $$plsql_line
                    || ' Sqlerrm '
                    || SQLERRM;


                errorcode := '46';
                --errorDescription := v_error;

                verrores_info := verrores_info + 1;
                pr.pkg_portacredit2.agregartarea ('ERROR',
                                                  'PR_TIPOS_PLAZOS',
                                                  'Codigo_Plazo',
                                                  '500',
                                                  errordescription, --'Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                                                  'Validar Solicitud');
        --p_depura (
        --  'errorCode ' || errorCode || ': ' || errorDescription);
        --ROLLBACK;
        --RETURN FALSE;
        END;

        reg1.f_vencimiento := reg1.f_apertura + reg1.plazo;
        --
        reg1.monto_credito := pinfo_prestamo.monto_credito;       --pmontocal;

        IF reg1.monto_credito NOT BETWEEN vmonto_minimo AND vmonto_maximo
        THEN
            errorcode := '47';
            errordescription := --'p_mensajeerror = Revisar el campo : Monto del Credito Solicitado, no se encuentra dentro de los rangos minimo y maximo del codigo de proyecto asignado ';
                   ' reg1.monto_credito '
                || TO_CHAR (reg1.monto_credito)
                || ' vmonto_minimo '
                || TO_CHAR (vmonto_minimo)
                || ' vmonto_maximo '
                || TO_CHAR (vmonto_maximo);

            verrores_info := verrores_info + 1;
            pr.pkg_portacredit2.agregartarea ('ERROR',
                                              'PR_TIPO_CREDITO',
                                              'TIPO_CREDITO',
                                              '500',
                                              errordescription, --'Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                                              'Validar Solicitud');
        END IF;

        BEGIN
            reg1.cuota := TO_NUMBER (                    /*pcuotaprestamocal*/
                                     pinfo_prestamo.cuota_fija);
        EXCEPTION
            WHEN OTHERS
            THEN
                errorcode := '48';
                errordescription :=
                    'El valor del campo cuota no esta siendo enviado en el formato correcto.';

                verrores_info := verrores_info + 1;
                pr.pkg_portacredit2.agregartarea ('ERROR',
                                                  'PR_CREDITOS',
                                                  'NO_CREDITO',
                                                  '500',
                                                  errordescription, --'Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                                                  'Validar Solicitud');
        END;

        BEGIN
            SELECT b.porcentaje, a.variacion_min, a.variacion_max
              INTO vporcentaje, vvariacion_min, vvariacion_max
              /* into :BKCredit.Desc_TASA_INTERES_BASE, :BKCredit.Desc_valor_tasa_corrientes,
              :BKCredit.variacion_min_interes, :BKCredit.variacion_max_interes*/
              FROM tipos_de_tasas_de_interes a, valores_de_tasas_de_interes b
             WHERE     a.codigo_tipo_de_tasa = b.codigo_tipo_de_tasa
                   AND b.codigo_empresa = p_codempresa
                   AND a.codigo_tipo_de_tasa =
                       TO_NUMBER (reg1.codigo_tipo_de_tasa)
                   --To_number( :New.tipocal )--LMVR
                   AND b.fecha_inicio =
                       (SELECT MAX (fecha_inicio)
                          FROM valores_de_tasas_de_interes
                         WHERE     codigo_empresa = p_codempresa
                               AND codigo_tipo_de_tasa =
                                   a.codigo_tipo_de_tasa
                               AND fecha_inicio <= TRUNC (SYSDATE) /*pfecha_registro*/
                                                                  );
        -- p_depura( 'ejecuto tasa de interes?:' || Sqlerrm );
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                errorcode := '49';
                errordescription :=
                    'no encontro registros, revisar campos : Validación de Tasa de Interes';

                verrores_info := verrores_info + 1;
                pr.pkg_portacredit2.agregartarea (
                    'ERROR',
                    'tipos_de_tasas_de_interes',
                    'TASA INTERES',
                    '500',
                    errordescription, --'Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                    'Validar Solicitud');
            WHEN OTHERS
            THEN
                -- p_depura( 'others tasa de interes:' || Sqlerrm );
                errordescription :=
                       'p_mensajeerror = revisar campos para consulta de tipos de tasas de interes '
                    || SQLERRM;

                verrores_info := verrores_info + 1;
                pr.pkg_portacredit2.agregartarea (
                    'ERROR',
                    'tipos_de_tasas_de_interes',
                    'TASA INTERES',
                    '500',
                    errordescription, --'Tipo credito ' || pINFO_PRESTAMO.CODIGO_PROYECTO || ' NO se ha Encontrado',
                    'Validar Solicitud');
        END;

        reg1.variacion_base :=                                    /*ptasacal*/
                               pinfo_prestamo.tasa - (vporcentaje);

        reg1.tasa_interes := pinfo_prestamo.tasa;                  --ptasacal;

        IF verrores_info = 0
        THEN
            vreturn := TRUE;
        ELSE
            vreturn := FALSE;
        END IF;

        RETURN vreturn;
    END;

    FUNCTION f_valida_evaluaciones (pevaluaciones pr.evaluacion_obj)
        RETURN BOOLEAN
    IS
        vreturn   BOOLEAN;
    BEGIN
        RETURN TRUE;
    END;


    FUNCTION f_valida_agencia (pcod_empresa   IN VARCHAR2,
                               pcod_agencia   IN VARCHAR2)
        RETURN BOOLEAN
    IS
        vreturn   BOOLEAN;
        vcount    NUMBER;
    BEGIN
        SELECT COUNT (1)
          INTO vcount
          FROM agencia
         WHERE cod_empresa = pcod_empresa AND cod_agencia = pcod_agencia;

        IF vcount = 0
        THEN
            vreturn := FALSE;
            pr.pkg_portacredit2.agregartarea (
                'ERROR',
                'pCODIGO_CENTRO_COSTO',
                pcod_agencia,
                '200',
                'Agencia ' || pcod_agencia || ' NO se ha Encontrado',
                'Procesar Solicitud');
        ELSE
            vreturn := TRUE;
        END IF;

        RETURN vreturn;
    END;

    FUNCTION f_valida_oficial (pcod_oficial VARCHAR2)
        RETURN BOOLEAN
    IS
        vreturn   BOOLEAN;
        vcount    NUMBER;
    BEGIN
        SELECT COUNT (1)          ---b.nombre ---into :BKCredit.Desc_Ejecutivo
          INTO vcount
          FROM empleados a, personas b, pr_analistas c
         WHERE     a.cod_empresa = 1                   --:Variables.CodEmpresa
               AND a.id_empleado IS NOT NULL
               AND a.esta_activo = 'S'
               AND a.es_promotor = 'S'
               AND a.es_oficial = 'S'
               AND b.cod_persona = a.cod_per_fisica
               AND a.id_empleado = c.codigo_persona
               --and c.codigo_persona = '0000'
               AND codigo_analista = pcod_oficial;

        IF vcount = 0
        THEN
            vreturn := FALSE;
            pr.pkg_portacredit2.agregartarea (
                'ERROR',
                'pCODIGO_EMPLEADO',
                'pCODIGO_EMPLEADO',
                '200',
                'Código Oficial no se ha validado correctamente',
                'Procesar Solicitud');
        ELSE
            vreturn := TRUE;
        END IF;

        RETURN vreturn;
    EXCEPTION
        WHEN OTHERS
        THEN
            vreturn := FALSE;
    END;

    FUNCTION f_valida_tipocredito (ptipo_credito NUMBER)
        RETURN BOOLEAN
    IS
        vreturn    BOOLEAN;
        vestado    pr_tipo_credito.estado%TYPE;
        pmensaje   VARCHAR2 (300);
    BEGIN
        BEGIN
            SELECT estado         ---b.nombre ---into :BKCredit.Desc_Ejecutivo
              INTO vestado
              FROM pr_tipo_credito
             WHERE codigo_empresa = 1                        --pCODIGO_EMPRESA
                                      AND tipo_credito = ptipo_credito;
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                pmensaje :=
                    'Tipo de credito ' || ptipo_credito || ' NO encontrado..';
                pr.pkg_portacredit2.agregartarea (
                    'Tarea Validar Tipo Credito',
                    'PR.PR_TIPO_CREDITO',
                    ptipo_credito,
                    '200',
                    pmensaje,
                    'Procesar Credito');
                RETURN FALSE;
        END;

        IF vestado != 'A'
        THEN
            pmensaje :=
                   'Tipo de credito '
                || ptipo_credito
                || ' en estado '
                || vestado;
            pr.pkg_portacredit2.agregartarea ('Tarea Validar Tipo Credito',
                                              'PR.PR_TIPO_CREDITO',
                                              ptipo_credito,
                                              '200',
                                              pmensaje,
                                              'Procesar Credito');
            vreturn := FALSE;
        ELSE
            vreturn := TRUE;
        END IF;

        -- tipo credito nuevos clientes

        --



        RETURN vreturn;
    EXCEPTION
        WHEN OTHERS
        THEN
            vreturn := FALSE;
    END;

    PROCEDURE pvalida_solicitud (
        psolicitud   IN     pr.solicitud_credito_obj,
        perrores        OUT NUMBER)
    IS
        verrores          NUMBER := 0;
        verrorespersona   NUMBER;                                   ---- := 0;
        vvalida_persona   BOOLEAN;

        v_tipo_id         VARCHAR2 (10);
    BEGIN
        --1-Validar Persona Principal
        FOR i IN 1 .. psolicitud.persona.COUNT
        LOOP
            verrorespersona := 0;
            vvalida_persona :=
                f_valida_persona (psolicitud.persona (i), verrorespersona);

            IF NOT vvalida_persona
            THEN
                verrores := NVL (verrores, 0) + NVL (verrorespersona, 0);
                raise_application_error (-20400,
                                         'Error validando persona ',
                                         FALSE);
            END IF;
        END LOOP;

        --2-Validar Vinculación Financiera

        ---27-01-2024 Begin
        DBMS_OUTPUT.put_line (
            '==============FinanciallyLinked==============');

        FOR fl IN 1 .. psolicitud.vinculacion_finaciera.COUNT
        LOOP
            --            DBMS_OUTPUT.put_line (
            --                   'FinanciallyLinked('
            --                || fl
            --                || ').Code = '
            --                || psolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan);
            --            DBMS_OUTPUT.put_line (
            --                ' ==============FinanciallyLinked.Persons==============');

            FOR i
                IN 1 .. psolicitud.vinculacion_finaciera (fl).personas.COUNT
            LOOP
                --  DBMS_OUTPUT.put_line (
                ---    '  ==============IdentificationDocuments==============');

                FOR x
                    IN 1 ..
                       psolicitud.vinculacion_finaciera (fl).personas (i).identificaciones.COUNT
                LOOP
                    vvalida_persona :=
                        f_valida_persona (
                            psolicitud.vinculacion_finaciera (fl).personas (
                                i),
                            verrorespersona);

                    IF NOT vvalida_persona
                    THEN
                        verrores :=
                            NVL (verrores, 0) + NVL (verrorespersona, 0);
                        raise_application_error (
                            -20400,
                               'Error validando persona vinculacion_finaciera '
                            || psolicitud.vinculacion_finaciera (fl).personas (
                                   i).identificaciones (x).num_id,
                            FALSE);
                    END IF;


                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').IdentificationDocuments('
                    --                        || x
                    --                        || ').DocumentTypeCode = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).identificaciones (
                    --                               x).cod_tipo_id);
                    --

                    v_tipo_id :=
                        psolicitud.vinculacion_finaciera (fl).personas (i).identificaciones (
                            x).cod_tipo_id;
                --                    DBMS_OUTPUT.put_line (
                --                           'FinanciallyLinked('
                --                        || fl
                --                        || ').Person('
                --                        || i
                --                        || ').IdentificationDocuments('
                --                        || x
                --                        || ').DocumentNumber = '
                --                        || psolicitud.vinculacion_finaciera (fl).personas (i).identificaciones (
                --                               x).num_id);
                END LOOP;

                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').FirstName = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).primer_nombre);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').SecondName = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).segundo_nombre);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').LastName = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).primer_apellido);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').SecondLastName = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).segundo_apellido);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').FullName = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).nombre_completo);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').NickName = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).apodo);

                ---Validar tipo cliente Ejemplo válido "511"
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').CustomerTypeCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).tipo_codigo_cliente);


                --                p_depura (
                --                       'Liinea: '
                --                    || $$plsql_line
                --                    || ' TIPO_CODIGO_CLIENTE: '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).tipo_codigo_cliente);

                IF NOT valida_tipo_cliente (
                           psolicitud.vinculacion_finaciera (fl).personas (i).tipo_codigo_cliente,
                           CASE WHEN v_tipo_id = 'R' THEN 'J' ELSE 'F' END)
                THEN
                    verrores := verrores + 1;
                    pr.pkg_portacredit2.agregartarea (
                        'ERROR',
                        'TIPO_CLIENTE',
                        'TIPO_CLIENTE',
                        '500',
                           'Error validando, TIPO CLIENTE: '
                        || psolicitud.vinculacion_finaciera (fl).personas (i).tipo_codigo_cliente,
                        'Validar Solicitud');
                END IF;

                /*  IF   psolicitud.vinculacion_finaciera (fl).personas (i).
                 THEN
                     verrores := verrores + 1;
                     pr.pkg_portacredit2.agregartarea (
                         'ERROR',
                         'TIPO_CLIENTE',
                         'TIPO_CLIENTE',
                         '500',
                            'Error validando, TIPO CLIENTE: '
                         || psolicitud.vinculacion_finaciera (fl).personas (i).tipo_codigo_cliente,
                         'Validar Solicitud');
                 END IF;*/
                ---


                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').GenderCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).genero);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').BirthDay = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).fecha_nacimiento);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').PlaceOfBirth = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).nacionalidad);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').Age = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).edad);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').CivilStatusCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).estado_civil);
                --
                --                DBMS_OUTPUT.put_line (
                --                       '  ==============FinanciallyLinked('
                --                    || fl
                --                    || ').Person.Addresses==============');

                FOR d
                    IN 1 ..
                       psolicitud.vinculacion_finaciera (fl).personas (i).direcciones.COUNT
                LOOP
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').AddressTypeCode          = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).tipo_direccion);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').CountryCode              = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).cod_pais);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').SectionCode              = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).cod_provincia);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').ProvinceCode             = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).cod_canton);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').MunicipalityCode         = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).cod_distrito);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').DistrictMunicipalityCode = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).cod_pueblo);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').NeighborhoodCode         = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).barrio);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').Street                   = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).calle);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').HousingTypeCode          = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).tipo_casa);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Addresses('
                    --                        || d
                    --                        || ').AddressReference         = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                    --                               d).referencia);
                    DBMS_OUTPUT.put_line (
                           'FinanciallyLinked('
                        || fl
                        || ').Person('
                        || i
                        || ').Addresses('
                        || d
                        || ').ResideSince              = '
                        || psolicitud.vinculacion_finaciera (fl).personas (i).direcciones (
                               d).reside_desde);
                END LOOP;

                --                DBMS_OUTPUT.put_line (
                --                       '  ==============FinanciallyLinked('
                --                    || fl
                --                    || ').Person.Locatos==============');

                FOR l
                    IN 1 ..
                       psolicitud.vinculacion_finaciera (fl).personas (i).localizadores.COUNT
                LOOP
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Locators('
                    --                        || l
                    --                        || ').locatorTypeCode = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).localizadores (
                    --                               l).tipo_localizador);
                    DBMS_OUTPUT.put_line (
                           'FinanciallyLinked('
                        || fl
                        || ').Person('
                        || i
                        || ').Locators('
                        || l
                        || ').value = '
                        || psolicitud.vinculacion_finaciera (fl).personas (i).localizadores (
                               l).valor);
                END LOOP;

                --                DBMS_OUTPUT.put_line (
                --                       '  ==============FinanciallyLinked('
                --                    || fl
                --                    || ').Person.Businesses==============');

                FOR n
                    IN 1 ..
                       psolicitud.vinculacion_finaciera (fl).personas (i).negocios.COUNT
                LOOP
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').code = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).codigo);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').name = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).nombre);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').employeeQuantity = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).cantidad_empleados);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').dopcumentTypeCode = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).codigo_tipo_doc);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').documentNumber = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).numero_documento);
                    DBMS_OUTPUT.put_line (
                           '   ==============FinanciallyLinked('
                        || fl
                        || ').Person.Businesses.Locatos==============');

                    FOR l
                        IN 1 ..
                           psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).localizadores.COUNT
                    LOOP
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Locators('
                        --                            || l
                        --                            || ').locatorTypeCode   = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).localizadores (l).tipo_localizador);
                        DBMS_OUTPUT.put_line (
                               'FinanciallyLinked('
                            || fl
                            || ').Person('
                            || i
                            || ').Businesses('
                            || n
                            || ').Locators('
                            || l
                            || ').value             = '
                            || psolicitud.vinculacion_finaciera (fl).personas (
                                   i).negocios (n).localizadores (l).valor);
                    END LOOP;

                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').EconomicSectorCode  = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).sector_economico);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').CiiuActivityCode    = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).ciiu_actividad);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').CiiuBranchCode  = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).ciiu_sucursal);
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').Businesses('
                    --                        || n
                    --                        || ').StartOperationDate  = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                    --                               n).fecha_inicio_operacion);
                    DBMS_OUTPUT.put_line (
                           '   ==============FinanciallyLinked('
                        || fl
                        || ').Person.Businesses.Addresses==============');

                    FOR d
                        IN 1 ..
                           psolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).direcciones.COUNT
                    LOOP
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').addressTypeCode          = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).tipo_direccion);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').countryCode              = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).cod_pais);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').sectionCode              = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).cod_provincia);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').provinceCode             = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).cod_canton);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').municipalityCode         = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).cod_distrito);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').districtMunicipalityCode = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).cod_pueblo);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').neighborhoodCode         = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).barrio);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').street                   = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).calle);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').housingTypeCode          = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).tipo_casa);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').addressReference         = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).negocios (n).direcciones (d).referencia);
                        DBMS_OUTPUT.put_line (
                               'FinanciallyLinked('
                            || fl
                            || ').Person('
                            || i
                            || ').Businesses('
                            || n
                            || ').Addresses('
                            || d
                            || ').ResideSince              = '
                            || psolicitud.vinculacion_finaciera (fl).personas (
                                   i).negocios (n).direcciones (d).reside_desde);
                    END LOOP;
                END LOOP;

                --                DBMS_OUTPUT.put_line (
                --                       '  ==============FinanciallyLinked('
                --                    || fl
                --                    || ').Person.References==============');

                FOR r
                    IN 1 ..
                       psolicitud.vinculacion_finaciera (fl).personas (i).referencias.COUNT
                LOOP
                    --                    DBMS_OUTPUT.put_line (
                    --                           'FinanciallyLinked('
                    --                        || fl
                    --                        || ').Person('
                    --                        || i
                    --                        || ').References('
                    --                        || r
                    --                        || ').referenceTypeCode = '
                    --                        || psolicitud.vinculacion_finaciera (fl).personas (i).referencias (
                    --                               r).tipo_referencia);
                    DBMS_OUTPUT.put_line (
                           '    ==============FinanciallyLinked('
                        || fl
                        || ').Person.References.PersonReferences==============');

                    FOR rp
                        IN 1 ..
                           psolicitud.vinculacion_finaciera (fl).personas (i).referencias (
                               r).personas_referencia.COUNT
                    LOOP
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').References('
                        --                            || r
                        --                            || ').PersonReference('
                        --                            || rp
                        --                            || ').name = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).referencias (r).personas_referencia (
                        --                                   rp).nombres);
                        --                        DBMS_OUTPUT.put_line (
                        --                               'FinanciallyLinked('
                        --                            || fl
                        --                            || ').Person('
                        --                            || i
                        --                            || ').References('
                        --                            || r
                        --                            || ').PersonReference('
                        --                            || rp
                        --                            || ').lastname = '
                        --                            || psolicitud.vinculacion_finaciera (fl).personas (
                        --                                   i).referencias (r).personas_referencia (
                        --                                   rp).apellidos);
                        DBMS_OUTPUT.put_line (
                               'FinanciallyLinked('
                            || fl
                            || ').Person('
                            || i
                            || ').References('
                            || r
                            || ').PersonReference('
                            || rp
                            || ').nickName = '
                            || psolicitud.vinculacion_finaciera (fl).personas (
                                   i).referencias (r).personas_referencia (
                                   rp).apodo);

                        FOR l
                            IN 1 ..
                               psolicitud.vinculacion_finaciera (fl).personas (
                                   i).referencias (r).personas_referencia (
                                   rp).localizadores.COUNT
                        LOOP
                            --                            DBMS_OUTPUT.put_line (
                            --                                   'FinanciallyLinked('
                            --                                || fl
                            --                                || ').Person('
                            --                                || i
                            --                                || ').References('
                            --                                || r
                            --                                || ').PersonReference('
                            --                                || rp
                            --                                || ').Locators('
                            --                                || l
                            --                                || ').locatorTypeCode   = '
                            --                                || psolicitud.vinculacion_finaciera (fl).personas (
                            --                                       i).referencias (r).personas_referencia (
                            --                                       rp).localizadores (l).tipo_localizador);
                            DBMS_OUTPUT.put_line (
                                   'FinanciallyLinked('
                                || fl
                                || ').Person('
                                || i
                                || ').References('
                                || r
                                || ').PersonReference('
                                || rp
                                || ').Locators('
                                || l
                                || ').value             = '
                                || psolicitud.vinculacion_finaciera (fl).personas (
                                       i).referencias (r).personas_referencia (
                                       rp).localizadores (l).valor);
                        END LOOP;
                    END LOOP;
                END LOOP;

                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.ChildrenQuantity = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).cantidad_hijos);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.DependentsQuantity = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).cantidad_dependientes);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.PersonGradeCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).grado_persona);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.PersonOccupationCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).ocupacion_persona);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.IsAdemiEmployee = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).es_empleado);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.IsLinkedAdemiEmployee = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).es_empleado_relacionado);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.LinkedAdemiEmployeeName = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).nombre_relacion_empleado);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.LinkedAdemiEmployeeTypeCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).tipo_relacion_empleado);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.IsPEP = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).es_pep);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.HaveRelationWithPEP = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).tiene_relacion_pep);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').AdditionalInfo.RelationShiptWithPEPCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).parentesco_pep);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').EconomicActivityCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).codigo_actividad_economica);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').CreditRequestPersonTypeCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).tipo_solicitud_credito);
                --                DBMS_OUTPUT.put_line (
                --                       'FinanciallyLinked('
                --                    || fl
                --                    || ').Person('
                --                    || i
                --                    || ').PersonTypeCode = '
                --                    || psolicitud.vinculacion_finaciera (fl).personas (i).codigo_tipo_persona);

                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessBalanceSheet==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.BalanceSheetDate = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.fecha_balance);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.AmountOfCashInPettyCashAndBank = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.efectivo_caja_chica);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.AccountsReceivable = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuentas_por_cobrar);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.FinishedGoodsInventory = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_producto_finalizado);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.InventoryProductInProduction = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_producto_produccion);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.InventoryRawMateria = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_materia_prima);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.AmountOfCommodity = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cantidad_mercancia);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.AmountOfAdvanceSuppliers = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cantidad_proveedor_anticipado);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.AmountOfMachineryFurnitureAndEquipment = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.maquinaria_mobiliario_eq);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.ValueOfBusinessPremises = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.valor_local_comercial);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.AccountsPayableToProvider = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuenta_por_pagar_proveedor);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.AccountsPayableVarious'
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuenta_por_pagar_varios);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.Heritage = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.patrimonio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.WorkingCapital = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.capital_de_trabajo);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.BalanceOfYourFinancialObligations = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.balance_oblicacion_financiera);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.TotalFixedAssets = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos_fijos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.TotalAssets = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.TotalLongTermLiabilities = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_largo_plazo);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.TotalLiabilities = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.TotalCurrentLiabilities = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_corriente);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.TotalLiabilitiesAndEquity = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_patrimonio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessGeneralBalance.TotalCurrentAssets = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos_corrientes);
                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.SalaryExpense = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_salarial);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.ServiceExpense = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_servicios);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.TransportFuelExpense = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_combustible);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.RentPayment = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.pagos_renta);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.InterestPaymentExpense = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_interes_pagos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.OthersExpense = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.otros_gastos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.TotalOperationalCost = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.total_costos_operacional);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.BusinessOperatingCosts.NetProfit     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.ganacia_neta);
                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.BalanceSheetDate = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.fecha_balance);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.ValueOfFurnitureAndVehicle = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.valor_muebles_vehiculo);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.ValueOfEstates     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.valor_propiedades);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.CommercialDebt = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.deuda_comercial);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.BankingDebt = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.deuda_bancaria);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.TotalHouseholdAssets = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.total_activos_familiares);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.TotalFamilyLiabilities = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.tota_pasivos_familiar);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FamilyGeneralBalance.TotalFamilyHeritage     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.total_patrimonio_familiar);
                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.HighestProfitOfTheMonth = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.mayor_beneficio_mes);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.LowestProfitOfTheMonth  = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.menor_beneficio_mes);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.AverageMonthlyProfit = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.beneficio_prom_mensual);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.AverageDailySales = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_diarias_promedio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.DaysWorkedPerMonth = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.dias_trabajados_por_mes);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.AverageWeeklyPurchases = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.compras_semanales_promedio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.DeclaredMonthlySales = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.DeclaredMonthlyPurchases = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.compras_mensuales_declaradas);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.FinancialEvaluation.DeclaredProfitMargin     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.margen_beneficio_declarado);
                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySpendingOnFood = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_alimentacion);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySpendingOnhHusing = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_vivienda);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySpendingOnClothing = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_ropa);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySpendingOnTransportation = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_transportacion);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySpendingOnServices = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_servicios);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySpendingOnMedicines = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_medicos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySpendingOnEducation = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_educacion);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilyDebts = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.debitos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.OtherFamilySpending = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.otros_gastos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.TotalFamilyExpenses = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.total_gastos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.HouseholExpenditure.FamilySurplus = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.excedente_familiar);
                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement.FinanciallyLinked('
                    || fl
                    || ').Person.EvaluationstartDate = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.fecha_inicio_eval);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement.EvaluationEndDate = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.fecha_fin_eval);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement.OtherIncome = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.otros_ingresos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement.RevenueFromSales = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.ingresos_por_ventas);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement.SalesCosts     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.costo_ventas);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement.GrossProfit     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.beneficio_ventas);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.IncomeStatement.AnnuelGrossProfit = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.utilidad_bruta_anual);

                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.HourAtWorkPerWeek     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.horas_trabajo_por_semana);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.YearsOfBusinessExperience     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.anio_experiencia_negocio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.IsBusinessPremisesNotRented = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.local_no_alquilado);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.HasTaxRecords = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.tiene_impuestos_gravados);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.IsForBusinessImprovements = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.es_mejoras_comerciales);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.BusinessLocationRatingCode = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.codigo_ubicacion_negocio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.BusinessCompetitionLevelCode = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.nivel_competencia_negocio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.TimeAtThePlaceOfBusinessOrEmployment = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.tiempo_lugar_negocio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.NonFinancialEvaluation.NumberOfFrequentCustomers     = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.numero_frecuencia_clientes);
                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.WageIncome==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.WageIncome.Salary = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.ingresos_salariales.salario);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.WageIncome.OtherIncome = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.ingresos_salariales.otros_ingresos);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.WageIncome.SpecifyOtherIncome = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.ingresos_salariales.especifica_otros_ing);
                DBMS_OUTPUT.put_line (
                       '==============FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator==============');
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.LiabilityDividedByEquity = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.respons_patrimonio);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.CurrentAssetsDividedBycurrentLiabilities = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.activos_pasivos_corr);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.OtherIncomeDividedByfamilySurplus = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.otros_ing_exced_fam);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.RecommendedFeeDividedByfamilySurplus = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.tarif_recom_exced_fam);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.TotalLiabilitiesDividedByEquity = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.total_respons_equidad);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.NetProfitDividedByEquity = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.benef_neto_capital);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.NetProfitDividedBySales = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.benef_neto_ventas);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.NetProfitDividedByTotalAssets = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.benef_neto_total_act);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.AccountsReceivableDividedBySales = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.cxp_ventas);
                DBMS_OUTPUT.put_line (
                       'FinanciallyLinked('
                    || fl
                    || ').Person('
                    || i
                    || ').Evaluations.Indicator.CostSalesDividedByInventory = '
                    || psolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.indicador.costo_ventas_inventario);
            END LOOP;
        END LOOP;

        --27-01-2024  End


        /*
                IF NOT f_valida_vinculacion_financ (pSolicitud.vinculacion_finaciera)
                THEN
                    vErrores := vErrores + 1;
                END IF;
        */

        --p_depura('pSolicitud.INFO_PRESTAMO: '||pSolicitud.INFO_PRESTAMO);

        --3-Valida Infomración del préstamo
        IF NOT f_valida_info_prestamo (psolicitud.info_prestamo)
        THEN
            ---IF NOT pINFO_PRESTAMO THEN
            verrores := verrores + 1;
        END IF;

        --4-Valida Evaluaciones
        IF NOT f_valida_evaluaciones (psolicitud.evaluaciones)
        THEN
            verrores := verrores + 1;
        END IF;

        ---  p_depura('pSolicitud.CODIGO_EMPLEADO: '||pSolicitud.CODIGO_EMPLEADO);
        --5-Validar Oficial de Negocio
        IF NOT f_valida_oficial (psolicitud.codigo_empleado)
        THEN
            ---IF NOT pCODIGO_EMPLEADO THEN
            verrores := verrores + 1;
        END IF;

        --6-Validar agencia

        ---p_depura('pSolicitud.CODIGO_CENTRO_COSTO: '||pSolicitud.CODIGO_CENTRO_COSTO);
        IF NOT f_valida_agencia ('1', psolicitud.codigo_centro_costo)
        THEN
            ---IF NOT pCODIGO_CENTRO_COSTO THEN
            verrores := verrores + 1;
        END IF;

        --   p_depura('vSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO: '||pSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO);

        IF NOT f_valida_tipocredito (
                   TO_NUMBER (psolicitud.info_prestamo.codigo_proyecto))
        THEN
            verrores := verrores + 1;
        END IF;

        perrores := verrores;
        p_depura ('pErrores = ' || perrores || ' Line: ' || $$plsql_line);
    END;

    --FUNCTION Valida_tipcredito_clienteNuevo(pTipo_credito in number, pno_cliente in number)
    --    RETURN BOOLEAN IS
    --
    --    vReturn BOOLEAN;
    --
    --    v_existe_credito   VARCHAR2 (1) := 'N';
    --BEGIN
    --            BEGIN
    --                SELECT DISTINCT esta
    --                  INTO v_existe_credito
    --                  FROM (SELECT 'S'     esta
    --                          FROM pr_creditos
    --                         WHERE     codigo_empresa = 1
    --                               AND estado IN ('D',
    --                                              'V',
    --                                              'M',
    --                                              'E',
    --                                              'J',
    --                                              'C')
    --                               AND codigo_cliente = pno_cliente --v_persona
    --                        UNION ALL
    --                        SELECT 'S'     esta
    --                          FROM pr_creditos_hi
    --                         WHERE     codigo_empresa = 1
    --                               AND estado = 'C'
    --                               AND codigo_cliente = reg1.codigo_cliente --v_persona
    --                                                                       );
    --            EXCEPTION
    --                WHEN OTHERS
    --                THEN
    --                   --- p_depura (' crear fud Linea ' || $$plsql_line);
    --                    v_existe_credito := 'N';
    --            END;
    --
    --          ---  p_depura (' crear fud Linea ' || $$plsql_line);
    --
    --            IF     v_existe_credito = 'S'
    --               AND INSTR (
    --                       param.parametro_x_empresa (1,
    --                                                  'TIPCRED_VAL_CLT_NEW',
    --                                                  'PR'),
    --                       /*pcodigoproyecto*/
    --                       TO_NUMBER (vSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO)) >
    --                   0
    --            THEN
    ----                v_error :=
    ----                       'El codigo de proyecto '
    ----                    || TO_NUMBER (vSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO) --pcodigoproyecto
    ----                    || ' solo aplica para clientes nuevos.';
    ----                errorCode := '51';
    ----                errorDescription := v_error;
    ----                p_depura (' crear fud Linea ' || $$plsql_line);
    ----                ROLLBACK;
    --                 pMENSAJE :=
    --                   'Tipo de credito '
    --                || pTIPO_CREDITO
    --                || ' en estado '
    --                || vEstado;
    --            PR.PKG_PORTACREDIT2.AgregarTarea ('Tarea Validar Tipo Credito',
    --                                              'PR.PR_TIPO_CREDITO',
    --                                               'Tipo',
    --                                              '200',
    --                                              pMENSAJE,
    --                                              'Procesar Credito');
    --
    --                --RETURN;
    --                 vReturn := FALSE;
    --                   ELSE
    --                 vReturn := TRUE;
    --                END IF;
    --
    --
    --                 RETURN vReturn;
    --        END;

    PROCEDURE p_info_laboral (p_persona     IN     VARCHAR2,
                              p_fec_ing     IN     DATE,
                              p_lugar_lab   IN     VARCHAR2,
                              p_sueldo      IN     NUMBER,
                              p_puesto      IN     VARCHAR2,
                              p_direccion   IN     VARCHAR2,
                              p_telefono    IN     VARCHAR2,
                              p_extension   IN     VARCHAR2,
                              --Excello:JPH:2020-03-18:REQ_ 108967:Begin >>
                              --P_Archivo_FUD  In  Varchar2,
                              ---P_TIdper_FUD   In  Varchar2,
                              ---P_NumIdoer_FUD In  Varchar2,
                              --Excello:JPH:2020-03-18:REQ_ 108967:End <<
                              p_procesado      OUT VARCHAR2,
                              p_msgerr         OUT VARCHAR2)
    IS
        CURSOR c_codlab IS
            SELECT NVL (MAX (TO_NUMBER (cod_laboral)) + 1, 0)
              FROM info_laboral
             WHERE cod_per_fisica = p_persona;


        --  Cursor C_MIngreso_Fec Is
        --   Select Nvl(Ventas_Ingresos,0)
        --   From   Pr.Tempfec
        --   Where  Nomarchivo             = P_Archivo_FUD
        --   And    Tipodocumentoidentidad = P_TIdper_FUD
        --   And    Documentoidentidad     = P_NumIdoer_FUD;



        v_codlab        NUMBER := 0;
        ---V_MIngresosp   NUMBER := 0;       --Excello:JPH:2020-03-18:REQ_ 108967
        vsqlerrm_char   VARCHAR2 (4000);
    BEGIN
        OPEN c_codlab;

        FETCH c_codlab INTO v_codlab;

        IF c_codlab%NOTFOUND
        THEN
            v_codlab := 1;
        END IF;

        CLOSE c_codlab;

        IF v_codlab > 1
        THEN
            UPDATE info_laboral
               SET empleo_actual = 'N'
             WHERE cod_per_fisica = p_persona;
        END IF;

        --Excello:JPH:2020-03-18:REQ_ 108967:Begin >>
        -- Ingresos de la persona  (Se buscan en TEMPFEC)---
        --        Open  C_MIngreso_Fec;
        --        Fetch C_MIngreso_Fec Into V_MIngresosp;
        --        If C_MIngreso_Fec%NotFound Then
        --            V_MIngresosp := 0;
        --        End If;
        --        Close C_MIngreso_Fec;
        --Excello:JPH:2020-03-18:REQ_ 108967:End <<

        -- Inserta  el registro --

        IF     p_persona IS NOT NULL                              --07-06-2024
           AND TO_CHAR (v_codlab) IS NOT NULL
           AND p_fec_ing IS NOT NULL
           AND p_lugar_lab IS NOT NULL
           AND p_sueldo IS NOT NULL ---V_MIngresosp,        --Excello:JPH:2020-03-18:REQ_ 108967
           AND p_puesto IS NOT NULL
        THEN
            ---COD_PER_FISICA, COD_LABORAL, FEC_INGRESO, LUGAR_TRABAJO, MONTO, PUESTO, TIPO_INGRESO, EMPLEO_ACTUAL
            INSERT INTO info_laboral (cod_per_fisica,
                                      cod_laboral,
                                      fec_ingreso,
                                      lugar_trabajo,
                                      monto,
                                      puesto,
                                      tipo_ingreso,
                                      empleo_actual,
                                      direccion,
                                      cod_area,
                                      num_telefono,
                                      extension_tel,
                                      cod_cargo)
                 VALUES (p_persona,
                         TO_CHAR (v_codlab),
                         p_fec_ing,
                         p_lugar_lab,
                         p_sueldo, ---V_MIngresosp,        --Excello:JPH:2020-03-18:REQ_ 108967
                         p_puesto,
                         'S',
                         'S',
                         p_direccion,
                         SUBSTR (p_telefono, 1, 3),
                         SUBSTR (p_telefono, 4),
                         SUBSTR (p_extension, 1, 4),
                         '50');

            p_procesado := 'S';
        END IF;
    EXCEPTION
        WHEN OTHERS
        THEN
            vsqlerrm_char := LTRIM (RTRIM (SQLERRM));
            p_msgerr :=
                   'Error procesando información laboral para Cod Persona  '
                || p_persona
                || ' Error : '
                || vsqlerrm_char;
            p_procesado := 'N';
    END;



    FUNCTION f_direccion_completa (pcod_pais_iso          VARCHAR2,
                                   pcod_canton            VARCHAR2,
                                   pcod_provincia         VARCHAR2,
                                   pcod_distrito          VARCHAR2,
                                   pcalle                 VARCHAR2,
                                   pincluyedespais        VARCHAR2,
                                   pincluyedesprovincia   VARCHAR2)
        RETURN VARCHAR2
    IS
        vdescpais             pais.pais%TYPE;
        vcodpais              pais.cod_pais%TYPE;

        v_desc_canton         VARCHAR2 (100);
        v_desc_distrito       VARCHAR2 (100);
        v_direccion_detalle   VARCHAR2 (300);
    BEGIN
        BEGIN
            SELECT pais, cod_pais
              INTO vdescpais, vcodpais
              FROM pais
             WHERE cod_pais_iso = pcod_pais_iso;
        EXCEPTION
            WHEN OTHERS
            THEN
                vcodpais := 1;
        END;

        --
        --        v_desc_canton :=
        --            LTRIM (
        --                pa.obt_desc_canton (vcodpais, Pcod_provincia, pcod_canton));

        BEGIN
            SELECT descripcion
              INTO v_desc_canton
              FROM pa.cantones
             WHERE     cod_pais = vcodpais
                   AND cod_canton = pcod_canton
                   AND ROWNUM = 1;
        EXCEPTION
            WHEN OTHERS
            THEN
                v_desc_canton := NULL;
        END;

        --
        --        v_desc_distrito :=
        --            pa.obt_desc_distrito (vcodpais,
        --                                  Pcod_provincia,
        --                                  Pcod_canton,
        --                                  Pcod_distrito);

        BEGIN
            SELECT descripcion
              INTO v_desc_distrito
              FROM distritos
             WHERE     cod_pais = vcodpais                          --pCodPais
                   --And   Cod_Provincia = pCodProvincia
                   AND cod_canton = pcod_canton
                   AND cod_distrito = pcod_distrito
                   AND ROWNUM = 1;
        EXCEPTION
            WHEN OTHERS
            THEN
                v_desc_distrito := NULL;
        END;

        v_direccion_detalle :=
               pcalle
            || CASE WHEN v_desc_canton IS NOT NULL THEN ', ' ELSE NULL END
            || v_desc_canton
            || CASE WHEN v_desc_distrito IS NOT NULL THEN ', ' ELSE NULL END
            || v_desc_distrito
            || CASE WHEN vdescpais IS NOT NULL THEN ', ' ELSE NULL END
            || vdescpais;



        RETURN v_direccion_detalle;
    END;

    PROCEDURE p_solicitud_cliente (
        vsolicitud         IN     pr.solicitud_credito_obj,
        pn_nocredito          OUT NUMBER,
        pc_task               OUT pa.tarea_list,
        errorcode          IN OUT VARCHAR2,
        errordescription   IN OUT VARCHAR2)
    IS
        vcod_persona         VARCHAR2 (15);
        verrores_solicitud   NUMBER;
    BEGIN
        --Validar solicitud
        verrores_solicitud := 0;

        BEGIN
            pvalida_solicitud (psolicitud   => vsolicitud,
                               perrores     => verrores_solicitud);



            IF verrores_solicitud > 0
            THEN
                errordescription :=
                       'Errores en el proceso de validación('
                    || verrores_solicitud
                    || '), '
                    || 'Solicitud NO Procesada..';
                RETURN;
            END IF;
        END;

        FOR i IN 1 .. vsolicitud.persona.COUNT
        LOOP
            vcod_persona := NULL;

            BEGIN
                p_procesar_persona (
                    ppersona           => vsolicitud.persona (i),
                    psolicitud         => vsolicitud.id_solicitud_credito,
                    --pCodigo_Moneda     => reg1.codigo_moneda,
                    pcod_oficial       => TO_NUMBER (vsolicitud.codigo_empleado),
                    pcodigo_agencia    =>
                        TO_NUMBER (vsolicitud.codigo_centro_costo /*CODIGO_BRANCH*/
                                                                 ),
                    psalario           =>
                          NVL (
                              vsolicitud.evaluaciones.ingresos_salariales.salario,
                              0)
                        + NVL (
                              vsolicitud.evaluaciones.ingresos_salariales.otros_ingresos,
                              0),                      ---malmanzar 05-02-2024
                    pcod_persona       => vcod_persona,
                    errorcode          => errorcode,
                    errordescription   => errordescription);
            END;
        ---p_depura('Linea: ' || $$plsql_line || ' vCod_Persona: ' || vcod_persona || ' ERRORCODE: ' || errorcode || ' ERRORDESCRIPTION: ' || errordescription);
        --Identificaciones Persona
        END LOOP;

        FOR fl IN 1 .. vsolicitud.vinculacion_finaciera.COUNT
        LOOP                               ---vSolicitud.VINCULACION_FINACIERA
            --            p_depura (
            --                   'FinanciallyLinked.FinanciallyLinkedCode = '
            --                || vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan
            --                || ' Linea: '
            --                || $$plsql_line);
            --
            --            p_depura (
            --                   '==============FinanciallyLinked.Persons==============Linea: '
            --                || $$plsql_line);

            FOR i
                IN 1 .. vsolicitud.vinculacion_finaciera (fl).personas.COUNT
            LOOP --Personas        ---vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS
                --                p_depura (
                --                       'FinanciallyLinked.FinanciallyLinkedCode = Linea: '
                --                    || $$plsql_line);

                --Procesar Persona Begin
                BEGIN
                    ---vTipo_Solicitante := NULL;
                    --- p_depura('vSolicitud.VINCULACION_FINACIERA (fl).CODIGO_VINCULACION_FINAN: ' || vsolicitud.vinculacion_finaciera(fl).codigo_vinculacion_finan);

                    vcod_persona := NULL;

                    p_procesar_persona (
                        ppersona           =>
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i),
                        psolicitud         => vsolicitud.id_solicitud_credito,
                        ---pCodigo_Moneda     => vMoneda_Credito,
                        pcod_oficial       =>
                            TO_NUMBER (vsolicitud.codigo_empleado),
                        pcodigo_agencia    =>
                            TO_NUMBER (vsolicitud.codigo_centro_costo /*vSolicitud.CODIGO_BRANCH*/
                                                                     ),
                        psalario           =>
                              NVL (
                                  vsolicitud.vinculacion_finaciera (fl).personas (
                                      i).evaluaciones.ingresos_salariales.salario,
                                  0)
                            + NVL (
                                  vsolicitud.vinculacion_finaciera (fl).personas (
                                      i).evaluaciones.ingresos_salariales.otros_ingresos,
                                  0),
                        --pTipo_Solicitante      => vTipo_solicitante,
                        pcod_persona       => vcod_persona,
                        errorcode          => errorcode,
                        errordescription   => errordescription);
                END;
            END LOOP;   ---vsolicitud.vinculacion_finaciera(fl).personas.count
        END LOOP;                     --vsolicitud.vinculacion_finaciera.count
    END p_solicitud_cliente;

    PROCEDURE obt_cod_persona (ppersona       IN     pr.persona_cr_obj,
                               pcod_persona      OUT VARCHAR2,
                               pnum_id           OUT VARCHAR2)
    IS
        vcod_persona              VARCHAR2 (15);
        vtipodocumentoidentidad   VARCHAR2 (5);
        vnumidformat              VARCHAR2 (30);
    BEGIN
        FOR x IN 1 .. ppersona.identificaciones.COUNT
        LOOP
            vtipodocumentoidentidad := NULL;                      --04-08-2022

            vtipodocumentoidentidad :=
                f_tipoid_pda_core (
                    ptipo_id_pda   =>
                        ppersona.identificaciones (x).cod_tipo_id --ptipodocumentoidentidad
                                                                 ); --malmanzar 09-06-2022

            vnumidformat :=
                pa.formatear_identifi (ppersona.identificaciones (x).num_id, --(pnumdocumentoidentidad,
                                       vtipodocumentoidentidad); -- ptipodocumentoidentidad  03-03-2023

            p_busca_id_persona (pcod_tipo_id   => vtipodocumentoidentidad, --ppersona.identificaciones (x).cod_tipo_id,
                                pnum_id        => vnumidformat, --ppersona.identificaciones (x).num_id,
                                pcod_persona   => vcod_persona);
        END LOOP;

        pcod_persona := vcod_persona;
        pnum_id := vnumidformat;
    END;

    PROCEDURE p_solicitud_credito (
        vsolicitud         IN     pr.solicitud_credito_obj,
        pn_nocredito          OUT NUMBER,
        pc_task               OUT pa.tarea_list,
        errorcode          IN OUT VARCHAR2,
        errordescription   IN OUT VARCHAR2)
    IS
        reg1                        pr_credito.t_rec_pr_creditos;
        vcod_persona                VARCHAR2 (15);
        p_codempresa                NUMBER := 1;
        v_pr_pr_tipo_credito_list   pr_pkg_utl.t_pr_tipo_credito_list
            := pr_pkg_utl.t_pr_tipo_credito_list ();
        --
        vplazo_minimo               pr_tipo_credito.plazo_minimo%TYPE;
        vplazo_maximo               pr_tipo_credito.plazo_maximo%TYPE;
        vmonto_minimo               pr_tipo_credito.monto_minimo%TYPE;
        vmonto_maximo               pr_tipo_credito.monto_maximo%TYPE;
        vvariacion_base             pr_tipo_credito.variacion_base%TYPE;
        --
        vporcentaje                 valores_de_tasas_de_interes.porcentaje%TYPE;
        vvariacion_min              tipos_de_tasas_de_interes.variacion_min%TYPE;
        vvariacion_max              tipos_de_tasas_de_interes.variacion_max%TYPE;

        v_credito_anula             NUMBER (5);

        --        V_Pa_Empleados_List         pa_pkg_utl.t_Pa_Empleados_List
        --                                        := pa_pkg_utl.t_Pa_Empleados_List ();

        v_error                     VARCHAR2 (500);

        v_desc_plan_inversion       VARCHAR2 (500);
        v_desc_ejecutivo            VARCHAR2 (500);
        v_desc_actividad            VARCHAR2 (500);
        v_agencia_labora            VARCHAR2 (100);
        p_mensajeerror              VARCHAR2 (500);
        p_nrocredito                pr_creditos.no_credito%TYPE;
        vtasks                      pa.tarea_list := pa.tarea_list ();
        --Out
        vestadofec                  VARCHAR2 (30);            --- Out varchar2
        vmensajefec                 VARCHAR2 (3000);          -- OUT VARCHAR2,
        ---        vNoSolicitud                NUMBER (15);                 -- OUT NUMBER
        ----vTipo_Solicitante                   PERSONAS_FISICAS.TIPO_PERSONA%TYPE;

        verrores_solicitud          NUMBER;                          --- := 0;

        v_telefono_info_laboral     VARCHAR2 (20);
        v_email__info_laboral       VARCHAR2 (100);
        v_direccion_detalle         info_laboral.direccion%TYPE;
        vdescpais                   pais.pais%TYPE;
        vcodpais                    pais.cod_pais%TYPE;
        v_procesado                 VARCHAR2 (100);
        p_msgerr                    VARCHAR2 (500);
        v_num_id                    VARCHAR2 (15);
    BEGIN
        --Validar solicitud
        verrores_solicitud := 0;

        BEGIN
            pvalida_solicitud (psolicitud   => vsolicitud,
                               perrores     => verrores_solicitud);


            --            p_depura (
            --                   'vErrores_Solicitud = '
            --                || verrores_solicitud
            --                || ' Line: '
            --                || $$plsql_line);

            IF verrores_solicitud > 0
            THEN
                errordescription :=
                       'Errores en el proceso de validación('
                    || verrores_solicitud
                    || '), '
                    || 'Solicitud NO Procesada..';
                RETURN;
            END IF;
        END;

        reg1.codigo_empresa := 1;
        reg1.codigo_agencia := TO_NUMBER (vsolicitud.codigo_centro_costo /*CODIGO_BRANCH*/
                                                                        );
        reg1.tipo_credito := vsolicitud.info_prestamo.codigo_proyecto;
        reg1.f_apertura :=
            fecha_actual_calendario ('PR', reg1.codigo_empresa, 50 --Para evitar error con envio centro empleados
                                                                  --reg1.codigo_agencia
                                                                  );
        reg1.plazo_segun_unidad := vsolicitud.info_prestamo.termino_prestamo;

        --        p_depura (
        --               'plazo_segun_unidad = '
        --            || reg1.plazo_segun_unidad
        --            || ' Linea: '
        --            || $$plsql_line);


        --        p_depura (
        --               'Linea: '
        --            || $$plsql_line
        --            || ' '
        --            || 'f_apertura = '
        --            || reg1.f_apertura
        --            || '  reg1.codigo_agencia '
        --            || reg1.codigo_agencia
        --            || ' TO_NUMBER (vSolicitud.CODIGO_CENTRO_COSTO: '
        --            || TO_NUMBER (vsolicitud.codigo_centro_costo));
        --        p_depura ('==============CreditRequest==============');
        --        p_depura ('Id = ' || vsolicitud.id_solicitud_credito);

        BEGIN
            v_pr_pr_tipo_credito_list :=
                ia.pr_pkg_utl.pr_tipo_credito_select (
                    pcodigo_empresa                 => p_codempresa,
                    ptipo_credito                   =>
                        TO_NUMBER (vsolicitud.info_prestamo.codigo_proyecto),
                    pdescripcion                    => NULL,
                    pcodigo_sub_aplicacion          => NULL,
                    pes_linea_credito               => NULL,
                    pcodigo_moneda                  => NULL,
                    pcodigo_plazo                   => NULL,
                    pcodigo_origen                  => NULL,
                    pmodalidad_cobro                => NULL,
                    ptiene_vencimiento              => NULL,
                    ptipo_intereses                 => NULL,
                    ptipo_calendario                => NULL,
                    ptipo_linea                     => NULL,
                    pmanejo                         => NULL,
                    pplazo_minimo                   => NULL,
                    pplazo_maximo                   => NULL,
                    pmonto_minimo                   => NULL,
                    pmonto_maximo                   => NULL,
                    ptipo_tasa                      => NULL,
                    pcodigo_tipo_de_tasa            => NULL,
                    pvariacion_base                 => NULL,
                    ptasa_interes                   => NULL,
                    pcodigo_tasa_moratorios         => NULL,
                    pvariacion_mora                 => NULL,
                    ptasa_moratorios                => NULL,
                    pgracia_principal               => NULL,
                    pgracia_mora                    => NULL,
                    pdias_atraso_cobro_jud          => NULL,
                    pcontinua_cobro_intereses       => NULL,
                    pcomision_normal                => NULL,
                    pcomision_normal_minima         => NULL,
                    pcomision_normal_maxima         => NULL,
                    pperiodo_comision_normal        => NULL,
                    prevaloriza                     => NULL,
                    paprobacion_con_garantia        => NULL,
                    padicionado_por                 => NULL,
                    pfecha_adicion                  => NULL,
                    pmodificado_por                 => NULL,
                    pfecha_modificacion             => NULL,
                    ptipo_comision                  => NULL,
                    ptipo_mora                      => NULL,
                    pporcentaje_tasa_mora           => NULL,
                    pmax_dias_vencido_cobro         => NULL,
                    ppermite_sobregiro              => NULL,
                    pporcentaje_sobregiro           => NULL,
                    pcargo_comision                 => NULL,
                    pcargo_poliza                   => NULL,
                    pcodigo_corte                   => NULL,
                    pvariacion_minima               => NULL,
                    pvariacion_maxima               => NULL,
                    pperiodos_gracia_principal      => NULL,
                    pcargo_comision_atrasada        => NULL,
                    pmnemonico                      => NULL,
                    pcargo_cobro_administrativo     => NULL,
                    pcobra_comision_atrasada        => NULL,
                    pcobra_cobro_administrativo     => NULL,
                    pdias_atraso_cobro_admin        => NULL,
                    pbase_calculo_moratorios        => NULL,
                    pcomision_sobre_saldos          => NULL,
                    psaldos_teoricos                => NULL,
                    pcargo_iva                      => NULL,
                    pcobra_saldo_no_utilizado       => NULL,
                    pcargo_saldo_no_utilizado       => NULL,
                    pcomision_genera_iva            => NULL,
                    pcobra_intereses_dia_pago       => NULL,
                    pcargo_interes_prorrogado       => NULL,
                    pcargo_moratorio_prorrogado     => NULL,
                    pcargo_comision_prorrogada      => NULL,
                    ptipo_calculo_mora              => NULL,
                    pcargo_mora_flat                => NULL,
                    pdia_pago                       => NULL,
                    ptipo_cartera                   => NULL,
                    pdias_atraso_en_vigente         => NULL,
                    pes_pre_aprobado                => NULL,
                    pvigencia_solicitud             => NULL,
                    pcobro_aut_poliza               => NULL,
                    pes_cuota_multiple              => NULL,
                    ptipo_credito_hijos             => NULL,
                    pdescuentainteresesdesembolso   => NULL,
                    pcantidad_cuotas_descontar      => NULL,
                    pind_poliza_bco                 => NULL,
                    pind_pr_vehiculo                => NULL,
                    pmax_porc_extraordinario        => NULL,
                    pcon_garantia_certificado       => NULL,
                    pporcentaje_pignoracion_cd      => NULL,
                    poficial_autorizado             => NULL,
                    pgrupo_tipo_credito             => NULL,
                    ptipo_de_persona                => NULL,
                    pllamada_atraso                 => NULL,
                    pind_es_reserva                 => NULL,
                    pind_credito_universitario      => NULL,
                    pind_micro_credito              => NULL,
                    plimite_tolerable_ea            => NULL,
                    plimite_tolerable_lc            => NULL,
                    plimite_tolerable_gf            => NULL,
                    plimite_tolerable_cp            => NULL,
                    pfacilidad_creditic             => NULL,
                    pind_cobra_mora                 => NULL,
                    pestado                         => NULL,
                    ptipo_cuota                     => NULL,
                    pmultiples_desembolsos          => NULL,
                    pdesembolso_pactado             => NULL,
                    pgracia_mora_principal          => NULL,
                    errorcode                       => errorcode,
                    errordescription                => errordescription);

            --            p_depura (
            --                   'Linea '
            --                || $$plsql_line
            --                || ' Program Unit = '
            --                || $$plsql_unit);

            IF v_pr_pr_tipo_credito_list.COUNT = 0
            THEN
                errorcode := '45-' || errorcode;
                errordescription :=
                       errordescription
                    || '-Tipo de credito '
                    || vsolicitud.info_prestamo.codigo_proyecto
                    || ' no encontrado';
                ROLLBACK;
                RETURN;
            ELSE
                FOR i IN 1 .. v_pr_pr_tipo_credito_list.COUNT
                LOOP
                    reg1.codigo_moneda :=
                        v_pr_pr_tipo_credito_list (i).codigo_moneda;
                    reg1.tipo_credito :=
                        v_pr_pr_tipo_credito_list (i).tipo_credito;
                    reg1.es_linea_credito :=
                        v_pr_pr_tipo_credito_list (i).es_linea_credito;
                    reg1.tipo_linea :=
                        v_pr_pr_tipo_credito_list (i).tipo_linea;
                    reg1.manejo := v_pr_pr_tipo_credito_list (i).manejo;
                    reg1.modalidad_cobro :=
                        v_pr_pr_tipo_credito_list (i).modalidad_cobro;
                    reg1.tipo_intereses :=
                        v_pr_pr_tipo_credito_list (i).tipo_intereses;
                    reg1.tipo_calendario :=
                        v_pr_pr_tipo_credito_list (i).tipo_calendario;
                    reg1.periodo_comision_normal :=
                        v_pr_pr_tipo_credito_list (i).periodo_comision_normal;
                    reg1.comision_normal :=
                        v_pr_pr_tipo_credito_list (i).comision_normal;
                    reg1.tipo_tasa := v_pr_pr_tipo_credito_list (i).tipo_tasa;
                    reg1.codigo_tipo_de_tasa :=
                        v_pr_pr_tipo_credito_list (i).codigo_tipo_de_tasa;
                    reg1.variacion_base :=
                        v_pr_pr_tipo_credito_list (i).variacion_base;
                    reg1.tasa_interes :=
                        v_pr_pr_tipo_credito_list (i).tasa_interes;
                    reg1.codigo_tasa_moratorios :=
                        v_pr_pr_tipo_credito_list (i).codigo_tasa_moratorios;
                    reg1.variacion_mora :=
                        v_pr_pr_tipo_credito_list (i).variacion_mora;
                    reg1.tasa_moratorios :=
                        v_pr_pr_tipo_credito_list (i).tasa_moratorios;
                    reg1.gracia_principal :=
                        v_pr_pr_tipo_credito_list (i).gracia_principal;
                    reg1.gracia_mora :=
                        v_pr_pr_tipo_credito_list (i).gracia_mora;
                    reg1.codigo_origen :=
                        v_pr_pr_tipo_credito_list (i).codigo_origen;
                    reg1.continua_cobro_intereses :=
                        v_pr_pr_tipo_credito_list (i).continua_cobro_intereses;
                    reg1.dia_pago := v_pr_pr_tipo_credito_list (i).dia_pago;
                    reg1.revaloriza :=
                        v_pr_pr_tipo_credito_list (i).revaloriza;
                    reg1.codigo_sub_aplicacion :=
                        v_pr_pr_tipo_credito_list (i).codigo_sub_aplicacion;
                    reg1.tipo_comision :=
                        v_pr_pr_tipo_credito_list (i).tipo_comision;
                    reg1.tipo_mora := v_pr_pr_tipo_credito_list (i).tipo_mora;
                    reg1.porcentaje_tasa_mora :=
                        v_pr_pr_tipo_credito_list (i).porcentaje_tasa_mora;
                    -- reg1.codigo_plazo,
                    reg1.permite_sobregiro :=
                        v_pr_pr_tipo_credito_list (i).permite_sobregiro;
                    reg1.porcentaje_sobregiro :=
                        v_pr_pr_tipo_credito_list (i).porcentaje_sobregiro;
                    reg1.variacion_minima :=
                        v_pr_pr_tipo_credito_list (i).variacion_minima;
                    reg1.variacion_maxima :=
                        v_pr_pr_tipo_credito_list (i).variacion_maxima;
                    reg1.periodos_gracia_principal :=
                        v_pr_pr_tipo_credito_list (i).periodos_gracia_principal;
                    reg1.base_calculo_moratorios :=
                        v_pr_pr_tipo_credito_list (i).base_calculo_moratorios;
                    reg1.descuenta_intereses_desembolso :=
                        v_pr_pr_tipo_credito_list (i).descuenta_intereses_desembolso;
                    reg1.cantidad_cuotas_descontar :=
                        v_pr_pr_tipo_credito_list (i).cantidad_cuotas_descontar;
                    reg1.ind_pr_vehiculo :=
                        v_pr_pr_tipo_credito_list (i).ind_pr_vehiculo;
                    -- reg1.dias_periodo_cuota,
                    -- reg1.plazo,
                    reg1.tipo_desembolso := 'C'; ---V_Pr_Pr_Tipo_Credito_List(i).tipo_desembolso;
                    reg1.codigo_actividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_actividad;
                    reg1.codigo_subactividad := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_subactividad;
                    reg1.codigo_sub_clase := 0; --V_Pr_Pr_Tipo_Credito_List(i).codigo_sub_clase;
                    reg1.codigo_plazo :=
                        v_pr_pr_tipo_credito_list (i).codigo_plazo;
                    vplazo_minimo :=
                        v_pr_pr_tipo_credito_list (i).plazo_minimo;
                    vplazo_maximo :=
                        v_pr_pr_tipo_credito_list (i).plazo_maximo;
                    vmonto_minimo :=
                        v_pr_pr_tipo_credito_list (i).monto_minimo;
                    vmonto_maximo :=
                        v_pr_pr_tipo_credito_list (i).monto_maximo;
                    vvariacion_base :=
                        v_pr_pr_tipo_credito_list (i).variacion_base;
                END LOOP;
            END IF;
        END;


        ---Cliente
        FOR i IN 1 .. vsolicitud.persona.COUNT
        LOOP
            vcod_persona := NULL;
            --- vcod_persona := GetCodPersona (ppersona => vsolicitud.persona (i));


            obt_cod_persona (ppersona       => vsolicitud.persona (i),
                             pcod_persona   => vcod_persona,   --OUT VARCHAR2,
                             pnum_id        => v_num_id         --OUT VARCHAR2
                                                       );

            IF vcod_persona IS NULL
            THEN
                ROLLBACK;
                errorcode := '1001';
                errordescription :=
                    '1001-Error procesando persona: ' || v_num_id;
                raise_application_error (num   => -20000,
                                         msg   => errordescription);
            END IF;
        END LOOP;                                  ---vsolicitud.persona.COUNT

        reg1.codigo_cliente := (vcod_persona);

        ---End Cliente

        --Paste End   18-01-2024
        --malmanzar 17-02-2022 reactiva codigo comentado    2019
        BEGIN
            ---malmanzar 09-06-2022
            reg1.codigo_periodo_cuota :=
                f_periodicidad_pda_core (
                    TO_NUMBER (
                        SUBSTR (
                            vsolicitud.info_prestamo.codigo_frecuencia_pago,
                            1,
                            2)));
        END;

        reg1.plazo :=
              pr_proyeccion.my_add_month (
                  reg1.f_apertura,                               /*pplazocal*/
                  vsolicitud.info_prestamo.termino_prestamo)
            - reg1.f_apertura;
        --        p_depura (
        --               ' crear fud Linea '
        --            || $$plsql_line
        --            || ' vSolicitud.INFO_PRESTAMO.TERMINO_PRESTAMO: '
        --            || vsolicitud.info_prestamo.termino_prestamo);
        --        p_depura (
        --               ' crear fud Linea '
        --            || $$plsql_line
        --            || ' eg1.f_apertura: '
        --            || reg1.f_apertura
        --            || ' reg1.plazo: '
        --            || reg1.plazo);
        --        p_depura (
        --            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);



        --        p_depura (
        --            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        reg1.estado := 'R';
        reg1.tipo_cuota := 'N';

        BEGIN
            SELECT codigo_plazo
              INTO reg1.codigo_plazo
              FROM pr_tipos_plazos
             WHERE     codigo_plazo = reg1.codigo_plazo
                   AND reg1.plazo BETWEEN plazo_minimo AND plazo_maximo;
        --Between vPlazo_Minimo And vPlazo_Maximo;
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                v_error :=
                       'Revisar el campo Plazo: '
                    || reg1.plazo
                    || ' Codigo_Plazo '
                    || reg1.codigo_plazo
                    || ' '
                    || $$plsql_unit
                    || ' $$PLSQL_LINE = '
                    || $$plsql_line
                    || ' Sqlerrm '
                    || SQLERRM;


                errorcode := '46';
                errordescription := v_error;

                p_depura ('errorCode ' || errorcode || ': ' || v_error);
                ROLLBACK;
                RETURN;
        END;

        --
        --        p_depura (
        --            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        reg1.f_vencimiento := reg1.f_apertura + reg1.plazo;
        --
        reg1.monto_credito := vsolicitud.info_prestamo.monto_credito; --pmontocal;

        --        p_depura (' crear fud Linea ' || $$plsql_line);

        IF reg1.monto_credito NOT BETWEEN vmonto_minimo AND vmonto_maximo
        THEN
            v_error := --'p_mensajeerror = Revisar el campo : Monto del Credito Solicitado, no se encuentra dentro de los rangos minimo y maximo del codigo de proyecto asignado ';
                   ' reg1.monto_credito '
                || TO_CHAR (reg1.monto_credito)
                || ' vmonto_minimo '
                || TO_CHAR (vmonto_minimo)
                || ' vmonto_maximo '
                || TO_CHAR (vmonto_maximo);
            errorcode := '47';
            errordescription := v_error;
            ROLLBACK;
            RETURN;
        END IF;

        BEGIN
            reg1.cuota := TO_NUMBER (                    /*pcuotaprestamocal*/
                                     vsolicitud.info_prestamo.cuota_fija);
        EXCEPTION
            WHEN OTHERS
            THEN
                v_error :=
                    'El valor del campo cuota no esta siendo enviado en el formato correcto.';
                errorcode := '48';
                errordescription := v_error;
                ROLLBACK;
                RETURN;
        END;

        --        p_depura (
        --            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        --        p_depura (
        --               ' crear fud Linea '
        --            || $$plsql_line
        --            || ' vSolicitud.CODIGO_EMPLEADO: '
        --            || vsolicitud.codigo_empleado);

        -- p_depura( 'valida :new.CUOTAPRESTAMOCAL ' || :New.cuotaprestamocal || ' ' || reg1.cuota );
        reg1.codigo_analista := vsolicitud.codigo_empleado;     -- pidoficial;

        --        p_depura (
        --            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);

        --10-07-2019 Begin
        BEGIN
            SELECT b.porcentaje, a.variacion_min, a.variacion_max
              INTO vporcentaje, vvariacion_min, vvariacion_max
              /* into :BKCredit.Desc_TASA_INTERES_BASE, :BKCredit.Desc_valor_tasa_corrientes,
              :BKCredit.variacion_min_interes, :BKCredit.variacion_max_interes*/
              FROM tipos_de_tasas_de_interes a, valores_de_tasas_de_interes b
             WHERE     a.codigo_tipo_de_tasa = b.codigo_tipo_de_tasa
                   AND b.codigo_empresa = p_codempresa
                   AND a.codigo_tipo_de_tasa =
                       TO_NUMBER (reg1.codigo_tipo_de_tasa)
                   --To_number( :New.tipocal )--LMVR
                   AND b.fecha_inicio =
                       (SELECT MAX (fecha_inicio)
                          FROM valores_de_tasas_de_interes
                         WHERE     codigo_empresa = p_codempresa
                               AND codigo_tipo_de_tasa =
                                   a.codigo_tipo_de_tasa
                               AND fecha_inicio <= TRUNC (SYSDATE) /*pfecha_registro*/
                                                                  );
        -- p_depura( 'ejecuto tasa de interes?:' || Sqlerrm );
        EXCEPTION
            WHEN NO_DATA_FOUND
            THEN
                p_depura (' crear fud Linea ' || $$plsql_line);
                v_error :=
                    'no encontro registros, revisar campos : Validaci¿n de Tasa de Interes';
                errorcode := '49';
                errordescription := v_error;
                ROLLBACK;
                RETURN;
            WHEN OTHERS
            THEN
                -- p_depura( 'others tasa de interes:' || Sqlerrm );
                v_error :=
                       'p_mensajeerror = revisar campos para consulta de tipos de tasas de interes '
                    || SQLERRM;
                p_depura (
                       'Linea '
                    || $$plsql_line
                    || ' Program Unit = '
                    || $$plsql_unit
                    || ' v_error: '
                    || v_error);
        END;

        --        p_depura (
        --            'Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);
        reg1.variacion_base :=                                    /*ptasacal*/
                               vsolicitud.info_prestamo.tasa - (vporcentaje);
        ---- p_depura('salio de validaciones 2 '||sqlerrm);
        reg1.tasa_interes := vsolicitud.info_prestamo.tasa;        --ptasacal;
        ---p_depura ('Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit||' reg1.codigo_cliente: '||reg1.codigo_cliente);

        --    IF  reg1.codigo_cliente is not null THEN
        reg1.segregacion_rd := get_ciuu (reg1.codigo_cliente); --pidrama_ciiu;
        --   IF  reg1.segregacion_rd is not null THEN
        --     ROLLBACK;
        --       errorDescription := 'Error al procesar persona';
        -- RETURN;
        ---END IF;
        ---- errorDescription := 'Error al procesar persona';
        --  RETURN;
        ---END IF;
        ---p_depura ('Linea ' || $$PLSQL_LINE || ' Program Unit = ' || $$plsql_unit);

        --a begin
        pr_credito.obtiene_planinversion (p_codempresa,
                                          'ESPA',
                                          reg1.plan_inversion,
                                          v_desc_plan_inversion);
        --        p_depura (
        --            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);
        pr_credito.busca_extras_cliente (p_codempresa,
                                         reg1.codigo_actividad,
                                         reg1.codigo_cliente, --:New.idaperturacliente,--LMVR
                                         v_desc_ejecutivo,
                                         v_desc_ejecutivo,
                                         v_desc_actividad,
                                         v_agencia_labora,
                                         --FAMH --- 22-04-2005 PROBLEMA CON LA AGENCIA
                                         reg1,
                                         'ESPA');

        --        p_depura (
        --            'Linea ' || $$plsql_line || ' Program Unit = ' || $$plsql_unit);

        --
        -----------------------------------------------------------------------------
        -- JMoraM   02/08/2016
        -- Se valida si hay un cr¿dito en estado Registrado,
        -- Se anula los que est¿n para que cree el nuevo.
        -----------------------------------------------------------------------------



        IF                                                       /*v_persona*/
           reg1.codigo_cliente IS NOT NULL
        THEN
            BEGIN
                SELECT COUNT (no_credito)
                  INTO v_credito_anula
                  FROM pr.pr_creditos
                 WHERE     codigo_empresa = 1
                       AND estado = 'R'
                       AND codigo_cliente = reg1.codigo_cliente;  --v_persona;
            EXCEPTION
                WHEN OTHERS
                THEN
                    v_credito_anula := 0;
            END;

            IF v_credito_anula > 0
            THEN
                BEGIN
                    FOR a
                        IN (SELECT no_credito
                              FROM pr_creditos
                             WHERE     codigo_empresa = 1
                                   AND estado = 'R'
                                   AND codigo_cliente = reg1.codigo_cliente --v_persona
                                                                           )
                    LOOP
                        anula_credito_at (a.no_credito);
                    END LOOP;
                EXCEPTION
                    WHEN OTHERS
                    THEN
                        v_error := 'Error Anulacion AT ' || SQLERRM;
                        errorcode := '50';
                        errordescription := v_error;
                        ROLLBACK;
                        RETURN;
                END;
            --LMVR
            ---  p_depura (' crear fud Linea ' || $$plsql_line);
            --
            END IF;
        --p_depura (' crear fud Linea ' || $$plsql_line);
        END IF;

        --a end
        --p_depura (' crear fud Linea ' || $$plsql_line);

        --b Begin
        DECLARE
            v_existe_credito   VARCHAR2 (1) := 'N';
        BEGIN
            --            BEGIN
            --                SELECT DISTINCT esta
            --                  INTO v_existe_credito
            --                  FROM (SELECT 'S'     esta
            --                          FROM pr_creditos
            --                         WHERE     codigo_empresa = 1
            --                               AND estado IN ('D',
            --                                              'V',
            --                                              'M',
            --                                              'E',
            --                                              'J',
            --                                              'C')
            --                               AND codigo_cliente = reg1.codigo_cliente --v_persona
            --                        UNION ALL
            --                        SELECT 'S'     esta
            --                          FROM pr_creditos_hi
            --                         WHERE     codigo_empresa = 1
            --                               AND estado = 'C'
            --                               AND codigo_cliente = reg1.codigo_cliente --v_persona
            --                                                                       );
            --            EXCEPTION
            --                WHEN OTHERS
            --                THEN
            --                    p_depura (' crear fud Linea ' || $$plsql_line);
            --                    v_existe_credito := 'N';
            --            END;

            --p_depura (' crear fud Linea ' || $$plsql_line);

            --            IF     v_existe_credito = 'S'
            --               AND INSTR (
            --                       param.parametro_x_empresa (1,
            --                                                  'TIPCRED_VAL_CLT_NEW',
            --                                                  'PR'),
            --                       /*pcodigoproyecto*/
            --                       TO_NUMBER (vSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO)) >
            --                   0
            --            THEN
            --                v_error :=
            --                       'El codigo de proyecto '
            --                    || TO_NUMBER (vSolicitud.INFO_PRESTAMO.CODIGO_PROYECTO) --pcodigoproyecto
            --                    || ' solo aplica para clientes nuevos.';
            --                errorCode := '51';
            --                errorDescription := v_error;
            --                p_depura (' crear fud Linea ' || $$plsql_line);
            --                ROLLBACK;
            --                RETURN;
            --            ELSE
            --- p_depura (' crear fud Linea ' || $$plsql_line);

            ---p_depura (' crear fud Linea ' || $$plsql_line);

            BEGIN
                pr_credito.inserta_credito (p_codempresa,
                                            reg1.codigo_agencia, --p_codagencia
                                            p_nrocredito,
                                            reg1,
                                            p_mensajeerror);

                pn_nocredito := p_nrocredito;
            --                    PR.PKG_PORTACREDIT2.AgregarTarea (
            --                        'pr_credito.inserta_credito',
            --                        'PR.PR_CREDITOS',
            --                        'No_Credito',
            --                        '200',
            --                        'Credito procesado exitosamente',
            --                        TO_CHAR (p_nrocredito));
            --                        p_depura (' crear fud Linea ' || $$plsql_line||' p_nrocredito: '||p_nrocredito);
            EXCEPTION
                WHEN OTHERS
                THEN
                    errorcode := '51.5';
                    errordescription :=
                           'Error pr_credito.inserta_credito sqlerrm '
                        || SQLERRM
                        || ' Linea '
                        || $$plsql_line
                        || ' p_mensajeerror '
                        || p_mensajeerror;
                    p_depura (
                           ' crear fud Linea '
                        || $$plsql_line
                        || ' errorDescription: '
                        || errordescription);
                    -- p_depura (errorDescription);
                    RETURN;                             --malmanzar 04-08-2022
            END;



            --            p_depura ('Proceso Fec principal Linea: ' || $$plsql_line);

            BEGIN
                IF p_nrocredito IS NOT NULL
                THEN
                    --Begin 14-05-2024

                    p_operaciones_realizar (
                        pcod_persona            => vcod_persona,
                        ptipo_producto          => 'PRESTAMOS',
                        pcod_moneda             => reg1.codigo_moneda, --vMoneda_Credito,--pTIPOMONEDA,             --'1',
                        pproposito              =>
                            vsolicitud.info_prestamo.destino_credito_especif, ---vFudRow.ESPECIFIQUEDESTINO,
                        pmonto_inicial          =>
                            vsolicitud.info_prestamo.monto_credito, --- pMONTOINICIAL,
                        pinstrumento_bancario   => 'EFECTIVO',
                        /*CASE
                            WHEN pFORMAOPERACION = '1' THEN 'EFECTIVO'
                            WHEN pFORMAOPERACION = '2' THEN 'CHEQUE'
                            WHEN pFORMAOPERACION = '3' THEN 'TRANSFERENCIA'
                        END,*/
                        porigen_fondos          =>
                            vsolicitud.evaluaciones.estado_resultado.origen_recursos, -- 'SALARIO' -- pORIGENRECURSOS 14-05-2024
                        pno_credito             => p_nrocredito);
                    --End 14-05-2024



                    --New Fec Persona Begin
                    pcreafecpersona (
                        p_solicitud                      => reg1.no_credito,
                        p_codcliente                     => reg1.codigo_cliente,
                        p_codagencia                     => reg1.codigo_agencia, -- IN NUMBER,
                        ptipo_solicitante                => '01', --vTipo_Solicitante, ---Temp
                        --P_cuotasegurocal,
                        ----              monedacal,
                        p_destinocredito                 =>
                            vsolicitud.info_prestamo.destino_credito, -----Temp IN VARCHAR2 ,
                        p_especifiquedestino             =>
                            vsolicitud.info_prestamo.destino_credito_especif, --Temp--IN VARCHAR2,
                        pidtempfec                       => 0, --IN OUT NUMBER,
                        pnomarchivo                      => '0', --IN OUT VARCHAR2,
                        pidevaluacioncrediticia          => '0', --IN OUT VARCHAR2,
                        ptipodocumentoidentidad          => '0', --IN OUT VARCHAR2,
                        pdocumentoidentidad              => '0', --IN OUT VARCHAR2,
                        pnombrecliente                   => '0', --IN OUT VARCHAR2,
                        pnumerosolicitud                 => p_nrocredito, --IN OUT NUMBER,
                        pmontorecomendado                => reg1.monto_credito, --IN OUT NUMBER,
                        pfrecuencia                      =>
                            vsolicitud.info_prestamo.codigo_frecuencia_pago,
                        --vSolicitud.INFO_PRESTAMO.CODIGO_FRECUENCIA_PAGO, --IN OUT VARCHAR2, --malmanzar 14-07-222
                        pplazo                           => reg1.plazo, --IN OUT NUMBER,
                        ppro1ventasmensuales             => 0, --IN OUT NUMBER,
                        ppro2ventasmensuales             => 0, --IN OUT NUMBER,
                        ppro3ventasmensuales             => 0, --IN OUT NUMBER,
                        pprootroventasmensuales          => 0, --IN OUT NUMBER,
                        pventasmensuales1                => 0, --IN OUT NUMBER,
                        pventasmensuales2                => 0, --IN OUT NUMBER,
                        pventasmensuales3                => 0, --IN OUT NUMBER,
                        pventasmensuales4                => 0, --IN OUT NUMBER,
                        pventasmensuales5                => 0, --IN OUT NUMBER,
                        pventasmensuales6                => 0, --IN OUT NUMBER,
                        pventasmensuales7                => 0, --IN OUT NUMBER,
                        pventasmensuales8                => 0, --IN OUT NUMBER,
                        pventasmensualesot               => 0, --IN OUT NUMBER,
                        pventas_ingresos                 =>
                            NVL (
                                vsolicitud.evaluaciones.ingresos_salariales.salario,
                                vsolicitud.evaluaciones.estado_resultado.ingresos_por_ventas), --  30-01-2024   TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                        ---vSolicitud.EVALUACIONES.ESTADO_RESULTADO.INGRESOS_POR_VENTAS
                        ppro1costosventasmensuales       => 0, --IN OUT NUMBER,
                        ppro2costosventasmensuales       => 0, --IN OUT NUMBER,
                        ppro3costosventasmensuales       => 0, --IN OUT NUMBER,
                        pprootrocostosventasmensuales    => 0, --IN OUT NUMBER,
                        pcostoventas1                    => 0, --IN OUT NUMBER,
                        pcostoventas2                    => 0, --IN OUT NUMBER,
                        pcostoventas3                    => 0, --IN OUT NUMBER,
                        pcostoventas4                    => 0, --IN OUT NUMBER,
                        pcostoventas5                    => 0, --IN OUT NUMBER,
                        pcostoventas6                    => 0, --IN OUT NUMBER,
                        pcostoventas7                    => 0, --IN OUT NUMBER,
                        pcostoventas8                    => 0, --IN OUT NUMBER,
                        pcostoventasot                   => 0, --IN OUT NUMBER,
                        pcostoventas                     =>
                            vsolicitud.evaluaciones.estado_resultado.costo_ventas,
                        ---vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.TOTAL_COSTOS_OPERACIONAL, --    TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                        psueldo                          =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_salarial, --IN OUT NUMBER,
                        pservicio                        =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_servicios, --IN OUT NUMBER,
                        palquiler                        =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.pagos_renta, --IN OUT NUMBER, 22-01-2024 --Pendiente
                        ptransporte_combs                =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_combustible, --IN OUT NUMBER,
                        ppagointereses                   =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.gastos_interes_pagos, --IN OUT NUMBER,
                        potrosingresos_operacionales     =>
                            vsolicitud.evaluaciones.estado_resultado.otros_ingresos, --IN OUT NUMBER, 22-01-2024 --Pendiente
                        --Evaluacián Familiar
                        palimentacion                    =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_alimentacion, ---COSTOS_FAMILIARES.GASTOS_ALIMENTACION, --IN OUT NUMBER,
                        pvivienda                        =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_vivienda, --IN OUT NUMBER,
                        pvestido                         =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_ropa, --IN OUT NUMBER,
                        ptransporte                      =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_transportacion, --IN OUT NUMBER,
                        pservicios                       =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_servicios, --IN OUT NUMBER,
                        pmedicinas                       =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_medicos, --IN OUT NUMBER,
                        peducacion                       =>
                            vsolicitud.evaluaciones.gastos_del_hogar.gastos_educacion, --IN OUT NUMBER,
                        pdeudasfamiliares                =>
                            vsolicitud.evaluaciones.gastos_del_hogar.debitos, --IN OUT NUMBER,
                        potros_gastos                    =>
                            vsolicitud.evaluaciones.gastos_del_hogar.otros_gastos, --IN OUT NUMBER,
                        ptotalgastos_familiares          =>
                            vsolicitud.evaluaciones.gastos_del_hogar.total_gastos, --IN OUT NUMBER, --pendiente
                        pexcedentefamiliar               =>
                            vsolicitud.evaluaciones.gastos_del_hogar.excedente_familiar, --IN OUT NUMBER, --pendiente
                        potros                           =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.otros_gastos, -- 23-01-2024 ---malmanzar 27-09-2023 pendiente   vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.OTROS_INGRESOS, --IN OUT NUMBER,
                        ---Evaluación Comercial
                        pmaquinaria_mueblesequipos       =>
                            vsolicitud.evaluaciones.balance_comercial.maquinaria_mobiliario_eq, --IN OUT NUMBER,
                        pefectivo_cajabanco              =>
                            vsolicitud.evaluaciones.balance_comercial.efectivo_caja_chica, --IN OUT NUMBER,
                        pcuentaxcobrar                   =>
                            vsolicitud.evaluaciones.balance_comercial.cuentas_por_cobrar, --IN OUT NUMBER,
                        pinventario_prod_tem             =>
                            vsolicitud.evaluaciones.balance_comercial.inventario_producto_finalizado, --IN OUT NUMBER,
                        pinventario_prod_proc            =>
                            vsolicitud.evaluaciones.balance_comercial.inventario_producto_produccion, --IN OUT NUMBER,
                        pinventario_materiaprima         =>
                            vsolicitud.evaluaciones.balance_comercial.inventario_materia_prima, --IN OUT NUMBER,
                        pmercancia                       =>
                            vsolicitud.evaluaciones.balance_comercial.cantidad_mercancia, --IN OUT NUMBER,
                        panticipo_proveedores            =>
                            vsolicitud.evaluaciones.balance_comercial.cantidad_proveedor_anticipado, --IN OUT NUMBER,
                        plocalnegocio                    =>
                            vsolicitud.evaluaciones.balance_comercial.valor_local_comercial, --IN OUT NUMBER,
                        pobligacionesfinancieras         =>
                            vsolicitud.evaluaciones.balance_comercial.balance_oblicacion_financiera, --IN OUT NUMBER,
                        ptotal_pasivo_lp                 =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_largo_plazo, --IN OUT NUMBER,
                        pmueble_vehiculo                 =>
                            vsolicitud.evaluaciones.balance_familiar.valor_muebles_vehiculo, --IN OUT NUMBER,
                        pdeudacomercial                  =>
                            vsolicitud.evaluaciones.balance_familiar.deuda_comercial, --IN OUT NUMBER,
                        ptasa                            => reg1.tasa_interes, --IN OUT NUMBER,  --pendiente
                        pcuota                           => reg1.cuota, --IN OUT NUMBER,  --pendiente
                        pcuentapagarprovedor             =>
                            vsolicitud.evaluaciones.balance_comercial.cuenta_por_pagar_proveedor, --IN OUT NUMBER,
                        pcuentapagarvarias               =>
                            vsolicitud.evaluaciones.balance_comercial.cuenta_por_pagar_varios, --IN OUT NUMBER,
                        pinmuebles                       =>
                            vsolicitud.evaluaciones.balance_familiar.valor_propiedades, --IN OUT NUMBER,
                        ptotal_activofamiliar            =>
                            vsolicitud.evaluaciones.balance_familiar.total_activos_familiares, --IN OUT NUMBER,
                        pdeudabancaria                   =>
                            vsolicitud.evaluaciones.balance_familiar.deuda_bancaria, --IN OUT NUMBER,
                        ptotal_pasivofamiliar            =>
                            vsolicitud.evaluaciones.balance_familiar.tota_pasivos_familiar, --IN OUT NUMBER,
                        ppatrio_fam_balgen               =>
                            vsolicitud.evaluaciones.balance_familiar.total_patrimonio_familiar, --IN OUT NUMBER,   ---
                        ptotal_activocorriente           =>
                            vsolicitud.evaluaciones.balance_comercial.total_activos_corrientes, --IN OUT NUMBER,
                        ptotal_activofijo                =>
                            vsolicitud.evaluaciones.balance_comercial.total_activos_fijos, --IN OUT NUMBER,
                        ptotal_activos1                  =>
                            vsolicitud.evaluaciones.balance_comercial.total_activos, --IN OUT NUMBER,
                        ptotal_pasivocorrientes          =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_corriente, --IN OUT NUMBER,
                        ptotal_pasivo                    =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo, --IN OUT NUMBER,
                        ptotal_pasivopatrimonio          =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                        ppasivo_patrimonio               =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                        ppatrimonio                      =>
                            vsolicitud.evaluaciones.balance_comercial.patrimonio, --IN OUT NUMBER,
                        pactivocorte_pascte              => 0, --IN OUT NUMBER,
                        potrosingresos_excedente         => 0, --IN OUT NUMBER,
                        pcuotarecomendada_excedfam       => 0, --IN OUT NUMBER,
                        ptotalpasivo_patrimonio          =>
                            vsolicitud.evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                        putilidadneta_patrimonio         => 0, --IN OUT NUMBER,
                        putilidadneta_totalactivos1      => 0, --IN OUT NUMBER,
                        putilidadneta_ventas             => 0, --IN OUT NUMBER,
                        pcuentasxcobrar_ventas           => 0, --IN OUT NUMBER,
                        pcostoventa_inventario           => 0, --IN OUT NUMBER,
                        pgastoslegales                   => 0, --IN OUT NUMBER,    --
                        pmoneda                          => reg1.codigo_moneda, --IN OUT VARCHAR2,
                        pcapital_trabajo                 =>
                            vsolicitud.evaluaciones.balance_comercial.capital_de_trabajo, --IN OUT NUMBER,
                        pfechabalancegeneral             =>
                            vsolicitud.evaluaciones.balance_comercial.fecha_balance, --IN OUT VARCHAR2,
                        pdesde                           =>
                            vsolicitud.evaluaciones.estado_resultado.fecha_inicio_eval, --IN OUT VARCHAR2,
                        phasta                           =>
                            vsolicitud.evaluaciones.estado_resultado.fecha_fin_eval, ---FECHA_FIN_EVALUACION, --IN OUT VARCHAR2,
                        ptotalcostooperacional           =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.total_costos_operacional, --IN OUT NUMBER,
                        putilidadneta                    =>
                            vsolicitud.evaluaciones.costos_operacion_negocio.ganacia_neta, --IN OUT NUMBER,
                        pventasdiarias_promedio          =>
                            vsolicitud.evaluaciones.evaluacion_financiera.ventas_diarias_promedio, --IN OUT NUMBER,
                        pdiastrabajados                  =>
                            vsolicitud.evaluaciones.evaluacion_financiera.dias_trabajados_por_mes, --IN OUT NUMBER,
                        pcomprassemanalesdeclaradas      =>
                            vsolicitud.evaluaciones.evaluacion_financiera.compras_semanales_promedio, --IN OUT NUMBER,
                        pventasmensualesdeclaradas       =>
                            vsolicitud.evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --IN OUT NUMBER,
                        pmargendeclarado                 =>
                            vsolicitud.evaluaciones.evaluacion_financiera.margen_beneficio_declarado, --IN OUT NUMBER,
                        pmontomesalto                    =>
                            vsolicitud.evaluaciones.evaluacion_financiera.mayor_beneficio_mes, --MONTE_MES_MAS_GANANCIAS, --IN OUT NUMBER,
                        pmontomesmedio                   =>
                            vsolicitud.evaluaciones.evaluacion_financiera.beneficio_prom_mensual, --IN OUT NUMBER,
                        pcomprasmensualesdeclaradas      =>
                            vsolicitud.evaluaciones.evaluacion_financiera.compras_mensuales_declaradas, --IN OUT NUMBER,
                        pmontomesbajo                    =>
                            vsolicitud.evaluaciones.evaluacion_financiera.menor_beneficio_mes, --MONTO_MES_MENOS_GANANCIAS, --IN OUT NUMBER,
                        pventasmensuales                 =>
                            vsolicitud.evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                        pcostoventamensual               =>
                            vsolicitud.evaluaciones.estado_resultado.costo_ventas, --Pendiente 27-09-2023 vSolicitud.EVALUACIONES.TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                        putilidadbruta                   =>
                            vsolicitud.evaluaciones.estado_resultado.beneficio_ventas, --IN OUT NUMBER,
                        pmargenganancia                  =>
                            vsolicitud.evaluaciones.evaluacion_financiera.margen_beneficio_declarado, --MARGEN_GANANCIA, --IN OUT NUMBER,
                        pprimera_ref_vecinos             => '0', --IN OUT VARCHAR2,
                        psegunda_ref_vecinos             => '0', --IN OUT VARCHAR2,
                        pambientefamiliar                => '0', --IN OUT VARCHAR2,
                        pdependientes                    => 0, --IN OUT NUMBER,
                        pedad                            => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                        pestadosaludfamilia              => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                        pingresos                        =>
                            vsolicitud.evaluaciones.estado_resultado.ingresos_por_ventas, --IN OUT VARCHAR2, --Number  27-07-2022
                        potrosingresos                   =>
                            vsolicitud.evaluaciones.estado_resultado.otros_ingresos, --IN OUT VARCHAR2, --Number  27-07-2022
                        pexperiencia_neg                 =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.anio_experiencia_negocio, --IN OUT NUMBER, --malmanzar 27-07-2022
                        phoras_neg                       =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.horas_trabajo_por_semana, --IN OUT NUMBER,
                        plocalpropio                     =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.local_no_alquilado, --IN OUT VARCHAR2, --malmanzar 14-07-2022
                        ptiempoempleo                    =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.tiempo_lugar_negocio, --IN OUT NUMBER,
                        pubicacionnegocio                =>
                            vsolicitud.evaluaciones.evaluacion_no_financiera.codigo_ubicacion_negocio, --IN OUT VARCHAR2,
                        pllevaregistro                   => '0', --IN OUT VARCHAR2,
                        pmejorasnegocio                  => '0', --IN OUT VARCHAR2,
                        pclientesfrecuentes              => 0, --IN OUT NUMBER,
                        pnivelcompetencia                => '0', --IN OUT VARCHAR2, --malmanzar 14-07-2022
                        pfecha_balancegeneral_al         =>
                            vsolicitud.evaluaciones.balance_familiar.fecha_balance, --IN OUT VARCHAR2,
                        --                             IN=> 0, -- OUT
                        pdestinocredito                  =>
                            vsolicitud.info_prestamo.destino_credito, --IN OUT VARCHAR2,
                        pespecifiquedestino              =>
                            vsolicitud.info_prestamo.destino_credito_especif, --IN OUT VARCHAR2,
                        pestadosolicitud                 => 0, --IN OUT NUMBER,
                        pactividadeconomica              => '0', --IN OUT VARCHAR2,
                        pactividadeconomicadinrap        => '0', --IN OUT VARCHAR2,
                        pmargenbrutoestandar             => 0, --IN OUT NUMBER,
                        pgastosoperacionalesestandar     => 0, --IN OUT NUMBER,
                        palto_indicadores                => 0, --IN OUT NUMBER,
                        pbajo_indicadores                => 0, --IN OUT NUMBER,
                        plunes                           => '0', --IN OUT VARCHAR2,
                        pmartes                          => '0', --IN OUT VARCHAR2,
                        pmiercoles                       => '0', --IN OUT VARCHAR2,
                        pjueves                          => '0', --IN OUT VARCHAR2,
                        pviernes                         => '0', --IN OUT VARCHAR2,
                        psabado                          => '0', --IN OUT VARCHAR2,
                        pdomingo                         => '0', --IN OUT VARCHAR2,
                        ptotal_ventasaltas               => 0, --IN OUT NUMBER,
                        ptotal_ventasbajas               => 0, --IN OUT NUMBER,
                        ptotal_ventassemanales           => 0, --IN OUT NUMBER,
                        ptotal_ventasmensuales           => 0, --IN OUT NUMBER,
                        pmargenbrutodeclarado            => 0, --IN OUT NUMBER,
                        palimentacion_gastos             => 0, --IN OUT NUMBER,
                        pvivienda_gastos                 => 0, --IN OUT NUMBER,
                        peducacion_gastos                => 0, --IN OUT NUMBER,
                        psalud_gastos                    => 0, --IN OUT NUMBER,
                        ptransporte_gastos               => 0, --IN OUT NUMBER,
                        pvestido_gastos                  => 0, --IN OUT NUMBER,
                        ppagodeudas_gastos               => 0, --IN OUT NUMBER,
                        potros_gastos_familiares         => 0, --IN OUT NUMBER,
                        ptotal_gastos                    => 0, --IN OUT NUMBER,
                        pventas_gastos                   => 0, --IN OUT NUMBER,
                        pcostosventas_gastos             => 0, --IN OUT NUMBER,
                        pgastosoperativos                => 0, --IN OUT NUMBER,
                        potros_ingresos_gastos           => 0, --IN OUT NUMBER,
                        ptotal_gastos_familiares         => 0, --IN OUT NUMBER,
                        pexcedentefamiliar_gastos        => 0, --IN OUT NUMBER,
                        pcuotasolicitada                 => 0, --IN OUT NUMBER,
                        prelcuotasolicitada_excfam       => 0, --IN OUT NUMBER,
                        ---Datos Recom Soli
                        pmonto_recomendacion             => reg1.monto_credito, --IN OUT NUMBER,
                        pmoneda_recomendacion            => reg1.codigo_moneda, --IN OUT VARCHAR2,
                        pplazo_recomendacion             =>
                            reg1.plazo_segun_unidad,          --IN OUT NUMBER,
                        ptasa_recomendacion              => reg1.tasa_interes, --IN OUT NUMBER,
                        pfrecuencia_recomendacion        =>
                            vsolicitud.info_prestamo.codigo_frecuencia_pago, --reg1.codigo_periodo_cuota, --IN OUT VARCHAR2,
                        pcuota_recomendacion             => reg1.cuota, --IN OUT NUMBER,
                        pestadosolicitud_recomendacion   => 0, --IN OUT NUMBER,
                        pcuotarecomendada_excfamiliar    => 0, --IN OUT NUMBER,
                        pventasevalanterior              => 0, --IN OUT NUMBER,
                        pactual_ventas                   => 0, --IN OUT NUMBER,
                        pvariacionventas                 => 0, --IN OUT NUMBER,
                        pcomentario1                     => '0', --IN OUT VARCHAR2,
                        pcomentario2                     => '0', --IN OUT VARCHAR2,
                        ppro1nombre                      => '0', --IN OUT VARCHAR2,
                        ppro1materiaprima1               => 0, --IN OUT NUMBER,
                        ppro1materiaprima2               => 0, --IN OUT NUMBER,
                        ppro1materiaprima3               => 0, --IN OUT NUMBER,
                        ppro1totalmp                     => 0, --IN OUT NUMBER,
                        ppro1sueldo1                     => 0, --IN OUT NUMBER,
                        ppro1sueldo2                     => 0, --IN OUT NUMBER,
                        ppro1totalsueldo                 => 0, --IN OUT NUMBER,
                        ppro1otroscostos                 => 0, --IN OUT NUMBER,
                        ppro1totalcostos                 => 0, --IN OUT NUMBER,
                        ppro1costounitario               => 0, --IN OUT NUMBER,
                        ppro1preciounitario              => 0, --IN OUT NUMBER,
                        ppro1unidadesvendidas            => 0, --IN OUT NUMBER,
                        ppro1margenganancia              => 0, --IN OUT NUMBER,
                        ppro2nombre                      => '0', --IN OUT VARCHAR2,
                        ppro2materiaprima1               => 0, --IN OUT NUMBER,
                        ppro2materiaprima2               => 0, --IN OUT NUMBER,
                        ppro2materiaprima3               => 0, --IN OUT NUMBER,
                        ppro2totalmp                     => 0, --IN OUT NUMBER,
                        ppro2sueldo1                     => 0, --IN OUT NUMBER,
                        ppro2sueldo2                     => 0, --IN OUT NUMBER,
                        ppro2totalsueldo                 => 0, --IN OUT NUMBER,
                        ppro2otroscostos                 => 0, --IN OUT NUMBER,
                        ppro2totalcostos                 => 0, --IN OUT NUMBER,
                        ppro2costounitario               => 0, --IN OUT NUMBER,
                        ppro2preciounitario              => 0, --IN OUT NUMBER,
                        ppro2unidadesvendidas            => 0, --IN OUT NUMBER,
                        ppro2margenganancia              => 0, --IN OUT NUMBER,
                        ppro3nombre                      => '0', --IN OUT VARCHAR2,
                        ppro3materiaprima1               => 0, --IN OUT NUMBER,
                        ppro3materiaprima2               => 0, --IN OUT NUMBER,
                        ppro3materiaprima3               => 0, --IN OUT NUMBER,
                        ppro3totalmp                     => 0, --IN OUT NUMBER,
                        ppro3sueldo1                     => 0, --IN OUT NUMBER,
                        ppro3sueldo2                     => 0, --IN OUT NUMBER,
                        ppro3totalsueldo                 => 0, --IN OUT NUMBER,
                        ppro3otroscostos                 => 0, --IN OUT NUMBER,
                        ppro3totalcostos                 => 0, --IN OUT NUMBER,
                        ppro3costounitario               => 0, --IN OUT NUMBER,
                        ppro3preciounitario              => 0, --IN OUT NUMBER,
                        ppro3unidadesvendidas            => 0, --IN OUT NUMBER,
                        ppro3margenganancia              => 0, --IN OUT NUMBER,
                        pprootromateriaprima1            => 0, --IN OUT NUMBER,
                        pprootromateriaprima2            => 0, --IN OUT NUMBER,
                        pprootromateriaprima3            => 0, --IN OUT NUMBER,
                        pprootrototalmp                  => 0, --IN OUT NUMBER,
                        pprootrosueldo1                  => 0, --IN OUT NUMBER,
                        pprootrosueldo2                  => 0, --IN OUT NUMBER,
                        pprootrototalsueldo              => 0, --IN OUT NUMBER,
                        pprootrootroscostos              => 0, --IN OUT NUMBER,
                        pprootrototalcostos              => 0, --IN OUT NUMBER,
                        pprootrocostounitario            => 0, --IN OUT NUMBER,
                        pprootropreciounitario           => 0, --IN OUT NUMBER,
                        pprootrounidadesvendidas         => 0, --IN OUT NUMBER,
                        pprootromargenganancia           => 0, --IN OUT NUMBER,
                        plinea1                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario1                 => 0, --IN OUT NUMBER,
                        pcostounitario1                  => 0, --IN OUT NUMBER,
                        pmargendeganancia1               => 0, --IN OUT NUMBER,
                        punidadesvendidas1               => 0, --IN OUT NUMBER,
                        plinea2                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario2                 => 0, --IN OUT NUMBER,
                        pcostounitario2                  => 0, --IN OUT NUMBER,
                        pmargendeganancia2               => 0, --IN OUT NUMBER,
                        punidadesvendidas2               => 0, --IN OUT NUMBER,
                        plinea3                          => 0, --IN OUT VARCHAR2,
                        ppreciounitario3                 => 0, --IN OUT NUMBER,
                        pcostounitario3                  => 0, --IN OUT NUMBER,
                        pmargendeganancia3               => 0, --IN OUT NUMBER,
                        punidadesvendidas3               => 0, --IN OUT NUMBER,
                        plineaot                         => 0, --IN OUT VARCHAR2,
                        ppreciounitarioot                => 0, --IN OUT NUMBER,
                        pcostounitarioot                 => 0, --IN OUT NUMBER,
                        pmargendegananciaot              => 0, --IN OUT NUMBER,
                        punidadesvendidasot              => 0, --IN OUT NUMBER,
                        ptipocredito                     => '0', --IN OUT VARCHAR2,
                        pgarantias                       => '0', --IN OUT VARCHAR2,
                        pvalorgarantia                   => '0', --IN OUT VARCHAR2,
                        pdescripciongarantia             => '0', --IN OUT VARCHAR2,
                        pprestamodescontar               => '0', --IN OUT VARCHAR2,
                        plinea4                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario4                 => 0, --IN OUT NUMBER,
                        pcostounitario4                  => 0, --IN OUT NUMBER,
                        pmargendeganancia4               => 0, --IN OUT NUMBER,
                        punidadesvendidas4               => 0, --IN OUT NUMBER,
                        plinea5                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario5                 => 0, --IN OUT NUMBER,
                        pcostounitario5                  => 0, --IN OUT NUMBER,
                        pmargendeganancia5               => 0, --IN OUT NUMBER,
                        punidadesvendidas5               => 0, --IN OUT NUMBER,
                        plinea6                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario6                 => 0, --IN OUT NUMBER,
                        pcostounitario6                  => 0, --IN OUT NUMBER,
                        pmargendeganancia6               => 0, --IN OUT NUMBER,
                        punidadesvendidas6               => 0, --IN OUT NUMBER,
                        plinea7                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario7                 => 0, --IN OUT NUMBER,
                        pcostounitario7                  => 0, --IN OUT NUMBER,
                        pmargendeganancia7               => 0, --IN OUT NUMBER,
                        punidadesvendidas7               => 0, --IN OUT NUMBER,
                        plinea8                          => '0', --IN OUT VARCHAR2,
                        ppreciounitario8                 => 0, --IN OUT NUMBER,
                        pcostounitario8                  => 0, --IN OUT NUMBER,
                        pmargendeganancia8               => 0, --IN OUT NUMBER,
                        punidadesvendidas8               => 0, --IN OUT NUMBER,
                        pcomentario                      => '0', --IN OUT VARCHAR2,
                        pidoficial                       => '0', --IN OUT VARCHAR2,
                        pfecharegistro                   => SYSDATE, --IN OUT DATE,
                        pfechafija                       => '0', --IN OUT VARCHAR2,
                        pidestado                        => '0', --IN OUT VARCHAR2,
                        pmensaje                         => '0', --IN OUT VARCHAR2,
                        pnosubida                        => '0', --IN OUT VARCHAR2,
                        pidgrupo                         => '0', --IN OUT VARCHAR2,
                        pimpreso                         => '0', --IN OUT VARCHAR2,
                        /*Valores a retornar para elimina=> 0, --r uso Funci¿n fnupdatefud que ejecuta via WS
                           proceso debe implementarse en => 0, --el llamado de SQL/Server
                          */
                        pestadofec                       => vestadofec, --IN OUT VARCHAR2,
                        pmensajefec                      => vmensajefec --, --IN OUT VARCHAR2,
                                                                       --pNoSolicitud                     => vNoSolicitud --IN OUT NUMBER
                                                                       );
                --New Fec Persona End



                --                    p_depura (
                --                           'Proceso Fec principal Linea: '
                --                        || $$plsql_line
                --                        || ' NoCredito p_nrocredito: '
                --                        || p_nrocredito);
                END IF;
            EXCEPTION
                WHEN OTHERS
                THEN
                    --p_depura ('error ' || sqlerrm);
                    NULL;
            END;
        --  END IF;
        END;



        --b End
        --
        --**
        --C Begin.
        --        p_depura (
        --               '==============FinanciallyLinked============== Linea: '
        --            || $$plsql_line);

        FOR fl IN 1 .. vsolicitud.vinculacion_finaciera.COUNT
        LOOP                               ---vSolicitud.VINCULACION_FINACIERA
            --            p_depura (
            --                   'FinanciallyLinked.FinanciallyLinkedCode = '
            --                || vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan
            --                || ' Linea: '
            --                || $$plsql_line);
            --
            --            p_depura (
            --                   '==============FinanciallyLinked.Persons==============Linea: '
            --                || $$plsql_line);

            FOR i
                IN 1 .. vsolicitud.vinculacion_finaciera (fl).personas.COUNT
            LOOP --Personas        ---vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS
                --                p_depura (
                --                       'FinanciallyLinked.FinanciallyLinkedCode = Linea: '
                --                    || $$plsql_line);

                --Procesar Persona Begin
                BEGIN
                    ---vTipo_Solicitante := NULL;
                    --                    p_depura (
                    --                           'vSolicitud.VINCULACION_FINACIERA (fl).CODIGO_VINCULACION_FINAN: '
                    --                        || vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan);

                    vcod_persona := NULL;
                    v_num_id := NULL;
                    obt_cod_persona (
                        ppersona       =>
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i),
                        pcod_persona   => vcod_persona,        --OUT VARCHAR2,
                        pnum_id        => v_num_id              --OUT VARCHAR2
                                                  );

                    IF vcod_persona IS NULL
                    THEN
                        ROLLBACK;
                        errorcode := '2001';
                        errordescription :=
                            'Error procesando persona: ' || v_num_id;
                        raise_application_error (num   => -20000,
                                                 msg   => errordescription);
                    END IF;

                    --                    p_depura (
                    --                           'Despues p_procesar_persona: vCod_Persona'
                    --                        || vcod_persona
                    --                        || ' Linea: '
                    --                        || $$plsql_line
                    --                        || ' ERRORDESCRIPTION: '
                    --                        || errordescription);


                    ---malmanzar 18-01-2023 Begin

                    --                    p_depura (
                    --                           '2-ORIGEN_RECURSOS:'
                    --                        || vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.origen_recursos);


                    p_operaciones_realizar (
                        pcod_persona            => vcod_persona,
                        ptipo_producto          => 'PRESTAMOS',
                        pcod_moneda             => reg1.codigo_moneda, --vMoneda_Credito,--pTIPOMONEDA,             --'1',
                        pproposito              =>
                            vsolicitud.info_prestamo.destino_credito_especif, ---vFudRow.ESPECIFIQUEDESTINO,
                        pmonto_inicial          =>
                            vsolicitud.info_prestamo.monto_credito, --- pMONTOINICIAL,
                        pinstrumento_bancario   => 'EFECTIVO',
                        /*CASE
                            WHEN pFORMAOPERACION = '1' THEN 'EFECTIVO'
                            WHEN pFORMAOPERACION = '2' THEN 'CHEQUE'
                            WHEN pFORMAOPERACION = '3' THEN 'TRANSFERENCIA'
                        END,*/
                        porigen_fondos          =>
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i).evaluaciones.estado_resultado.origen_recursos, -- 'SALARIO' -- pORIGENRECURSOS  14-05-2024
                        pno_credito             => reg1.no_credito);

                    ---p_depura('vSolicitud.VINCULACION_FINACIERA (fl).CODIGO_VINCULACION_FINAN: ' || vsolicitud.vinculacion_finaciera(fl).codigo_vinculacion_finan);
                    ---DBMS_OUTPUT.PUT_LINE(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).EVALUACIONES.ESTADO_RESULTADO.ORIGEN_RECURSOS    );


                    IF errordescription IS NOT NULL
                    THEN
                        p_depura (
                               'Linea: '
                            || $$plsql_line
                            || ' vCod_Persona: '
                            || vcod_persona
                            || ' ERRORCODE: '
                            || errorcode
                            || ' ERRORDESCRIPTION: '
                            || errordescription);
                        ROLLBACK;
                        p_nrocredito := NULL;          ---malmanzar 09-10-2023
                        raise_application_error (num   => -20000,
                                                 msg   => errordescription);
                    ---raise;
                    END IF;
                --                    DBMS_OUTPUT.PUT_LINE (
                --                           'Person('
                --                        || i
                --                        || ').id = '
                --                        || vSolicitud.PERSONA (i).ID_PERSONA_CREDITO
                --                        || ' vCod_Persona: '
                --                        || vCod_Persona);
                --  DBMS_OUTPUT.PUT_LINE (
                ---  '==============IdentificationDocuments==============');
                END;

                --fl info_laboral Begin 26-01-2024
                FOR n
                    IN 1 ..
                       vsolicitud.vinculacion_finaciera (fl).personas (i).negocios.COUNT
                LOOP                                                --Negocios
                    --                    p_depura (
                    --                        vsolicitud.vinculacion_finaciera (fl).personas (i).negocios.COUNT);

                    FOR l
                        IN 1 ..
                           vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).localizadores.COUNT
                    LOOP                                       --Localizadores
                        --p_depura( vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (i).NEGOCIOS (n).LOCALIZADORES (l).TIPO_LOCALIZADOR);
                        --                        p_depura (
                        --                            vsolicitud.vinculacion_finaciera (fl).personas (
                        --                                i).negocios (n).localizadores.COUNT);

                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                             'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Locators('
                        --                            || l
                        --                            || ').locatorTypeCode   = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).LOCALIZADORES (l).TIPO_LOCALIZADOR);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Locators('
                        --                            || l
                        --                            || ').value             = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).LOCALIZADORES (l).VALOR);
                        --
                        IF vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).localizadores (l).tipo_localizador =
                           '01'
                        THEN
                            --                            --Teléfono
                            v_telefono_info_laboral :=
                                vsolicitud.vinculacion_finaciera (fl).personas (
                                    i).negocios (n).localizadores (l).valor;
                        --                        --Email
                        ELSIF vsolicitud.vinculacion_finaciera (fl).personas (
                                  i).negocios (n).localizadores (l).tipo_localizador =
                              '02'
                        THEN
                            v_email__info_laboral :=
                                vsolicitud.vinculacion_finaciera (fl).personas (
                                    i).negocios (n).localizadores (l).valor;
                        END IF;
                    END LOOP;


                    --
                    FOR d
                        IN 1 ..
                           vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                               n).direcciones.COUNT
                    LOOP
                        --                 DBMS_OUTPUT.PUT_LINE (
                        --                        'FinanciallyLinked.Person('
                        --                     || i
                        --                     || ').Businesses('
                        ----                            || n
                        ----                            || ').Addresses('
                        ----                            || d
                        ----                            || ').addressTypeCode          = '
                        ----                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        ----                                   i).NEGOCIOS (n).Direcciones (d).TIPO_DIRECCION);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').countryCode              = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_PAIS);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').sectionCode              = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_PROVINCIA);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').provinceCode             = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_CANTON);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').municipalityCode         = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_DISTRITO);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').districtMunicipalityCode = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).COD_PUEBLO);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').neighborhoodCode         = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).BARRIO);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').street                   = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).CALLE);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').housingTypeCode          = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).TIPO_CASA);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').addressReference         = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).REFERENCIA);
                        --                        DBMS_OUTPUT.PUT_LINE (
                        --                               'FinanciallyLinked.Person('
                        --                            || i
                        --                            || ').Businesses('
                        --                            || n
                        --                            || ').Addresses('
                        --                            || d
                        --                            || ').ResideSince              = '
                        --                            || vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS (
                        --                                   i).NEGOCIOS (n).Direcciones (d).RESIDE_DESDE);
                        --


                        v_direccion_detalle :=
                            f_direccion_completa (
                                pcod_pais_iso          =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_pais, --VARCHAR2,
                                pcod_canton            =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_canton, --VARCHAR2,
                                pcod_provincia         =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_provincia, --VARCHAR2,
                                pcod_distrito          =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).cod_distrito, --VARCHAR2,
                                pcalle                 =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).direcciones (d).calle,
                                pincluyedespais        => 'N',
                                pincluyedesprovincia   => 'N');    --VARCHAR2)
                    END LOOP;

                    ---p_depura(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).NEGOCIOS(n).CODIGO);

                    --                    p_depura (
                    --                           'infolaboral Linea: '
                    --                        || $$plsql_line
                    --                        || ' vcod_persona: '
                    --                        || vcod_persona);
                    --                    p_depura (
                    --                           'infolaboral Linea: '
                    --                        || $$plsql_line
                    --                        || ' vcod_persona: '
                    --                        || vcod_persona
                    --                        || ' : NVL(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).EVALUACIONES.INGRESOS_SALARIALES.SALARIO,0)  NVL(vSolicitud.VINCULACION_FINACIERA(fl).PERSONAS(i).EVALUACIONES.INGRESOS_SALARIALES.OTROS_INGRESOS ,0): '
                    --                        || TO_CHAR (
                    --                               vsolicitud.vinculacion_finaciera (fl).personas (
                    --                                   i).evaluaciones.ingresos_salariales.salario)
                    --                        || ' - '
                    --                        || TO_CHAR (
                    --                               vsolicitud.vinculacion_finaciera (fl).personas (
                    --                                   i).evaluaciones.ingresos_salariales.otros_ingresos));

                    IF vsolicitud.vinculacion_finaciera (fl).personas (i).negocios (
                           n).nombre
                           IS NOT NULL ---AND pPersona.INFORMACION_TRABAJO.FECHA_INGRESO IS NOT NULL
                    THEN
                        BEGIN
                            p_info_laboral (
                                p_persona     => vcod_persona, ---In  Varchar2,
                                p_fec_ing     =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).fecha_inicio_operacion, --                                      pPersona.INFORMACION_TRABAJO.FECHA_INGRESO,
                                p_lugar_lab   =>
                                    vsolicitud.vinculacion_finaciera (fl).personas (
                                        i).negocios (n).nombre,
                                p_sueldo      =>
                                      NVL (
                                          vsolicitud.vinculacion_finaciera (
                                              fl).personas (i).evaluaciones.ingresos_salariales.salario,
                                          0)
                                    + NVL (
                                          vsolicitud.vinculacion_finaciera (
                                              fl).personas (i).evaluaciones.ingresos_salariales.otros_ingresos,
                                          0), --                                                    pPersona.INFORMACION_TRABAJO.SALARIO_MENSUAL, ---In  Number,
                                p_puesto      =>
                                    vsolicitud.persona (i).informacion_trabajo.cargo, --malmanzar 05-02-2024 -- pPersona.INFORMACION_TRABAJO.CARGO, ---In  Varchar2,
                                p_direccion   => v_direccion_detalle, --pPERSONA.INFORMACION_TRABAJO.DIRECCION.DETALLE, ---pPersona.INFORMACION_TRABAJO.,---In  Varchar2,  --Pendiene
                                p_telefono    => v_telefono_info_laboral, --                                                    pPersona.INFORMACION_TRABAJO.NUMERO_TELEFONO, ---In  Varchar2,
                                p_extension   => NULL, --                                                    pPersona.INFORMACION_TRABAJO.EXTENSION_TELEFONICA, ---In  Varchar2,
                                p_procesado   => v_procesado, ---Out Varchar2,
                                p_msgerr      => p_msgerr      ---Out Varchar2
                                                         );
                        EXCEPTION
                            WHEN OTHERS
                            THEN
                                p_depura ('sqlerrm: ' || SQLERRM);
                                raise_application_error (
                                    -20400,
                                    'Error procesando info laboral');
                        END;
                    END IF;
                END LOOP;

                --Conyuge  02-10-2023 Begin
                --if  vSolicitud.VINCULACION_FINACIERA(fl).CODIGO_VINCULACION_FINAN
                --Conyuge 02-10-2023 End

                --Cuenta relacion Begin
                IF vcod_persona IS NOT NULL
                THEN
                    IF vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan =
                       '04'
                    THEN
                        BEGIN
                            UPDATE personas_fisicas
                               SET conyugue = vcod_persona
                             WHERE cod_per_fisica = reg1.codigo_cliente; --v_persona;
                        EXCEPTION
                            WHEN OTHERS
                            THEN
                                NULL;
                        END;
                    ELSIF vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan IN
                              ('02', '03')         -- =  '02' --IN('02', '03')
                    THEN
                        --
                        -- Tipos de Solicitantes
                        --
                        --01 Cliente
                        --02 Fiador
                        --03 Codeudor
                        --04 Conyuge

                        DECLARE
                            vnumero_linea   NUMBER;
                        BEGIN
                            SELECT NVL (MAX (numero_linea), 0) + 1
                              INTO vnumero_linea
                              FROM cuenta_cliente_relacion
                             WHERE num_cuenta = TO_CHAR (reg1.no_credito);

                            --
                            --                            p_depura (
                            --                                   'vCod_Persona: '
                            --                                || vcod_persona
                            --                                || 'vSolicitud.VINCULACION_FINACIERA(fl).CODIGO_VINCULACION_FINAN : '
                            --                                || vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan
                            --                                || ' Linea: '
                            --                                || $$plsql_line);

                            --Inserta en tabla cuenta cliente relación
                            INSERT INTO cuenta_cliente_relacion (
                                            num_cuenta,
                                            codigo_cliente,
                                            tipo_relacion,
                                            principal,
                                            cod_sistema,
                                            estado,
                                            numero_linea)
                                     VALUES (
                                                reg1.no_credito,
                                                vcod_persona,
                                                CASE
                                                    WHEN vsolicitud.vinculacion_finaciera (
                                                             fl).codigo_vinculacion_finan =
                                                         '02'
                                                    THEN
                                                        'F'           --Fiador
                                                    ELSE
                                                        'O'         --Codeudor
                                                END,
                                                'N',
                                                'PR',
                                                NULL,
                                                vnumero_linea              --2
                                                             );
                        EXCEPTION
                            WHEN DUP_VAL_ON_INDEX
                            THEN
                                NULL;
                        END;
                    END IF;
                END IF;

                --Cuenta_relacion End



                --Fec Vinculados Begin
                pcreafecpersona (
                    p_solicitud                      => reg1.no_credito,
                    p_codcliente                     => vcod_persona, ---reg1.codigo_cliente,
                    p_codagencia                     => reg1.codigo_agencia, -- IN NUMBER,
                    ptipo_solicitante                =>
                        vsolicitud.vinculacion_finaciera (fl).codigo_vinculacion_finan, --vTipo_Solicitante,     ---Temp
                    --P_cuotasegurocal,
                    ----              monedacal,
                    p_destinocredito                 =>
                        vsolicitud.info_prestamo.destino_credito, -----Temp IN VARCHAR2 ,
                    p_especifiquedestino             =>
                        vsolicitud.info_prestamo.destino_credito_especif, --Temp--IN VARCHAR2,
                    pidtempfec                       => 0,    --IN OUT NUMBER,
                    pnomarchivo                      => '0', --IN OUT VARCHAR2,
                    pidevaluacioncrediticia          => '0', --IN OUT VARCHAR2,
                    ptipodocumentoidentidad          => '0', --IN OUT VARCHAR2,
                    pdocumentoidentidad              => '0', --IN OUT VARCHAR2,
                    pnombrecliente                   => '0', --IN OUT VARCHAR2,
                    pnumerosolicitud                 => p_nrocredito, --IN OUT NUMBER,
                    pmontorecomendado                => reg1.monto_credito, --IN OUT NUMBER,
                    pfrecuencia                      =>
                        vsolicitud.info_prestamo.codigo_frecuencia_pago, --IN OUT VARCHAR2, --malmanzar 14-07-222
                    pplazo                           => reg1.plazo, --IN OUT NUMBER,
                    ppro1ventasmensuales             => 0,    --IN OUT NUMBER,
                    ppro2ventasmensuales             => 0,    --IN OUT NUMBER,
                    ppro3ventasmensuales             => 0,    --IN OUT NUMBER,
                    pprootroventasmensuales          => 0,    --IN OUT NUMBER,
                    pventasmensuales1                => 0,    --IN OUT NUMBER,
                    pventasmensuales2                => 0,    --IN OUT NUMBER,
                    pventasmensuales3                => 0,    --IN OUT NUMBER,
                    pventasmensuales4                => 0,    --IN OUT NUMBER,
                    pventasmensuales5                => 0,    --IN OUT NUMBER,
                    pventasmensuales6                => 0,    --IN OUT NUMBER,
                    pventasmensuales7                => 0,    --IN OUT NUMBER,
                    pventasmensuales8                => 0,    --IN OUT NUMBER,
                    pventasmensualesot               => 0,    --IN OUT NUMBER,
                    pventas_ingresos                 =>
                        NVL (
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i).evaluaciones.ingresos_salariales.salario,
                            vsolicitud.vinculacion_finaciera (fl).personas (
                                i).evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas), --30-01-2024 --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_MENSUALES_DECLARADAS, --/**/ -- vSolicitud.EVALUACIONES.TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                    ppro1costosventasmensuales       => 0,    --IN OUT NUMBER,
                    ppro2costosventasmensuales       => 0,    --IN OUT NUMBER,
                    ppro3costosventasmensuales       => 0,    --IN OUT NUMBER,
                    pprootrocostosventasmensuales    => 0,    --IN OUT NUMBER,
                    pcostoventas1                    => 0,    --IN OUT NUMBER,
                    pcostoventas2                    => 0,    --IN OUT NUMBER,
                    pcostoventas3                    => 0,    --IN OUT NUMBER,
                    pcostoventas4                    => 0,    --IN OUT NUMBER,
                    pcostoventas5                    => 0,    --IN OUT NUMBER,
                    pcostoventas6                    => 0,    --IN OUT NUMBER,
                    pcostoventas7                    => 0,    --IN OUT NUMBER,
                    pcostoventas8                    => 0,    --IN OUT NUMBER,
                    pcostoventasot                   => 0,    --IN OUT NUMBER,
                    pcostoventas                     =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.costo_ventas,
                    ---vSolicitud.EVALUACIONES.ESTADO_RESULTADO.COSTO_VENTAS, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.MATRIX_COSTO_INGRESOS.COSTO_MENSUAL_VENTAS, -- vSolicitud.EVALUACIONES.TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                    psueldo                          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_salarial, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_SALARIAL, --IN OUT NUMBER,
                    pservicio                        =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_servicios, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_SERVICIOS, --IN OUT NUMBER,
                    palquiler                        =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.pagos_renta, --IN OUT NUMBER,  --Pendiente
                    ptransporte_combs                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_combustible, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_COMBUSTIBLE, --IN OUT NUMBER,
                    ppagointereses                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.gastos_interes_pagos, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_INTERES_PAGOS, --vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GASTOS_INTERES_PAGOS, --IN OUT NUMBER,
                    potrosingresos_operacionales     =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.otros_ingresos, --IN OUT NUMBER, --Pendiente
                    palimentacion                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_alimentacion, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_ALIMENTACION, --IN OUT NUMBER,
                    pvivienda                        =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_vivienda, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_VIVIENDA, --IN OUT NUMBER,
                    pvestido                         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_ropa, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_ROPA, --IN OUT NUMBER,
                    ptransporte                      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_transportacion, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_TRANSPORTACION, --IN OUT NUMBER,
                    pservicios                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_servicios, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_SERVICIOS, --IN OUT NUMBER,
                    pmedicinas                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_medicos, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_MEDICOS, --IN OUT NUMBER,
                    peducacion                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.gastos_educacion, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.GASTOS_EDUCACION, --IN OUT NUMBER,
                    pdeudasfamiliares                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.debitos, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.DEBITOS, --IN OUT NUMBER,
                    potros_gastos                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.otros_gastos, --vSolicitud.EVALUACIONES.COSTOS_FAMILIARES.OTROS_GASTOS, --IN OUT NUMBER,
                    ptotalgastos_familiares          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.total_gastos, --IN OUT NUMBER, --pendiente
                    pexcedentefamiliar               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.gastos_del_hogar.excedente_familiar, --IN OUT NUMBER, --pendiente
                    potros                           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.otros_gastos, ---otros ingresos--vSolicitud.EVALUACIONES.COSTOS_OPERACION_NEGOCIO.OTROS_INGRESOS, --IN OUT NUMBER,
                    --/  Balance Comercial/
                    pmaquinaria_mueblesequipos       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.maquinaria_mobiliario_eq, ---                vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.MAQUINARIA_MOBILIARIO_EQ, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.MAQUINARIA_MOBILIARIO_EQ, --IN OUT NUMBER,
                    pefectivo_cajabanco              =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.efectivo_caja_chica, --       vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.EFECTIVO_CAJA_CHICA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.EFECTIVO_CAJA_CHICA, --IN OUT NUMBER,
                    pcuentaxcobrar                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuentas_por_cobrar, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CUENTAS_POR_COBRAR, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CUENTAS_POR_COBRAR, --IN OUT NUMBER,
                    pinventario_prod_tem             =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_producto_finalizado, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_FINALIZADO, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_FINALIZADO, --IN OUT NUMBER,
                    pinventario_prod_proc            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_producto_produccion, ---                   vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_PRODUCCION, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_PRODUCTO_PRODUCCION, --IN OUT NUMBER,
                    pinventario_materiaprima         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.inventario_materia_prima, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_MATERIA_PRIMA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.INVENTARIO_MATERIA_PRIMA, --IN OUT NUMBER,
                    pmercancia                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cantidad_mercancia, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CANTIDAD_MERCANCIA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CANTIDAD_MERCANCIA, --IN OUT NUMBER,
                    panticipo_proveedores            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cantidad_proveedor_anticipado, ---Pendiente  --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CANTIDAD_PROVEEDOR_ANTICIPADO, --IN OUT NUMBER,
                    plocalnegocio                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.valor_local_comercial, --                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.VALOR_LOCAL_COMERCIAL, --vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.LOCAL_ALQUILADO,--vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.VALOR_LOCAL_COMERCIAL, --IN OUT NUMBER,
                    pobligacionesfinancieras         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.balance_oblicacion_financiera, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.BALANCE_OBLICACION_FINANCIERA, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.BALANCE_OBLICACION_FINANCIERA, --IN OUT NUMBER,
                    ptotal_pasivo_lp                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_largo_plazo, --            vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_LARGO_PLAZO, ---vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_LARGO_PLAZO, --IN OUT NUMBER,
                    pmueble_vehiculo                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.valor_muebles_vehiculo, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.VALOR_MUEBLES_VEHICULO, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.VALOR_MUEBLES_VEHICULO, --IN OUT NUMBER,
                    pdeudacomercial                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.deuda_comercial, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.DEUDA_COMERCIAL, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.DEUDA_COMERCIAL, --IN OUT NUMBER,
                    ptasa                            => reg1.tasa_interes, --IN OUT NUMBER,  --pendiente
                    pcuota                           => reg1.cuota, --IN OUT NUMBER,  --pendiente
                    pcuentapagarprovedor             =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuenta_por_pagar_proveedor, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_PROVEEDOR, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_PROVEEDOR, --IN OUT NUMBER,
                    pcuentapagarvarias               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.cuenta_por_pagar_varios, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_VARIOS, --vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CUENTA_POR_PAGAR_VARIOS, --IN OUT NUMBER,
                    pinmuebles                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.valor_propiedades, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.VALOR_PROPIEDADES, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.VALOR_PROPIEDADES, --IN OUT NUMBER,
                    ptotal_activofamiliar            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.total_activos_familiares, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.TOTAL_ACTIVOS_FAMILIARES, --IN OUT NUMBER,
                    pdeudabancaria                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.deuda_bancaria, ---                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.DEUDA_BANCARIA, --vSolicitud.EVALUACIONES.BALANCE_FAMILIAR.DEUDA_BANCARIA, --IN OUT NUMBER,
                    ptotal_pasivofamiliar            =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.tota_pasivos_familiar, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.TOTA_PASIVOS_FAMILIAR, --IN OUT NUMBER,
                    ppatrio_fam_balgen               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.total_patrimonio_familiar, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_FAMILIAR.TOTAL_PATRIMONIO_FAMILIAR, --IN OUT NUMBER,   ---
                    ptotal_activocorriente           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos_corrientes, --              vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_ACTIVOS_CORRIENTES, --IN OUT NUMBER,
                    ptotal_activofijo                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos_fijos, --                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_ACTIVOS_FIJOS, --IN OUT NUMBER,
                    ptotal_activos1                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_activos, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_ACTIVOS, --IN OUT NUMBER,
                    ptotal_pasivocorrientes          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_corriente, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_CORRIENTE, --IN OUT NUMBER,
                    ptotal_pasivo                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo, --                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO, --IN OUT NUMBER,
                    ptotal_pasivopatrimonio          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_patrimonio, --                vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.TOTAL_PASIVO_PATRIMONIO, --IN OUT NUMBER,
                    ppasivo_patrimonio               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.total_pasivo_patrimonio, --IN OUT NUMBER,
                    ppatrimonio                      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.patrimonio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.PATRIMONIO, --IN OUT NUMBER,
                    pactivocorte_pascte              => 0,    --IN OUT NUMBER,
                    potrosingresos_excedente         => 0,    --IN OUT NUMBER,
                    pcuotarecomendada_excedfam       => 0,    --IN OUT NUMBER,
                    ptotalpasivo_patrimonio          => 0,    --IN OUT NUMBER,
                    putilidadneta_patrimonio         => 0,    --IN OUT NUMBER,
                    putilidadneta_totalactivos1      => 0,    --IN OUT NUMBER,
                    putilidadneta_ventas             => 0,    --IN OUT NUMBER,
                    pcuentasxcobrar_ventas           => 0,    --IN OUT NUMBER,
                    pcostoventa_inventario           => 0,    --IN OUT NUMBER,
                    pgastoslegales                   =>
                        vsolicitud.info_prestamo.monto_gastos_legales, --IN OUT NUMBER,    --
                    pmoneda                          => '0', --IN OUT VARCHAR2,
                    pcapital_trabajo                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.capital_de_trabajo, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.CAPITAL_DE_TRABAJO, ---vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.CAPITAL_DE_TRABAJO, --IN OUT NUMBER,
                    pfechabalancegeneral             =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_comercial.fecha_balance, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BALANCE_COMERCIAL.FECHA_BALANCE, ---vSolicitud.EVALUACIONES.BALANCE_COMERCIAL.FECHA_BALANCE, --IN OUT VARCHAR2,
                    pdesde                           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.fecha_inicio_eval, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.FECHA_INICIO_EVALUACION, --vSolicitud.EVALUACIONES.FECHA_INICIO_EVALUACION, --IN OUT VARCHAR2,
                    phasta                           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.fecha_fin_eval, --                vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.FECHA_FIN_EVALUACION, --vSolicitud.EVALUACIONES.FECHA_FIN_EVALUACION, --IN OUT VARCHAR2,
                    ptotalcostooperacional           =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.total_costos_operacional, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.TOTAL_COSTOS_OPERACIONAL, --IN OUT NUMBER,
                    putilidadneta                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.costos_operacion_negocio.ganacia_neta, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.GANACIA_NETA, --IN OUT NUMBER,
                    pventasdiarias_promedio          =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_diarias_promedio, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_DIARIAS_PROMEDIO, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_DIARIAS_PROMEDIO, --IN OUT NUMBER,
                    pdiastrabajados                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.dias_trabajados_por_mes, --         vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.DIAS_TRABAJADOS_POR_MES, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.DIAS_TRABAJADOS_POR_MES, --IN OUT NUMBER,
                    pcomprassemanalesdeclaradas      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.compras_semanales_promedio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_SEMANALES_PROMEDIO, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_SEMANALES_PROMEDIO, --IN OUT NUMBER,
                    pventasmensualesdeclaradas       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_MENSUALES_DECLARADAS, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.VENTAS_MENSUALES_DECLARADAS, --IN OUT NUMBER,
                    pmargendeclarado                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.margen_beneficio_declarado, --IN OUT NUMBER,
                    pmontomesalto                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.mayor_beneficio_mes, ----                   vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MONTE_MES_MAS_GANANCIAS, -- vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.MONTE_MES_MAS_GANANCIAS, --IN OUT NUMBER,
                    pmontomesmedio                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.beneficio_prom_mensual, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MONTE_MES, --IN OUT NUMBER,
                    pcomprasmensualesdeclaradas      =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.compras_mensuales_declaradas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_MENSUALES_DECLARADAS, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.COMPRAS_MENSUALES_DECLARADAS, --IN OUT NUMBER,
                    pmontomesbajo                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.menor_beneficio_mes, ---                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MONTO_MES_MENOS_GANANCIAS, --vSolicitud.EVALUACIONES.EVALUACION_FINANCIERA.MONTO_MES_MENOS_GANANCIAS, --IN OUT NUMBER,
                    pventasmensuales                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.ventas_mensuales_declaradas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.MATRIX_COSTO_INGRESOS.VENTAS_MENSUALES, --vSolicitud.EVALUACIONES.TOTAL_VENTAS_MENSUAL, --IN OUT NUMBER,
                    pcostoventamensual               =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.costo_ventas, --                  vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.MATRIX_COSTO_INGRESOS.COSTO_MENSUAL_VENTAS, --vSolicitud.EVALUACIONES.TOTAL_COSTO_VENTAS_MENSUAL, --IN OUT NUMBER,
                    putilidadbruta                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.beneficio_ventas, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.BENEFICIO_BRUTO, --IN OUT NUMBER,
                    pmargenganancia                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_financiera.margen_beneficio_declarado, ---                 vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_FINANCIERA.MARGEN_BENEFICIO_DECLARADO, -- vSolicitud.EVALUACIONES.MATRIX_COSTO_INGRESOS.MARGEN_GANANCIA, --IN OUT NUMBER,
                    pprimera_ref_vecinos             => '0', --IN OUT VARCHAR2,
                    psegunda_ref_vecinos             => '0', --IN OUT VARCHAR2,
                    pambientefamiliar                => '0', --IN OUT VARCHAR2,
                    pdependientes                    => 0,    --IN OUT NUMBER,
                    pedad                            => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                    pestadosaludfamilia              => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                    pingresos                        => '0', --IN OUT VARCHAR2, --Number  27-07-2022
                    potrosingresos                   =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.estado_resultado.otros_ingresos, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.COSTOS_OPERACION_NEGOCIO.OTROS_INGRESOS, --IN OUT VARCHAR2, --Number  27-07-2022
                    pexperiencia_neg                 =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.anio_experiencia_negocio, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.ANIO_EXPERIENCIA_NEGOCIO, --IN OUT NUMBER, --malmanzar 27-07-2022
                    phoras_neg                       =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.horas_trabajo_por_semana, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.HORAS_TRABAJO_POR_SEMANA, --IN OUT NUMBER,
                    plocalpropio                     =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.local_no_alquilado, --0, --IN OUT VARCHAR2, --malmanzar 14-07-2022
                    ptiempoempleo                    =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.tiempo_lugar_negocio, ----                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.TIEMPO_LUGAR_NEGOCIO, --IN OUT NUMBER,
                    pubicacionnegocio                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.codigo_ubicacion_negocio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.LOCALIZACION_NEGOCIO, --IN OUT VARCHAR2,
                    pllevaregistro                   => '0', --IN OUT VARCHAR2,
                    pmejorasnegocio                  =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.es_mejoras_comerciales, --               vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.ES_MEJORAS_COMERCIALES, --IN OUT VARCHAR2,
                    pclientesfrecuentes              =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.numero_frecuencia_clientes, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.NUMERO_FRECUENCIA_CLIENTES, --IN OUT NUMBER,
                    pnivelcompetencia                =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.evaluacion_no_financiera.nivel_competencia_negocio, --                    vSolicitud.VINCULACION_FINACIERA (fl).EVALUACIONES.EVALUACION_NO_FINANCIERA.NIVEL_COMPETICION_NEGOCIO, --IN OUT VARCHAR2, --malmanzar 14-07-2022
                    pfecha_balancegeneral_al         =>
                        vsolicitud.vinculacion_finaciera (fl).personas (i).evaluaciones.balance_familiar.fecha_balance, --'0',    --IN OUT VARCHAR2,
                    --                             IN=> 0, -- OUT
                    pdestinocredito                  =>
                        vsolicitud.info_prestamo.destino_credito, -- '0',    --IN OUT VARCHAR2,
                    pespecifiquedestino              =>
                        vsolicitud.info_prestamo.destino_credito_especif, --'0',    --IN OUT VARCHAR2,
                    pestadosolicitud                 => 0,    --IN OUT NUMBER,
                    pactividadeconomica              => '0', --IN OUT VARCHAR2,
                    pactividadeconomicadinrap        => '0', --IN OUT VARCHAR2,
                    pmargenbrutoestandar             => 0,    --IN OUT NUMBER,
                    pgastosoperacionalesestandar     => 0,    --IN OUT NUMBER,
                    palto_indicadores                => 0,    --IN OUT NUMBER,
                    pbajo_indicadores                => 0,    --IN OUT NUMBER,
                    plunes                           => '0', --IN OUT VARCHAR2,
                    pmartes                          => '0', --IN OUT VARCHAR2,
                    pmiercoles                       => '0', --IN OUT VARCHAR2,
                    pjueves                          => '0', --IN OUT VARCHAR2,
                    pviernes                         => '0', --IN OUT VARCHAR2,
                    psabado                          => '0', --IN OUT VARCHAR2,
                    pdomingo                         => '0', --IN OUT VARCHAR2,
                    ptotal_ventasaltas               => 0,    --IN OUT NUMBER,
                    ptotal_ventasbajas               => 0,    --IN OUT NUMBER,
                    ptotal_ventassemanales           => 0,    --IN OUT NUMBER,
                    ptotal_ventasmensuales           => 0,    --IN OUT NUMBER,
                    pmargenbrutodeclarado            => 0,    --IN OUT NUMBER,
                    palimentacion_gastos             => 0,    --IN OUT NUMBER,
                    pvivienda_gastos                 => 0,    --IN OUT NUMBER,
                    peducacion_gastos                => 0,    --IN OUT NUMBER,
                    psalud_gastos                    => 0,    --IN OUT NUMBER,
                    ptransporte_gastos               => 0,    --IN OUT NUMBER,
                    pvestido_gastos                  => 0,    --IN OUT NUMBER,
                    ppagodeudas_gastos               => 0,    --IN OUT NUMBER,
                    potros_gastos_familiares         => 0,    --IN OUT NUMBER,
                    ptotal_gastos                    => 0,    --IN OUT NUMBER,
                    pventas_gastos                   => 0,    --IN OUT NUMBER,
                    pcostosventas_gastos             => 0,    --IN OUT NUMBER,
                    pgastosoperativos                => 0,    --IN OUT NUMBER,
                    potros_ingresos_gastos           => 0,    --IN OUT NUMBER,
                    ptotal_gastos_familiares         => 0,    --IN OUT NUMBER,
                    pexcedentefamiliar_gastos        => 0,    --IN OUT NUMBER,
                    pcuotasolicitada                 => 0,    --IN OUT NUMBER,
                    prelcuotasolicitada_excfam       => 0,    --IN OUT NUMBER,
                    ---Datos Recom Soli
                    pmonto_recomendacion             => reg1.monto_credito, --reg1.monto_credito,--0,        --IN OUT NUMBER,
                    pmoneda_recomendacion            => reg1.codigo_moneda, --'0',    --IN OUT VARCHAR2,
                    pplazo_recomendacion             => reg1.plazo_segun_unidad, --0,        --IN OUT NUMBER,
                    ptasa_recomendacion              => reg1.tasa_interes, --0,        --IN OUT NUMBER,
                    pfrecuencia_recomendacion        =>
                        vsolicitud.info_prestamo.codigo_frecuencia_pago, --'0',    --IN OUT VARCHAR2,
                    pcuota_recomendacion             => reg1.cuota, -- 0,        --IN OUT NUMBER,
                    pestadosolicitud_recomendacion   => 0,    --IN OUT NUMBER,
                    pcuotarecomendada_excfamiliar    => 0,    --IN OUT NUMBER,
                    pventasevalanterior              => 0,    --IN OUT NUMBER,
                    pactual_ventas                   => 0,    --IN OUT NUMBER,
                    pvariacionventas                 => 0,    --IN OUT NUMBER,
                    pcomentario1                     => '0', --IN OUT VARCHAR2,
                    pcomentario2                     => '0', --IN OUT VARCHAR2,
                    ppro1nombre                      => '0', --IN OUT VARCHAR2,
                    ppro1materiaprima1               => 0,    --IN OUT NUMBER,
                    ppro1materiaprima2               => 0,    --IN OUT NUMBER,
                    ppro1materiaprima3               => 0,    --IN OUT NUMBER,
                    ppro1totalmp                     => 0,    --IN OUT NUMBER,
                    ppro1sueldo1                     => 0,    --IN OUT NUMBER,
                    ppro1sueldo2                     => 0,    --IN OUT NUMBER,
                    ppro1totalsueldo                 => 0,    --IN OUT NUMBER,
                    ppro1otroscostos                 => 0,    --IN OUT NUMBER,
                    ppro1totalcostos                 => 0,    --IN OUT NUMBER,
                    ppro1costounitario               => 0,    --IN OUT NUMBER,
                    ppro1preciounitario              => 0,    --IN OUT NUMBER,
                    ppro1unidadesvendidas            => 0,    --IN OUT NUMBER,
                    ppro1margenganancia              => 0,    --IN OUT NUMBER,
                    ppro2nombre                      => '0', --IN OUT VARCHAR2,
                    ppro2materiaprima1               => 0,    --IN OUT NUMBER,
                    ppro2materiaprima2               => 0,    --IN OUT NUMBER,
                    ppro2materiaprima3               => 0,    --IN OUT NUMBER,
                    ppro2totalmp                     => 0,    --IN OUT NUMBER,
                    ppro2sueldo1                     => 0,    --IN OUT NUMBER,
                    ppro2sueldo2                     => 0,    --IN OUT NUMBER,
                    ppro2totalsueldo                 => 0,    --IN OUT NUMBER,
                    ppro2otroscostos                 => 0,    --IN OUT NUMBER,
                    ppro2totalcostos                 => 0,    --IN OUT NUMBER,
                    ppro2costounitario               => 0,    --IN OUT NUMBER,
                    ppro2preciounitario              => 0,    --IN OUT NUMBER,
                    ppro2unidadesvendidas            => 0,    --IN OUT NUMBER,
                    ppro2margenganancia              => 0,    --IN OUT NUMBER,
                    ppro3nombre                      => '0', --IN OUT VARCHAR2,
                    ppro3materiaprima1               => 0,    --IN OUT NUMBER,
                    ppro3materiaprima2               => 0,    --IN OUT NUMBER,
                    ppro3materiaprima3               => 0,    --IN OUT NUMBER,
                    ppro3totalmp                     => 0,    --IN OUT NUMBER,
                    ppro3sueldo1                     => 0,    --IN OUT NUMBER,
                    ppro3sueldo2                     => 0,    --IN OUT NUMBER,
                    ppro3totalsueldo                 => 0,    --IN OUT NUMBER,
                    ppro3otroscostos                 => 0,    --IN OUT NUMBER,
                    ppro3totalcostos                 => 0,    --IN OUT NUMBER,
                    ppro3costounitario               => 0,    --IN OUT NUMBER,
                    ppro3preciounitario              => 0,    --IN OUT NUMBER,
                    ppro3unidadesvendidas            => 0,    --IN OUT NUMBER,
                    ppro3margenganancia              => 0,    --IN OUT NUMBER,
                    pprootromateriaprima1            => 0,    --IN OUT NUMBER,
                    pprootromateriaprima2            => 0,    --IN OUT NUMBER,
                    pprootromateriaprima3            => 0,    --IN OUT NUMBER,
                    pprootrototalmp                  => 0,    --IN OUT NUMBER,
                    pprootrosueldo1                  => 0,    --IN OUT NUMBER,
                    pprootrosueldo2                  => 0,    --IN OUT NUMBER,
                    pprootrototalsueldo              => 0,    --IN OUT NUMBER,
                    pprootrootroscostos              => 0,    --IN OUT NUMBER,
                    pprootrototalcostos              => 0,    --IN OUT NUMBER,
                    pprootrocostounitario            => 0,    --IN OUT NUMBER,
                    pprootropreciounitario           => 0,    --IN OUT NUMBER,
                    pprootrounidadesvendidas         => 0,    --IN OUT NUMBER,
                    pprootromargenganancia           => 0,    --IN OUT NUMBER,
                    plinea1                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario1                 => 0,    --IN OUT NUMBER,
                    pcostounitario1                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia1               => 0,    --IN OUT NUMBER,
                    punidadesvendidas1               => 0,    --IN OUT NUMBER,
                    plinea2                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario2                 => 0,    --IN OUT NUMBER,
                    pcostounitario2                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia2               => 0,    --IN OUT NUMBER,
                    punidadesvendidas2               => 0,    --IN OUT NUMBER,
                    plinea3                          => 0,  --IN OUT VARCHAR2,
                    ppreciounitario3                 => 0,    --IN OUT NUMBER,
                    pcostounitario3                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia3               => 0,    --IN OUT NUMBER,
                    punidadesvendidas3               => 0,    --IN OUT NUMBER,
                    plineaot                         => 0,  --IN OUT VARCHAR2,
                    ppreciounitarioot                => 0,    --IN OUT NUMBER,
                    pcostounitarioot                 => 0,    --IN OUT NUMBER,
                    pmargendegananciaot              => 0,    --IN OUT NUMBER,
                    punidadesvendidasot              => 0,    --IN OUT NUMBER,
                    ptipocredito                     => '0', --IN OUT VARCHAR2,
                    pgarantias                       => '0', --IN OUT VARCHAR2,
                    pvalorgarantia                   => '0', --IN OUT VARCHAR2,
                    pdescripciongarantia             => '0', --IN OUT VARCHAR2,
                    pprestamodescontar               => '0', --IN OUT VARCHAR2,
                    plinea4                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario4                 => 0,    --IN OUT NUMBER,
                    pcostounitario4                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia4               => 0,    --IN OUT NUMBER,
                    punidadesvendidas4               => 0,    --IN OUT NUMBER,
                    plinea5                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario5                 => 0,    --IN OUT NUMBER,
                    pcostounitario5                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia5               => 0,    --IN OUT NUMBER,
                    punidadesvendidas5               => 0,    --IN OUT NUMBER,
                    plinea6                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario6                 => 0,    --IN OUT NUMBER,
                    pcostounitario6                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia6               => 0,    --IN OUT NUMBER,
                    punidadesvendidas6               => 0,    --IN OUT NUMBER,
                    plinea7                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario7                 => 0,    --IN OUT NUMBER,
                    pcostounitario7                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia7               => 0,    --IN OUT NUMBER,
                    punidadesvendidas7               => 0,    --IN OUT NUMBER,
                    plinea8                          => '0', --IN OUT VARCHAR2,
                    ppreciounitario8                 => 0,    --IN OUT NUMBER,
                    pcostounitario8                  => 0,    --IN OUT NUMBER,
                    pmargendeganancia8               => 0,    --IN OUT NUMBER,
                    punidadesvendidas8               => 0,    --IN OUT NUMBER,
                    pcomentario                      => '0', --IN OUT VARCHAR2,
                    pidoficial                       => '0', --IN OUT VARCHAR2,
                    pfecharegistro                   => SYSDATE, --IN OUT DATE,
                    pfechafija                       => '0', --IN OUT VARCHAR2,
                    pidestado                        => '0', --IN OUT VARCHAR2,
                    pmensaje                         => '0', --IN OUT VARCHAR2,
                    pnosubida                        => '0', --IN OUT VARCHAR2,
                    pidgrupo                         => '0', --IN OUT VARCHAR2,
                    pimpreso                         => '0', --IN OUT VARCHAR2,
                    /*Valores a retornar para elimina=> 0, --r uso Funci¿n fnupdatefud que ejecuta via WS
                       proceso debe implementarse en => 0, --el llamado de SQL/Server
                      */
                    pestadofec                       => vestadofec, --IN OUT VARCHAR2,
                    pmensajefec                      => vmensajefec --, --IN OUT VARCHAR2,
                                                                   --pNoSolicitud                     => vNoSolicitud --IN OUT NUMBER
                                                                   );
            END LOOP;      -----vSolicitud.VINCULACION_FINACIERA (fl).PERSONAS
        END LOOP;                        ---- vSolicitud.VINCULACION_FINACIERA

        --fl info_laboral Begin 26-01-2024
        --**
        FOR s IN 1 .. vsolicitud.info_prestamo.seguros.COUNT
        LOOP
            --            p_depura ('Linea: ' || $$plsql_line);
            --            DBMS_OUTPUT.put_line (
            --                   'LoanInfo.insurances('
            --                || s
            --                || ').insuranceTypeCode = '
            --                || vsolicitud.info_prestamo.seguros (s).tipo_seguro);
            --            DBMS_OUTPUT.put_line (
            --                   'LoanInfo.insurances('
            --                || s
            --                || ').amount = '
            --                || vsolicitud.info_prestamo.seguros (s).monto);

            --Seguros Begin

            --Recalcular seguro de vida 28-03-2023 para incluir codeudor en el c¿lculo
            --                    IF NVL (vEsVida, 'N') = 'S'
            --                    THEN
            DECLARE
                cmensaje         VARCHAR2 (500);
                vmonto_calculo   NUMBER;
                --Out
                vesvida          VARCHAR2 (1);
                vesvehiculo      VARCHAR2 (1);
                vesincendio      VARCHAR2 (1);
                vesincendiopy    VARCHAR2 (1);
                vesdesempleo     VARCHAR2 (1);
                vcodeudor        VARCHAR2 (30);
            BEGIN
                --                p_depura (
                --                       'Linea: '
                --                    || $$plsql_line
                --                    || ' VSolicitud.INFO_PRESTAMO.SEGUROS(s).TIPO_SEGURO: '
                --                    || vsolicitud.info_prestamo.seguros (s).tipo_seguro);

                --30-01-2024
                IF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'V'
                THEN
                    vesvida := 'S';                              --Seguro Vida
                    vesvehiculo := 'N';
                    vesincendio := 'N';
                    vesincendiopy := 'N';
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'H'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'N';
                    vesincendio := 'S';                          --Hipotecario
                    vesincendiopy := 'N';
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'I'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'N';
                    vesincendio := 'N';
                    vesincendiopy := 'S';                      --Incendio Pyme
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'A'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'S';                             --Vehiculo
                    vesincendio := 'N';
                    vesincendiopy := 'N';
                    vesdesempleo := 'N';
                ELSIF vsolicitud.info_prestamo.seguros (s).tipo_seguro = 'D'
                THEN
                    vesvida := 'N';
                    vesvehiculo := 'N';
                    vesincendio := 'N';
                    vesincendiopy := 'N';
                    vesdesempleo := 'S';                           --Desempleo
                END IF;



                IF vesdesempleo = 'N'
                THEN
                    pkg_polizas.agrega_poliza (
                        pempresa        => 1,
                        pcredito        => p_nrocredito,      ---p_no_credito,
                        pfecha          => TRUNC (SYSDATE), ---p_credito.f_apertura,
                        --Sysdate,
                        pesvida         => vesvida,                     --'S',
                        pesvehiculo     => vesvehiculo,                 --'N',
                        pesincendio     => vesincendio,                -- 'N',
                        pesincendiopy   => vesincendiopy,               --'N',
                        pmensajeerror   => cmensaje,
                        pcodeudor       => vcodeudor, --v_persona,    --vncodeudor,
                        paccion         => 'I', --C = Solo c¿lculo, I = Calcula e inserta
                        ptipopoliza     => NULL, --  VSolicitud.INFO_PRESTAMO.SEGUROS (s).TIPO_SEGURO, -- NULL,  --30-01-2024
                        pmontocalculo   => vmonto_calculo);

                    --Incendio Pyme
                    IF vesincendiopy = 'S'
                    THEN                                --malmanzar 16-09-2024
                        UPDATE pr_creditos
                           SET esincendio_pyme = 'S'
                         WHERE     codigo_empresa = 1
                               AND no_credito = p_nrocredito;
                    --Vehículo
                    ELSIF vesvehiculo = 'S'
                    THEN
                        UPDATE pr_creditos c
                           SET c.esvehiculo = 'S'
                         WHERE     codigo_empresa = 1
                               AND no_credito = p_nrocredito;
                    --Incendio     \
                    ELSIF vesincendio = 'S'
                    THEN
                        UPDATE pr_creditos v
                           SET v.esincendio = 'S'
                         WHERE     codigo_empresa = 1
                               AND no_credito = p_nrocredito;
                    END IF;
                ELSE
                    --OMARIOT 08/06/2018 REQ_84355 Seguro Desempleo
                    BEGIN
                        --IF NVL (pSEGURODESEMPLEODIS, 0) = 1
                        ---THEN
                        DECLARE
                            vparamlist             pkg_polizas.tlistaparam
                                                       := pkg_polizas.tlistaparam ();
                            nindex                 PLS_INTEGER := 0;
                            nedad                  NUMBER := 0;
                            nedadminima            NUMBER := 0;
                            nedadmaxima            NUMBER := 0;

                            perrordescription      VARCHAR2 (500);

                            form_trigger_failure   EXCEPTION;
                        BEGIN
                            BEGIN
                                --  Calcula la edad de la persona
                                SELECT TRUNC (
                                             (  TRUNC (SYSDATE)
                                              - p.fec_nacimiento)
                                           / 365)
                                  INTO nedad
                                  FROM pa.personas_fisicas p
                                 WHERE p.cod_per_fisica = reg1.codigo_cliente; ---v_persona; --:BKCREDIT.CODIGO_CLIENTE;
                            EXCEPTION
                                WHEN NO_DATA_FOUND
                                THEN
                                    perrordescription :=
                                        'El cliente no está registrado como persona fisica.';
                                    --Message(' ');
                                    RAISE form_trigger_failure;
                            END;

                            nedadminima :=
                                TO_NUMBER (
                                    param.parametro_x_empresa (
                                        1,
                                        'POL_DESEMPLEOEDADMIN',
                                        'PR'));
                            nedadmaxima :=
                                TO_NUMBER (
                                    param.parametro_x_empresa (
                                        1,
                                        'POL_DESEMPLEOEDADMAX',
                                        'PR'));

                            --  Validación de la edad de la persona dentro del rango permitido
                            IF nedad BETWEEN (nedadminima) AND (nedadmaxima)
                            THEN
                                ---MARCA_INDICADOR_POLIZA;

                                vparamlist.delete;
                                nindex := nindex + 1;
                                vparamlist.EXTEND;
                                vparamlist (nindex) :=
                                    pkg_polizas.agrega_parametro (
                                        pnombreparam   => 'ESDESEMPLEO',
                                        puso           => 'D',
                                        pindparam      => 'S');

                                pkg_polizas.agrega_poliza_list (
                                    pempresa         => 1, ---:Variables.CodEmpresa,
                                    pcredito         => reg1.no_credito, --vFudRow.nocredito, ---:BKCredit.No_Credito,
                                    pfecha           => SYSDATE, ---vFudRow.fecha_registro, --:Variables.Fecha,
                                    pindtipopoliza   => vparamlist,
                                    pmensajeerror    => perrordescription);

                                IF perrordescription IS NOT NULL
                                THEN
                                    RAISE form_trigger_failure;
                                ELSE
                                    agregar_indicador_marcarpoliza (
                                        1,
                                        reg1.no_credito, ---vFudRow.nocredito,
                                        0,
                                        'D',
                                        'S',
                                        perrordescription);

                                    IF perrordescription IS NOT NULL
                                    THEN
                                        RAISE form_trigger_failure;
                                    END IF;
                                END IF;
                            ELSE
                                perrordescription :=
                                       'La Persona debe tener la edad permitida ('
                                    || nedadminima
                                    || '-'
                                    || nedadmaxima
                                    || ') para este tipo de póliza.';

                                RAISE form_trigger_failure;
                            END IF;
                        EXCEPTION
                            WHEN form_trigger_failure
                            THEN
                                ROLLBACK;
                                RETURN;
                        END;
                    END;
                END IF;



                --                p_depura (
                --                       'VSolicitud.INFO_PRESTAMO.SEGUROS(s).TIPO_SEGURO: '
                --                    || vsolicitud.info_prestamo.seguros (s).tipo_seguro
                --                    || '  cmensaje: '
                --                    || cmensaje);

                COMMIT;



                vtasks := pr.pkg_portacredit2.obtenertareas;
                pc_task := vtasks;
            --                p_depura (
            --                       'cmensaje: '
            --                    || cmensaje
            --                    || ' vmonto_calculo: '
            --                    || vmonto_calculo);
            EXCEPTION
                WHEN OTHERS
                THEN
                    p_depura (
                        'Linea: ' || $$plsql_line || ' sqlerrm: ' || SQLERRM);
                    NULL;
            END;
        --- END IF;                                           --ESVIDA
        --Seguros End

        END LOOP;

        --End
        ---vTasks := PR.PKG_PORTACREDIT2.ObtenerTareas;
        pc_task := vtasks;
    END p_solicitud_credito;

    PROCEDURE pcrearsolicitud (vsolicitud         IN     pr.solicitud_credito_obj,
                               pn_nocredito          OUT NUMBER,
                               pc_task               OUT pa.tarea_list,
                               errorcode          IN OUT VARCHAR2,
                               errordescription   IN OUT VARCHAR2)
    IS
        vl_solicitud          pr.solicitud_credito_obj;
        vl_nocredito          NUMBER;
        vc_task               pa.tarea_list;
        vl_errorcode          VARCHAR2 (100);
        vl_errordescription   VARCHAR2 (4000);

        verrores_solicitud    NUMBER;
    BEGIN
        vl_solicitud := vsolicitud;

        BEGIN
            p_solicitud_cliente (vsolicitud         => vl_solicitud, -- IN     pr.solicitud_credito_obj,
                                 pn_nocredito       => vl_nocredito, --    OUT NUMBER,
                                 pc_task            => vc_task, --    OUT pa.tarea_list,
                                 errorcode          => vl_errorcode, -- IN OUT VARCHAR2,
                                 errordescription   => vl_errordescription -- IN OUT VARCHAR2
                                                                          );
        --            IF vl_errordescription IS NOT NULL
        --            THEN
        --                raise_application_error (num   => -20000,
        --                                         msg   => errordescription);
        --            END IF;
        --        EXCEPTION
        --            WHEN OTHERS
        --            THEN
        --                errorcode := '3001';
        --                errordescription :=
        --                    '3001-Error procesando cliente - sqlerrm: ' || SQLERRM;
        --                ROLLBACK;
        --                raise_application_error (num   => -20000,
        --                                         msg   => errordescription);
        END;

        vl_nocredito := NULL;
        vl_errorcode := NULL;
        vl_errordescription := NULL;

        BEGIN
            p_solicitud_credito (vsolicitud         => vl_solicitud, -- IN     pr.solicitud_credito_obj,
                                 pn_nocredito       => vl_nocredito, --    OUT NUMBER,
                                 pc_task            => vc_task, --    OUT pa.tarea_list,
                                 errorcode          => vl_errorcode, -- IN OUT VARCHAR2,
                                 errordescription   => vl_errordescription -- IN OUT VARCHAR2
                                                                          );

            pn_nocredito := vl_nocredito;
            pc_task := vc_task;
            errorcode := vl_errorcode;
            errordescription := vl_errordescription;
        EXCEPTION
            WHEN OTHERS
            THEN
                errorcode := '4001';
                errordescription :=
                    '4001-Error procesando crédito - sqlerrm: ' || SQLERRM;
                raise_application_error (num   => -20000,
                                         msg   => errordescription);
        END;
    END;                                                                    --
END;